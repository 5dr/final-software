!function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="https://static.parastorage.com/services/adi-web/2.540.0/",i.p="undefined"!=typeof window&&window.__STATICS_BASE_URL__||i.p,i(i.s=474)}({0:function(e,t){e.exports=_},474:function(e,t,i){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(475),r=o.cc,a=o.commonControls,s=o.P23RichTextInput,l=o.CcPanelFrame;i(477),i(478);var c=i(479),d=c.core,u=c.LogoColorExtraction,p=c.DocumentServicesMediator,h=c.LogoColorService,g=c.preset;Object.assign(window,{cc:r,commonControls:a,P23RichTextInput:s,CcPanelFrame:l,core:n({},d,window.core,d),LogoColorExtraction:u,LogoColorService:h,DocumentServicesMediator:p,preset:g})},475:function(e,t,i){"use strict";var n,o,r,a;_e.$inject=["$window"];var s=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};angular.module("commonControlsAppInternal",["commonControlsTranslations","commonControlsPreload","ngSanitize"]).run(["$location","ccFlags",function(e,t){t=s({},e.search(),t)}]).config(["$animateProvider",function(e){e.classNameFilter(/^((?!cc-no-animation).)*$/)}]),angular.module("commonControlsApp",["commonControlsAppInternal","ngMaterial","as.sortable","monospaced.elastic","wixAngular","wix.common.bi"]).config(["CCSvgIconServiceProvider",function(e){e.setSpritePrefix("images/svg-sprites/icons.sprite.svg")}]);var l=function(){return function(){this.KEY_UP=38,this.KEY_DOWN=40,this.KEY_ENTER=13,this.KEY_ESC=27,this.KEY_TAB=9,this.KEY_SHIFT=16,this.KEY_A=65,this.KEY_B=66,this.KEY_C=67}}();angular.module("commonControlsAppInternal").constant("keyMap",new l);var c=function(){function e(){this.list=[{name:"help",type:"hint",appearance:"info"},{name:"settings",type:"hint",appearance:"info"},{name:"edit",type:"hint",appearance:"info"},{name:"crop",type:"hint",appearance:"info"},{name:"back",type:"hint",appearance:"info"},{name:"hidden_item",type:"hint",appearance:"info"},{name:"show_item",type:"hint",appearance:"info"},{name:"disabled_item",type:"rich",appearance:"info"},{name:"hide_item",type:"hint",appearance:"info"},{name:"richtext_bold",type:"hint",appearance:"info"},{name:"richtext_italic",type:"hint",appearance:"info"},{name:"richtext_underline",type:"hint",appearance:"info"},{name:"richtext_bullets",type:"hint",appearance:"info"},{name:"richtext_numbers",type:"hint",appearance:"info"},{name:"richtext_add-link",type:"hint",appearance:"info"},{name:"richtext_edit-link",type:"hint",appearance:"info"},{name:"richtext_cannot-link",type:"rich",appearance:"info"},{name:"color",type:"hint",appearance:"info"},{name:"image",type:"hint",appearance:"info"},{name:"video",type:"hint",appearance:"info"},{name:"gallery",type:"hint",appearance:"info"},{name:"pattern",type:"hint",appearance:"info"},{name:"shape",type:"hint",appearance:"info"},{name:"richtext_clear-formatting",type:"hint",appearance:"info"},{name:"playground.previous",type:"hint",appearance:"info"},{name:"playground.next",type:"hint",appearance:"info"},{name:"playground.tooltip",type:"hint",appearance:"info"},{name:"playground.simple",type:"hint",appearance:"error"},{name:"playground.compile",type:"hint",appearance:"info",compiled:!0,interactive:!0},{name:"playground.complex",type:"rich",appearance:"error"},{name:"playground.tab-disabled-tooltip",type:"hint",appearance:"info"},{name:"playground.tab-tooltip",type:"hint",appearance:"info"},{name:"C4_VIDEO",type:"hint",appearance:"info"},{name:"C4_GALLERY",type:"hint",appearance:"info"},{name:"C4_IMAGE",type:"hint",appearance:"info"},{name:"C4_SHAPE",type:"hint",appearance:"info"},{name:"P3_SELECTED_VALUE",type:"hint",appearance:"info",content:""}]}return e.prototype.registerTooltips=function(e){_.each(this.list,function(t){return e.setToolTip(t.name,_.omit(t,"name"))})},e}();angular.module("commonControlsAppInternal").constant("commonTooltips",new c).run(["ccTooltipManager","commonTooltips",function(e,t){return t.registerTooltips(e)}]),function(e){!function(e){e[e.SingleImage=0]="SingleImage",e[e.MultipleImages=1]="MultipleImages",e[e.Video=2]="Video",e[e.ExtVideo=3]="ExtVideo",e[e.Clipart=4]="Clipart",e[e.Shape=5]="Shape",e[e.Pattern=6]="Pattern",e[e.InlineVideo=7]="InlineVideo"}(e.MediaPreviewType||(e.MediaPreviewType={})),function(e){e[e.BoldUnderlineItalic=0]="BoldUnderlineItalic",e[e.Listing=1]="Listing",e[e.Linking=2]="Linking",e[e.ClearFormatting=3]="ClearFormatting"}(e.RTTSection||(e.RTTSection={})),function(e){e[e.Bold=0]="Bold",e[e.Underline=1]="Underline",e[e.Italic=2]="Italic",e[e.Bullets=3]="Bullets",e[e.Numbers=4]="Numbers",e[e.Link=5]="Link",e[e.ClearFormatting=6]="ClearFormatting"}(e.RTTCommand||(e.RTTCommand={}))}(U||(U={}));var d=U,u=function(){function e(e,t,i,n,o,r,a,s){var l=this;this.CcDialogBuilder=e,this.ccTooltipManager=t,this.ccTip=i,this.$scope=n,this.$location=o,this.$document=r,this.$window=a,this.ccFlags=s,this.socialIcons=["amazon","googleplay","soundcloud","applemusic","googleplus","spotify","bandcamp","houzz","tidal","beatport","instagram","tripadvisor","blogger","itunes","tumblr","cdbaby","linkedin","twitter","deezer","myspace","vimeo","facebook","odnokiassinki","vkontakte","fancy","pinterest","whatsapp","flickr","rss","yelp","generic","shoutout","youtube","googleplaces","snapchat"],this.svgIcons=["design:embed","design:freewix","design:upload","background-preview:color","background-preview:gallery","background-preview:image","background-preview:pattern","background-preview:video","background-preview:upload-gallery","background-preview:upload-image","background-preview:upload-video","background-preview:action-menu-design","background-preview:action-menu-manage","coloration:add-large","coloration:add-small","coloration:check-green","coloration:dark","coloration:edit","coloration:light","coloration:magic-wand","coloration:negative-validation-outline","coloration:positive-validation-outline-small","coloration:replace","coloration:selected","design:animations","design:background","design:color","design:font","design:font-size-small","design:font-size-large","design:spacing-small","design:spacing-medium","design:spacing-large","osi:textSizeMinus","osi:textSizePlus","osi:design","osi:manage","osi:upArrow","design:height","misc:loader-circle-small","misc:negative-validation-outline","misc:crop","misc:location","primitives:intro-arrow","primitives:minus","primitives:plus","rich-text:bold","rich-text:bullets","rich-text:clear-formatting","rich-text:italic","rich-text:link","rich-text:numbers","rich-text:underline","edit-text:text-align-center","edit-text:text-align-left","edit-text:text-align-right","edit-text:text-clear-formatting","edit-text:text-color","edit-text:text-format-bold","edit-text:text-format-italic","edit-text:text-format-underline","edit-text:text-hide","edit-text:text-link","edit-text:text-list-bulleted","edit-text:text-list-numbered","edit-text:text-size-decrease","edit-text:text-size-increase","edit-text:text-size"].concat(this.socialIcons.map(function(e){return"social:"+e})),this.complexSvgIcons=["design:headerbg","design:headerbg_hover","design:listbg","design:listbg_hover","image-positions:top-left","image-positions:top","image-positions:top-right","image-positions:left","image-positions:center","image-positions:right","image-positions:bottom-left","image-positions:bottom","image-positions:bottom-right"],this.icons=["mainpage","arrow-down","arrow-left","check","checkbox-check","delete","undo","undo-small","redo","redo-small","crop","show","hide","actions","add-large","add-small","arrow-right","arrow-small-new","arrow-up","close-8","close-10","close-12","close-24","customise","customise-design","dashboard","desktop","intro-next-arrow","intro-back-arrow","drag-here-arrow","drag-large","drag-small","dragsquare","duplicate","edit","help-12x7","help-24x13","help-25x14","info","home","link","mailbox","mobile","move-to","music","negative-validation","new-tab","pause","play","positive-validation","rename","replace","required","search","search-intro","seo","settings","subpage","image","gallery","video","shape","clipart","blog","blog2","store","booking","events","time","zoom-in","zoom-in-small","zoom-out","zoom-out-small","generic-social-link","blogger","facebook","fancy","flickr","google-places","google-plus","houzz","instagram","linkedin","members","myspace","odnok","pinterest","rss","soundcloud","shoutout","trip-advisor","tumblr","twitter","vimeo","vkontakte","whatsapp","yelp","youtube","seowiz","social-placeholder","social-not-found","wix-logo","pages","page","section","import","app","switch-layout","hide-eye","show-eye","mobile-edit-notice","switch-to-mobile","switch-to-desktop","assistant-bucket-connect-domain","assistant-bucket-content","assistant-bucket-imported-content","assistant-bucket-preview","assistant-bucket-essentials","assistant-bucket-publish","assistant-bucket-section-design","assistant-bucket-image","assistant-bucket-seo","assistant-bucket-site-design","assistant-menu-play","assistant-bucket-play","assistant-bucket-arrow","smart-assist-connect-button","smart-assist-connect-socials","smart-assist-publish","smart-assist-tpa-ecom","smart-assist-tpa-payments","smart-assist-tpa-bookings","smart-assist-tpa-upgrade","best-match","reorder-section","manage","design"],this.animationIcons=["Fade","Float","Fly","Fold","None","Slide","Turn"],this.backgroundImageOptionsIcons=["PositionBottom","PositionCenter","PositionTop"],this.headerDesign=["solid","transparent","fixed"],this.autocompleteValue="de",this.autocompleteItems=["pace@jamil.com","Capital Typography","Kat","Doge","Kat","Hi","Ho"],this.autocompleteMediaItems=[{text:"Mr. Kat",media:{mediaType:"image",relativeUri:"5010811d6ed30a57c1390c2753ee0c9f.png"}},{text:"Mrs. Kat",media:{mediaType:"image",relativeUri:"a2438da2b4054c82ab313b96bb487827.jpg"}},{text:"Kid Kat",media:{mediaType:"image",relativeUri:"24b04690d5dc436b91637be29f8e047d.jpg"}},{text:"Karate Kat",media:{mediaType:"image",relativeUri:"24b04690d5dc436b91637be29f8e047d.jpg"}},{text:"Mr. Katiagi",media:{mediaType:"image",relativeUri:"24b04690d5dc436b91637be29f8e047d.jpg"}}],this.checkbox={label:"Checkbox",checked:!0,required:!1},this.checkboxLong={label:"This is a longer checkbox label, breaking to two lines",checked:!0,required:!0},this.checkboxItems=[{label:"label",checked:!0,required:!1},{label:"label2",checked:!1,required:!0}],this.radioValue="first",this.radioButtons=[{label:"First",value:"first"},{label:"Second",value:"second"}],this.tabsItems=[{label:"private services line"},{label:"group services"}],this.labelGraphicItems=[{cssClass:"cc-icon-twitter",data:{some:"data"}},{cssClass:"cc-icon-facebook",data:{some:"data2"}}],this.c24VisibleTabs=[{mediaType:0},{mediaType:1},{mediaType:2,disabled:!0,tooltip:"playground.tab-disabled-tooltip",showTooltipIcon:!1},{mediaType:6,tooltip:"playground.tab-tooltip"}],this.c24VisibleTabsLogo=[{mediaType:4},{mediaType:5}],this.media=[{fileName:"Two Flamingos",relativeUri:"0d5a8583187a44688b918f91298eba80.jpg",width:1920,height:1280,Title:"Two Flamingos",Description:"",Link:{},mediaType:"image"},{fileName:"Logo",relativeUri:"23cea2e1c87b4c41b15dfb65a70a06a8.png",width:1920,height:1280,Title:"Abstract",Description:"",Link:{},mediaType:"image"},{borderColor:"#999999",borderWidth:"0",fileName:"Yoga Pose 4",fillColor:"#000000",height:0,mediaType:"shape",relativeUri:"shapes/5b321028f0664becb2ef5083a72dedb3.svg",width:0},{Title:"",fileName:"Cactus 9",height:600,mediaType:"clipart",relativeUri:"ef50a06da5104118acc3804866be7059.png",width:600},{mediaType:"extVideo",videoUrl:"http://www.youtube.com/watch?v=PMWmYf2043g",Title:"Wix default video",thumbnailUrl:"http://img.youtube.com/vi/PMWmYf2043g/0.jpg"},{mediaType:"video",Description:"",Link:{},Title:"Urban View",fileName:"11062b_3e2f37c297534f9ead156265242fbca8",uri:"11062b_3e2f37c297534f9ead156265242fbca8",fileUrl:"video/11062b_3e2f37c297534f9ead156265242fbca8",fileInput:{audioBitrate:.196,videoBitrate:10.082,height:1080,width:1920,fps:25,duration:19600,type:"video",displayAspectRatio:"16:9"},fileOutput:{image:[{status:"READY",secure:!1,format:"jpg",url:"media/11062b_3e2f37c297534f9ead156265242fbca8f000.jpg",height:1080,width:1920,key:"poster.0"},{status:"READY",secure:!1,format:"jpg",url:"media/11062b_3e2f37c297534f9ead156265242fbca8f001.jpg",height:1080,width:1920,key:"poster.1"},{status:"READY",secure:!1,format:"jpg",url:"media/11062b_3e2f37c297534f9ead156265242fbca8f002.jpg",height:1080,width:1920,key:"poster.2"},{status:"READY",secure:!1,format:"jpg",url:"media/11062b_3e2f37c297534f9ead156265242fbca8f003.jpg",height:1080,width:1920,key:"poster.3"}],video:[{status:"READY",audioBitrate:-1,secure:!1,fps:25,format:"mp4",url:"video/11062b_3e2f37c297534f9ead156265242fbca8/480p/mp4/file.mp4",height:480,videoBitrate:877,tag:"High",key:"480p.mp4",duration:19600,displayAspectRatio:"16:9",quality:"480p",width:853},{status:"READY",audioBitrate:-1,secure:!1,fps:25,format:"webm",url:"video/11062b_3e2f37c297534f9ead156265242fbca8/480p/webm/file.webm",height:480,videoBitrate:1457,tag:"High",key:"480p.webm",duration:19600,displayAspectRatio:"16:9",quality:"480p",width:853},{status:"READY",audioBitrate:-1,secure:!1,fps:25,format:"mp4",url:"video/11062b_3e2f37c297534f9ead156265242fbca8/720p/mp4/file.mp4",height:720,videoBitrate:3362,tag:"HD",key:"720p.mp4",duration:19600,displayAspectRatio:"16:9",quality:"720p",width:1280},{status:"READY",audioBitrate:-1,secure:!1,fps:25,format:"webm",url:"video/11062b_3e2f37c297534f9ead156265242fbca8/720p/webm/file.webm",height:720,videoBitrate:3954,tag:"HD",key:"720p.webm",duration:19600,displayAspectRatio:"16:9",quality:"720p",width:1280},{status:"READY",audioBitrate:-1,secure:!1,fps:25,format:"mp4",url:"video/11062b_3e2f37c297534f9ead156265242fbca8/1080p/mp4/file.mp4",height:1080,videoBitrate:5753,tag:"HD",key:"1080p.mp4",duration:19600,displayAspectRatio:"16:9",quality:"1080p",width:1920},{status:"READY",audioBitrate:-1,secure:!1,fps:25,format:"webm",url:"video/11062b_3e2f37c297534f9ead156265242fbca8/1080p/webm/file.webm",height:1080,videoBitrate:7151,tag:"HD",key:"1080p.webm",duration:19600,displayAspectRatio:"16:9",quality:"1080p",width:1920}]},vendor:"bigstock&bigstock&bigstock&clipcanvas",reference:"v49780622&v493478872&v49737086&v318347",fileBaseUrl:"video/11062b_3e2f37c297534f9ead156265242fbca8",relativeUri:"11062b_3e2f37c297534f9ead156265242fbca8",thumbnailUrl:"https://static.wixstatic.com/media/11062b_3e2f37c297534f9ead156265242fbca8f002.jpg/v1/fit/w_288,h_155/11062b_3e2f37c297534f9ead156265242fbca8f002.jpg",controls:0,playmode:{autoplay:!0,loop:!0},active:!0},{mediaType:"pattern",thumbRatio:50,relativeUri:"d38a861dd2f149cab4f02dcf3409b749.png",width:500,height:500,rgbBackgroundColor:"rgb(189, 140, 201)"}],this.currentMedia=this.media[0],this.currentMedia2=this.media[6],this.currentMediaLogo=this.media[1],this.disableMediaChangeButton=!1,this.dropdownListItems=[{id:1,label:"Bob",media:{mediaType:"image",relativeUri:"images/cat1.jpg"}},{id:2,label:"George",media:{mediaType:"image",relativeUri:"images/cat2.png"}},{id:3,label:"Alice",media:{mediaType:"image",relativeUri:"images/cat3.jpg"}},{id:4,label:"Steve",media:{mediaType:"image",relativeUri:"images/cat2.png"}},{id:5,label:"Steve",media:{mediaType:"image",relativeUri:"images/cat2.png"}},{id:6,label:"Steve",media:{mediaType:"image",relativeUri:"images/cat2.png"}},{id:7,label:"Steve",media:{mediaType:"image",relativeUri:"images/cat2.png"}},{id:8,label:"Steve",media:{mediaType:"image",relativeUri:"images/cat2.png"}},{id:9,label:"Steve",media:{mediaType:"image",relativeUri:"images/cat2.png"}},{id:10,label:"Steve",media:{mediaType:"image",relativeUri:"images/cat2.png"}}],this.selectedDropDownItem=this.dropdownListItems[2],this.singleOptionDropdownOptions=[this.selectedDropDownItem],this.keyCatcherOutput="no keydown caught yet",this.currentStep=1,this.singleLine='This is a rich text. <a href="http://www.wix.com">Visit wix.com!</a>',this.richText='This<br><i>is</i> a <b>rich</b> <u>text</u>.<a href="http://www.wix.com">Visit wix.com!</a>',this.richTextValue0='<p class="font_7">This is P23 without C23</p>',this.richTextValue1='<p class="font_7">This is <span style="font-weight:bold;">bold</span></p>',this.richTextValue2='<ol class="font_7"><li><p class="font_7">First</p></li><li><p class="font_7">Last<br></p></li></ol>',this.richTextMobile='This<i>is your joyfully</i>a <b>rich</b> <u>text</u>.<a href="http://www.wix.com">Visit wix.com!</a> Stuff to make it longer.<br>This is a next line',this.richTextStylesManager={getFonts:function(){return{}},getThemes:function(){return{}},getCssData:function(){var e={"adi-ux-fonts":{id:"adi-ux-fonts",value:"//static.parastorage.com/services/third-party/fonts/Helvetica/fontFace.css",isLink:!0,force:!1},theme_fonts:{id:"theme_fonts",value:".cke_editable p,.cke_editable h1,.cke_editable h2,.cke_editable h3,.cke_editable h4,.cke_editable h5,.cke_editable h6,.cke_editable div,.cke_editable li,.cke_editable ol,.cke_editable ul {-webkit-font-smoothing: antialiased;font: normal normal 300 16px/24px HelveticaNeueW01-55Roma,HelveticaNeueW02-55Roma,HelveticaNeueW10-55Roma,\"'Helvetica Neue', Helvetica, Arial, Meiryo, 'Hiragino Kaku Gothic Pro W3', 'Hiragino Kaku Gothic Pro', sans-serif\";color:#20303c;}::selection {background-color:#d3edff}.cke_editable a {color:#4196e0}.cke_editable ol,.cke_editable ul {margin-top:0;margin-bottom:0}",isLink:!1,force:!1}};return e}},this.showC23=!0,this.linkToggler=function(e){return angular.injector(["ng"]).get("$q").when(e?void 0:"nonEmptyLinkID")},this.toggleLeftIcon="coloration:light",this.toggleRightIcon="coloration:dark",this.customDraggableItemValidation=function(e){return"Item 2"!==e.label},this.itemsArray=[{label:"Item 1",icon:"twitter"},{label:"Item 2",icon:"whatsapp"},{label:"Item 3 long long long long long long long long long",icon:"facebook",hidden:!0}],this.listItems=_.map(this.itemsArray,function(e){return _.omit(e,"icon")}),this.listItemsA=_.map(this.itemsArray,function(e){return _.omit(e,["icon","hidden"])}).map(function(e){return e.label===l.itemsArray[0].label?{label:"Default item",selected:!0}:e}),this.listItemsB=_.map(this.itemsArray,function(e){return _.omit(e,"icon")}),this.listItemsC=_.map(this.itemsArray,function(e){return _.omit(e,"icon")}).map(function(e){return e.label===l.itemsArray[0].label?{label:"Unhidable item",canHide:!1}:e}),this.listItemsD=angular.copy(this.itemsArray),this.listItemsE=angular.copy(this.itemsArray),this.listItemsM=_.map(this.itemsArray,function(e){return _.omit(e,"icon")}),this.listItemsL=[{value:"Item 1",buttonVisible:!0,buttonText:"Add Link",iconName:"rich-text:link",iconVisible:!1,placeholder:"Edit Me"},{value:"Item 2",buttonVisible:!1,buttonText:"Add Link",iconName:"rich-text:link",iconVisible:!0,placeholder:"Edit Me"},{value:"Item 3 long long long long long long long long",buttonVisible:!1,buttonText:"Add Link",iconName:"rich-text:link",iconVisible:!0,placeholder:"Edit Me"}],this.currentDate=new Date,this.multiPagePopup={heading:"Welcome to mobile editing",headingNext:"Mobile affects only mobile",text:"Now you can edit the mobile version of your website. Your site will be automatically optimized to look amazing on mobile",textNext:"Changes made in your mobile editor affect only your mobile website. Your desktop site will remain unchanged",nextButtonText:"Next",icon:"EditMobileFirstTime.svg",iconNext:"EditMobileFirstTime2.svg",cancelButtonText:"Cancel",gotItButtonText:"Got it",showCancelButton:!0},this.firstTimeNotice={heading:"Editing Business Info",text:"Editing your business info will change the info in all the places it appears in",hideFirstTimeCheckBox:!0,dontBotherMe:!0,dontBotherMeText:"Don't show again",acceptButtonText:"Got it",icon:"congrats.svg",biDialogName:"edit-business-info"},this.positiveConfirmation={heading:"Editing Business Info",text:"Editing your business info will change the info in all the places it appears in",acceptButtonText:"Got it",rejectButtonText:"Cancel",icon:"badge.gif",noClose:!0,biDialogName:"edit-business-info"},this.negativeConfirmation={heading:"Delete this section",text:"Are you sure you want to delete this section?",acceptButtonText:"Delete",rejectButtonText:"Cancel",icon:"delete-single.gif",biDialogName:"delete-section",onConfirm:function(){return l.$window.open("https://users.wix.com/signin?loginDialogContext=login&referralInfo=ONBOARDING&postLogin=https://www.wix.com/my-account/sites/")}},this.continuedAction={heading:"Move section",dropDownItems:[{name:"Page 1",value:"page_1"},{name:"Page 2",value:"page_2"},{name:"Page 3",value:"page_3"}],acceptButtonText:"Move",rejectButtonText:"Cancel",description:"<p>It will show above the footer</p>",text:"Select Page",biDialogName:"move-section",onHelp:this.onOpenSupportIframe.bind(this)},this.linkEditorMockDropDownItems=[{name:"None",value:""},{name:"URL",value:"http://bla.bla"},{name:"email",value:"mailto:boogie@man.com"}],this.linkEditorMock=function(e){return{heading:"Choose link",description:"It will show above the footer",text:"Select a link from the list",dropDown:_.filter(l.linkEditorMockDropDownItems,function(t){return t.value===e})[0],dropDownItems:l.linkEditorMockDropDownItems,acceptButtonText:"Done",rejectButtonText:"Cancel",biDialogName:"edit-link",onHelp:l.onOpenSupportIframe.bind(l)}},this.c20GraphicRadioControl={radioElements:[{label:"1x1",icon:"pro-gallery:1x1",complex:!1},{label:"3x4",icon:"pro-gallery:3x4",complex:!1},{label:"4x3",tooltip:"playground.tooltip",icon:"pro-gallery:4x3",complex:!1},{label:"9x16",tooltip:"playground.tooltip",icon:"pro-gallery:9x16",complex:!1},{label:"16x9",icon:"pro-gallery:16x9",complex:!1,showTooltipIcon:!0,tooltip:""},{label:"0x0",icon:"pro-gallery:1x1",complex:!1,isDisabled:!0}],radioElements2:[{label:"winter collection",url:"https://support.apple.com/content/dam/edam/applecare/images/en_US/mac/mini-hero-mac-family_2x.png",complex:!1},{label:"outlet",tooltip:"playground.tooltip",icon:"pro-gallery:4x3",complex:!1}]},this.c12Thumbnails={onSelect:function(e){console.log("Selected thumbnail",e)},label:"My Thumbnails",thumbnails:[{label:"Thumby",picture:"images/cat1.jpg",isSelected:!0},{label:"Wumby",picture:"images/cat2.png"},{label:"Chumby",picture:"images/cat3.jpg"}]},this.c2eState=!1,this.c2eState2=!1,this.displayedRTTSections=[le.BoldUnderlineItalic,le.Linking,le.ClearFormatting],this.displayedRTTSections2=[le.BoldUnderlineItalic,le.Linking,le.Listing,le.ClearFormatting],this.RTTCommands=[],this.RTTCommandsDisabled=[!1,!1,!0,!1,!1,!1,!1],this.ettAlign="left",this.sliders={categoryLabels:{"-3":"tiny","-2":"extra small","-1":"small",0:"medium",1:"large",2:"extra large",3:"huge"},values:[0,0,0,0,0]},this.currentIndex=3,this.maxIndex=3,this.maxIndex2=4,this.scrollDisabled=!1}return e.$inject=["CcDialogBuilder","ccTooltipManager","ccTip","$scope","$location","$document","$window","ccFlags"],e.prototype.validateGraphicItems=function(e){return"data"===e.data.some},Object.defineProperty(e.prototype,"nestedTitle",{get:function(){return this.showNestedNested?"Nested Nested":this.showNested?"Nested":"Panel With Nested"},enumerable:!0,configurable:!0}),e.prototype.onNestedReturn=function(){this.showNestedNested?this.showNestedNested=!1:this.showNested=!1},e.prototype.toggleRTTCommand=function(e){this.RTTCommands[e]=!this.RTTCommands[e]},e.prototype.getRTTCommandState=function(e){return this.RTTCommands[e]},e.prototype.isRTTCommandDisabled=function(e){return this.RTTCommandsDisabled[e]},e.prototype.getETTAlign=function(){return this.ettAlign},e.prototype.setETTAlign=function(e){this.ettAlign=e},e.prototype.$onInit=function(){this.iconsPages=_.chunk(this.icons,12).map(function(e,t){return{icons:e,label:"Icons "+(t+1)}}),this.listItemsC[0].helpTooltip="playground.tooltip",this.listItemsC[1].onHelp=this.onOpenSupportIframe.bind(this),this.visiblePanelLabel=this.visiblePanelLabel||this.getVisiblePanelFromURL()||"all"},e.prototype.onC3ButtonClick=function(){alert("you are awesome!")},e.prototype.backgroundPreviewEdit=function(){console.log("backgroundPreviewEdit")},e.prototype.getVisiblePanelFromURL=function(){return this.$location.search().visiblePanel},e.prototype.onC20GraphicRadio=function(e){console.log("onC20GraphicRadio",e)},e.prototype.onP25BackgroundPreview=function(e){console.log("onP25BackgroundPreview",e)},e.prototype.isVisible=function(e){return"all"===this.visiblePanelLabel&&!e.startsWith("e2e")||this.visiblePanelLabel===e},e.prototype.help=function(){console.log("hello help"),this.onOpenSupportIframe()},e.prototype.messageGetter=function(e){return e.index?"<p>Clicked "+e.index+" is not readable.</p><a ng-click='$ctrl.setColor(action, -1)' href=\"\">Fix Colors</a>":"Plain text"},e.prototype.callback=function(e){console.log("callback called",e)},e.prototype.close=function(){console.log("close")},e.prototype.return=function(){console.log("return"),this.visiblePanelLabel="all"},e.prototype.maskChange=function(){console.log("toggle mask")},e.prototype.valueChange=function(e){console.log("value changed: "+e)},e.prototype.onBlur=function(){console.log("blur")},e.prototype.onTooltipClick=function(){console.log("tooltip clicked")},e.prototype.genericMenuItemClick=function(){console.log("generic menu item click")},e.prototype.genericMenuClick=function(e){console.log("generic menu click, item:",e)},e.prototype.actionButtonClick=function(){console.log("action button click")},e.prototype.displayModal=function(e){var t=e.popup,i=e.model;this.CcDialogBuilder[t](this[i])},e.prototype.simulateRichTextLinkDialog=function(e){return this.CcDialogBuilder.showPositiveContinuedAction(this.linkEditorMock(e)).then(function(e){return e.selected.value})},e.prototype.displayTip=function(){this.firstTip=this.ccTip.build({scope:{contact:{name:"Rachel",profession:"Wix Specialist",img:"images/cat2.png"},title:"You're about to add your Practices section",contentLink:{text:"See Examples >",url:"http://www.wix.com"},footer:{closeButton:"Got it"}},style:{top:"150px",left:"1242px"},templateUrl:"views/tips/example.html",onHide:function(e){console.log("I just clicked on hide",e)}}),this.ccTip.show(this.firstTip)},e.prototype.updateTipContent=function(){this.ccTip.update(this.firstTip,{scope:{contact:{name:"Alon",profession:"FED developer",img:"images/cat3.jpg"},title:"That is a new title",contentLink:{text:"New text",url:"http://www.wix-new.com"},footer:{closeButton:"New button"}},template:"This is some new <b>content</b>"})},e.prototype.compiledTooltipClick=function(){console.log("compiled tooltip clicked")},e.prototype.onGroupToggled=function(e){console.log("group toggled",e)},e.prototype.onGroupToggled2=function(e){console.log("group toggled2",e)},e.prototype.onMediaPreviewToggled=function(e){console.log("media preview toggled",e)},e.prototype.onMediaTypeChange=function(e){var t=de.convertType(e);this.currentMedia=this.media.find(function(e){return e.mediaType===t})},e.prototype.listItemP10aClick=function(e){this.listItemsA.forEach(function(e){e.selected=!1}),e.selected=!0,console.log("list item click, item:",e)},e.prototype.listItemP10aEdit=function(e){this.listItemsA.forEach(function(e){e.selected=!1}),e.selected=!0,console.log("list item edit, item:",e)},e.prototype.onCheckboxToggle=function(e){console.log("checkbox state changed",e.checked)},e.prototype.onSliderValueChange=function(e,t){console.log("slider value changed",e,t)},e.prototype.onRadioValueChange=function(e,t){console.log("radio value changed",e,t)},e.prototype.onToggleValueChange=function(e){console.log("toggle value changed",e)},e.prototype.onItemNavigationValueChange=function(e,t){console.log("item navigation value changed",e,t)},e.prototype.onCheckboxListItemChange=function(e){console.log("checkbox list item changed",e)},e.prototype.onTabsItemChange=function(e){console.log("tabs item changed",e)},e.prototype.onAutocompleteLinkClick=function(){console.log("autocomplete link clicked")},e.prototype.onActionClick=function(){console.log("on action click")},e.prototype.onDropdownListSelectionChange=function(e){console.log("selection changed",e)},e.prototype.toggleDropdownItems=function(){var e=this;1===this.singleOptionDropdownOptions.length?this.singleOptionDropdownOptions=this.dropdownListItems:this.singleOptionDropdownOptions=[this.dropdownListItems.find(function(t){return t.id===e.selectedDropDownItem.id})]},e.prototype.onListOrderChange=function(e){console.log("list order change: ",e)},e.prototype.onOpenIframe=function(){this.CcDialogBuilder.showIframe("http://www.wix.com")},e.prototype.onOpenSupportIframe=function(){this.CcDialogBuilder.showSupportIframe("https://www.wix.com/support/html5/widget/0/63ff21be-9556-4f52-9ac9-4d441bd3dae4#/main/view?itemId=8764da11-da73-4b57-adb9-cee9be8d1c4e","bi-dialog-name")},e.prototype.onDisplayP19Calendar=function(){this.CcDialogBuilder.show({parent:this.$document.body,template:'\n      <p19-calendar date="$ctrl.currentDate">\n      </p19-calendar>\n      ',controller:e,controllerAs:"$ctrl",clickOutsideToClose:!0,escapeToClose:!0})},e.prototype.onMediaChange=function(e){var t=this;console.log("media change button clicked",e),this.disableMediaChangeButton=!0,setTimeout(function(){t.disableMediaChangeButton=!1,t.$scope.$apply()},2e3)},e.prototype.toggleC2EState=function(){this.c2eState=!this.c2eState},e.prototype.checkC2EValue=function(){console.log("Checking value of C2E: "+this.c2eValue)},e.prototype.toggleC2EState2=function(){this.c2eState2=!this.c2eState2},e.prototype.checkC2EValue2=function(){console.log("Checking value of C2E: "+this.c2eValue2)},e.prototype.labelFilter=function(e){return e.substring(0,1)},e.prototype.onColorTagsClick=function(){console.log("color tags clicked")},e.prototype.keyCatcher=function(e){this.keyCatcherOutput=(e.ctrlKey?"ctrl ":"")+(e.metaKey?"meta ":"")+(e.shiftKey?"shift ":"")+(e.altKey?"alt ":"")+e.key},e.prototype.toggleDisableScroll=function(){this.scrollDisabled=!this.scrollDisabled},e.prototype.onControlHeaderActionClick=function(){console.log("clicked control header action")},e.prototype.addFlag=function(e){this.$location.search(e,"true"),this.$window.location.reload()},e.prototype.doOnSelect=function(){console.log("onselect clicked!")},e.prototype.onAddClick=function(){console.log("onAddClick clicked!")},e}();angular.module("commonControlsAppInternal").component("ccPlayground",{bindings:{visiblePanelLabel:"@"},templateUrl:"views/playground.html",controller:u});var p=function(){function e(){}return Object.defineProperty(e.prototype,"verticalSpacer",{get:function(){return!this.isHorizontal},enumerable:!0,configurable:!0}),e.prototype.$onInit=function(){void 0===this.size||-1===["medium","large"].indexOf(this.size)?this.sizeClass="":this.sizeClass="-"+this.size},e}();angular.module("commonControlsAppInternal").component("p0Spacer",{templateUrl:"views/primitives/p0-spacer.html",controller:p,bindings:{size:"@?",isHorizontal:"@?"}});var h=function(){function e(e,t){this.$scope=e,this.keyMap=t}return e.$inject=["$scope","keyMap"],e.prototype.$onInit=function(){this.isLongTextFocused=!1,void 0===this.long&&(this.long=!1),void 0===this.debounceDelay&&(this.debounceDelay=0),void 0===this.changeValueOnBlur&&(this.changeValueOnBlur=!1),this.initValidation(),this.initModelOptions(),this.selectOnFocus=!1!==this.selectOnFocus},e.prototype.initValidation=function(){this.validation&&(this.validation.isValid=!0),this.validator=this.getValidation("validator",function(){return!0}),this.validationTooltip=this.getValidation("tooltip",null)},e.prototype.initModelOptions=function(){var e=this,t=function(){return e.modelOptions={updateOn:e.changeValueOnBlur?"default blur":"default",debounce:{default:e.debounceDelay,blur:0}}};this.$scope.$watch(function(){return e.debounceDelay},t),this.$scope.$watch(function(){return e.changeValueOnBlur},t)},e.prototype.onLongTextFocus=function(e){this.$scope.$broadcast("elastic:adjust"),this.isLongTextFocused=!0,this.onFocus&&this.onFocus({$event:e})},e.prototype.onShortTextFocus=function(e){this.onFocus&&this.onFocus({$event:e})},e.prototype.onLongTextBlur=function(e){this.isLongTextFocused=!1,this.onBlur({$event:e})},e.prototype.onTextKeyUp=function(e,t){void 0===t&&(t=!1),e.keyCode===this.keyMap.KEY_ENTER&&this.long||(e.keyCode!==this.keyMap.KEY_ENTER&&e.keyCode!==this.keyMap.KEY_ESC||this.onBlur({$event:e}),e.keyCode===this.keyMap.KEY_ENTER&&this.onSubmit&&this.onSubmit({value:this.value}),this.onKeyup&&!this.long&&this.onKeyup({$event:e}))},e.prototype.onChange=function(){this.setValidity(),this.onChangeValue&&this.onChangeValue({value:this.value})},e.prototype.onRightIconClicked=function(){this.rightIconClicked&&this.rightIconClicked()},e.prototype.isInputValid=function(){return!this.isShowValidatorError||!this.validation||this.validation.isValid},e.prototype.setValidity=function(){this.validation&&this.validator&&(this.validation.isValid=this.validator(this.value))},e.prototype.getValidation=function(e,t){return this.validation&&this.validation[e]||t},e}();angular.module("commonControlsAppInternal").component("p1TextInput",{templateUrl:"views/primitives/p1-text-input.html",controller:h,bindings:{value:"=",isDisabled:"=",isShowValidatorError:"=?",long:"=?",focused:"=?",placeholder:"=",debounceDelay:"=?",changeValueOnBlur:"<",onChangeValue:"&",onSubmit:"&",onBlur:"&",onFocus:"&",onKeyup:"&",maxLength:"@?",validation:"=?",selectOnFocus:"=?",rightIconName:"=?",rightIconClicked:"&?",leftIconName:"=?",type:"@?"}});var g=function(){function e(e){this.$scope=e,this.showList=!1}return e.$inject=["$scope"],e.prototype.$onInit=function(){var e=this;this.selectedIndex=_.indexOf(this.items,this.value),this.$scope.$watch("$ctrl.value",function(t,i){e.selectedIndex=_.indexOf(e.items,e.value)})},e.prototype.getTitle=function(e){return this.showTitles?this.getItemLabel(e):""},Object.defineProperty(e.prototype,"mdContainerClass",{get:function(){return["cc-md-select",this.containerClass].join(" ")},enumerable:!0,configurable:!0}),e.prototype.toggleList=function(){this.showList=!this.showList},e.prototype.closeList=function(){this.showList=!1},e.prototype.getItemLabel=function(e){if(e)return this.labelKey?e[this.labelKey]:String(e)},e.prototype.itemSelected=function(e,t){this.selectedIndex=t,this.showList=!1,this.value!==e&&(this.value=e,this.onSelectionChange&&this.onSelectionChange({item:e}))},e.prototype.onOpen=function(){if(this.onOpenList)return this.onOpenList()},e.prototype.shouldShowSelect=function(){return!!this.items&&(!!(this.alwaysShowSelect&&this.items.length>0)||this.items.length>1)},e.prototype.selectTooltipOptions=function(){return{content:this.getItemLabel(this.value)||"",maxWidth:170}},e}();angular.module("commonControlsAppInternal").component("p3DropdownList",{templateUrl:"views/primitives/p3-dropdown-list.html",controller:g,bindings:{value:"=",items:"=",trackByKey:"@",labelKey:"@",linkTitle:"@",onSelectionChange:"&",onLinkClick:"&",onOpenList:"&",placeholder:"@?",showTitles:"<?",containerClass:"@?",noHover:"<?",onHelp:"&?",helpTooltip:"@?",showButton:"<?",buttonText:"<?",buttonTooltip:"<?",alwaysShowSelect:"<?",onButtonClick:"&",automation:"@?"}});var m=function(){function e(e,t,i){var n=this;this.$element=e,this.$scope=t,this.keyMap=i,this.dragBegin=null,this.mouseListeners={downOnLine:function(e){if(null===n.dragBegin){var t=e.offsetX;"p5-slider"===e.target.className&&(t-=n.p5Handle.width()/2);var i=t/n.pxLength*n.unitsLength;n.unroundedValue=i+n.min,n.mouseListeners.down(e),n.mouseListeners.move(e)}},down:function(e){null===n.dragBegin&&(document.activeElement&&document.activeElement.blur(),n.dragBegin=n.pxLocation-e.screenX,e.preventDefault(),window.addEventListener("mousemove",n.mouseListeners.move,!1),n.$scope.$apply(function(){n.dragging=!0}))},move:function(e){var t=n.dragBegin+e.screenX,i=t/n.pxLength*n.unitsLength;n.unroundedValue=i+n.min,n.stepper?n.$scope.$apply(function(){n.update()}):(n.unroundedValue>n.max?n.updateHandle(n.pxLength):n.unroundedValue<n.min?n.updateHandle(0):n.updateHandle(t),n.$scope.$apply(function(){n.updateValue(),n.updateLabel()}))},up:function(e){null!==n.dragBegin&&(n.dragBegin=null,n.$scope.$apply(function(){n.dragging=!1,n.update(),n.onValueSettle&&n.onValueSettle({value:n.value})}),window.removeEventListener("mousemove",n.mouseListeners.move,!1))},enter:function(e){1!==e.buttons&&n.mouseListeners.up()}}}return e.$inject=["$element","$scope","keyMap"],Object.defineProperty(e.prototype,"pxLength",{get:function(){return this.p5Slider.width()-this.p5Handle.width()},enumerable:!0,configurable:!0}),e.prototype.updateHandle=function(e){e=Math.round(e),this.p5Handle[0].dataset.left===e&&void 0!==this.steppers||this.updateSteppers(),this.p5Handle[0].dataset.left=e,this.p5Handle[0].style.transform="translateX("+e+"px)",this.p5Current[0].style.width=e+"px"},e.prototype.updateValue=function(){var e=this.value;void 0===this.unroundedValue?this.value=void 0:(this.unroundedValue<this.min&&(this.unroundedValue=this.min),this.unroundedValue>this.max&&(this.unroundedValue=this.max),void 0===this.step?this.value=this.unroundedValue:(this.value=Math.round((this.unroundedValue-this.min)/this.step)*this.step+this.min,this.value=Math.round(100*this.value)/100)),this.value!==e&&this.onValueChange({value:this.value}),this.p5Slider.css("visibility",void 0!==this.value||this.stepper?"visible":"hidden")},e.prototype.updateLabel=function(){this.editing||(this.label=void 0===this.value?"":this.value.toString()+this.units)},e.prototype.update=function(){this.updateValue(),this.unroundedValue=this.value,this.updateLabel(),this.updateHandle(this.pxLocation)},Object.defineProperty(e.prototype,"pxLocation",{get:function(){return this.location*this.pxLength},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"location",{get:function(){return this.unitsLocation/this.unitsLength},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unitsLocation",{get:function(){return void 0===this.unroundedValue?0:this.unroundedValue-this.min},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unitsLength",{get:function(){return this.max-this.min},enumerable:!0,configurable:!0}),e.prototype.onIconClick=function(e,t){if(e.stopPropagation(),this.clickableIcons){var i=t?-1*this.step:this.step;this.unroundedValue=this.value+i,this.update(),this.onValueSettle&&this.onValueSettle({value:this.value})}},e.prototype.onInputFocus=function(){this.editing=!0,this.label=void 0===this.value?"":this.value.toString()},e.prototype.onInputBlur=function(){this.editing=!1,this.updateLabel()},e.prototype.onInputKeyup=function(e){e.keyCode===this.keyMap.KEY_ENTER&&this.$element.find("input").trigger("blur")},e.prototype.updateSteppers=function(){var e,t,i,n=this.pxLength,o=this.unitsLength;if(0!==this.pxLength&&this.stepper)for(this.steppers=[],e=0;e>=o&&(t=!0,e=o),i=e/o,this.steppers.push({left:i*n,filled:this.unroundedValue>=e+this.min}),!t;e+=this.step);},e.prototype.$onInit=function(){this.p5Slider=this.$element.find(".p5-slider"),this.p5Handle=this.$element.find(".p5-handle"),this.p5Current=this.$element.find(".p5-current"),this.editing=!1,this.dragging=!1,this.unroundedValue=this.value,void 0===this.units&&(this.units=""),void 0===this.stepper&&(this.stepper=!1),void 0===this.stepperTicks&&this.stepper&&(this.stepperTicks=!0)},e.prototype.$postLink=function(){var e=this;this.update(),this.$element.on("DOMNodeInsertedIntoDocument",function(){e.$scope.$apply(function(){return e.update()})}),this.$scope.$watch("$ctrl.value",function(){null===e.dragBegin&&(e.unroundedValue=e.value,e.update())}),this.$scope.$watch("$ctrl.label",function(){e.editing&&(""===e.label?e.unroundedValue=e.min:(e.unroundedValue=parseFloat(e.label),isNaN(e.unroundedValue)&&(e.unroundedValue=e.min)),e.update())}),this.p5Slider.mousedown(this.mouseListeners.downOnLine),this.p5Handle.mousedown(this.mouseListeners.down),window.addEventListener("mouseup",this.mouseListeners.up,!1),document.body.addEventListener("mouseenter",this.mouseListeners.enter)},e.prototype.$onDestroy=function(){window.removeEventListener("mouseup",this.mouseListeners.up,!1),document.body.removeEventListener("mouseenter",this.mouseListeners.enter,!1)},e}();angular.module("commonControlsAppInternal").component("p5Slider",{templateUrl:"views/primitives/p5-slider.html",controller:m,bindings:{onValueChange:"&",onValueSettle:"&?",onFocus:"&",onBlur:"&",units:"=?",step:"=",min:"=",max:"=",value:"=",stepper:"=?",stepperTicks:"=?",type:"@",iconBefore:"@?",iconAfter:"@?",clickableIcons:"<?"}});var f=function(){function e(){}return e.prototype.shouldToggle=function(e){var t=$(e.target).closest("[data-name='toggle-button']"),i=!(!t||"toggle-button"!==t.data("name"));return this.onToggle&&(i||!this.active)&&!this.hideToggleButton},e.prototype.toggle=function(e){this.shouldToggle(e)&&this.onToggle({$event:e})},e}();angular.module("commonControlsAppInternal").component("p6ControlHeader",{templateUrl:"views/primitives/p6-control-header.html",controller:f,transclude:!0,bindings:{label:"=",showNewTooltip:"=?",showHelpButton:"=?",hideToggleButton:"=?",onToggle:"&",onHelp:"&",active:"=?",helpTooltip:"@?",showAction:"=?",actionLabel:"=?",onAction:"&?",actionTooltip:"@?"}});var v=function(){function e(){}return e.prototype.canPrev=function(){return this.current>1},e.prototype.canNext=function(){return this.current<this.count},e.prototype.goPrevious=function(){this.canPrev()&&(this.current--,this.onPrevious&&this.onPrevious({current:this.current}))},e.prototype.goNext=function(){this.canNext()&&(this.current++,this.onNext&&this.onNext({current:this.current}))},e}();angular.module("commonControlsAppInternal").component("p11ItemNavigation",{templateUrl:"views/primitives/p11-item-navigation.html",controller:v,bindings:{nextTooltip:"@",previousTooltip:"@",current:"=",count:"=",onPrevious:"&",onNext:"&"}});var y=function(){return function(){}}();angular.module("commonControlsAppInternal").component("p12Thumbnail",{controller:y,bindings:{thumbnail:"=",isSelected:"="},template:'\n                <div class="p12-thumbnail-wrapper" ng-class="{selected: $ctrl.isSelected}">\n                  <div class="p12-label-wrapper p8-label" ng-class="{\'-hidden\': !$ctrl.isSelected, \'-active\': $ctrl.isSelected}">\n                    <span class="p12-label-icon" ng-show="$ctrl.isSelected"><i class="cc-icon-check"></i></span>\n                    <span class="p12-label">{{$ctrl.thumbnail.label}}</span>\n                  </div>\n                  <div class="p12-picture-wrapper">\n                    <img class="p12-picture" ng-src="{{$ctrl.thumbnail.picture}}" />\n                  </div>\n                </div>\n              '});var b=function(){function e(){this.name=Math.random().toString()}return e.prototype.setValue=function(e){this.value!==e&&(this.value=e,this.onValueChange({value:this.value}))},e}();angular.module("commonControlsAppInternal").component("p13RadioButtons",{templateUrl:"views/primitives/p13-radio-buttons.html",controller:b,bindings:{onValueChange:"&",items:"=",value:"="}});var S=function(){function e(){}return e.prototype.valueChanged=function(){this.onToggle&&this.onToggle({item:this.item})},e.prototype.toggleValue=function(e){this.item.checked=e,this.valueChanged()},e.prototype.toggleRequire=function(){this.item.required=!this.item.required,this.onRequiredChange&&this.onRequiredChange({item:this.item})},e}();angular.module("commonControlsAppInternal").component("p14Checkbox",{templateUrl:"views/primitives/p14-checkbox.html",controller:S,bindings:{item:"=",onToggle:"&",onRequiredChange:"&"}});var C=function(){function e(e,t){this.$element=e,this.$scope=t}return e.$inject=["$element","$scope"],e.prototype.$onInit=function(){var e=this;this.value||(this.value=!1),this.$element.click(function(t){e.$scope.$apply(function(){e.value=!e.value,e.onValueChange({value:e.value})})}),this.$scope.$watch("$ctrl.value",function(t,i){e.value?angular.element(e.$element.find("div")[0]).addClass("p15-on"):angular.element(e.$element.find("div")[0]).removeClass("p15-on")})},e}();angular.module("commonControlsAppInternal").component("p15Toggle",{templateUrl:"views/primitives/p15-toggle.html",controller:C,bindings:{onValueChange:"&",value:"=",leftIcon:"=?",rightIcon:"=?"}});var w=function(){function e(e,t,i,n){var o=this;this.$element=e,this.$timeout=t,this.ccFlags=i,this.$translate=n,this.showActionShourtcut=function(){return o.showActionShourcutMenu=!0},this.hideActionShourtcut=function(){return o.showActionShourcutMenu=!1},this.showActionShourcutMenu=!1}return e.$inject=["$element","$timeout","ccFlags","$translate"],e.prototype.hasNumber=function(){return _.isFinite(parseFloat(this.number))},e.prototype.shouldShowBackArrow=function(){return this.ccFlags.cardsToPanels&&(this.showReturnButton||this.showNested)},e.prototype.getLabel=function(){return this.ccFlags.cardsToPanels&&this.shouldShowBackArrow()?this.$translate.instant("tooltips.back"):this.label},e}();angular.module("commonControlsAppInternal").component("p16PanelHeader",{templateUrl:"views/primitives/p16-panel-header.html",controller:w,transclude:{shourtcut:"?shourtcut"},bindings:{label:"@",number:"@?",helpTooltip:"@?",onHelp:"&?",onClose:"&?",onReturn:"&?",onReset:"&?",showHelpButton:"=?",showCloseButton:"=?",showReturnButton:"=?",showResetButton:"=?",showNested:"<?",actionShourtcut:"<?"}}),angular.module("commonControlsAppInternal").component("p17Divider",{templateUrl:"views/primitives/p17-divider.html",bindings:{shorterDivider:"<"}});var T=function(){function e(e){var t=this;this.$scope=e,this.$scope.$watch("$ctrl.date",function(e,i){t.onDateChange&&e!==i&&t.onDateChange({date:t.date})},!0)}return e.$inject=["$scope"],e}();angular.module("commonControlsAppInternal").component("p19Calendar",{templateUrl:"views/primitives/p19-calendar.html",controller:T,bindings:{date:"=",onDateChange:"&?",minDate:"=?"}});var I=function(){function e(e){this.$translate=e,this.connectLabel=e.instant("general.no-link-hover"),this.noLinkLabel=e.instant("general.no-link")}return e.$inject=["$translate"],e}();angular.module("commonControlsAppInternal").component("p20Link",{templateUrl:"views/primitives/p20-link.html",controller:I,bindings:{link:"=",onLinkClick:"&",isHover:"=?"}});var x,P=function(){function e(){this.placeholderIcon="add-large",this.defaultColor="#fff",this.buttonOffsetLarge=42}return e.prototype.handleClick=function(e){this.onClick&&this.onClick({color:this.color,$event:e})},e.prototype.getIcon=function(){return this.icon||"edit"},e}();angular.module("commonControlsAppInternal").component("p21ColorTag",{templateUrl:"views/primitives/p21-color-tag.html",controller:P,controllerAs:"$ctrl",bindings:{color:"@",size:"@",showIcon:"<",icon:"@",isSelected:"<",isPlaceholder:"<",tooltip:"@",onClick:"&?"}}),function(e){e[e.Active=0]="Active",e[e.Inactive=1]="Inactive",e[e.Disabled=2]="Disabled"}(x||(x={}));var M=function(){function e(){var e=this;this.isBUISectionVisible=function(){return e.isSectionDisplayed(le.BoldUnderlineItalic)},this.isListingSectionVisible=function(){return e.isSectionDisplayed(le.Listing)},this.isLinkingSectionVisible=function(){return e.isSectionDisplayed(le.Linking)},this.isClearFormattingSectionVisible=function(){return e.isSectionDisplayed(le.ClearFormatting)}}return e.staticGetName=function(e){return _.kebabCase(se[e])},e.upperFirst=function(e){return e.substring(0,1).toUpperCase()+e.substring(1)},e.prototype.getCommandByName=function(t){var i=e.upperFirst(_.camelCase(t));if(void 0===se[i])throw Error("Unidentified command name: "+t+" ("+i+")");return se[i]},e.prototype.isSectionDisplayed=function(e){return-1!==this.displayedSections.indexOf(e)},e.prototype.isActive=function(e){var t=this.getCommandByName(e);return this.commandState({command:t})===x.Active},e.prototype.commandDisabled=function(e){var t=this.getCommandByName(e);return this.commandState({command:t})===x.Disabled},e.prototype.buttonClick=function(e){var t=this.getCommandByName(e);this.commandDisabled(e)||this.onClick({command:t})},e.prototype.getLinkTooltip=function(){var e=this.getCommandByName("link");switch(this.commandState({command:e})){case x.Inactive:return"richtext_add-link";case x.Active:return"richtext_edit-link";case x.Disabled:return"richtext_cannot-link"}},e}();angular.module("commonControlsAppInternal").component("p22RichTextToolbar",{templateUrl:"views/primitives/p22-rich-text-toolbar.html",controller:M,bindings:{displayedSections:"=",commandState:"&",onClick:"&"}});var L=function(){function e(e,t,i,n,o,r,a){var s=this;this.$scope=e,this.$element=t,this.$timeout=i,this.osUtils=n,this.focusKeeper=o,this.keyMap=r,this.ccDebounce=a,this.ckCmdState={},this.mdDialogIsOpen=!1,this.heightStabilized=!1,this.mostUpdatedData="",this.setEditorInstance=function(e){s.instance=e,s.focusOnInit&&s.focused&&s.$timeout(function(){return s.handleFocusOnInstance()},400),s.instance.onDataChange(function(e){return s.mostUpdatedData=e,s.value=e,s.debouncedChangeHandler(e)}),s.instance.onCut(function(){s.$timeout(function(){s.instance.commands.autogrow();var e=s.instance.getData();s.onChangeValue({value:e})})}),s.instance.onCmdStateChange(function(e){s.$timeout(function(){s.ckCmdState=e})}),s.instance.onFocus(function(){s.isDisabled||(s.heightStabilized=!0,s.markAsActiveEditor(),s.mdDialogIsOpen||s.ignoreBlurAndFocus||s.focusP23())}),s.instance.onBlur(function(){!s.instance||s.instance.isIgnoringBlur||s.mdDialogIsOpen||s.ignoreBlurAndFocus||s.blurP23()}),s.instance.onKey(function(e){if(!s.mdDialogIsOpen)switch(e.keyCode){case s.keyMap.KEY_ESC:s.setIgnoreBlurAndFocus(!1),s.blurEditor();break;case s.keyMap.KEY_TAB:case s.keyMap.KEY_SHIFT:s.setIgnoreBlurAndFocus(!1);break;default:s.setIgnoreBlurAndFocus(!0)}}),s.instance.onExternalPasteHandle(function(e){s.onExternalPaste&&(e.data.pasteString=s.onExternalPaste({value:e.data.pasteString}))}),s.instance.setData(s.value||"",{setSelectionOnStart:!1,validateHtml:!1,callback:function(){s.mostUpdatedData=s.instance.getData(),s.ckCmdState=s.instance.getCommandsStates(),s.onReady&&s.onReady(),s.autogrowWhenReady(1e4)}})}}return e.$inject=["$scope","$element","$timeout","osUtils","focusKeeper","keyMap","ccDebounce"],e.prototype.$onInit=function(){var e=this;this.$scope.$watch("$ctrl.value",function(t){(!e.isActiveEditor()||e.forceFocus)&&e.instance&&t&&(e.instance.setData(t,{setSelectionOnStart:!1,validateHtml:!1}),e.heightStabilized&&e.instance.commands.autogrow(),e.mostUpdatedData=t)}),this.$scope.$watch("$ctrl.focused",function(t){t&&e.handleFocusOnInstance()}),this.registerCommandRunner({runner:this.runCommand.bind(this),utilFuncs:{isAlive:function(){return!!e.instance},getValue:function(){return e.mostUpdatedData},getDimensions:function(){return e.instance.getDimensions()},hasSelection:function(){return e.instance.hasSelection()},selectAll:function(){return e.selectAllInEditor()},getCKCommandState:function(t){return e.getCKCommandState(t)},focusEditor:function(t){return void 0===t&&(t=!1),e.focusEditor(t)},blurP23:function(){return e.blurP23()},isActiveEditor:function(){return e.isActiveEditor()},markAsActiveEditor:function(){return e.markAsActiveEditor()}}}),void 0===this.debounceDelay&&(this.debounceDelay=500),this.debouncedChangeHandler=this.ccDebounce(this.debounceDelay,function(t){e.$timeout(function(){return e.onChangeValue({value:t})})},!0),this.$element.on("$destroy",function(){e.instance&&(e.focusKeeper.clearActiveEditor(e),e.instance.destroy(),e.instance=void 0)})},e.prototype.handleFocusOnInstance=function(){this.ignoreBlurAndFocus||(this.markAsActiveEditor(),this.focusEditor(!0))},e.prototype.setIgnoreBlurAndFocus=function(e){var t=this;this.ignoreBlurAndFocus!==e&&this.$scope.$apply(function(){t.ignoreBlurAndFocus=e})},e.prototype.autogrowWhenReady=function(e){var t=this;if(!this.heightStabilized&&e>=0&&this.instance){var i=this.instance.getDimensions();this.instance.commands.autogrow(),_.isEqual(this.instance.getDimensions(),i)?this.$timeout(function(){return t.autogrowWhenReady(e-100)},100):this.heightStabilized=!0}},e.prototype.focusP23=function(){this.onFocus({$event:null,$value:this.mostUpdatedData})},e.prototype.blurP23=function(){this.forceFocus||(!this.osUtils.isIE&&this.instance&&this.instance.collapseSelection(),this.focusKeeper.clearActiveEditor(this),this.onBlur({$event:null,$value:this.mostUpdatedData}),this.changeValueOnBlur&&this.debouncedChangeHandler.flushPending())},e.prototype.isActiveEditor=function(){return this===this.focusKeeper.getActiveEditor()},e.prototype.markAsActiveEditor=function(){this.focusKeeper.setActiveEditor(this)},e.prototype.focusEditor=function(e){void 0===e&&(e=!0),this.instance&&this.isActiveEditor()&&(this.instance.focus(),e&&this.selectAllInEditor())},e.prototype.blurEditor=function(){this.instance&&window.focus()},e.prototype.selectAllInEditor=function(){this.instance?this.execCommand("selectAll"):console.log("trying to selectAllInEditor() when no instance!")},e.prototype.execCommand=function(e){for(var t,i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];this.instance&&(t=this.instance).execCommand.apply(t,[e].concat(i))},e.prototype.clearFormatting=function(){this.instance&&this.instance.hasSelection()&&(this.execCommand("resetThemeAndStyles"),this.defaultFormatting&&(this.defaultFormatting.isBold()&&this.runCommand(se.Bold),this.defaultFormatting.isItalic()&&this.runCommand(se.Italic),this.defaultFormatting.isUnderline()&&this.runCommand(se.Underline)))},e.prototype.linkCommand=function(){var t=this,i=this.commandState({command:se.Link});if(this.instance&&(i===x.Active||i===x.Inactive)){var n=_.get(this.ckCmdState,[e.currentLinkIdField]);this.mdDialogIsOpen=!0,this.onLinkCommand({linkId:n}).then(function(e){e?t.execCommand("wixLink",e):t.execCommand("wixUnlink")}).catch(function(e){return angular.noop}).finally(function(){t.mdDialogIsOpen=!1,t.focusEditor(!1)})}},e.prototype.runCommand=function(t){switch(t){case se.Bold:case se.Underline:case se.Italic:case se.Bullets:case se.Numbers:this.execCommand(e.getCKEditorCommandName(t));break;case se.Link:this.linkCommand();break;case se.ClearFormatting:this.clearFormatting();break;default:throw"Unknown command: "+t}},e.getCKEditorCommandName=function(e){switch(e){case se.Bold:return"bold";case se.Italic:return"italic";case se.Underline:return"underline";case se.Bullets:return"bulletedlist";case se.Numbers:return"numberedlist";case se.Link:return"wixLink";case se.ClearFormatting:return"clearFormatting";default:return"unknown command!"}},e.prototype.getCKCommandState=function(t){var i=e.getCKEditorCommandName(t),n=this.ckCmdState[i];return"wixLink"===i&&0===n?x.Disabled:n?x.Active:x.Inactive},e.currentLinkIdField="wixLink",e}(),k=function(){function e(){}return e.prototype.createInstance=function(e){wixRichtext.createInstance(e)},e}(),A=function(){function e(){}return e.prototype.setActiveEditor=function(e){e!==this.activeEditor&&(this.clearActiveEditor(this.activeEditor),this.activeEditor=e)},e.prototype.clearActiveEditor=function(e){this.activeEditor===e&&(this.activeEditor&&(this.activeEditor.ignoreBlurAndFocus=!1),this.activeEditor=void 0)},e.prototype.getActiveEditor=function(){return this.activeEditor},e.prototype.setIsIgnoringBlurOnActiveEditor=function(e){this.activeEditor&&this.activeEditor.instance&&(this.activeEditor.instance.isIgnoringBlur=e)},e.prototype.restoreFocus=function(){this.activeEditor&&this.activeEditor.focusEditor(!1)},e}();angular.module("commonControlsAppInternal").component("p23RichTextInput",{templateUrl:"views/primitives/p23-rich-text-input.html",controller:L,bindings:{onChangeValue:"&",debounceDelay:"=?",defaultFormatting:"=",onLinkCommand:"&?",onExternalPaste:"&?",registerCommandRunner:"&",onBlur:"&",onFocus:"&",onReady:"&?",focused:"=?",focusOnInit:"=?",isDisabled:"=?",value:"=",commandState:"&",linksManager:"=",stylesManager:"=",ignoreBlurAndFocus:"=",changeValueOnBlur:"<",forceFocus:"="}}).directive("p23RichTextInputInline",["richtextProvider","ccFlags",function(e,t){return{restrict:"A",require:"^p23RichTextInput",link:function(t,i,n,o){if(o.isDisabled)i.html(o.value);else{var r={domElement:i[0],initialData:o.value,onLoaded:o.setEditorInstance,linksManager:o.linksManager,stylesManager:o.stylesManager,setSelectionOnStart:!1,validateHtml:!1,autoGrow:!0};e.createInstance(r)}}}}]).service("richtextProvider",k).service("focusKeeper",A);var E=function(){return function(){}}();angular.module("commonControlsAppInternal").component("p24Palette",{templateUrl:"views/primitives/p24-palette.html",controller:E,bindings:{colors:"<",isSelectable:"<",isSelected:"<"}});var D=function(){function e(e,t,i){this.$element=e,this.mediaUrl=t,this.ccTooltipManager=i,this.$containerWidth=240,this.$containerHeight=102,this.$containerWidthBig=300,this.$containerHeightBig=118,this.$galleryItemMargin=4}return e.$inject=["$element","mediaUrl","ccTooltipManager"],Object.defineProperty(e.prototype,"dotsLimit",{get:function(){return e.DOTS_LIMIT},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"slidesLimit",{get:function(){return e.SLIDES_LIMIT},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tooltip",{get:function(){return"type."+this.data.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"videoTag",{get:function(){return this._videoTag||(this._videoTag=this.$element.find(".video-tag")[0]),this._videoTag},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isVideo",{get:function(){return"video"===this.data.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isGallery",{get:function(){return"gallery"===this.data.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSlideshow",{get:function(){return this.isGallery&&"slideshow"===this.data.metaData.galleryType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cls",{get:function(){return"container-"+(this.data.type||"").toLowerCase()},enumerable:!0,configurable:!0}),e.prototype.getImageURL=function(e){var t,i="small"===this.size?this.$containerHeight:this.$containerHeightBig;return t="gallery"===this.data.type&&"showcase"===this.data.metaData.galleryType?i+this.$galleryItemMargin:"small"===this.size?this.$containerWidth:this.$containerWidthBig,this.mediaUrl.generate({relativeUri:e},t,i)},e.prototype.getGalleryURL=function(e){return this.getImageURL(e)},Object.defineProperty(e.prototype,"imageURL",{get:function(){return this.getImageURL(this.data.value)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){switch(this.data.type){case"color":return{backgroundColor:this.data.value};case"pattern":return{backgroundImage:"url("+Ee.MEDIA_BASE_URL+"media/"+this.data.value+")",backgroundColor:_.get(this.data.metaData,"patternBgColor"),backgroundSize:_.get(this.data.metaData,"thumbRatio",100)+"%"};case"image":return{backgroundImage:"url("+this.imageURL+")"};case"video":default:return""}},enumerable:!0,configurable:!0}),e.prototype.$onInit=function(){this.initSize(),this.initSlides()},e.prototype.initSlides=function(){var e=this;this.isGallery&&_.range(0,this.slidesLimit-this.data.value.length).forEach(function(){e.data.value.push(e.data.value[0])})},e.prototype.initSize=function(){this.size=this.size||"small"},e.prototype.mouseEnter=function(){this.isVideo&&this.videoTag.play()},e.prototype.mouseLeave=function(){this.isVideo&&this.videoTag.pause()},e.DOTS_LIMIT=5,e.SLIDES_LIMIT=3,e}();angular.module("commonControlsAppInternal").component("p25BackgroundPreview",{templateUrl:"views/primitives/p25-background-preview.html",controller:D,controllerAs:"$ctrl",bindings:{data:"=",size:"<?",isSelected:"<?",onClick:"&?",metaData:"=?"}});var F=function(){return function(){this.isSelectedIndex=function(e){return e===parseInt(this.selectedRectangle,10)},this.getClasses=function(e){var t=e===parseInt(this.selectedRectangle,10);return{break:0===e,rectangle:0!==e,"margin-left":(e-1)%this.rectanglesCountEachRow!=0,"margin-top":e/this.rectanglesCountEachRow>1,selected:t}},this.selectPosition=function(e){this.selectedRectangle=e,this.onPositionClicked&&this.onPositionClicked({index:e})},this.getElementsIndices=function(){this.elements=[];for(var e=parseInt(this.rectanglesCount,10),t=parseInt(this.rectanglesCountEachRow,10),i=1;i<=e;i+=1)this.elements.push(i),i%t==0&&i<e&&this.elements.push(0);return this.elements}}}();angular.module("commonControlsAppInternal").component("p26ImagePosition",{templateUrl:"views/primitives/p26-image-position.html",controller:F,bindings:{rectanglesCount:"=",letterOfSelected:"@?",rectanglesCountEachRow:"=",selectedRectangle:"=",onPositionClicked:"&?"}});var B=function(){function e(){}return e.prototype.isSelectedColor=function(e){return e&&e.$index===this.selectedIndex},e.prototype.useLightColorIcon=function(e){return this.lightIconIndex&&this.lightIconIndex.indexOf(e.$index)>-1},e.prototype.getClass=function(e,t){var i={"-selected":this.isSelectedColor({$index:e}),"on-dark":this.useLightColorIcon({$index:e})};return t&&t.class&&(i[t.class]=!0),i},e.prototype.getStyle=function(e){return{backgroundColor:e&&e.color?e.color:e}},e.prototype.setColor=function(e){this.selectedIndex=e,this.setColorCallback({index:e})},Object.defineProperty(e.prototype,"notification",{get:function(){var e=this.selectedIndex;return this.notificationGetter&&this.notificationGetter({index:e})},enumerable:!0,configurable:!0}),e}();angular.module("commonControlsAppInternal").component("p27PaletteColorPicker",{templateUrl:"views/primitives/p27-palette-color-picker.html",controller:B,bindings:{colors:"<",lightIconIndex:"<?",selectedIndex:"=",setColorCallback:"&",notificationGetter:"&?"}});var O=function(){function e(e,t,i){this.$timeout=e,this.$element=t,this.keyMap=i,this.inFocus=!1,this.autocompleteMatches=[],this.autocompleteHoveredIndex=-1,this.ignoreValueForAutoComplete=!0}return e.$inject=["$timeout","$element","keyMap"],e.prototype.$onInit=function(){var e=this;void 0===this.active&&(this.active=!0),void 0===this.long&&(this.long=!1),void 0===this.debounceDelay&&(this.debounceDelay=0),void 0===this.changeValueOnBlur&&(this.changeValueOnBlur=!1),void 0===this.autocompleteMedia&&(this.autocompleteMedia=!1),void 0===this.disableToggle&&(this.disableToggle=!1),!0===this.noHeader&&(this.disableToggle=!0),void 0===this.mobile&&(this.mobile=!1),this.iconName&&(this.isIconSvg=-1!==this.iconName.indexOf(":")),void 0===this.isDisabled&&(this.isDisabled=this.disabled),this.long&&this.$timeout(function(){return e.calculateInputHeight(e.$element.find("textarea"))}),this.randId=Math.random().toString().substr(2)},e.prototype.onInputFocus=function(e){this.ignoreValueForAutoComplete=!0,this.inFocus=!0,this.onFocus({$event:e})},e.prototype.onInputBlur=function(e){var t=e.target;this.inFocus=!1,!this.disableToggle&&""===t.value.trim()&&this.active&&(this.matchCount<=0||this.forceToggle)&&!this.dontAutoToggleWhenEmpty&&this.toggle(),this.long&&this.calculateInputHeight($(t)),this.onBlur({$event:e})},e.prototype.calculateInputHeight=function(e){var t=e.height(),i=e.attr("rows",3).height("auto").height();e.removeAttr("rows").height(Math.min(t,i))},e.prototype.scrollToHoveredItem=function(){var e=angular.element("#ac-"+this.randId+"-item-0"),t=angular.element("#ac-"+this.randId+"-item-"+this.autocompleteHoveredIndex);angular.element("#"+this.randId).animate({scrollTop:t.offset().top-e.offset().top},150)},e.prototype.onKeyUp=function(e){if(e.keyCode===this.keyMap.KEY_UP&&this.autocompleteHoveredIndex>0)this.autocompleteHoveredIndex--,this.scrollToHoveredItem();else if(e.keyCode===this.keyMap.KEY_DOWN&&this.autocompleteHoveredIndex<this.matchCount-1)this.autocompleteHoveredIndex++,this.scrollToHoveredItem();else if(e.keyCode===this.keyMap.KEY_ENTER){if(this.matchCount>0&&this.autocompleteHoveredIndex>=0&&this.autocompleteMatches.length>0){var t=this.autocompleteMatches[this.autocompleteHoveredIndex];this.autocompleteMedia?this.autocompleteMediaItemSelect(t):this.autocomplete&&this.autocompleteItemSelect(t),this.autocompleteHoveredIndex=-1}}else e.keyCode===this.keyMap.KEY_ESC?this.inFocus=!1:this.inFocus=!0},e.prototype.onChange=function(e){this.ignoreValueForAutoComplete=!1,this.onChangeValue&&this.onChangeValue({value:e})},e.prototype.toggle=function(){this.active=!this.active,this.onToggle&&this.onToggle({visibility:this.active})},e.prototype.matchChange=function(e){this.autocompleteMatches=e,this.autocompleteHoveredIndex=-1},e.prototype.autocompleteItemSelect=function(e){this.value!==e&&(this.value=e,this.onChange(this.value))},e.prototype.autocompleteMediaItemSelect=function(e){this.value!==e.text&&(this.value=e.text,this.onChange(e))},Object.defineProperty(e.prototype,"showAutocomplete",{get:function(){return void 0!==this.autocomplete&&this.autocomplete.length>0&&this.inFocus},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showTextAutocomplete",{get:function(){return this.showAutocomplete&&!this.autocompleteMedia},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showMediaAutocomplete",{get:function(){return this.showAutocomplete&&this.autocompleteMedia},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showNewTooltip",{get:function(){return 0===this.matchCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"matchCount",{get:function(){return this.autocompleteMatches.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headerToggleDisabled",{get:function(){return this.disableToggle||this.mobile&&this.active},enumerable:!0,configurable:!0}),e}();angular.module("commonControlsAppInternal").component("c2TextInput",{templateUrl:"views/c2-text-input.html",controller:O,bindings:{label:"@",value:"=",isDisabled:"=?",disabled:"=?",isShowValidatorError:"=?",active:"=?",focused:"=?",long:"=?",prefix:"@?",placeholder:"=?",debounceDelay:"=?",changeValueOnBlur:"<",autocomplete:"=?",autocompleteMedia:"=?",autocompleteLinkLabel:"@?",showHelpButton:"=?",disableToggle:"=?",forceToggle:"=?",dontAutoToggleWhenEmpty:"=?",onToggle:"&",onHelp:"&",helpTooltip:"@?",onChangeValue:"&",onSubmit:"&",onAutocompleteLinkClick:"&",onBlur:"&",onFocus:"&",showButton:"=?",buttonText:"@?",onButtonClick:"&?",showIcon:"=?",iconName:"@?",onIconClick:"&?",maxLength:"@?",validation:"=?",mobile:"=?",onTooltipLinkClick:"&?",valueTooltip:"@?",type:"@?",showAction:"=?",actionLabel:"=?",onAction:"&?",actionTooltip:"@?",noHeader:"=?"}});var H=function(){function e(e){this.$scope=e}return e.$inject=["$scope"],e.prototype.$onInit=function(){void 0===this.active&&(this.active=!0)},e.prototype.toggle=function(){this.disableToggle||(this.active=!this.active,this.onToggle&&this.onToggle({visibility:this.active}))},e}();angular.module("commonControlsAppInternal").component("c3DropdownList",{templateUrl:"views/c3-dropdown-list.html",controller:H,bindings:{label:"@",value:"=",items:"=",trackByKey:"@",labelKey:"@",linkTitle:"@",disableToggle:"=?",onToggle:"&",onSelectionChange:"&",onLinkClick:"&",onHelp:"&",showHelpButton:"=",helpTooltip:"@?",placeholder:"@?",containerClass:"@?",showTitles:"<?",showButton:"<?",buttonText:"<?",buttonTooltip:"<?",onButtonClick:"&",alwaysShowSelect:"<?",automation:"@?"}});var R=function(){function e(e,t,i,n,o,r,a){this.$scope=e,this.mediaUrl=t,this.$sce=i,this.$element=n,this.ccTooltipManager=o,this.$translate=r,this.ccFlags=a,this.DEFAULT_PREVIEW_WIDTH=240,this.DEFAULT_PREVIEW_HEIGHT=144,this.C4M_PREVIEW_WIDTH=80,this.C4M_PREVIEW_HEIGHT=48}return e.$inject=["$scope","mediaUrl","$sce","$element","ccTooltipManager","$translate","ccFlags"],e.prototype.$onInit=function(){var e=this;this.ccFlags.cardsToPanels&&(this.DEFAULT_PREVIEW_HEIGHT=de.BIG_PREVIEW_HEIGHT,this.DEFAULT_PREVIEW_WIDTH=de.BIG_PREVIEW_WIDTH),this.showInfo=!!this.$element.attr("on-info"),void 0===this.type&&(this.type="c4"),void 0===this.active&&(this.active=!0),void 0===this.showTabs&&(this.showTabs=!0),void 0===this.visibleTabs&&(this.visibleTabs=[d.MediaPreviewType.SingleImage]),void 0===this.currentTab&&(this.currentTab=this.visibleTabs[0]),void 0===this.imageCrop&&(this.imageCrop=!0),void 0===this.label&&(this.label=this.$translate.instant("cc.media-preview.label.media")),void 0===this.replaceButtonText&&(this.replaceButtonText=this.$translate.instant("cc.media-preview.button-text.replace")),void 0===this.cropButtonText&&(this.cropButtonText=this.$sce.trustAsHtml("&#9712;")),void 0===this.changeGalleryButtonText&&(this.changeGalleryButtonText=this.$translate.instant("cc.media-preview.button-text.change-gallery")),void 0===this.dontCrop&&(this.showDontCrop=!1),this.previewWidth="c4m"===this.type?this.C4M_PREVIEW_WIDTH:this.DEFAULT_PREVIEW_WIDTH,this.previewHeight="c4m"===this.type?this.C4M_PREVIEW_HEIGHT:this.DEFAULT_PREVIEW_HEIGHT,this.setCurrentMedia(this.convertType(this.currentTab)),this.$scope.$watch("$ctrl.media",function(t,i){e.setCurrentMedia(e.convertType(e.currentTab))},!0)},e.prototype.setCurrentMedia=function(e){var t=_.filter(this.media,function(t){return t.mediaType===("inlineVideo"===e?"video":e)});"video"!==e&&"inlineVideo"!==e||(t=t.filter(function(e){return!0===e.active})),t.length>0&&(this.previewMediaUrl=this.getMediaUrl(t[0],e),this.previewMediaTitle=this.getMediaTitle(t[0]),this.previewMediaAlt=this.getMediaAlt(t[0]))},e.prototype.getTabLabel=function(e){if(this.tabLabels&&e in this.tabLabels)return this.tabLabels[e];switch(e){case d.MediaPreviewType.Clipart:case d.MediaPreviewType.SingleImage:return this.$translate.instant("cc.media-preview.tab-label.image");case d.MediaPreviewType.ExtVideo:case d.MediaPreviewType.InlineVideo:case d.MediaPreviewType.Video:return this.$translate.instant("cc.media-preview.tab-label.video");case d.MediaPreviewType.MultipleImages:return this.$translate.instant("cc.media-preview.tab-label.gallery");case d.MediaPreviewType.Shape:return this.$translate.instant("cc.media-preview.tab-label.shape")}},e.prototype.getActiveLabel=function(){return this.getTabLabel(this.currentTab)||this.label},e.prototype.getMediaUrl=function(e,t){var i=e.width||this.previewWidth,n=e.height||this.previewHeight;if("image"===t)i=this.previewWidth,n=this.previewHeight;else{var o=this.previewWidth/e.width,r=this.previewHeight/e.height;o<r&&o<1?(i=this.previewWidth,n*=o):r<o&&r<1&&(n=this.previewHeight,i*=r)}return this.mediaUrl.generate(e,i,n)},e.prototype.getMediaTitle=function(e){return"extVideo"===e.mediaType||"video"===e.mediaType||"inlineVideo"===e.mediaType?e.Title:e.fileName+" - "+e.width+"x"+e.height+"px"},e.prototype.getMediaAlt=function(e){return"extVideo"===e.mediaType||"video"===e.mediaType||"inlineVideo"===e.mediaType?e.Title:e.fileName},Object.defineProperty(e.prototype,"imageSelected",{get:function(){return this.currentTab===d.MediaPreviewType.SingleImage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"videoSelected",{get:function(){return this.currentTab===d.MediaPreviewType.Video},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extVideoSelected",{get:function(){return this.currentTab===d.MediaPreviewType.ExtVideo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inlineVideoSelected",{get:function(){return this.currentTab===d.MediaPreviewType.InlineVideo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gallerySelected",{get:function(){return this.currentTab===d.MediaPreviewType.MultipleImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shapeSelected",{get:function(){return this.currentTab===d.MediaPreviewType.Shape},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clipartSelected",{get:function(){return this.currentTab===d.MediaPreviewType.Clipart},enumerable:!0,configurable:!0}),e.prototype.showTabSeparator=function(e){return-1!==_.findIndex(this.visibleTabs,function(t){return t<e})&&-1!==_.findIndex(this.visibleTabs,function(t){return t===e})&&this.active},e.prototype.showImage=function(){this.currentTab!==d.MediaPreviewType.SingleImage&&(this.currentTab=d.MediaPreviewType.SingleImage,this.changeMediaType(this.currentTab))},e.prototype.showExtVideo=function(){this.currentTab!==d.MediaPreviewType.ExtVideo&&(this.currentTab=d.MediaPreviewType.ExtVideo,this.changeMediaType(this.currentTab))},e.prototype.showVideo=function(){this.currentTab!==d.MediaPreviewType.Video&&(this.currentTab=d.MediaPreviewType.Video,this.changeMediaType(this.currentTab))},e.prototype.showInlineVideo=function(){this.currentTab!==d.MediaPreviewType.InlineVideo&&(this.currentTab=d.MediaPreviewType.InlineVideo,this.changeMediaType(this.currentTab))},e.prototype.showGallery=function(){this.currentTab!==d.MediaPreviewType.MultipleImages&&(this.currentTab=d.MediaPreviewType.MultipleImages,this.changeMediaType(this.currentTab))},e.prototype.showShape=function(){this.currentTab!==d.MediaPreviewType.Shape&&(this.currentTab=d.MediaPreviewType.Shape,this.changeMediaType(this.currentTab))},e.prototype.showClipart=function(){this.currentTab!==d.MediaPreviewType.Clipart&&(this.currentTab=d.MediaPreviewType.Clipart,this.changeMediaType(this.currentTab))},e.prototype.changeMediaType=function(e){this.setCurrentMedia(this.convertType(e)),this.onMediaTypeChange&&this.onMediaTypeChange({mediaType:e})},e.prototype.convertType=function(e){switch(e){case d.MediaPreviewType.SingleImage:case d.MediaPreviewType.MultipleImages:return"image";case d.MediaPreviewType.ExtVideo:return"extVideo";case d.MediaPreviewType.Shape:return"shape";case d.MediaPreviewType.Clipart:return"clipart";case d.MediaPreviewType.Video:return"video";case d.MediaPreviewType.InlineVideo:return"inlineVideo";default:return"image"}},e.prototype.replaceMedia=function(){var e=d.MediaPreviewType.SingleImage;this.gallerySelected?e=d.MediaPreviewType.MultipleImages:this.extVideoSelected?e=d.MediaPreviewType.ExtVideo:this.inlineVideoSelected?e=d.MediaPreviewType.InlineVideo:this.videoSelected?e=d.MediaPreviewType.Video:this.shapeSelected?e=d.MediaPreviewType.Shape:this.clipartSelected&&(e=d.MediaPreviewType.Clipart),this.onMediaChange&&this.onMediaChange({mediaType:e})},e.prototype.toggle=function(){this.disableToggle||(this.active=!this.active,this.onToggle&&this.onToggle({visibility:this.active}))},e.prototype.isVisibleTab=function(e){return this.visibleTabs.indexOf(e)>-1},Object.defineProperty(e.prototype,"isImageTabVisible",{get:function(){return this.active&&this.isVisibleTab(d.MediaPreviewType.SingleImage)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isGalleryTabVisible",{get:function(){return this.active&&this.isVisibleTab(d.MediaPreviewType.MultipleImages)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isVideoTabVisible",{get:function(){return this.active&&this.isVisibleTab(d.MediaPreviewType.Video)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInlineVideoTabVisible",{get:function(){return this.active&&this.isVisibleTab(d.MediaPreviewType.Video)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isExtVideoTabVisible",{get:function(){return this.active&&this.isVisibleTab(d.MediaPreviewType.ExtVideo)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShapeTabVisible",{get:function(){return this.active&&this.isVisibleTab(d.MediaPreviewType.Shape)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isClipArtTabVisible",{get:function(){return this.active&&this.isVisibleTab(d.MediaPreviewType.Clipart)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCornerIconVisible",{get:function(){return this.visibleTabs.length>1},enumerable:!0,configurable:!0}),e}();angular.module("commonControlsAppInternal").component("c4MediaPreview",{controller:R,templateUrl:"views/c4-media-preview.html",bindings:{media:"=",active:"=?",visibleTabs:"=?",currentTab:"=?",imageCrop:"=?",showEditPanel:"=?",showTabs:"=?",showDontCrop:"<?",dontCrop:"<?",onToggle:"&",onMediaTypeChange:"&",onMediaChange:"&",onCrop:"&",onInfo:"&",onChangeGallery:"&",onDontCropChange:"&",replaceButtonText:"@?",dontCropToggleText:"@?",changeGalleryButtonText:"@?",cropButtonText:"@?",noHover:"=?",disableToggle:"=?",disableMediaChangeButton:"=?",label:"@?",tabLabels:"=?",mediaTooltip:"@?",onTooltipLinkClick:"&?",type:"@?"}});var N=function(){function e(){}return e.prototype.$onInit=function(){void 0===this.active&&(this.active=!0),this.isHover=!1},e.prototype.toggle=function(){this.active=!this.active,this.onToggle&&this.onToggle({visibility:this.active})},e.prototype.setIsHover=function(e){this.isHover=e},e}();angular.module("commonControlsAppInternal").component("c5LinkInput",{templateUrl:"views/c5-link-input.html",controller:N,bindings:{label:"@",link:"=",active:"=?",disableToggle:"=?",showHelpButton:"=",helpTooltip:"@?",onHelp:"&",onToggle:"&",onEditLink:"&",hideLinkOnToggle:"<?"}});var U,V=function(){function e(e){var t=this;this.CcDialogBuilder=e,this.showMenu=!1,this.toggle=function(){"p10f"===t.itemType&&t.item.disabled||(t.item.hidden=!t.item.hidden,t.onToggle&&t.onToggle({item:t.item}))},this.menuAction=function(e){e&&e({item:t.item})},this.itemToPage=function(){return t.menuAction(t.onItemToPage)},this.duplicate=function(){return t.menuAction(t.onDuplicate)},this.delete=function(){return t.menuAction(t.onDelete)},this.edit=function(){t.editInPlace?t.toggleEditMode():t.onEdit&&t.menuAction(t.onEdit)}}return e.$inject=["CcDialogBuilder"],e.prototype.$onInit=function(){this.labelProperty=this.labelProperty||"label",this.iconProperty=this.iconProperty||"icon"},e.prototype.getItemValue=function(e){return _.get(this.item,e)},e.prototype.setItemValue=function(e,t){return _.set(this.item,e,t)},Object.defineProperty(e.prototype,"icon",{get:function(){return this.getItemValue(this.iconProperty)},set:function(e){this.setItemValue(this.iconProperty,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"label",{get:function(){return this.getItemValue(this.labelProperty)},set:function(e){this.setItemValue(this.labelProperty,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldHideEyeWhenActive",{get:function(){return!this.showEyeIcon||!(void 0===this.item.canHide||!0===this.item.canHide)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHideIconEnabled",{get:function(){return this.item.hidden&&("p10c"===this.itemType||"p10e"===this.itemType)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShowIconEnabled",{get:function(){return!this.item.hidden&&("p10c"===this.itemType||"p10e"===this.itemType)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShowItemListNewDesign",{get:function(){return"p10c"!==this.itemType&&"p10e"!==this.itemType},enumerable:!0,configurable:!0}),e.prototype.getTooltipName=function(){return this.item.disabled?"disabled_item":this.item.hidden?"show_item":"hide_item"},e.prototype.isItemDisabled=function(){return"p10f"===this.itemType&&this.item.disabled},Object.defineProperty(e.prototype,"showOrHideItem",{get:function(){return this.isShowEyeIconEnabled?"cc-icon-show":this.isHideEyeIconEnabled?this.isItemDisabled()?"cc-icon-show -disabled":"cc-icon-hide":void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHideEyeIconEnabled",{get:function(){return this.item.hidden&&"p10c"!==this.itemType&&"p10e"!==this.itemType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShowEyeIconEnabled",{get:function(){return!this.item.hidden&&"p10c"!==this.itemType&&"p10e"!==this.itemType},enumerable:!0,configurable:!0}),e.prototype.enableEditMode=function(){this.inEditMode=!0},e.prototype.disableEditMode=function(){this.inEditMode=!1},e.prototype.toggleEditMode=function(){this.inEditMode=!this.inEditMode},e.prototype.itemClicked=function(){this.onClick&&this.onClick({item:this.item}),this.editInPlace&&this.enableEditMode()},e.prototype.itemDoubleClicked=function(){this.onDoubleClick&&this.onDoubleClick({item:this.item})},e.prototype.editIconClicked=function(){this.editInPlace&&this.toggleEditMode(),this.onEdit({item:this.item})},Object.defineProperty(e.prototype,"isItemDraggable",{get:function(){return this.isDraggable&&"p10f"!==this.itemType},enumerable:!0,configurable:!0}),e.prototype.onEditText=function(e){this.onEdit&&(this.label=e,this.onEdit(this.item))},e.prototype.openMenu=function(e){var t=this,i={clientPos:{clientX:e.clientX,clientY:e.clientY},item:this.item,noDelete:this.noDelete,noDuplicate:this.noDuplicate,noEdit:this.noEdit,noHide:this.noHide,onDelete:this.delete,onDuplicate:this.duplicate,onEdit:this.edit,onItemToPage:this.itemToPage,noItemToPage:this.noItemToPage,onToggle:this.toggle};this.showMenu=!0,this.CcDialogBuilder.showListItemMenu(i).finally(function(){t.showMenu=!1})},e.prototype.isValid=function(){if(this.itemValidator){var e=this.itemValidator({item:this.item});return!0===e||void 0===e}return!0},e.prototype.getLabel=function(e){return this.labelFilter?this.labelFilter(e):e},e.prototype.getInvalidTooltip=function(){if(this.invalidTooltip)return"string"==typeof this.invalidTooltip?this.invalidTooltip:this.invalidTooltip(this.item)},e}();angular.module("commonControlsAppInternal").component("c6ListItem",{templateUrl:"views/c6-list-item.html",controller:V,bindings:{item:"=",itemType:"=",noMenu:"=?",noDelete:"=?",noEdit:"=?",noDuplicate:"=?",noHide:"=?",invalidTooltip:"=?",onToggle:"&",onItemToPage:"&",noItemToPage:"=?",onEdit:"&",onDelete:"&",onDuplicate:"&",onClick:"&?",onDoubleClick:"&?",itemValidator:"&?",labelProperty:"=?",iconProperty:"=?",isDraggable:"=?",isSelectable:"=?",editInPlace:"=?",showEyeIcon:"=?",showEditIcon:"=?",labelFilter:"<?",cogAlwaysVisible:"=?",editAlwaysVisible:"=?"}}),function(e){var t=function(){function e(){this.DEFAULT_ICON="rich-text:bold",this.DEFAULT_BUTTON_TEXT="Click Here"}return e.prototype.$onInit=function(){this.iconProperty=this.iconProperty||"iconName","undefined"===this.itemType&&(this.itemType="p10l")},e.prototype.getItemValue=function(e){return _.get(this.item,e)},Object.defineProperty(e.prototype,"icon",{get:function(){return this.getItemValue(this.iconProperty)||this.DEFAULT_ICON},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.getItemValue("value")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"placeholder",{get:function(){return this.getItemValue("placeholder")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buttonText",{get:function(){return this.getItemValue("buttonText")||this.DEFAULT_BUTTON_TEXT},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isButtonVisible",{get:function(){return this.getItemValue("buttonVisible")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isIconVisible",{get:function(){return this.getItemValue("iconVisible")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isItemDraggable",{get:function(){return this.isDraggable},enumerable:!0,configurable:!0}),e.prototype.handleOnBlur=function(e){this.onBlur({value:e.currentTarget.value})},e.prototype.handleOnDelete=function(){this.onDelete()},e.prototype.handleOnChangeValue=function(e){this.onChangeValue({value:e})},e.prototype.handleOnButtonClick=function(){this.onButtonClick()},e.prototype.handleOnIconClick=function(){this.onIconClick()},e}();angular.module("commonControlsAppInternal").component("c6ListItemP10l",{templateUrl:"views/c6-list-item-p10l.html",controller:t,bindings:{item:"=",itemType:"=",onDelete:"&",onChangeValue:"&",onBlur:"&",noDelete:"=",onButtonClick:"&",onIconClick:"&",debounceDelay:"<",isDraggable:"=?",iconProperty:"<",isSingleItem:"<",focused:"="}})}(U||(U={}));var z=function(){function e(e,t){var i=this;this.$translate=e,this.$timeout=t,this.isDragInProgress=!1,this.sortableOptions={orderChanged:function(e){i.onOrderChange&&i.onOrderChange({event:{fromIndex:e.source.index,toIndex:e.dest.index}})},accept:function(e,t){return e.itemScope.sortableScope.$id===t.$id},dragStart:function(){i.isDragInProgress=!0},dragEnd:function(){i.isDragInProgress=!1}}}return e.$inject=["$translate","$timeout"],e.prototype.$onInit=function(){this.itemType=this.itemType||"default",void 0===this.disableToggle&&(this.disableToggle=!0),void 0===this.active&&(this.active=!0);var t=e.getConfiguration(this.itemType);t.addNewTitle=this.overrideLabel||e.getAddNewTitle(this.itemType,this.$translate),this.applyConfiguration(t)},e.getAddNewTitle=function(e,t){switch(e.toLowerCase()){case"p10a":case"p10b":case"p10c":case"p10d":case"p10e":case"p10m":return;case"p10l":case"default":case"p10":default:return t.instant("cc.c6-list.add-new-item.title")}},e.getConfiguration=function(e){var t;switch(e.toLowerCase()){case"p10a":t={isDraggable:!1,isSelectable:!0,showEditIcon:!0,noMenu:!0};break;case"p10b":t={isDraggable:!1,showEditIcon:!0,noMenu:!0};break;case"p10c":t={isDraggable:!1,showEyeIcon:!0,noMenu:!0};break;case"p10d":t={editInPlace:!0,noDuplicate:!0,showEditIcon:!0};break;case"p10e":t={isDraggable:!1,showEyeIcon:!0,noMenu:!0};break;case"p10m":t={isDraggable:!1,noDelete:!0,noItemToPage:!0,noDuplicate:!0,showEditIcon:!0,noMenu:!0,editAlwaysVisible:!0};break;case"p10l":t={isDraggable:!0,linkBottom:!0};break;case"default":case"p10":default:t={showEditIcon:!0}}var i={isDraggable:!0,isSelectable:!1,editInPlace:!1,showEyeIcon:!1,showEditIcon:!1,noMenu:!1,noDelete:!1,noEdit:!1,noHide:!1,noDuplicate:!1,noItemToPage:!1,cogAlwaysVisible:!1,editAlwaysVisible:!1};return _.assign(i,t),i},e.prototype.applyConfiguration=function(e){var t=this;_.forOwn(e,function(i,n){void 0===t[n]&&(t[n]=e[n])})},e.prototype.handleOnDelete=function(e){this.onDelete({index:e})},e.prototype.handleOnEdit=function(e){this.onEdit({index:e})},e.prototype.handleOnBlur=function(e,t){var i=this;""===t&&this.onToggle&&(this.items.length>1?this.$timeout(function(){return i.onDelete({index:e})}):this.onToggle({visibility:!1}))},e.prototype.handleOnChangeValue=function(e,t){this.onTextChange({index:e,value:t})},Object.defineProperty(e.prototype,"isShowItemListNewDesign",{get:function(){return"p10c"!==this.itemType&&"p10e"!==this.itemType},enumerable:!0,configurable:!0}),e}();angular.module("commonControlsAppInternal").filter("cleanAddNewTitle",function(){return function(e){return(e||"").replace(/^\+ ?/,"")}}),angular.module("commonControlsAppInternal").component("c6List",{templateUrl:"views/c6-list.html",controller:z,bindings:{label:"@",items:"=",itemType:"@",addNewTitle:"@?",itemLabelProperty:"@?",itemIconProperty:"@?",enableDeleteOnSingleItem:"=?",onAddNew:"&",onEdit:"&",onDuplicate:"&",onDelete:"&",onToggle:"&",onItemToPage:"&",onOrderChange:"&",onItemClick:"&?",onItemDoubleClick:"&?",onHelp:"&",showHelpButton:"=",helpTooltip:"@?",editTooltip:"@?",disableToggle:"=?",itemValidator:"&?",isDraggable:"=?",editInPlace:"=?",showEyeIcon:"=?",showEditIcon:"=?",invalidTooltip:"=?",noMenu:"=?",noDelete:"=?",noEdit:"=?",noHide:"=?",noItemToPage:"=?",noDuplicate:"=?",labelFilter:"<?",overrideLabel:"=?",cogAlwaysVisible:"=?",editAlwaysVisible:"=?",disableListLink:"=?",onTextChange:"&",active:"=?",debounceDelay:"<",focused:"=?",focusIndex:"=?"}});var j=function(){function e(){}return e.prototype.$onInit=function(){void 0===this.active&&(this.active=!0)},e.prototype.toggle=function(){this.active=!this.active,this.onToggle&&this.onToggle({visibility:this.active})},e}();angular.module("commonControlsAppInternal").component("c7MultiFieldGroup",{templateUrl:"views/c7-multi-field-group.html",controller:j,transclude:!0,bindings:{label:"@",active:"=?",onHelp:"&",showHelpButton:"=",helpTooltip:"@?",disableToggle:"=?",onToggle:"&"}});var W=function(){return function(){}}();angular.module("commonControlsAppInternal").component("c8LabelAction",{templateUrl:"views/c8-label-action.html",controller:W,bindings:{label:"@",actionText:"=",onActionClick:"&"}});var G=function(){function e(e){this.$scope=e}return e.$inject=["$scope"],e.prototype.$onInit=function(){var e=this;this.$scope.$watchCollection(function(){return e.items},function(t){t&&t.length||(e.active=!1)}),void 0===this.active&&(this.active=!0)},e.prototype.onClick=function(e,t){this.onItemClick&&(e.stopPropagation(),this.onItemClick({item:t}))},e.prototype.toggle=function(e){e.stopPropagation(),this.active=!this.active,this.onToggle&&this.onToggle({visibility:this.active})},e.prototype.isValid=function(){var e=this;return!this.itemValidator||this.items.reduce(function(t,i){return t&&e.itemValidator({item:i})},!0)},e}();angular.module("commonControlsAppInternal").component("c8bLabelGraphic",{templateUrl:"views/c8b-label-graphic.html",controller:G,bindings:{label:"@",paragraph:"=?",items:"=",active:"=?",onItemClick:"&",onToggle:"&",onHelp:"&",showHelpButton:"=",helpTooltip:"@?",disableToggle:"=?",itemValidator:"&?",validationTooltip:"@?"}});var K=function(){return function(){}}();angular.module("commonControlsAppInternal").component("c9ActionButton",{templateUrl:"views/c9-action-button.html",controller:K,bindings:{label:"@",onClick:"&"}});var q=function(){return function(){}}();angular.module("commonControlsAppInternal").component("c10ItemNavigation",{templateUrl:"views/c10-item-navigation.html",controller:q,bindings:{nextTooltip:"@",previousTooltip:"@",current:"=",count:"=",onPrevious:"&",onNext:"&"}});var Y=function(){return function(){}}();angular.module("commonControlsAppInternal").component("c11Paragraph",{templateUrl:"views/c11-paragraph.html",controller:Y,bindings:{html:"="}});var X=function(){function e(){}return e.prototype.onThumbnailSelect=function(e){var t=this.thumbnails.find(function(t){return t===e});this.thumbnails.forEach(function(e){return e.isSelected=!1}),t.isSelected=!0,this.onSelect({item:t})},e}();angular.module("commonControlsAppInternal").component("c12Thumbnails",{controller:X,bindings:{label:"@",thumbnails:"=",onSelect:"&"},template:'\n                <div class="c12-thumbnails-wrapper">\n                  <p6-control-header label="$ctrl.label" hide-toggle-button="true"></p6-control-header>\n                  <div class="c12-thumbnail-container">\n                    <p12-thumbnail ng-repeat="thumbnail in $ctrl.thumbnails"\n                                  thumbnail="thumbnail"\n                                  is-selected="thumbnail.isSelected"\n                                  ng-click="$ctrl.onThumbnailSelect(thumbnail)">\n                    </p12-thumbnail>\n                  </div>\n                  <p17-divider></p17-divider>\n                </div>\n              '});var Z=function(){function e(){}return e.prototype.checkedChange=function(e){this.onItemChange&&this.onItemChange({item:e})},e.prototype.requiredChange=function(e){this.onItemChange&&this.onItemChange({item:e})},e}();angular.module("commonControlsAppInternal").component("c13CheckboxList",{templateUrl:"views/c13-checkbox-list.html",controller:Z,bindings:{label:"@",items:"=",onItemChange:"&"}});var J=function(){return function(){}}();angular.module("commonControlsAppInternal").component("c14Checkbox",{templateUrl:"views/c14-checkbox.html",controller:J,bindings:{item:"=",onToggle:"&",onRequiredChange:"&"}});var Q=function(){function e(){}return e.prototype.$onInit=function(){void 0===this.active&&(this.active=!0)},e.prototype.toggle=function(){this.active=!this.active,this.onToggle()},e}();angular.module("commonControlsAppInternal").component("c15RadioButtons",{templateUrl:"views/c15-radio-buttons.html",controller:Q,bindings:{active:"=?",items:"=",value:"=",showHelpButton:"=",helpTooltip:"@?",label:"@",onValueChange:"&",onToggle:"&",onHelp:"&"}});var ee=function(){function e(e,t){var i=this;this.$scope=e,this.$translate=t,this.onValueChangeDebounce=this.debounceDelay>0?_.debounce(function(e){return i.onValueChange(e)},this.debounceDelay):this.onValueChange}return e.$inject=["$scope","$translate"],e}();angular.module("commonControlsAppInternal").component("c16Slider",{templateUrl:"views/c16-slider.html",controller:ee,bindings:{onValueChange:"&",onValueSettle:"&",sliderType:"@",horizontal:"<?",showDivider:"<?",label:"@",iconBefore:"@",iconAfter:"@",categoryTitle:"@",categoryLabels:"<",min:"=",max:"=",step:"=",stepper:"=?",units:"=?",value:"=",showHelpButton:"=",helpTooltip:"@?",onHelp:"&",debounceDelay:"<?",clickableIcons:"<?"}});var te=function(){function e(e,t){var i=this;this.$element=e,this.$scope=t,this.toggle=function(){i.value=!i.value,i.onValueChange({value:i.value})}}return e.$inject=["$element","$scope"],e.prototype.$onInit=function(){var e=this;void 0===this.type&&(this.type="c19a"),"c19c"!==this.type&&this.$element.click(function(t){var i=e.$element.find("p15-toggle")[0];i&&(t.target===i||$.contains(i,t.target))||e.disableToggle||e.$scope.$apply(e.toggle)}),this.$element.mousedown(function(e){e.stopPropagation(),e.preventDefault()})},e}();angular.module("commonControlsAppInternal").component("c19Toggle",{templateUrl:"views/c19-toggle.html",controller:te,bindings:{label:"@",value:"=",onHelp:"&?",helpTooltip:"@?",toggleTooltip:"@?",onValueChange:"&",leftIcon:"=?",rightIcon:"=?",type:"@?",disableToggle:"=?"}});var ie=function(){function e(e,t){this.$scope=e,this.$attrs=t,void 0===this.complex&&(this.complex=!0),this.tooltip&&void 0===this.showTooltipIcon&&(this.showTooltipIcon=!0)}return e.$inject=["$scope","$attrs"],e.prototype.$onInit=function(){var e=this;this.$scope.$parent.$watch(this.$attrs.ngDisabled,function(t){return e.isDisabled=t})},Object.defineProperty(e.prototype,"showIcon",{get:function(){return!this.selectedIcon||this.selectedIcon&&!this.isSelected},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showSelectedIcon",{get:function(){return this.isSelected&&!!this.selectedIcon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showDisabledIcon",{get:function(){return this.isDisabled&&!!this.disabledIcon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayedIcon",{get:function(){var e=this.showDisabledIcon?this.disabledIcon:this.showSelectedIcon?this.selectedIcon:this.icon;return(""+(this.complex?"graphic-radio:":"")+e).replace(":","-")},enumerable:!0,configurable:!0}),e.prototype.getSelectedIconSize=function(){var e=[];return this.small&&e.push("-small"),this.selectedIconSize&&e.push("-selected-icon-"+this.selectedIconSize),e},e}();angular.module("commonControlsAppInternal").component("c20GraphicRadio",{templateUrl:"views/c20-graphic-radio.html",controller:ie,controllerAs:"$ctrl",bindings:{icon:"<",url:"<?",backgroundColor:"<",label:"<",tooltip:"@?",onClick:"&?",isSelected:"<?",selectedIcon:"<?",disabledIcon:"<?",hoverImgUrl:"<?",complex:"<",small:"<",selectedIconSize:"@",customClass:"@",automation:"@?",onTooltipClick:"&?",showTooltipIcon:"<?"}});var ne=function(){function e(){}return e.prototype.$postLink=function(){var e=this;this.postRadioItems=[{label:"",icon:"misc:addlarge",class:"c20-add-button",complex:!1,isUnselectable:!0,onClick:function(){e.onAddClick&&e.onAddClick()}}]},e}();angular.module("commonControlsAppInternal").component("c20AddableList",{controller:ne,templateUrl:"views/c20-addable-list.html",bindings:{onSelect:"&?",onAddClick:"&?",selectedRadio:"<",radioItems:"<",label:"@"}});var oe,re=function(){function e(){this.small="small"===this.size}return e.prototype.setSelected=function(e){e.isDisabled||(e.onClick&&e.onClick(),e.isUnselectable||this.selectedRadio===e||(this.selectedRadio=e,this.onSelect&&this.onSelect({item:e})))},e}();angular.module("commonControlsAppInternal").component("c20GraphicRadioControl",{controller:re,templateUrl:"views/c20-graphic-radio-control.html",bindings:{onSelect:"&?",onMouseEnter:"&?",selectedRadio:"<",size:"@",selectedIconSize:"@",radioItems:"<",postRadioItems:"<",label:"@",showHelpButton:"<",showToggleButton:"<",onToggle:"&?",onHelp:"&?",headerToggleActive:"<",helpToolTip:"@"}}),function(e){e[e.Active=0]="Active",e[e.Inactive=1]="Inactive",e[e.Disabled=2]="Disabled"}(oe||(oe={}));var ae=function(){function e(){var e=this;this.isSizeVisible=function(){return!0},this.isBUICSectionVisible=function(){return e.isSectionDisplayed(le.BoldUnderlineItalic)},this.isListingSectionVisible=function(){return e.isSectionDisplayed(le.Listing)},this.isLinkingSectionVisible=function(){return e.isSectionDisplayed(le.Linking)},this.isClearFormattingSectionVisible=function(){return e.isSectionDisplayed(le.ClearFormatting)}}return e.upperFirst=function(e){return e.substring(0,1).toUpperCase()+e.substring(1)},e.prototype.getCommandByName=function(t){var i=e.upperFirst(_.camelCase(t));if(void 0===se[i])throw Error("Unidentified command name: "+t+" ("+i+")");return se[i]},e.prototype.isSectionDisplayed=function(e){return-1!==this.displayedSections.indexOf(e)},e.prototype.isActive=function(e){var t=this.getCommandByName(e);return this.commandState({command:t})===oe.Active},e.prototype.commandDisabled=function(e){var t=this.getCommandByName(e);return this.commandState({command:t})===oe.Disabled},e.prototype.handleCommandClick=function(e){var t=this.getCommandByName(e);this.commandDisabled(e)||this.onCommandClick({command:t})},e.prototype.getLinkTooltip=function(){var e=this.getCommandByName("link");switch(this.commandState({command:e})){case oe.Inactive:return"richtext_add-link";case oe.Active:return"richtext_edit-link";case oe.Disabled:return"richtext_cannot-link"}},e.prototype.decreaseSize=function(){this.onDecreaseSize()},e.prototype.increaseSize=function(){this.onIncreaseSize()},e.prototype.getAlign=function(){return this.alignState()},e.prototype.setAlign=function(e){this.onAlignClick({align:e})},e.prototype.handleActionClick=function(){this.onActionClick()},e.prototype.handleHideClick=function(){this.onHideClick()},e}();angular.module("commonControlsAppInternal").component("c22EditTextToolbar",{templateUrl:"views/c22-edit-text-toolbar.html",controller:ae,bindings:{displayedSections:"<",commandState:"&",onCommandClick:"&",onDecreaseSize:"&",onIncreaseSize:"&",alignState:"&",onAlignClick:"&",actionLabel:"@",onActionClick:"&",onHideClick:"&"}});var se=U.RTTCommand,le=U.RTTSection,ce=function(){function e(e,t,i,n){var o=this;this.$timeout=e,this.$scope=t,this.$element=i,this.osUtils=n,this.inFocus=!1,this.hasBeenBlurred=!1,this.ignoreBlurAndFocus=!1,this.shouldSelectAllOnFocus=!0,this.callOnClick=function(e){o.$timeout(function(){$.contains(o.$element.get(0),e.target)||o.osUtils.isIE&&$.contains(o.$element.get(0),e.target.correspondingUseElement)?(o.setIgnoreBlurAndFocus(!0),o.utilFuncs.focusEditor(!1)):o.setIgnoreBlurAndFocus(!1)})}}return e.$inject=["$timeout","$scope","$element","osUtils"],e.prototype.$onInit=function(){var e=this;void 0===this.active&&(this.active=!0),void 0===this.debounceDelay&&(this.debounceDelay=500),void 0===this.disableToggle&&(this.disableToggle=!1),void 0===this.maxRowsOnBlur&&(this.maxRowsOnBlur=2),void 0===this.maxRowsOnFocus&&(this.maxRowsOnFocus=20),void 0===this.displayedRTTSections&&(this.displayedRTTSections=[le.BoldUnderlineItalic,le.Listing,le.Linking,le.ClearFormatting]),-1===this.displayedRTTSections.indexOf(le.Listing)?this.onExternalPaste=function(e){return e.replace(/<\/?li.*?>/g,"").replace(/<\/?[ou]l.*?>/g,"")}:this.onExternalPaste=_.identity,this.$scope.$watch(function(){return e.inFocus&&e.utilFuncs&&!e.utilFuncs.isActiveEditor()},function(t,i){t&&i!==t&&(e.utilFuncs.blurP23(),e.ignoreBlurAndFocus=!1,e.inFocus=!1)})},e.prototype.$onDestroy=function(){this.onInputBlur(null,this.value)},e.prototype.log=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var n=(this.utilFuncs&&this.utilFuncs.getValue()||"empty").replace(/<.*?>/g,"").split(" ")[0];"mute"!==n&&console.log.apply(console,[n,e].concat(t))},e.prototype.setIgnoreBlurAndFocus=function(e){var t=this;this.$scope.$apply(function(){t.ignoreBlurAndFocus=e})},e.prototype.onMouseLeave=function(){this.osUtils.isIE||(this.ignoreBlurAndFocus=!1)},e.prototype.onMouseEnter=function(){this.utilFuncs&&!this.utilFuncs.isActiveEditor()&&(this.ignoreBlurAndFocus=!1)},e.prototype.onInputFocus=function(e){var t=this;this.$timeout(function(){t.utilFuncs.markAsActiveEditor(),t.inFocus=!0,t.hasBeenBlurred=!1,t.calculateInputHeight(),t.setIgnoreBlurAndFocus(!1),t.shouldSelectAllOnFocus&&!t.disableSelectAllOnFocus&&(t.utilFuncs.selectAll(),t.shouldSelectAllOnFocus=!1),window.document.addEventListener("mousedown",t.callOnClick,!0),t.onFocus({$event:e})})},e.prototype.onInputBlur=function(e,t){var i=this;this.hasBeenBlurred||this.forceFocus||(this.inFocus=!1,this.hasBeenBlurred=!0,this.$timeout(function(){!i.disableToggle&&i.isEmptyValue({value:t})&&i.active&&!i.dontAutoToggleWhenEmpty?i.toggle():(i.calculateInputHeight(),i.inputElem.scrollTop(0)),i.setIgnoreBlurAndFocus(!1),window.document.removeEventListener("mousedown",i.callOnClick,!0),i.shouldSelectAllOnFocus=!0,i.onBlur({$event:e,$value:t})}))},e.prototype.calculateInputHeight=function(){this.inFocus?this.animateMaxHeight(this.maxRowsOnBlur,this.maxRowsOnFocus,"auto"):this.animateMaxHeight(this.maxRowsOnFocus,this.maxRowsOnBlur,"hidden")},e.prototype.animateMaxHeight=function(e,t,i){var n=this.inputElem,o=this.utilFuncs&&this.utilFuncs.isAlive()?this.utilFuncs.getDimensions().height:0,r=Math.min(o,24*e);r=e<t?Math.max(r,n.height()):Math.min(r,n.height());var a=Math.min(o,24*t);n.stop(!0,!1),n.css({overflow:"hidden","max-height":r,"animation-timing-function":"ease-out"}),n.animate({maxHeight:a},180,function(){n.css({overflow:i,"max-height":24*t})})},e.prototype.onEditorReady=function(){var e=this;this.$timeout(function(){return e.calculateInputHeight()})},Object.defineProperty(e.prototype,"inputElem",{get:function(){return $(this.$element.find("p23-rich-text-input"))},enumerable:!0,configurable:!0}),e.prototype.onChange=function(e){this.onChangeValue&&(this.onChangeValue({value:e}),this.shouldFocusOnChangeValue&&this.onInputFocus())},e.prototype.toggle=function(){this.active=!this.active,this.inFocus=!1,this.ignoreBlurAndFocus=!1,this.onToggle&&this.onToggle({visibility:this.active})},e.prototype.registerCommandRunner=function(e,t){this.commandRunner=e,this.utilFuncs=t},e.prototype.runCommand=function(e){var t=this.getCommandState(e);this.commandRunner(e),this.onRunCommand&&this.onRunCommand({command:e,state:t===x.Inactive})},e.prototype.getCommandState=function(e){return this.utilFuncs?this.utilFuncs.getCKCommandState(e):x.Disabled},e}();angular.module("commonControlsAppInternal").component("c23RichTextInput",{templateUrl:"views/c23-rich-text-input.html",controller:ce,bindings:{label:"@",value:"=",isDisabled:"=?",active:"=?",focused:"=?",focusOnInit:"=?",placeholder:"=?",debounceDelay:"=?",showHelpButton:"=?",disableToggle:"=?",dontAutoToggleWhenEmpty:"=?",helpTooltip:"@?",onToggle:"&",onHelp:"&",onChangeValue:"&",onBlur:"&",onFocus:"&",onRunCommand:"&",iconName:"@?",maxLength:"@?",validation:"=?",displayedRTTSections:"=?",defaultFormatting:"=",onLinkCommand:"&?",linksManager:"=",stylesManager:"=",isEmptyValue:"&",maxRowsOnBlur:"=?",maxRowsOnFocus:"=?",changeValueOnBlur:"<",showAction:"=?",actionLabel:"=?",onAction:"&?",actionTooltip:"@?",forceFocus:"=?",disableSelectAllOnFocus:"=?",shouldFocusOnChangeValue:"=?"}});var de=function(){function e(e,t,i,n,o,r){var a=this;this.$scope=e,this.mediaUrl=t,this.$sce=i,this.$element=n,this.ccTooltipManager=o,this.$translate=r,this.C4M_PREVIEW_WIDTH=80,this.C4M_PREVIEW_HEIGHT=48,this.showReplaceOptions=function(){return a.showReplaceOptionsMenu=!0},this.hideReplaceOptions=function(){return a.showReplaceOptionsMenu=!1}}return e.$inject=["$scope","mediaUrl","$sce","$element","ccTooltipManager","$translate"],e.prototype.$onInit=function(){var e=this;this.showInfo=!!this.$element.attr("on-info"),void 0===this.type&&(this.type="c4"),void 0===this.active&&(this.active=!0),void 0===this.showTabs&&(this.showTabs=!0),void 0===this.visibleTabs&&(this.visibleTabs=[{mediaType:d.MediaPreviewType.SingleImage}]),void 0===this.currentTab&&(this.currentTab=this.visibleTabs[0].mediaType),void 0===this.label&&(this.label=this.$translate.instant("cc.media-preview.label.media")),void 0===this.replaceButtonText&&(this.replaceButtonText=this.$translate.instant("cc.media-preview.button-text.replace")),void 0===this.customizeButtonText&&(this.customizeButtonText=this.$translate.instant("cc.media-preview.button-text.customize")),void 0===this.size&&(this.size="small"),void 0===this.showCustomize&&(this.showCustomize="small"===this.size),this.setCurrentMedia(this.currentTab),this.$scope.$watch("$ctrl.currentMedia",function(){e.setCurrentMedia(e.currentTab)},!0),this.$scope.$watch("$ctrl.currentTab",function(t){e.updateMediaType(t)},!0),this.$scope.$watch("$ctrl.visibleTabs",function(){e.setCurrentMedia(e.currentTab),e.initTabs()},!0),this.$scope.$watch("$ctrl.tabLabels",function(){e.initTabs()},!0)},Object.defineProperty(e.prototype,"indicatorIcon",{get:function(){return(this.getTabLabel(this.currentTab)||"").toLowerCase()},enumerable:!0,configurable:!0}),e.prototype.setMediaPreviewSize=function(){this.previewWidth="big"===this.size?e.BIG_PREVIEW_WIDTH:e.DEFAULT_PREVIEW_WIDTH,this.previewHeight="big"===this.size?e.BIG_PREVIEW_HEIGHT:e.DEFAULT_PREVIEW_HEIGHT,this.isSmallMedia&&(this.previewWidth-=this.previewWidth/this.previewHeight*e.SMALL_MEDIA_GAP,this.previewHeight-=e.SMALL_MEDIA_GAP)},e.prototype.initTabs=function(){var t=this;this.options=this.visibleTabs.map(function(i){var n=t.getTabLabel(i.mediaType),o=e.getTabLabelByMediaType(i.mediaType);return{id:i.mediaType,label:n,icon:"graphic-radio-section-media:"+o,complex:!1,automation:"media preview "+o,isDisabled:!!i.disabled,tooltip:i.tooltip,onTooltipClick:i.onTooltipClick,showTooltipIcon:i.showTooltipIcon}})},e.prototype.updateMediaType=function(t){this.mediaType=e.getTabLabelByMediaType(t),this.setMediaPreviewSize()},e.prototype.setCurrentMedia=function(t){var i=e.convertType(t);this.currentMedia&&(this.previewMediaUrl=this.getMediaUrl(this.currentMedia,i),this.previewMediaTitle=this.getMediaTitle(this.currentMedia),this.previewMediaAlt=this.getMediaAlt(this.currentMedia),this.updateMediaType(t),"pattern"===i&&(this.backgroundSize=this.currentMedia.thumbRatio,this.rgbBackgroundColor=this.currentMedia.rgbBackgroundColor))},e.getTabLabelByMediaType=function(e){switch(e){case d.MediaPreviewType.Clipart:return"Clipart";case d.MediaPreviewType.SingleImage:return"Image";case d.MediaPreviewType.ExtVideo:case d.MediaPreviewType.InlineVideo:case d.MediaPreviewType.Video:return"Video";case d.MediaPreviewType.MultipleImages:return"Gallery";case d.MediaPreviewType.Shape:return"Shape";case d.MediaPreviewType.Pattern:return"Pattern"}},e.prototype.getTabLabel=function(t){return this.tabLabels&&t in this.tabLabels?this.tabLabels[t]:e.getTabLabelByMediaType(t)},e.prototype.getActiveLabel=function(){return this.getTabLabel(this.currentTab)||this.label},e.prototype.getMediaUrl=function(e,t){var i=e.width||this.previewWidth,n=e.height||this.previewHeight;if("image"===t)i=this.previewWidth,n=this.previewHeight;else{var o=this.previewWidth/e.width,r=this.previewHeight/e.height;o<r&&o<1?(i=this.previewWidth,n*=o):r<o&&r<1&&(n=this.previewHeight,i*=r)}return this.mediaUrl.generate(e,i,n)},e.prototype.getMediaTitle=function(e){return"extVideo"===e.mediaType||"video"===e.mediaType||"inlineVideo"===e.mediaType?e.Title:(e.fileName||e.Title)+" - "+e.width+"x"+e.height+"px"},e.prototype.getMediaAlt=function(e){return"extVideo"===e.mediaType||"video"===e.mediaType||"inlineVideo"===e.mediaType?e.Title:e.fileName},Object.defineProperty(e.prototype,"cssClass",{get:function(){return[{"-active":this.active,c24m:"c24m"===this.type},"-"+this.size,"-"+(this.mediaType||"").toLowerCase()]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"patternStyle",{get:function(){if(this.patternSelected)return{backgroundImage:"url("+this.previewMediaUrl+")",backgroundSize:this.backgroundSize+"%",backgroundColor:this.rgbBackgroundColor}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageSelected",{get:function(){return this.currentTab===d.MediaPreviewType.SingleImage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"videoSelected",{get:function(){return this.currentTab===d.MediaPreviewType.Video},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inlineVideoSelected",{get:function(){return this.currentTab===d.MediaPreviewType.InlineVideo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extVideoSelected",{get:function(){return this.currentTab===d.MediaPreviewType.ExtVideo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gallerySelected",{get:function(){return this.currentTab===d.MediaPreviewType.MultipleImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSmall",{get:function(){return"small"===this.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSmallMedia",{get:function(){return this.currentTab===d.MediaPreviewType.Clipart||this.currentTab===d.MediaPreviewType.Shape},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shapeSelected",{get:function(){return this.currentTab===d.MediaPreviewType.Shape},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clipartSelected",{get:function(){return this.currentTab===d.MediaPreviewType.Clipart},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"patternSelected",{get:function(){return this.currentTab===d.MediaPreviewType.Pattern},enumerable:!0,configurable:!0}),e.prototype.selectedTab=function(){var e=this;return this.options.find(function(t){return t.id===e.currentTab})},e.prototype.showTab=function(e){e!==this.currentTab&&(this.currentTab=e,this.changeMediaType(this.currentTab))},e.prototype.changeMediaType=function(e){this.setCurrentMedia(e),this.onMediaTypeChange&&this.onMediaTypeChange({mediaType:e})},e.convertType=function(e){switch(e){case d.MediaPreviewType.SingleImage:case d.MediaPreviewType.MultipleImages:default:return"image";case d.MediaPreviewType.InlineVideo:return"inlineVideo";case d.MediaPreviewType.ExtVideo:return"extVideo";case d.MediaPreviewType.Shape:return"shape";case d.MediaPreviewType.Clipart:return"clipart";case d.MediaPreviewType.Video:return"video";case d.MediaPreviewType.Pattern:return"pattern"}},e.prototype.replaceMedia=function(){var e=d.MediaPreviewType.SingleImage;this.gallerySelected?e=d.MediaPreviewType.MultipleImages:this.extVideoSelected?e=d.MediaPreviewType.ExtVideo:this.videoSelected?e=d.MediaPreviewType.Video:this.inlineVideoSelected?e=d.MediaPreviewType.InlineVideo:this.shapeSelected?e=d.MediaPreviewType.Shape:this.clipartSelected&&(e=d.MediaPreviewType.Clipart),this.onMediaChange&&this.onMediaChange({mediaType:e})},e.prototype.toggle=function(){this.disableToggle||(this.active=!this.active,this.onToggle&&this.onToggle({visibility:this.active}))},e.prototype.isVisibleTab=function(e){return!!this.visibleTabs.find(function(t){return t.mediaType===e})},Object.defineProperty(e.prototype,"isImageTabVisible",{get:function(){return this.active&&this.isVisibleTab(d.MediaPreviewType.SingleImage)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isGalleryTabVisible",{get:function(){return this.active&&this.isVisibleTab(d.MediaPreviewType.MultipleImages)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isVideoTabVisible",{get:function(){return this.active&&this.isVisibleTab(d.MediaPreviewType.Video)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isExtVideoTabVisible",{get:function(){return this.active&&this.isVisibleTab(d.MediaPreviewType.ExtVideo)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShapeTabVisible",{get:function(){return this.active&&this.isVisibleTab(d.MediaPreviewType.Shape)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isClipArtTabVisible",{get:function(){return this.active&&this.isVisibleTab(d.MediaPreviewType.Clipart)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCornerIconVisible",{get:function(){return this.visibleTabs.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showReplaceButton",{get:function(){return""!==this.replaceButtonText&&!Boolean(this.replaceOptions)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showReplaceOptionsButton",{get:function(){return""!==this.replaceButtonText&&Boolean(this.replaceOptions)},enumerable:!0,configurable:!0}),e.DEFAULT_PREVIEW_WIDTH=240,e.DEFAULT_PREVIEW_HEIGHT=144,e.BIG_PREVIEW_WIDTH=300,e.BIG_PREVIEW_HEIGHT=180,e.SMALL_MEDIA_GAP=48,e}();angular.module("commonControlsAppInternal").component("c24MediaPreview",{controller:de,templateUrl:"views/c24-media-preview.html",transclude:{options:"?options"},bindings:{currentMedia:"=",active:"=?",visibleTabs:"=?",currentTab:"=?",showTabs:"=?",onToggle:"&",onMediaTypeChange:"&",onMediaChange:"&",onCustomize:"&",replaceButtonText:"@?",disableTogglSe:"=?",disableMediaChangeButton:"=?",label:"@?",tabLabels:"<?",type:"@?",size:"@?",showCustomize:"<?",customizeButtonText:"@?",organizeMediaButtonText:"@?",showHeader:"<?",onColorClick:"&?",colorButtonText:"@?",replaceOptions:"<?"}});var ue=function(){function e(){}return e.prototype.$onInit=function(){this.onEdit=this.onEdit||angular.noop(),this.label=this.label||"background"},e}();angular.module("commonControlsAppInternal").component("c25BackgroundPreview",{templateUrl:"views/c25-background-preview.html",controller:ue,controllerAs:"$ctrl",bindings:{data:"=",onEdit:"&?",label:"@?"}});var pe=function(){function e(){}return e.prototype.footerLinkClicked=function(e){"A"===e.target.tagName&&this.footerLink()},e}();angular.module("commonControlsAppInternal").component("c26ImagePosition",{templateUrl:"views/c26-image-position.html",controller:pe,bindings:{headerTitle:"@",body:"@",footerContentText:"@?",footerLink:"&?",showFooter:"=?",rectanglesCount:"@",rectanglesCountEachRow:"@",selectedRectangle:"@",onPositionClicked:"&?",onClose:"&"}});var he=function(){function e(){this.minIndex=this.minIndex||0,this.increaseIcon=this.increaseIcon||"osi:textSizePlus",this.decreaseIcon=this.decreaseIcon||"osi:textSizeMinus"}return e.prototype.decreaseShouldDisable=function(){return this.minIndex===this.currentIndex},e.prototype.increaseShouldDisable=function(){return this.maxIndex===this.currentIndex},e.prototype.increase=function(){this.currentIndex<this.maxIndex&&(this.currentIndex++,this.onIncrease({value:this.currentIndex}))},e.prototype.decrease=function(){this.currentIndex>this.minIndex&&(this.currentIndex--,this.onDecrease({value:this.currentIndex}))},e}();angular.module("commonControlsAppInternal").component("c27IncreaseDecrease",{templateUrl:"views/c27-increase-decrease.html",controller:he,bindings:{currentIndex:"<",minIndex:"<?",maxIndex:"<",onIncrease:"&",onDecrease:"&",increaseIcon:"@?",decreaseIcon:"@?"}});var ge=function(){function e(){this.selectedOption=this.selectedOption||this.optionsList[0]}return e.prototype.close=function(){this.onClose()},e.prototype.done=function(){this.onDone(this.selectedOption),this.onClose()},e}();angular.module("commonControlsAppInternal").component("c28DropdownAction",{templateUrl:"views/c28-dropdown-action.html",controller:ge,bindings:{optionsList:"<",selectedOption:"=",onClose:"=",onDone:"=",headline:"=",description:"=",dropDownTitle:"=",closeLabel:"=",doneLabel:"=",onHelp:"&",showHelpButton:"<",helpTooltip:"@?",negative:"<?"}}),angular.module("commonControlsAppInternal").component("ccValidation",{templateUrl:"views/cc-validation.html",bindings:{isValid:"=",tooltip:"@?"}}),function e(t,i,o){function r(s,l){if(!i[s]){if(!t[s]){if(!l&&("function"==typeof n&&n))return n(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=i[s]={exports:{}};t[s][0].call(d.exports,function(e){var i=t[s][1][e];return r(i||e)},d,d.exports,e,t,i,o)}return i[s].exports}for(var a="function"==typeof n&&n,s=0;s<o.length;s++)r(o[s]);return r}({1:[function(e,t,n){var s=e("../main"),l=e("../plugin/instances");function c(e){e.fn.perfectScrollbar=function(e){return this.each(function(){if("object"==typeof e||void 0===e){var t=e;l.get(this)||s.initialize(this,t)}else{var i=e;"update"===i?s.update(this):"destroy"===i&&s.destroy(this)}})}}r=[i(476)],void 0===(a="function"==typeof(o=c)?o.apply(n,r):o)||(t.exports=a),t.exports=c},{"../main":7,"../plugin/instances":18}],2:[function(e,t,i){i.add=function(e,t){e.classList?e.classList.add(t):function(e,t){var i=e.className.split(" ");i.indexOf(t)<0&&i.push(t),e.className=i.join(" ")}(e,t)},i.remove=function(e,t){e.classList?e.classList.remove(t):function(e,t){var i=e.className.split(" "),n=i.indexOf(t);n>=0&&i.splice(n,1),e.className=i.join(" ")}(e,t)},i.list=function(e){return e.classList?Array.prototype.slice.apply(e.classList):e.className.split(" ")}},{}],3:[function(e,t,i){var n={};n.e=function(e,t){var i=document.createElement(e);return i.className=t,i},n.appendTo=function(e,t){return t.appendChild(e),e},n.css=function(e,t,i){return"object"==typeof t?function(e,t){for(var i in t){var n=t[i];"number"==typeof n&&(n=n.toString()+"px"),e.style[i]=n}return e}(e,t):void 0===i?function(e,t){return window.getComputedStyle(e)[t]}(e,t):function(e,t,i){return"number"==typeof i&&(i=i.toString()+"px"),e.style[t]=i,e}(e,t,i)},n.matches=function(e,t){return void 0!==e.matches?e.matches(t):void 0!==e.matchesSelector?e.matchesSelector(t):void 0!==e.webkitMatchesSelector?e.webkitMatchesSelector(t):void 0!==e.mozMatchesSelector?e.mozMatchesSelector(t):void 0!==e.msMatchesSelector?e.msMatchesSelector(t):void 0},n.remove=function(e){void 0!==e.remove?e.remove():e.parentNode&&e.parentNode.removeChild(e)},n.queryChildren=function(e,t){return Array.prototype.filter.call(e.childNodes,function(e){return n.matches(e,t)})},t.exports=n},{}],4:[function(e,t,i){var n=function(e){this.element=e,this.events={}};n.prototype.bind=function(e,t){void 0===this.events[e]&&(this.events[e]=[]),this.events[e].push(t),this.element.addEventListener(e,t,!1)},n.prototype.unbind=function(e,t){var i=void 0!==t;this.events[e]=this.events[e].filter(function(n){return!(!i||n===t)||(this.element.removeEventListener(e,n,!1),!1)},this)},n.prototype.unbindAll=function(){for(var e in this.events)this.unbind(e)};var o=function(){this.eventElements=[]};o.prototype.eventElement=function(e){var t=this.eventElements.filter(function(t){return t.element===e})[0];return void 0===t&&(t=new n(e),this.eventElements.push(t)),t},o.prototype.bind=function(e,t,i){this.eventElement(e).bind(t,i)},o.prototype.unbind=function(e,t,i){this.eventElement(e).unbind(t,i)},o.prototype.unbindAll=function(){for(var e=0;e<this.eventElements.length;e++)this.eventElements[e].unbindAll()},o.prototype.once=function(e,t,i){var n=this.eventElement(e),o=function(e){n.unbind(t,o),i(e)};n.bind(t,o)},t.exports=o},{}],5:[function(e,t,i){t.exports=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return function(){return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}()},{}],6:[function(e,t,i){var n=e("./class"),o=e("./dom"),r=i.toInt=function(e){return parseInt(e,10)||0},a=i.clone=function(e){if(null===e)return null;if(e.constructor===Array)return e.map(a);if("object"==typeof e){var t={};for(var i in e)t[i]=a(e[i]);return t}return e};i.extend=function(e,t){var i=a(e);for(var n in t)i[n]=a(t[n]);return i},i.isEditable=function(e){return o.matches(e,"input,[contenteditable]")||o.matches(e,"select,[contenteditable]")||o.matches(e,"textarea,[contenteditable]")||o.matches(e,"button,[contenteditable]")},i.removePsClasses=function(e){for(var t=n.list(e),i=0;i<t.length;i++){var o=t[i];0===o.indexOf("ps-")&&n.remove(e,o)}},i.outerWidth=function(e){return r(o.css(e,"width"))+r(o.css(e,"paddingLeft"))+r(o.css(e,"paddingRight"))+r(o.css(e,"borderLeftWidth"))+r(o.css(e,"borderRightWidth"))},i.startScrolling=function(e,t){n.add(e,"ps-in-scrolling"),void 0!==t?n.add(e,"ps-"+t):(n.add(e,"ps-x"),n.add(e,"ps-y"))},i.stopScrolling=function(e,t){n.remove(e,"ps-in-scrolling"),void 0!==t?n.remove(e,"ps-"+t):(n.remove(e,"ps-x"),n.remove(e,"ps-y"))},i.env={isWebKit:"WebkitAppearance"in document.documentElement.style,supportsTouch:"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,supportsIePointer:null!==window.navigator.msMaxTouchPoints}},{"./class":2,"./dom":3}],7:[function(e,t,i){var n=e("./plugin/destroy"),o=e("./plugin/initialize"),r=e("./plugin/update");t.exports={initialize:o,update:r,destroy:n}},{"./plugin/destroy":9,"./plugin/initialize":17,"./plugin/update":21}],8:[function(e,t,i){t.exports={handlers:["click-rail","drag-scrollbar","keyboard","wheel","touch"],maxScrollbarLength:null,minScrollbarLength:null,scrollXMarginOffset:0,scrollYMarginOffset:0,stopPropagationOnClick:!0,suppressScrollX:!1,suppressScrollY:!1,swipePropagation:!0,useBothWheelAxes:!1,wheelPropagation:!1,wheelSpeed:1,theme:"default"}},{}],9:[function(e,t,i){var n=e("../lib/helper"),o=e("../lib/dom"),r=e("./instances");t.exports=function(e){var t=r.get(e);t&&(t.event.unbindAll(),o.remove(t.scrollbarX),o.remove(t.scrollbarY),o.remove(t.scrollbarXRail),o.remove(t.scrollbarYRail),n.removePsClasses(e),r.remove(e))}},{"../lib/dom":3,"../lib/helper":6,"./instances":18}],10:[function(e,t,i){var n=e("../../lib/helper"),o=e("../instances"),r=e("../update-geometry"),a=e("../update-scroll");t.exports=function(e){!function(e,t){function i(e){return e.getBoundingClientRect()}var o=function(e){e.stopPropagation()};t.settings.stopPropagationOnClick&&t.event.bind(t.scrollbarY,"click",o),t.event.bind(t.scrollbarYRail,"click",function(o){var s=n.toInt(t.scrollbarYHeight/2),l=t.railYRatio*(o.pageY-window.pageYOffset-i(t.scrollbarYRail).top-s)/(t.railYRatio*(t.railYHeight-t.scrollbarYHeight));l<0?l=0:l>1&&(l=1),a(e,"top",(t.contentHeight-t.containerHeight)*l),r(e),o.stopPropagation()}),t.settings.stopPropagationOnClick&&t.event.bind(t.scrollbarX,"click",o),t.event.bind(t.scrollbarXRail,"click",function(o){var s=n.toInt(t.scrollbarXWidth/2),l=t.railXRatio*(o.pageX-window.pageXOffset-i(t.scrollbarXRail).left-s)/(t.railXRatio*(t.railXWidth-t.scrollbarXWidth));l<0?l=0:l>1&&(l=1),a(e,"left",(t.contentWidth-t.containerWidth)*l-t.negativeScrollAdjustment),r(e),o.stopPropagation()})}(e,o.get(e))}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],11:[function(e,t,i){var n=e("../../lib/helper"),o=e("../../lib/dom"),r=e("../instances"),a=e("../update-geometry"),s=e("../update-scroll");function l(e,t){var i=null,r=null;var l=function(o){!function(o){var r=i+o*t.railXRatio,a=Math.max(0,t.scrollbarXRail.getBoundingClientRect().left)+t.railXRatio*(t.railXWidth-t.scrollbarXWidth);t.scrollbarXLeft=r<0?0:r>a?a:r;var l=n.toInt(t.scrollbarXLeft*(t.contentWidth-t.containerWidth)/(t.containerWidth-t.railXRatio*t.scrollbarXWidth))-t.negativeScrollAdjustment;s(e,"left",l)}(o.pageX-r),a(e),o.stopPropagation(),o.preventDefault()},c=function(){n.stopScrolling(e,"x"),t.event.unbind(t.ownerDocument,"mousemove",l)};t.event.bind(t.scrollbarX,"mousedown",function(a){r=a.pageX,i=n.toInt(o.css(t.scrollbarX,"left"))*t.railXRatio,n.startScrolling(e,"x"),t.event.bind(t.ownerDocument,"mousemove",l),t.event.once(t.ownerDocument,"mouseup",c),a.stopPropagation(),a.preventDefault()})}function c(e,t){var i=null,r=null;var l=function(o){!function(o){var r=i+o*t.railYRatio,a=Math.max(0,t.scrollbarYRail.getBoundingClientRect().top)+t.railYRatio*(t.railYHeight-t.scrollbarYHeight);t.scrollbarYTop=r<0?0:r>a?a:r;var l=n.toInt(t.scrollbarYTop*(t.contentHeight-t.containerHeight)/(t.containerHeight-t.railYRatio*t.scrollbarYHeight));s(e,"top",l)}(o.pageY-r),a(e),o.stopPropagation(),o.preventDefault()},c=function(){n.stopScrolling(e,"y"),t.event.unbind(t.ownerDocument,"mousemove",l)};t.event.bind(t.scrollbarY,"mousedown",function(a){r=a.pageY,i=n.toInt(o.css(t.scrollbarY,"top"))*t.railYRatio,n.startScrolling(e,"y"),t.event.bind(t.ownerDocument,"mousemove",l),t.event.once(t.ownerDocument,"mouseup",c),a.stopPropagation(),a.preventDefault()})}t.exports=function(e){var t=r.get(e);l(e,t),c(e,t)}},{"../../lib/dom":3,"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],12:[function(e,t,i){var n=e("../../lib/helper"),o=e("../../lib/dom"),r=e("../instances"),a=e("../update-geometry"),s=e("../update-scroll");function l(e,t){var i=!1;t.event.bind(e,"mouseenter",function(){i=!0}),t.event.bind(e,"mouseleave",function(){i=!1});t.event.bind(t.ownerDocument,"keydown",function(r){if(!(r.isDefaultPrevented&&r.isDefaultPrevented()||r.defaultPrevented)){var l=o.matches(t.scrollbarX,":focus")||o.matches(t.scrollbarY,":focus");if(i||l){var c=document.activeElement?document.activeElement:t.ownerDocument.activeElement;if(c){if("IFRAME"===c.tagName)c=c.contentDocument.activeElement;else for(;c.shadowRoot;)c=c.shadowRoot.activeElement;if(n.isEditable(c))return}var d=0,u=0;switch(r.which){case 37:d=-30;break;case 38:u=30;break;case 39:d=30;break;case 40:u=-30;break;case 33:u=90;break;case 32:u=r.shiftKey?90:-90;break;case 34:u=-90;break;case 35:u=r.ctrlKey?-t.contentHeight:-t.containerHeight;break;case 36:u=r.ctrlKey?e.scrollTop:t.containerHeight;break;default:return}s(e,"top",e.scrollTop-u),s(e,"left",e.scrollLeft+d),a(e),function(i,n){var o=e.scrollTop;if(0===i){if(!t.scrollbarYActive)return!1;if(0===o&&n>0||o>=t.contentHeight-t.containerHeight&&n<0)return!t.settings.wheelPropagation}var r=e.scrollLeft;if(0===n){if(!t.scrollbarXActive)return!1;if(0===r&&i<0||r>=t.contentWidth-t.containerWidth&&i>0)return!t.settings.wheelPropagation}return!0}(d,u)&&r.preventDefault()}}})}t.exports=function(e){l(e,r.get(e))}},{"../../lib/dom":3,"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],13:[function(e,t,i){var n=e("../instances"),o=e("../update-geometry"),r=e("../update-scroll");function a(e,t){var i=!1;function n(n){var a=function(e){var t=e.deltaX,i=-1*e.deltaY;return void 0!==t&&void 0!==i||(t=-1*e.wheelDeltaX/6,i=e.wheelDeltaY/6),e.deltaMode&&1===e.deltaMode&&(t*=10,i*=10),t!=t&&i!=i&&(t=0,i=e.wheelDelta),[t,i]}(n),s=a[0],l=a[1];(function(t,i){var n=e.querySelector("textarea:hover, select[multiple]:hover, .ps-child:hover");if(n){if("TEXTAREA"!==n.tagName&&!window.getComputedStyle(n).overflow.match(/(scroll|auto)/))return!1;var o=n.scrollHeight-n.clientHeight;if(o>0&&!(0===n.scrollTop&&i>0||n.scrollTop===o&&i<0))return!0;var r=n.scrollLeft-n.clientWidth;if(r>0&&!(0===n.scrollLeft&&t<0||n.scrollLeft===r&&t>0))return!0}return!1})(s,l)||(i=!1,t.settings.useBothWheelAxes?t.scrollbarYActive&&!t.scrollbarXActive?(r(e,"top",l?e.scrollTop-l*t.settings.wheelSpeed:e.scrollTop+s*t.settings.wheelSpeed),i=!0):t.scrollbarXActive&&!t.scrollbarYActive&&(r(e,"left",s?e.scrollLeft+s*t.settings.wheelSpeed:e.scrollLeft-l*t.settings.wheelSpeed),i=!0):(r(e,"top",e.scrollTop-l*t.settings.wheelSpeed),r(e,"left",e.scrollLeft+s*t.settings.wheelSpeed)),o(e),(i=i||function(i,n){var o=e.scrollTop;if(0===i){if(!t.scrollbarYActive)return!1;if(0===o&&n>0||o>=t.contentHeight-t.containerHeight&&n<0)return!t.settings.wheelPropagation}var r=e.scrollLeft;if(0===n){if(!t.scrollbarXActive)return!1;if(0===r&&i<0||r>=t.contentWidth-t.containerWidth&&i>0)return!t.settings.wheelPropagation}return!0}(s,l))&&(n.stopPropagation(),n.preventDefault()))}void 0!==window.onwheel?t.event.bind(e,"wheel",n):void 0!==window.onmousewheel&&t.event.bind(e,"mousewheel",n)}t.exports=function(e){a(e,n.get(e))}},{"../instances":18,"../update-geometry":19,"../update-scroll":20}],14:[function(e,t,i){var n=e("../instances"),o=e("../update-geometry");t.exports=function(e){!function(e,t){t.event.bind(e,"scroll",function(){o(e)})}(e,n.get(e))}},{"../instances":18,"../update-geometry":19}],15:[function(e,t,i){var n=e("../../lib/helper"),o=e("../instances"),r=e("../update-geometry"),a=e("../update-scroll");function s(e,t){var i=null,s={top:0,left:0};function l(){i&&(clearInterval(i),i=null),n.stopScrolling(e)}var c=!1;t.event.bind(t.ownerDocument,"selectionchange",function(){e.contains(function(){var e=window.getSelection?window.getSelection():document.getSelection?document.getSelection():"";return 0===e.toString().length?null:e.getRangeAt(0).commonAncestorContainer}())?c=!0:(c=!1,l())}),t.event.bind(window,"mouseup",function(){c&&(c=!1,l())}),t.event.bind(window,"mousemove",function(t){if(c){var d={x:t.pageX,y:t.pageY},u={left:e.offsetLeft,right:e.offsetLeft+e.offsetWidth,top:e.offsetTop,bottom:e.offsetTop+e.offsetHeight};d.x<u.left+3?(s.left=-5,n.startScrolling(e,"x")):d.x>u.right-3?(s.left=5,n.startScrolling(e,"x")):s.left=0,d.y<u.top+3?(s.top=u.top+3-d.y<5?-5:-20,n.startScrolling(e,"y")):d.y>u.bottom-3?(s.top=d.y-u.bottom+3<5?5:20,n.startScrolling(e,"y")):s.top=0,0===s.top&&0===s.left?l():i||(i=setInterval(function(){o.get(e)?(a(e,"top",e.scrollTop+s.top),a(e,"left",e.scrollLeft+s.left),r(e)):clearInterval(i)},50))}})}t.exports=function(e){s(e,o.get(e))}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],16:[function(e,t,i){var n=e("../../lib/helper"),o=e("../instances"),r=e("../update-geometry"),a=e("../update-scroll");function s(e,t,i,n){function s(t,i){a(e,"top",e.scrollTop-i),a(e,"left",e.scrollLeft-t),r(e)}var l={},c=0,d={},u=null,p=!1,h=!1;function g(){p=!0}function m(){p=!1}function f(e){return e.targetTouches?e.targetTouches[0]:e}function v(e){return!(!e.targetTouches||1!==e.targetTouches.length)||!(!e.pointerType||"mouse"===e.pointerType||e.pointerType===e.MSPOINTER_TYPE_MOUSE)}function y(e){if(v(e)){h=!0;var t=f(e);l.pageX=t.pageX,l.pageY=t.pageY,c=(new Date).getTime(),null!==u&&clearInterval(u),e.stopPropagation()}}function b(i){if(!h&&t.settings.swipePropagation&&y(i),!p&&h&&v(i)){var n=f(i),o={pageX:n.pageX,pageY:n.pageY},r=o.pageX-l.pageX,a=o.pageY-l.pageY;s(r,a),l=o;var u=(new Date).getTime(),g=u-c;g>0&&(d.x=r/g,d.y=a/g,c=u),function(i,n){var o=e.scrollTop,r=e.scrollLeft,a=Math.abs(i),s=Math.abs(n);if(s>a){if(n<0&&o===t.contentHeight-t.containerHeight||n>0&&0===o)return!t.settings.swipePropagation}else if(a>s&&(i<0&&r===t.contentWidth-t.containerWidth||i>0&&0===r))return!t.settings.swipePropagation;return!0}(r,a)&&(i.stopPropagation(),i.preventDefault())}}function S(){!p&&h&&(h=!1,clearInterval(u),u=setInterval(function(){o.get(e)?Math.abs(d.x)<.01&&Math.abs(d.y)<.01?clearInterval(u):(s(30*d.x,30*d.y),d.x*=.8,d.y*=.8):clearInterval(u)},10))}i&&(t.event.bind(window,"touchstart",g),t.event.bind(window,"touchend",m),t.event.bind(e,"touchstart",y),t.event.bind(e,"touchmove",b),t.event.bind(e,"touchend",S)),n&&(window.PointerEvent?(t.event.bind(window,"pointerdown",g),t.event.bind(window,"pointerup",m),t.event.bind(e,"pointerdown",y),t.event.bind(e,"pointermove",b),t.event.bind(e,"pointerup",S)):window.MSPointerEvent&&(t.event.bind(window,"MSPointerDown",g),t.event.bind(window,"MSPointerUp",m),t.event.bind(e,"MSPointerDown",y),t.event.bind(e,"MSPointerMove",b),t.event.bind(e,"MSPointerUp",S)))}t.exports=function(e){(n.env.supportsTouch||n.env.supportsIePointer)&&s(e,o.get(e),n.env.supportsTouch,n.env.supportsIePointer)}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],17:[function(e,t,i){var n=e("../lib/helper"),o=e("../lib/class"),r=e("./instances"),a=e("./update-geometry"),s={"click-rail":e("./handler/click-rail"),"drag-scrollbar":e("./handler/drag-scrollbar"),keyboard:e("./handler/keyboard"),wheel:e("./handler/mouse-wheel"),touch:e("./handler/touch"),selection:e("./handler/selection")},l=e("./handler/native-scroll");t.exports=function(e,t){t="object"==typeof t?t:{},o.add(e,"ps-container");var i=r.add(e);i.settings=n.extend(i.settings,t),o.add(e,"ps-theme-"+i.settings.theme),i.settings.handlers.forEach(function(t){s[t](e)}),l(e),a(e)}},{"../lib/class":2,"../lib/helper":6,"./handler/click-rail":10,"./handler/drag-scrollbar":11,"./handler/keyboard":12,"./handler/mouse-wheel":13,"./handler/native-scroll":14,"./handler/selection":15,"./handler/touch":16,"./instances":18,"./update-geometry":19}],18:[function(e,t,i){var n=e("../lib/helper"),o=e("../lib/class"),r=e("./default-setting"),a=e("../lib/dom"),s=e("../lib/event-manager"),l=e("../lib/guid"),c={};function d(e){return e.getAttribute("data-ps-id")}i.add=function(e){var t=l();return function(e,t){e.setAttribute("data-ps-id",t)}(e,t),c[t]=new function(e){var t=this;function i(){o.add(e,"ps-focus")}function l(){o.remove(e,"ps-focus")}t.settings=n.clone(r),t.containerWidth=null,t.containerHeight=null,t.contentWidth=null,t.contentHeight=null,t.isRtl="rtl"===a.css(e,"direction"),t.isNegativeScroll=function(){var t,i=e.scrollLeft;return e.scrollLeft=-1,t=e.scrollLeft<0,e.scrollLeft=i,t}(),t.negativeScrollAdjustment=t.isNegativeScroll?e.scrollWidth-e.clientWidth:0,t.event=new s,t.ownerDocument=e.ownerDocument||document,t.scrollbarXRail=a.appendTo(a.e("div","ps-scrollbar-x-rail"),e),t.scrollbarX=a.appendTo(a.e("div","ps-scrollbar-x"),t.scrollbarXRail),t.scrollbarX.setAttribute("tabindex",0),t.event.bind(t.scrollbarX,"focus",i),t.event.bind(t.scrollbarX,"blur",l),t.scrollbarXActive=null,t.scrollbarXWidth=null,t.scrollbarXLeft=null,t.scrollbarXBottom=n.toInt(a.css(t.scrollbarXRail,"bottom")),t.isScrollbarXUsingBottom=t.scrollbarXBottom==t.scrollbarXBottom,t.scrollbarXTop=t.isScrollbarXUsingBottom?null:n.toInt(a.css(t.scrollbarXRail,"top")),t.railBorderXWidth=n.toInt(a.css(t.scrollbarXRail,"borderLeftWidth"))+n.toInt(a.css(t.scrollbarXRail,"borderRightWidth")),a.css(t.scrollbarXRail,"display","block"),t.railXMarginWidth=n.toInt(a.css(t.scrollbarXRail,"marginLeft"))+n.toInt(a.css(t.scrollbarXRail,"marginRight")),a.css(t.scrollbarXRail,"display",""),t.railXWidth=null,t.railXRatio=null,t.scrollbarYRail=a.appendTo(a.e("div","ps-scrollbar-y-rail"),e),t.scrollbarY=a.appendTo(a.e("div","ps-scrollbar-y"),t.scrollbarYRail),t.scrollbarY.setAttribute("tabindex",0),t.event.bind(t.scrollbarY,"focus",i),t.event.bind(t.scrollbarY,"blur",l),t.scrollbarYActive=null,t.scrollbarYHeight=null,t.scrollbarYTop=null,t.scrollbarYRight=n.toInt(a.css(t.scrollbarYRail,"right")),t.isScrollbarYUsingRight=t.scrollbarYRight==t.scrollbarYRight,t.scrollbarYLeft=t.isScrollbarYUsingRight?null:n.toInt(a.css(t.scrollbarYRail,"left")),t.scrollbarYOuterWidth=t.isRtl?n.outerWidth(t.scrollbarY):null,t.railBorderYWidth=n.toInt(a.css(t.scrollbarYRail,"borderTopWidth"))+n.toInt(a.css(t.scrollbarYRail,"borderBottomWidth")),a.css(t.scrollbarYRail,"display","block"),t.railYMarginHeight=n.toInt(a.css(t.scrollbarYRail,"marginTop"))+n.toInt(a.css(t.scrollbarYRail,"marginBottom")),a.css(t.scrollbarYRail,"display",""),t.railYHeight=null,t.railYRatio=null}(e),c[t]},i.remove=function(e){delete c[d(e)],function(e){e.removeAttribute("data-ps-id")}(e)},i.get=function(e){return c[d(e)]}},{"../lib/class":2,"../lib/dom":3,"../lib/event-manager":4,"../lib/guid":5,"../lib/helper":6,"./default-setting":8}],19:[function(e,t,i){var n=e("../lib/helper"),o=e("../lib/class"),r=e("../lib/dom"),a=e("./instances"),s=e("./update-scroll");function l(e,t){return e.settings.minScrollbarLength&&(t=Math.max(t,e.settings.minScrollbarLength)),e.settings.maxScrollbarLength&&(t=Math.min(t,e.settings.maxScrollbarLength)),t}t.exports=function(e){var t,i=a.get(e);i.containerWidth=e.clientWidth,i.containerHeight=e.clientHeight,i.contentWidth=e.scrollWidth,i.contentHeight=e.scrollHeight,e.contains(i.scrollbarXRail)||((t=r.queryChildren(e,".ps-scrollbar-x-rail")).length>0&&t.forEach(function(e){r.remove(e)}),r.appendTo(i.scrollbarXRail,e)),e.contains(i.scrollbarYRail)||((t=r.queryChildren(e,".ps-scrollbar-y-rail")).length>0&&t.forEach(function(e){r.remove(e)}),r.appendTo(i.scrollbarYRail,e)),!i.settings.suppressScrollX&&i.containerWidth+i.settings.scrollXMarginOffset<i.contentWidth?(i.scrollbarXActive=!0,i.railXWidth=i.containerWidth-i.railXMarginWidth,i.railXRatio=i.containerWidth/i.railXWidth,i.scrollbarXWidth=l(i,n.toInt(i.railXWidth*i.containerWidth/i.contentWidth)),i.scrollbarXLeft=n.toInt((i.negativeScrollAdjustment+e.scrollLeft)*(i.railXWidth-i.scrollbarXWidth)/(i.contentWidth-i.containerWidth))):i.scrollbarXActive=!1,!i.settings.suppressScrollY&&i.containerHeight+i.settings.scrollYMarginOffset<i.contentHeight?(i.scrollbarYActive=!0,i.railYHeight=i.containerHeight-i.railYMarginHeight,i.railYRatio=i.containerHeight/i.railYHeight,i.scrollbarYHeight=l(i,n.toInt(i.railYHeight*i.containerHeight/i.contentHeight)),i.scrollbarYTop=n.toInt(e.scrollTop*(i.railYHeight-i.scrollbarYHeight)/(i.contentHeight-i.containerHeight))):i.scrollbarYActive=!1,i.scrollbarXLeft>=i.railXWidth-i.scrollbarXWidth&&(i.scrollbarXLeft=i.railXWidth-i.scrollbarXWidth),i.scrollbarYTop>=i.railYHeight-i.scrollbarYHeight&&(i.scrollbarYTop=i.railYHeight-i.scrollbarYHeight),function(e,t){var i={width:t.railXWidth};t.isRtl?i.left=t.negativeScrollAdjustment+e.scrollLeft+t.containerWidth-t.contentWidth:i.left=e.scrollLeft,t.isScrollbarXUsingBottom?i.bottom=t.scrollbarXBottom-e.scrollTop:i.top=t.scrollbarXTop+e.scrollTop,r.css(t.scrollbarXRail,i);var n={top:e.scrollTop,height:t.railYHeight};t.isScrollbarYUsingRight?t.isRtl?n.right=t.contentWidth-(t.negativeScrollAdjustment+e.scrollLeft)-t.scrollbarYRight-t.scrollbarYOuterWidth:n.right=t.scrollbarYRight-e.scrollLeft:t.isRtl?n.left=t.negativeScrollAdjustment+e.scrollLeft+2*t.containerWidth-t.contentWidth-t.scrollbarYLeft-t.scrollbarYOuterWidth:n.left=t.scrollbarYLeft+e.scrollLeft,r.css(t.scrollbarYRail,n),r.css(t.scrollbarX,{left:t.scrollbarXLeft,width:t.scrollbarXWidth-t.railBorderXWidth}),r.css(t.scrollbarY,{top:t.scrollbarYTop,height:t.scrollbarYHeight-t.railBorderYWidth})}(e,i),i.scrollbarXActive?o.add(e,"ps-active-x"):(o.remove(e,"ps-active-x"),i.scrollbarXWidth=0,i.scrollbarXLeft=0,s(e,"left",0)),i.scrollbarYActive?o.add(e,"ps-active-y"):(o.remove(e,"ps-active-y"),i.scrollbarYHeight=0,i.scrollbarYTop=0,s(e,"top",0))}},{"../lib/class":2,"../lib/dom":3,"../lib/helper":6,"./instances":18,"./update-scroll":20}],20:[function(e,t,i){var n,o,r=e("./instances"),a=document.createEvent("Event"),s=document.createEvent("Event"),l=document.createEvent("Event"),c=document.createEvent("Event"),d=document.createEvent("Event"),u=document.createEvent("Event"),p=document.createEvent("Event"),h=document.createEvent("Event"),g=document.createEvent("Event"),m=document.createEvent("Event");a.initEvent("ps-scroll-up",!0,!0),s.initEvent("ps-scroll-down",!0,!0),l.initEvent("ps-scroll-left",!0,!0),c.initEvent("ps-scroll-right",!0,!0),d.initEvent("ps-scroll-y",!0,!0),u.initEvent("ps-scroll-x",!0,!0),p.initEvent("ps-x-reach-start",!0,!0),h.initEvent("ps-x-reach-end",!0,!0),g.initEvent("ps-y-reach-start",!0,!0),m.initEvent("ps-y-reach-end",!0,!0),t.exports=function(e,t,i){if(void 0===e)throw"You must provide an element to the update-scroll function";if(void 0===t)throw"You must provide an axis to the update-scroll function";if(void 0===i)throw"You must provide a value to the update-scroll function";"top"===t&&i<=0&&(e.scrollTop=i=0,e.dispatchEvent(g)),"left"===t&&i<=0&&(e.scrollLeft=i=0,e.dispatchEvent(p));var f=r.get(e);"top"===t&&i>=f.contentHeight-f.containerHeight&&((i=f.contentHeight-f.containerHeight)-e.scrollTop<=1?i=e.scrollTop:e.scrollTop=i,e.dispatchEvent(m)),"left"===t&&i>=f.contentWidth-f.containerWidth&&((i=f.contentWidth-f.containerWidth)-e.scrollLeft<=1?i=e.scrollLeft:e.scrollLeft=i,e.dispatchEvent(h)),n||(n=e.scrollTop),o||(o=e.scrollLeft),"top"===t&&i<n&&e.dispatchEvent(a),"top"===t&&i>n&&e.dispatchEvent(s),"left"===t&&i<o&&e.dispatchEvent(l),"left"===t&&i>o&&e.dispatchEvent(c),"top"===t&&(e.scrollTop=n=i,e.dispatchEvent(d)),"left"===t&&(e.scrollLeft=o=i,e.dispatchEvent(u))}},{"./instances":18}],21:[function(e,t,i){var n=e("../lib/helper"),o=e("../lib/dom"),r=e("./instances"),a=e("./update-geometry"),s=e("./update-scroll");t.exports=function(e){var t=r.get(e);t&&(t.negativeScrollAdjustment=t.isNegativeScroll?e.scrollWidth-e.clientWidth:0,o.css(t.scrollbarXRail,"display","block"),o.css(t.scrollbarYRail,"display","block"),t.railXMarginWidth=n.toInt(o.css(t.scrollbarXRail,"marginLeft"))+n.toInt(o.css(t.scrollbarXRail,"marginRight")),t.railYMarginHeight=n.toInt(o.css(t.scrollbarYRail,"marginTop"))+n.toInt(o.css(t.scrollbarYRail,"marginBottom")),o.css(t.scrollbarXRail,"display","none"),o.css(t.scrollbarYRail,"display","none"),a(e),s(e,"top",e.scrollTop),s(e,"left",e.scrollLeft),o.css(t.scrollbarXRail,"display",""),o.css(t.scrollbarYRail,"display",""))}},{"../lib/dom":3,"../lib/helper":6,"./instances":18,"./update-geometry":19,"./update-scroll":20}]},{},[1]);var me=function(){function e(){this.matchedItems=[]}return Object.defineProperty(e.prototype,"matches",{get:function(){var e=this;if(void 0===this.value)return[];if(this.ignoreValue)return this.setMatches(_.uniq(this.items)),this.matchedItems;var t=_.filter(this.items,function(t){return-1!==t.toLowerCase().indexOf(e.value.toLowerCase())});return this.setMatches(_.uniq(t)),this.matchedItems},enumerable:!0,configurable:!0}),e.prototype.setMatches=function(e){_.isEqual(e,this.matchedItems)||(this.onMatchChange&&this.onMatchChange({matches:e}),this.matchedItems=e)},e}();angular.module("commonControlsAppInternal").component("ccAutocomplete",{templateUrl:"views/autocomplete.html",controller:me,bindings:{value:"=",items:"=",linkLabel:"@",hoveredIndex:"=?",onLinkClick:"&",onMatchChange:"&",onItemSelect:"&",ignoreValue:"=?",randId:"@"}});var fe=function(){function e(e,t){this.mediaUrl=e,this.keyMap=t,this.matchedItems=[]}return e.$inject=["mediaUrl","keyMap"],Object.defineProperty(e.prototype,"matches",{get:function(){var e=this;if(void 0===this.value)return[];if(this.ignoreValue)return this.setMatches(this.items),this.matchedItems;var t=_.filter(this.items,function(t){return-1!==t.text.toLowerCase().indexOf(e.value.toLowerCase())});return this.setMatches(t),this.matchedItems},enumerable:!0,configurable:!0}),e.prototype.setMatches=function(e){_.isEqual(e,this.matchedItems)||(this.onMatchChange&&this.onMatchChange({matches:e}),this.matchedItems=e)},e.prototype.isImage=function(e){return"image"===e.mediaType},e}();angular.module("commonControlsAppInternal").component("ccAutocompleteMedia",{templateUrl:"views/autocomplete-media.html",controller:fe,bindings:{value:"=",items:"=",hoveredIndex:"=?",onMatchChange:"&",onItemSelect:"&",ignoreValue:"=?",randId:"@"}});var ve=function(){function e(){}return e.prototype.$onInit=function(){void 0===this.label&&(this.label="BUTTON"),void 0===this.active&&(this.active=!0),void 0===this.debounceDelay&&(this.debounceDelay=0)},e.prototype.onBlur=function(e){""===e.currentTarget.value&&this.onToggle&&(this.active=!1,this.onToggle({visibility:!1}))},e}();angular.module("commonControlsAppInternal").component("ccButtonEditor",{templateUrl:"views/button-editor.html",controller:ve,bindings:{label:"@?",text:"=",link:"=",focused:"=?",active:"=?",debounceDelay:"=?",onToggle:"&",onTextChange:"&",onEditLink:"&",disableToggle:"="}});var ye=function(){function e(){}return e.prototype.$onInit=function(){void 0===this.label&&(this.label="BUTTON"),void 0===this.active&&(this.active=!0),void 0===this.showHeader&&(this.showHeader=!0),void 0===this.debounceDelay&&(this.debounceDelay=0)},e.prototype.onBlur=function(e){this.showHeader&&""===e.currentTarget.value&&this.onToggle&&(this.active=!1,this.onToggle({visibility:!1}))},e}();angular.module("commonControlsAppInternal").component("ccButtonEditorLink",{templateUrl:"views/button-editor-link.html",controller:ye,bindings:{label:"@?",text:"=",isLinked:"=",focused:"=?",active:"=?",debounceDelay:"=?",onToggle:"&",onTextChange:"&",onEditLink:"&",disableToggle:"=?",showHeader:"=?"}});var be=function(){function e(){}return e.prototype.$onInit=function(){this.items.length>0&&(-1===this.items.indexOf(this.defaultItem)?this.selectedItem=this.items[0]:this.selectedItem=this.defaultItem)},e.prototype.itemChange=function(e){e!==this.selectedItem&&(this.selectedItem=e,this.onItemChange&&this.onItemChange({item:e}))},e}();angular.module("commonControlsAppInternal").component("c17Tabs",{templateUrl:"views/c17-tabs.html",controller:be,bindings:{items:"=",defaultItem:"=",onItemChange:"&"}});var Se=function(){function e(e,t){this.$element=e,this.$timeout=t}return e.$inject=["$element","$timeout"],e.prototype.setColor=function(e,t){angular.element(this.$element.find(".p4-item")[0]).css("color",e),angular.element(this.$element.find("span")[0]).css("fill",e),angular.element(this.$element.find("span")[0].parentElement).css("background",t),angular.element(this.$element.find("cc-svg-icon>svg")[0]).css("fill",e)},e.prototype.$onInit=function(){var e=this;(this.overrideColor||this.overrideHoverColor||this.highlightColor)&&(this.$element.mouseleave(function(){e.setColor(e.overrideColor||"","")}),this.$element.mouseenter(function(){e.setColor(e.overrideHoverColor||"",e.highlightColor||"")}),this.$timeout(function(){return e.setColor(e.overrideColor||"","")},0))},e}();angular.module("commonControlsAppInternal").component("ccMenuItem",{templateUrl:"views/menu-item.html",controller:Se,bindings:{label:"@",icon:"@",svgIcon:"@",svgIconHover:"@?",svgIconFromInline:"=",onClick:"&",overrideColor:"@?",highlightColor:"@?",overrideHoverColor:"@?"}});var Ce=function(){return function(){}}();angular.module("commonControlsAppInternal").component("ccTipMessage",{controller:Ce,templateUrl:"views/cc-tip-message.html",bindings:{enableClose:"=?",titleIcon:"<?",title:"@",description:"@",onCloseTip:"&?"}});var we=function(){function e(){this.content="I am tooltip",this.radioValue="info",this.radioButtons=[{label:"As Info Tooltip",value:"info"},{label:"As Error Tooltip",value:"error"}],this.purpose="info"}return e.prototype.onRadioValueChange=function(e){this.purpose=e},e}();angular.module("commonControlsAppInternal").component("ccVisibleTooltip",{templateUrl:"views/visible-tooltip.html",controller:we,bindings:{type:"@",displayedRTTSections:"=?",linkId:"@",onLinkCommand:"&?"}});var Te=function(){function e(e,t,i,n,o){this.$transclude=e,this.$timeout=t,this.ccFlags=i,this.$translate=n,this.$q=o}return e.$inject=["$transclude","$timeout","ccFlags","$translate","$q"],e.prototype.$onInit=function(){var t=this;this.showFooter=void 0===this.showFooter||this.showFooter,this.showHeader=void 0===this.showHeader||this.showHeader,this.ccFlags.cardsToPanels&&(_.isUndefined(this.showContentDelay)&&(this.showContentDelay=e.SHOW_CONTENT_DELAY),this.waitForIdNeeded(function(){t.showContent=!0},this.showContentDelay).then(function(){t.$timeout(function(){return t.initialized=!0})}))},e.prototype.waitForIdNeeded=function(e,t){return this.inTestContext()&&!this.ccFlags.ccFadePanels||!t?(e(),this.$q.when()):this.$timeout(e,t)},e.prototype.inTestContext=function(){return!!window.TurnerComponentDriver},e.prototype.hasFixedTop=function(){return this.$transclude.isSlotFilled("fixedTop")},e.prototype.hasFooter=function(){return this.$transclude.isSlotFilled("footer")&&this.showFooter},e.prototype.usesPanelBody=function(){return this.$transclude.isSlotFilled("body")},e.prototype.hasNestedPanel=function(){return this.$transclude.isSlotFilled("nested")},e.prototype.hasHeader=function(){return this.showHeader},e.SHOW_CONTENT_DELAY=300,e}();angular.module("commonControlsAppInternal").component("ccPanelFrame",{templateUrl:"views/cc-panel-frame.html",controller:Te,transclude:{shourtcut:"?shourtcut",fixedTop:"?ccPanelFixedTop",body:"?ccPanelBody",footer:"?ccPanelFooter",nested:"?ccPanelNested"},bindings:{label:"@",number:"@?",onHelp:"&?",onClose:"&?",onReturn:"&?",onReset:"&?",showHelpButton:"=?",showCloseButton:"=?",showReturnButton:"=?",showResetButton:"=?",showFooter:"<?",showHeader:"<?",helpTooltip:"@",scrollDisabled:"=?",showContentDelay:"<?",showNested:"<?",showHeaderActionShourtcut:"<?"}});var Ie=function(){function e(e,t,i){this.$transclude=e,this.$timeout=t,this.$element=i,this.isAllContentVisible=null}return e.$inject=["$transclude","$timeout","$element"],e.prototype.$onInit=function(){var e=this;void 0===this.backupPositionOn&&(this.backupPositionOn=!0),void 0===this.triggered&&(this.triggered=!1),void 0===this.position&&(this.position="down"),void 0===this.marginDistance&&(this.marginDistance=9),void 0===this.windowMarginBottom&&(this.windowMarginBottom=0),!this.triggerOnHover==!this.triggerOnClick&&(this.triggerOnClick=!1,this.triggerOnHover=!0),this.$timeout(function(){var t=e.$element.find("cc-popover-trigger").children()[0];e.distanceFromTriggerElement=e.distanceForPopoverFromTrigger(t),e.topOfMiddleTriggerElement=e.topForMiddleOfTriggerElement(t)})},e.prototype.distanceForPopoverFromTrigger=function(e){return this.marginDistance},e.prototype.topForMiddleOfTriggerElement=function(e){var t=e.offsetTop;return(e.clientHeight+t+t)/2},e.prototype.hasTrigger=function(){return this.$transclude.isSlotFilled("trigger")},e.prototype.hasContent=function(){return this.$transclude.isSlotFilled("content")},e.prototype.isTriggered=function(){return this.triggered},e.prototype.toggleTrigger=function(){this.triggered=!this.triggered,this.triggered?this.whenTriggerOn():this.whenTriggerOff()},e.prototype.enableTrigger=function(){var e=this;this.$timeout(function(){(e.contentHovered||e.buttonHovered)&&(e.triggered||e.whenTriggerOn(),e.triggered=!0)})},e.prototype.disableTrigger=function(){var e=this;this.$timeout(function(){e.contentHovered||e.buttonHovered||(e.triggered&&e.whenTriggerOff(),e.triggered=!1)},1e3)},e.prototype.whenTriggerOn=function(){var e=this;this.$timeout(function(){if(e.triggered){var t=e.$element.find(".popover-content");"down"===e.position?e.isAllContentVisible=window.innerHeight-e.windowMarginBottom-t.offset().top>t[0].clientHeight+e.distanceFromTriggerElement:"top"===e.position&&(e.isAllContentVisible=t.offset().top>t[0].clientHeight)}},100),this.invokeReceivedCallback(this.onTriggerOn)},e.prototype.whenTriggerOff=function(){this.isAllContentVisible=null,this.invokeReceivedCallback(this.onTriggerOff)},e.prototype.contentDisableTrigger=function(){this.triggerOnHover&&(this.contentHovered=!1,this.disableTrigger())},e.prototype.contentEnableTrigger=function(){this.triggerOnHover&&(this.contentHovered=!0,this.enableTrigger())},e.prototype.buttonDisableTrigger=function(){this.triggerOnHover&&(this.buttonHovered=!1,this.disableTrigger())},e.prototype.buttonEnableTrigger=function(){this.triggerOnHover&&(this.buttonHovered=!0,this.enableTrigger())},e.prototype.invokeReceivedCallback=function(e){e&&e()},e.prototype.notReady=function(){return null===this.isAllContentVisible},e.prototype.setClasses=function(){return this.notReady()?"notready":this.getTheAppropriatePosition()},e.prototype.setPositionStyle=function(){if(!this.notReady())return{top:this.calculateTop()}},e.prototype.calculateTop=function(){var e=this.getTheAppropriatePosition(),t=this.distanceFromTriggerElement;return(t>0&&"top"===e||t<0&&"down"===e)&&(t=-t),this.topOfMiddleTriggerElement+t},e.prototype.getTheAppropriatePosition=function(){return this.isAllContentVisible?this.position:this.backupPositionOn?e.OppositePositionMap[this.position]:this.position},e.prototype.setButtonHovered=function(e){this.buttonHovered=e},e.OppositePositionMap={top:"down",down:"top"},e}();angular.module("commonControlsAppInternal").component("ccPopover",{template:'<div class="popover-container"\n                    ng-mouseleave="$ctrl.triggerOnHover && $ctrl.disableTrigger()">\n                 <ng-transclude data-hook="popover-default-transclude" ng-if="!$ctrl.hasTrigger()"></ng-transclude>\n                 <div ng-transclude="trigger"\n                      data-hook="popover-trigger"\n                      class="popover-trigger"\n                      ng-if="$ctrl.hasTrigger()"\n                      ng-mouseenter="$ctrl.buttonEnableTrigger()"\n                      ng-mouseleave="$ctrl.buttonDisableTrigger()"\n                      ng-click="$ctrl.triggerOnClick && $ctrl.toggleTrigger()"></div>\n                 <div class="popover-content-container"\n                      ng-class="$ctrl.setClasses()"\n                      ng-mouseenter="$ctrl.contentEnableTrigger()"\n                      ng-mouseleave="$ctrl.contentDisableTrigger()"\n                      ng-style="$ctrl.setPositionStyle()">\n                    <div ng-transclude="content"\n                        data-hook="popover-content"\n                        ng-if="$ctrl.hasContent()"\n                        ng-click="$ctrl.triggerOnClick && $ctrl.toggleTrigger();$ctrl.triggerOnHover && $ctrl.contentDisableTrigger(); $event.stopPropagation()"\n                        class="popover-content"\n                        ng-class="{ enabled: $ctrl.isTriggered() }">\n                        </div>\n                 </div>\n               </div>',controller:Ie,transclude:{trigger:"?ccPopoverTrigger",content:"?ccPopoverContent"},bindings:{triggerOnHover:"<?",triggerOnClick:"<?",position:"@?",windowMarginBottom:"<",backupPositionOn:"<",marginDistance:"<",onTriggerOff:"&?",onTriggerOn:"&?"}});var xe=function(){function e(e,t){this.CCSvgIconService=e,this.$scope=t}return e.$inject=["CCSvgIconService","$scope"],e.prototype.$onInit=function(){var e=this;this.prefix=this.fromInline?"":this.CCSvgIconService.getSpritePrefix(),this.iconData=this.extractIconData(this.icon),this.hoverIconData=this.extractIconData(this.hoverIcon),angular.isUndefined(this.addCcSvgIconClass)&&(this.addCcSvgIconClass=!0),this.$scope.$watch("$ctrl.icon",function(){e.iconData=e.extractIconData(e.icon)}),this.$scope.$watch("$ctrl.hoverIcon",function(){e.hoverIconData=e.extractIconData(e.hoverIcon)})},e.prototype.extractIconData=function(e){if(!e)return{name:null,link:null,iconClass:null};var t={};if(-1!==e.indexOf(":")){var i=e.split(":");t.module=i[0],t.name=i[1]}else t.name=e;return t.link=this.getIconLink(t),t.iconClass=this.getIconClass(t),t},e.prototype.getIconClass=function(e){return"cc-svg-icon-"+e.name},e.prototype.getIconLink=function(e){return e.module?this.prefix+"#"+e.module+"-"+e.name:this.prefix+"#"+e.name},e}();angular.module("commonControlsAppInternal").component("ccSvgIcon",{controller:xe,template:"<svg data-hook='svg-icon' ng-class=\"[{'cc-svg-icon': $ctrl.addCcSvgIconClass, 'cc-svg-corner-icon': $ctrl.isCornerIcon, '-offhover': !!$ctrl.hoverIconData.name}, $ctrl.iconData.iconClass]\">\n                 <use xlink:href='{{$ctrl.iconData.link}}'/>\n               </svg>\n               <svg data-hook='svg-icon-hover' ng-class=\"[{'cc-svg-icon': $ctrl.addCcSvgIconClass, 'cc-svg-corner-icon': $ctrl.isCornerIcon}, $ctrl.hoverIconData.iconClass, '-onhover']\" ng-if=\"!!$ctrl.hoverIconData.name\">\n                 <use xlink:href='{{$ctrl.hoverIconData.link}}'/>\n               </svg>\n              ",bindings:{icon:"@",hoverIcon:"@?",isCornerIcon:"<",addCcSvgIconClass:"<?",fromInline:"<?"}});var Pe=function(){function e(){}return e.prototype.setSpritePrefix=function(e){this.spritePrefix=e},e.prototype.$get=function(){var e=this;return{getSpritePrefix:function(){return e.spritePrefix}}},e}();angular.module("commonControlsAppInternal").provider("CCSvgIconService",Pe).config(["CCSvgIconServiceProvider",function(e){e.setSpritePrefix("")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/playground.html","<cc-panel-frame class='-with-p16a-header' label='DEV PANEL' ng-if='$ctrl.isVisible(&#39;Panel Frame&#39;)' on-close='$ctrl.close()' show-close-button='true' show-header-action-shourtcut='true' show-return-button='!$ctrl.ccFlags.cardsToPanels'>\n<shourtcut>\nAction Shourtcut Example\n</shourtcut>\n<cc-panel-fixed-top>\n</cc-panel-fixed-top>\n<cc-panel-body>\n<c20-addable-list label='Stuff' on-add-click='$ctrl.onAddClick()' on-select='$ctrl.doOnSelect()' radio-items='$ctrl.c20GraphicRadioControl.radioElements2'></c20-addable-list>\n</cc-panel-body>\n<cc-panel-footer>\n<button class='p9a-secondary cc-x-height -inverse'>\n<div class='cc-x-height'>Big inverse button here</div>\n</button>\n</cc-panel-footer>\n</cc-panel-frame>\n<cc-panel-frame class='-with-p16a-header' help-tooltip='playground.tooltip' label='{{$ctrl.nestedTitle}}' ng-if='$ctrl.isVisible(&#39;Nested&#39;)' on-close='$ctrl.close()' on-help='$ctrl.help()' on-return='$ctrl.onNestedReturn()' show-close-button='true' show-nested='$ctrl.showNested' show-return-button='$ctrl.showNested'>\n<cc-panel-fixed-top>\n<div class='cc-panel-content' ignore-this-element-and-dont-use-it-in-your-code-its-only-for-the-playground>\nFix Top\n</div>\n</cc-panel-fixed-top>\n<cc-panel-body>\n<div class='cc-panel-content' ignore-this-element-and-dont-use-it-in-your-code-its-only-for-the-playground>\n<div ng-if='!$ctrl.ccFlags.cardsToPanels'>\n<button class='cc-x-height p9-primary -medium -red' ng-click='$ctrl.addFlag(&#39;cardsToPanels&#39;)'>\n<div class='cc-x-height'>You need cardsToPanels flag</div>\n</button>\n<br>\n<br>\n</div>\nLorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Vel orci porta non pulvinar neque laoreet suspendisse. Adipiscing elit pellentesque habitant morbi tristique. Sed risus ultricies tristique nulla aliquet enim tortor at auctor. Est placerat in egestas erat. Tellus at urna condimentum mattis. Accumsan lacus vel facilisis volutpat est velit egestas. Ac placerat vestibulum lectus mauris ultrices eros in cursus. Tellus rutrum tellus pellentesque eu tincidunt. Nunc sed augue lacus viverra vitae congue eu. Viverra nam libero justo laoreet. Proin sagittis nisl rhoncus mattis. Neque ornare aenean euismod elementum nisi quis eleifend quam. Vitae elementum curabitur vitae nunc sed velit dignissim sodales ut. Viverra aliquet eget sit amet tellus cras. Libero enim sed faucibus turpis in.\nSuspendisse sed nisi lacus sed viverra tellus in hac. Et sollicitudin ac orci phasellus egestas tellus rutrum. Sit amet volutpat consequat mauris. Ac turpis egestas sed tempus urna et pharetra pharetra massa. Malesuada nunc vel risus commodo. Aliquet risus feugiat in ante metus dictum. Non blandit massa enim nec dui nunc mattis. Varius vel pharetra vel turpis nunc eget. Feugiat scelerisque varius morbi enim nunc faucibus a pellentesque sit. Purus semper eget duis at tellus. Ante metus dictum at tempor commodo ullamcorper a lacus. Fringilla est ullamcorper eget nulla facilisi etiam dignissim diam. A pellentesque sit amet porttitor eget. Justo donec enim diam vulputate. Nulla facilisi nullam vehicula ipsum a arcu cursus vitae congue. Convallis posuere morbi leo urna molestie at elementum eu facilisis.\n</div>\n</cc-panel-body>\n<cc-panel-nested>\n<cc-panel-frame show-header='false' show-nested='$ctrl.showNestedNested'>\n<cc-panel-fixed-top>\n<p16-panel-header label='colors'></p16-panel-header>\n</cc-panel-fixed-top>\n<cc-panel-body>\n<div class='cc-panel-content' ignore-this-element-and-dont-use-it-in-your-code-its-only-for-the-playground>\nLorem dolor sed viverra ipsum nunc aliquet. Pellentesque massa placerat duis ultricies lacus sed turpis tincidunt. Eget lorem dolor sed viverra. Enim nec dui nunc mattis enim ut tellus elementum sagittis. Amet commodo nulla facilisi nullam vehicula ipsum a arcu cursus. Amet cursus sit amet dictum sit amet justo donec enim. At elementum eu facilisis sed odio morbi. Natoque penatibus et magnis dis. Viverra orci sagittis eu volutpat odio facilisis mauris sit. Quis vel eros donec ac odio tempor orci. Amet tellus cras adipiscing enim eu turpis egestas pretium aenean. Consequat ac felis donec et odio. Integer quis auctor elit sed vulputate mi sit. Dolor sed viverra ipsum nunc. Natoque penatibus et magnis dis parturient montes nascetur ridiculus. Duis convallis convallis tellus id. Nulla aliquet porttitor lacus luctus accumsan tortor posuere ac. Consequat nisl vel pretium lectus. Porta non pulvinar neque laoreet suspendisse interdum consectetur libero id.\nFringilla est ullamcorper eget nulla facilisi etiam dignissim. Ultricies leo integer malesuada nunc. Ut diam quam nulla porttitor. Aliquet lectus proin nibh nisl condimentum id venenatis a. Sed id semper risus in hendrerit gravida rutrum. Libero id faucibus nisl tincidunt eget nullam. Lobortis elementum nibh tellus molestie. Volutpat commodo sed egestas egestas fringilla phasellus faucibus. Nec feugiat in fermentum posuere urna nec tincidunt praesent. Dignissim cras tincidunt lobortis feugiat vivamus at augue eget arcu. Ante in nibh mauris cursus mattis molestie a.\nFringilla est ullamcorper eget nulla facilisi etiam dignissim. Ultricies leo integer malesuada nunc. Ut diam quam nulla porttitor. Aliquet lectus proin nibh nisl condimentum id venenatis a. Sed id semper risus in hendrerit gravida rutrum. Libero id faucibus nisl tincidunt eget nullam. Lobortis elementum nibh tellus molestie. Volutpat commodo sed egestas egestas fringilla phasellus faucibus. Nec feugiat in fermentum posuere urna nec tincidunt praesent. Dignissim cras tincidunt lobortis feugiat vivamus at augue eget arcu. Ante in nibh mauris cursus mattis molestie a.\n</div>\n</cc-panel-body>\n<cc-panel-nested>\n<cc-panel-frame show-header='false'>\n<cc-panel-body>\n<div class='cc-panel-content' ignore-this-element-and-dont-use-it-in-your-code-its-only-for-the-playground>\n<h4>nested nested panel</h4>\n</div>\n</cc-panel-body>\n</cc-panel-frame>\n</cc-panel-nested>\n<cc-panel-footer>\n<button class='p9a-secondary cc-x-height -inverse' ng-click='$ctrl.showNestedNested = true'>\n<div class='cc-x-height'>Get me deeper!</div>\n</button>\n</cc-panel-footer>\n</cc-panel-frame>\n</cc-panel-nested>\n<cc-panel-footer>\n<button class='p9a-secondary cc-x-height -inverse' ng-click='$ctrl.showNested = true'>\n<div class='cc-x-height'>Show nested panel</div>\n</button>\n</cc-panel-footer>\n</cc-panel-frame>\n<cc-panel-frame class='-with-p16a-header' help-tooltip='playground.tooltip' label='Panel Frame with very long title' ng-if='$ctrl.isVisible(&#39;Panel Frame&#39;)' on-close='$ctrl.close()' on-help='$ctrl.help()' show-close-button='true' show-return-button='!$ctrl.ccFlags.cardsToPanels'>\n<cc-panel-fixed-top>\n</cc-panel-fixed-top>\n<c11-paragraph html='&quot;&lt;p&gt;&lt;strong&gt;Panel Header&lt;/strong&gt;&lt;/p&gt;Each panel frame comes with an integrated header. The header can be configured via the attributes &amp;quot;API&amp;quot; (see examples in this playground). In addition, there are 3 variations of the header: the default one, &lt;code&gt;p16a&lt;/code&gt; (with return button on the left) and &lt;code&gt;p16b&lt;/code&gt; (for narrow sub panels). Use them by applying one of these specific classes to &lt;code&gt;&amp;lt;cc-panel-frame&amp;gt;&lt;/code&gt;: &lt;code&gt;-with-p16a-header&lt;/code&gt; and &lt;code&gt;-with-p16b-header&lt;/code&gt;.&quot;'></c11-paragraph>\n<c11-paragraph html='&quot;&lt;p&gt;&lt;strong&gt;Panel Fixed Top&lt;/strong&gt;&lt;/p&gt;The panel is scrollable, but it may have a fixed area on the top. To include a fixed top area in your panel frame, add the &lt;code&gt;&amp;lt;cc-panel-fixed-top&amp;gt&lt;/code&gt; element with desired content inside it. It looks like &lt;strong&gt;Panel Frame&lt;/strong&gt; paragraph above.&quot;'></c11-paragraph>\n<c11-paragraph html='&quot;&lt;p&gt;&lt;strong&gt;Panel Footer&lt;/strong&gt;&lt;/p&gt;The footer is not built-in to the panel frame and is optional. To include a footer in your panel frame, simply add the &lt;code&gt;&amp;lt;cc-panel-footer&amp;gt&lt;/code&gt; element with your element of choice inside it (usually a button primitive).&quot;'></c11-paragraph>\n<cc-panel-footer>\n<button class='p9a-secondary cc-x-height -inverse'>\n<div class='cc-x-height'>Big inverse button here</div>\n</button>\n</cc-panel-footer>\n</cc-panel-frame>\n<cc-panel-frame class='-with-p16a-header' label='Primitives 1' ng-if='$ctrl.isVisible(&#39;Primitives 1&#39;)' on-close='$ctrl.close()' on-return='$ctrl.return()' show-close-button='true' show-return-button='!$ctrl.ccFlags.cardsToPanels'>\n<cc-panel-body>\n<div class='cc-panel-content' ignore-this-element-and-dont-use-it-in-your-code-its-only-for-the-playground>\n<div class='p8-label'>%p17-divider</div>\n<p0-spacer></p0-spacer>\n<p17-divider></p17-divider>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>medium spacer</div>\n<p0-spacer size='medium'></p0-spacer>\n<div class='p8-label'>after medium spacer</div>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>large spacer</div>\n<p0-spacer size='large'></p0-spacer>\n<div class='p8-label'>after large spacer</div>\n<p0-spacer></p0-spacer>\nhorizontal space:A\n<p0-spacer is-horizontal='true' size='medium'></p0-spacer>\nA\n<div class='p8-label'>.p8-label</div>\n<p0-spacer></p0-spacer>\n<div class='p8-label -centered'>.p8-label.-centered</div>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<cc-tip-message description='Texts ADI found most suitable to this paragraph from your texts. Go ahead and use them!' enable-close='true' title-icon='&#39;cc-icon-best-match&#39;' title='Best Match Texts!'></cc-tip-message>\n<div class='p8-label'>%p1-text-input</div>\n<p1-text-input focused='true' label='Regular Input' on-change-mask='$ctrl.maskChange()' on-change-value='$ctrl.valueChange(value)' placeholder='&#39;i.e. www.yourlink.com&#39;' value='&#39;Initial value 1&#39;'></p1-text-input>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>%p1-text-input with icon</div>\n<p1-text-input focused='true' icon-name='&#39;cc-icon-close-8&#39;' label='Regular Input' on-change-mask='$ctrl.maskChange()' on-change-value='$ctrl.valueChange(value)' placeholder='&#39;i.e. www.yourlink.com&#39;' value='&#39;Initial value 1&#39;'></p1-text-input>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>%p3-dropdown-list</div>\n<p3-dropdown-list help-tooltip='playground.tooltip' items='$ctrl.dropdownListItems' label-key='label' on-selection-change='$ctrl.onDropdownListSelectionChange(item)' placeholder='test placeholder' track-by-key='id'></p3-dropdown-list>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>%p5-slider</div>\n<p5-slider max='100' min='0' on-value-change='$ctrl.onSliderValueChange(&quot;slider primitive&quot;, value)' step='1' stepper='false' units='&#39;%&#39;' value='$ctrl.sliderValue'></p5-slider>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>%p5a-slider</div>\n<p5-slider max='100' min='0' on-value-change='$ctrl.onSliderValueChange(&quot;slider primitive&quot;, value)' step='1' stepper='false' type='p5a' value='$ctrl.sliderValue'></p5-slider>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>%p5a-slider stepper no ticks</div>\n<p5-slider icon-after='design:font-size-large' icon-before='design:font-size-small' max='7' min='0' on-value-change='$ctrl.onSliderValueChange(&quot;slider primitive&quot;, value)' step='1' stepper-ticks='false' stepper='true' type='p5a' value='$ctrl.sliderValue2'></p5-slider>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>%p6-control-header</div>\n<p6-control-header help-tooltip='playground.tooltip' hide-toggle-button='false' label='&#39;regular&#39;' show-help-button='true'></p6-control-header>\n<p6-control-header help-tooltip='playground.tooltip' hide-toggle-button='false' label='&#39;regular with toggle&#39;' show-help-button='true'></p6-control-header>\n<p6-control-header action-label='&#39;Import&#39;' action-tooltip='playground.tooltip' label='&#39;With Action&#39;' on-action='$ctrl.onControlHeaderActionClick()' show-action='true'></p6-control-header>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>%p6-control-header</div>\n<p6-control-header active='true' help-tooltip='playground.tooltip' hide-toggle-button='true' label='&#39;regular without toggle&#39;' show-help-button='true'></p6-control-header>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>%p11-item-navigation</div>\n<p11-item-navigation count='4' current='$ctrl.currentStep' next-tooltip='playground.next' on-next='$ctrl.onItemNavigationValueChange(&#39;next&#39;, current)' on-previous='$ctrl.onItemNavigationValueChange(&#39;previous&#39;, current)' previous-tooltip='playground.previous'></p11-item-navigation>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>%p14-checkbox</div>\n<p14-checkbox item='$ctrl.checkbox' on-toggle='$ctrl.onCheckboxToggle($ctrl.checkbox)'></p14-checkbox>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>%p14-checkbox long</div>\n<p14-checkbox-ml item='$ctrl.checkboxLong' on-toggle='$ctrl.onCheckboxToggle($ctrl.checkbox)'></p14-checkbox-ml>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>%p13-radio-buttons</div>\n<p13-radio-buttons items='$ctrl.radioButtons' on-value-change='$ctrl.onRadioValueChange(&quot;primitive&quot;, value)' value='$ctrl.radioValue'></p13-radio-buttons>\n</div>\n</cc-panel-body>\n</cc-panel-frame>\n<cc-panel-frame label='Primitives 2' ng-if='$ctrl.isVisible(&#39;Primitives 2&#39;)' number='6' on-close='$ctrl.close()' on-help='$ctrl.help()' show-close-button='true' show-help-button='true'>\n<div class='cc-panel-content' ignore-this-element-and-dont-use-it-in-your-code-its-only-for-the-playground>\n<div class='p8-label'>%p15-toggle</div>\n<p15-toggle on-value-change='$ctrl.onToggleValueChange(value)' value='$ctrl.toggleValue'></p15-toggle>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>%p15-toggle with icons</div>\n<p15-toggle left-icon='$ctrl.toggleLeftIcon' on-value-change='$ctrl.onToggleValueChange(value)' right-icon='$ctrl.toggleRightIcon' value='$ctrl.toggleValue'></p15-toggle>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>%p20-link</div>\n<p20-link data-hook='p20-link' link='{value:&#39;https://www.wix.com/website/templates&#39;,state:true}' on-link-click='$ctrl.onEditLink({ link: $ctrl.link })'></p20-link>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>%p21-color-tag</div>\n<div class='cc-primitives-in-row' ignore-this-element-and-dont-use-it-in-your-code-its-only-for-the-playground>\n<p21-color-tag color='#64d4d2' show-icon='true' size='lg' tooltip='playground.tooltip'></p21-color-tag>\n</div>\n<div class='cc-primitives-in-row' ignore-this-element-and-dont-use-it-in-your-code-its-only-for-the-playground>\n<p21-color-tag color='#cf262f' size='md' tooltip='playground.tooltip'></p21-color-tag>\n<p21-color-tag color='#9f9f33' is-selected='true' size='sm' tooltip='playground.tooltip'></p21-color-tag>\n<p21-color-tag color='#4286f4' size='xs' tooltip='playground.tooltip'></p21-color-tag>\n</div>\n<div class='cc-primitives-in-row' ignore-this-element-and-dont-use-it-in-your-code-its-only-for-the-playground>\n<p21-color-tag color='#eeff00' size='sm'></p21-color-tag>\n<p21-color-tag cc-tooltip='playground.tooltip' color='#6D6378' size='sm'></p21-color-tag>\n<p21-color-tag color='#00E1FF' size='sm' tooltip='playground.tooltip'></p21-color-tag>\n<p21-color-tag color='#FF005E' size='sm'></p21-color-tag>\n<p21-color-tag color='' is-placeholder='true' size='sm'></p21-color-tag>\n</div>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>%p24-palette</div>\n<p24-palette colors='[&#39;#800080&#39;, &#39;#ffb4ff&#39;, &#39;#fcdedc&#39;, &#39;#133752&#39;]'></p24-palette>\n<p0-spacer></p0-spacer>\n<p24-palette colors='[&#39;#800080&#39;, &#39;#ff68fe&#39;, &#39;#fcdedc&#39;, &#39;#133752&#39;]' is-selectable='true'></p24-palette>\n<p0-spacer></p0-spacer>\n<p24-palette colors='[&#39;#800080&#39;, &#39;#ff1bfe&#39;, &#39;#fcdedc&#39;, &#39;#133752&#39;]' is-selectable='true' is-selected='true'></p24-palette>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>%p27-palette-color-picker</div>\n<p27-palette-color-picker colors='[&#39;#800080&#39;, &#39;#ffb4ff&#39;, &#39;#fcdedc&#39;, &#39;#1cdedc&#39;, &#39;#133752&#39;, &#39;#ffffff&#39;]' light-icon-index='[2,4]' notification-getter='$ctrl.messageGetter({index})' selected-index='1' set-color-callback='$ctrl.callback({index})'></p27-palette-color-picker>\n<p0-spacer></p0-spacer>\n<p17-divider></p17-divider>\n</div>\n</cc-panel-frame>\n<cc-panel-frame label='Primitives 3' ng-if='$ctrl.isVisible(&#39;Primitives 3&#39;)' number='6' on-close='$ctrl.close()' on-help='$ctrl.help()' show-close-button='true' show-help-button='true'>\n<div class='cc-panel-content' ignore-this-element-and-dont-use-it-in-your-code-its-only-for-the-playground>\n<div class='p8-label'>%p25-background-preview</div>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>color</div>\n<p25-background-preview data='{type:&#39;color&#39;, value: &#39;#000&#39;}'></p25-background-preview>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>image</div>\n<p25-background-preview data='{type: &#39;image&#39;, value: &#39;ccd850b43b8e4e6bb634c30e8963ec77.jpg&#39;}'></p25-background-preview>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>gallery (showcase)</div>\n<p25-background-preview data='{type: &#39;gallery&#39;, metaData: {galleryType: &#39;showcase&#39;}, value: [&#39;ccd850b43b8e4e6bb634c30e8963ec77.jpg&#39;, &#39;95484500d9204ee1a35eefd4792a61a8.jpg&#39;, &#39;a04ac0cde13c4cadb5e47f2d58d8f51a.jpg&#39;]}'></p25-background-preview>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>gallery (slideshow)</div>\n<p25-background-preview data='{type: &#39;gallery&#39;, metaData: {galleryType: &#39;slideshow&#39;}, value: [&#39;ccd850b43b8e4e6bb634c30e8963ec77.jpg&#39;, &#39;95484500d9204ee1a35eefd4792a61a8.jpg&#39;, &#39;a04ac0cde13c4cadb5e47f2d58d8f51a.jpg&#39;, &#39;ccd850b43b8e4e6bb634c30e8963ec77.jpg&#39;, &#39;95484500d9204ee1a35eefd4792a61a8.jpg&#39;, &#39;a04ac0cde13c4cadb5e47f2d58d8f51a.jpg&#39;]}'></p25-background-preview>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>pattern</div>\n<p25-background-preview data='{type: &#39;pattern&#39;, value: &#39;121632231243445db93fce794a36a279.gif&#39;, metaData: {patternBgColor: &#39;#881414&#39;, thumbRatio: 10} }'></p25-background-preview>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>video</div>\n<p25-background-preview data='{type: &#39;video&#39;, value: &#39;http://video.wixstatic.com/video/11062b_2ccb88c1c6de4151b51879d6c90fca9d/1080p/mp4/file.mp4&#39;}'></p25-background-preview>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>selected</div>\n<p25-background-preview data='{type: &#39;image&#39;, value: &#39;ccd850b43b8e4e6bb634c30e8963ec77.jpg&#39;}' is-selected='true'></p25-background-preview>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>clickable</div>\n<p25-background-preview data='{type: &#39;pattern&#39;, value: &#39;c392c08f44fc4a26bad0228f39ffc4a1.png&#39;}' on-click='$ctrl.onP25BackgroundPreview(&#39;some value&#39;)'></p25-background-preview>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>(size=\"big\")</div>\n<p25-background-preview data='{type: &#39;color&#39;, value: &#39;#000&#39;}' size='&#39;big&#39;'></p25-background-preview>\n</div>\n</cc-panel-frame>\n<cc-panel-frame class='-with-p16b-header' label='Buttons 1' ng-if='$ctrl.isVisible(&#39;Buttons 1&#39;)' on-return='$ctrl.return()' show-return-button='!$ctrl.ccFlags.cardsToPanels'>\n<div class='cc-panel-content' ignore-this-element-and-dont-use-it-in-your-code-its-only-for-the-playground>\n<div class='p8-label'>Assets link</div>\n<p0-spacer></p0-spacer>\n<a class='cc-ellipsis' href='https://zpl.io/GFp6I'>P9 Button specification</a>\n<p0-spacer></p0-spacer>\n<p17-divider></p17-divider>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>P9 Primary</div>\n<p0-spacer></p0-spacer>\n<button class='p9-primary cc-x-height'>\n<div class='cc-x-height'>.p9-primary</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='p9-primary -medium cc-x-height'>\n<div class='cc-x-height'>.p9-primary.-medium</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='p9-primary -small cc-x-height'>\n<div class='cc-x-height'>.p9-primary.-small</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='p9-primary -transparent-dark -controlbtn cc-x-height'>\n.p9-primary.-controlbtn.-transparent-dark\n</button>\n<p0-spacer></p0-spacer>\n<button class='p9-primary -controlbtn cc-x-height'>\n<div class='cc-x-height'>.p9-primary.-controlbtn (WITH x-height)</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='p9-primary -controlbtn'>\n.p9-primary.-controlbtn (NO x-height)\n</button>\n<p0-spacer></p0-spacer>\n<button class='p9-primary -red -medium cc-x-height'>\n<div class='cc-x-height'>.p9-primary.-red</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='p9-primary -purple -medium cc-x-height'>\n<div class='cc-x-height'>.p9-primary.-purple</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='p9-primary -disabled -medium cc-x-height'>\n<div class='cc-x-height'>.p9-primary.-grey / .-disabled</div>\n</button>\n</div>\n</cc-panel-frame>\n<cc-panel-frame label='Buttons 2' ng-if='$ctrl.isVisible(&#39;Buttons 2&#39;)' number='666'>\n<div class='cc-panel-content' ignore-this-element-and-dont-use-it-in-your-code-its-only-for-the-playground>\n<div class='p8-label'>P9A Secondary</div>\n<p0-spacer></p0-spacer>\n<button class='p9a-secondary cc-x-height'>\n<div class='cc-x-height'>.p9a-secondary</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='p9a-secondary -medium cc-x-height'>\n<div class='cc-x-height'>.p9a-secondary.-medium</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='p9a-secondary -small cc-x-height'>\n<div class='cc-x-height'>.p9a-secondary.-small</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='p9a-secondary -red -medium cc-x-height'>\n<div class='cc-x-height'>.p9a-secondary.-red</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='p9a-secondary -purple -medium cc-x-height'>\n<div class='cc-x-height'>.p9a-secondary.-purple</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='p9a-secondary -inverse -small cc-x-height'>\n<div class='cc-x-height'>.p9a-secondary.-inverse</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='p9a-secondary -inverse -red -small cc-x-height'>\n<div class='cc-x-height'>.p9a-secondary.-inverse.-red</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='p9a-secondary -inverse -purple -small cc-x-height'><div class='cc-x-height'>.p9a-secondary.-inverse.-purple</div></button>\n<p0-spacer></p0-spacer>\n<button class='p9a-secondary -small c18-panel-button'>.c18-panel-button.p9a-secondary.-small</button>\n<p0-spacer></p0-spacer>\n<div class='cc-sit-control-with-primitives'>\n<c18-panel-button label='&#39;.c18b-panel-button&#39;' on-click='$ctrl.onActionClick()'></c18-panel-button>\n</div>\n</div>\n</cc-panel-frame>\n<cc-panel-frame label='Buttons 3' ng-if='$ctrl.isVisible(&#39;Buttons 3&#39;)'>\n<div class='cc-panel-content' ignore-this-element-and-dont-use-it-in-your-code-its-only-for-the-playground>\n<div class='p8-label'>P9B Text button</div>\n<p0-spacer></p0-spacer>\n<button cc-tooltip='playground.tooltip' class='p9b-text-button cc-x-height'>\n<div class='cc-x-height'>.p9b-text-button</div>\n</button>\n<p0-spacer></p0-spacer>\n<button cc-tooltip='playground.tooltip' class='p9b-text-button -medium cc-x-height'>\n<div class='cc-x-height'>.p9b-text-button.-medium</div>\n</button>\n<p0-spacer></p0-spacer>\n<button cc-tooltip='playground.tooltip' class='p9b-text-button -small cc-x-height'>\n<div class='cc-x-height'>.p9b-text-button.-small</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='p9b-text-button -red cc-x-height'>\n<div class='cc-x-height'>.p9b-text-button.-red</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='p9b-text-button -purple cc-x-height'>\n<div class='cc-x-height'>.p9b-text-button.-purple</div>\n</button>\n<p0-spacer></p0-spacer>\n<p17-divider></p17-divider>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>P9C Media preview button</div>\n<p0-spacer></p0-spacer>\n<fieldset style='background: #00ccee'>\n<p0-spacer></p0-spacer>\n<button class='p9c-primary cc-x-height'>\n<div class='cc-x-height'>.p9c-primary</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='p9c-primary -with-icon cc-x-height'>\n<div class='cc-x-height'><i class='cc-icon-customise'></i>.p9c-primary.-with-icon</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='p9c-primary -icon-only'><i class='cc-icon-customise'></i></button>\n<span>\n.p9c-primary.-icon-only\n</span>\n<p0-spacer></p0-spacer>\n<button class='p9c-text-button cc-x-height'>\n<div class='cc-x-height'>.p9c-text-button</div>\n</button>\n<p0-spacer></p0-spacer>\n</fieldset>\n</div>\n</cc-panel-frame>\n<cc-panel-frame class='-with-p16a-header -with-control-higlights' label='Rich Text Input' ng-if='$ctrl.isVisible(&#39;Rich Text Input&#39;)' on-close='$ctrl.close()' on-return='$ctrl.return()' show-close-button='true' show-return-button='!$ctrl.ccFlags.cardsToPanels'>\n<div class='cc-panel-content' ignore-this-element-and-dont-use-it-in-your-code-its-only-for-the-playground>\n<div class='p8-label'>P23 Rich Text Input</div>\n<p23-rich-text-input cmd-state='{}' ignore-blur-and-focus='false' on-change-value='$ctrl.valueChange(value)' on-clear-formatting='$ctrl.resetRichText(value)' value='$ctrl.richTextValue0'></p23-rich-text-input>\n</div>\n<c19-toggle label='Show C23 (for e2e tests)' type='c19a' value='$ctrl.showC23'></c19-toggle>\n<c23-rich-text-input data-hook='c23-with-listing' displayed-r-t-t-sections='$ctrl.displayedRTTSections2' label='C23 Rich Text Input with listing' max-rows-on-blur='2' max-rows-on-focus='20' ng-if='$ctrl.showC23' on-change-value='$ctrl.valueChange(value)' on-clear-formatting='$ctrl.resetRichText(value)' on-link-command='$ctrl.simulateRichTextLinkDialog(linkId)' on-toggle='$ctrl.maskChange()' styles-manager='$ctrl.richTextStylesManager' value='$ctrl.richTextValue2'></c23-rich-text-input>\n<c23-rich-text-input data-hook='c23-without-listing' displayed-r-t-t-sections='$ctrl.displayedRTTSections' label='C23 Rich Text Input without listing' max-rows-on-blur='2' max-rows-on-focus='20' ng-if='$ctrl.showC23' on-change-value='$ctrl.valueChange(value)' on-clear-formatting='$ctrl.resetRichText(value)' on-link-command='$ctrl.simulateRichTextLinkDialog(linkId)' on-toggle='$ctrl.maskChange()' styles-manager='$ctrl.richTextStylesManager' value='$ctrl.richTextValue1'></c23-rich-text-input>\n<c23-rich-text-input displayed-r-t-t-sections='$ctrl.displayedRTTSections' is-disabled='true' label='C23 Rich Text Input disabled' max-rows-on-blur='2' max-rows-on-focus='20' ng-if='$ctrl.showC23' on-change-value='$ctrl.valueChange(value)' on-clear-formatting='$ctrl.resetRichText(value)' on-link-command='$ctrl.simulateRichTextLinkDialog(linkId)' on-toggle='$ctrl.maskChange()' styles-manager='$ctrl.richTextStylesManager' value='value'></c23-rich-text-input>\n</cc-panel-frame>\n<cc-panel-frame class='-with-p16a-header -with-control-higlights' label='Text Inputs' ng-if='$ctrl.isVisible(&#39;Text Inputs&#39;)' on-close='$ctrl.close()' on-return='$ctrl.return()' show-close-button='true' show-return-button='!$ctrl.ccFlags.cardsToPanels'>\n<c2-text-input help-tooltip='playground.tooltip' is-disabled='false' label='Regular Input' on-change-value='$ctrl.valueChange(value)' on-toggle='$ctrl.maskChange()' show-help-button='true' value='&#39;Mothers are all slightly insane&#39;'></c2-text-input>\n<c2-text-input is-disabled='true' label='Disabled input' value='&#39;Mothers are all slightly insane&#39;'></c2-text-input>\n<c2-text-input disable-toggle='true' is-disabled='false' label='Input with no toggle' value='&#39;Mothers are all slightly insane&#39;'></c2-text-input>\n<c2-text-input label='Required input with default text' placeholder='' value='&#39;Mothers are all slightly insane&#39;'></c2-text-input>\n<c2-text-input label='Long Input' long='true' placeholder='&#39;This is the placeholder text&#39;' value='&#39;If you really want to hear about it, the first thing you\\&#39;ll probably want to know is where I was born, and what my lousy childhood was like, and how my parents were occupied and all before they had me, and all that David Copperfield kind of crap, but I don\\&#39;t feel like going into it, if you want to know the truth.&#39;'></c2-text-input>\n<c2-text-input label='Prefix Input' prefix='http://www.../' value='&#39;Initial value 3&#39;'></c2-text-input>\n<c2-text-input autocomplete-link-label='link label' autocomplete='$ctrl.autocompleteItems' label='Autocomplete Input' on-autocomplete-link-click='$ctrl.onAutocompleteLinkClick()' value='$ctrl.autocompleteValue'></c2-text-input>\n<c2-text-input autocomplete-media='true' autocomplete='$ctrl.autocompleteMediaItems' label='Autocomplete Media Input' value='$ctrl.autocompleteValue'></c2-text-input>\n<c2-text-input button-text='Connect' disable-toggle='true' icon-name='check-green' label='C2E input button/icon no toggle' on-blur='$ctrl.checkC2EValue()' on-button-click='$ctrl.toggleC2EState()' on-change-value='$ctrl.checkC2EValue()' on-icon-click='$ctrl.toggleC2EState()' placeholder='&#39;Edit me&#39;' show-button='!$ctrl.c2eState' show-icon='$ctrl.c2eState' value='$ctrl.c2eValue'></c2-text-input>\n<c2-text-input button-text='Add Link' icon-name='rich-text:link' label='C2E input with button/icon' on-blur='$ctrl.checkC2EValue2()' on-button-click='$ctrl.toggleC2EState2()' on-change-value='$ctrl.checkC2EValue2()' on-icon-click='$ctrl.toggleC2EState2()' placeholder='&#39;Edit me&#39;' show-button='!$ctrl.c2eState2' show-icon='$ctrl.c2eState2' value='$ctrl.c2eValue2'></c2-text-input>\n<c2-text-input button-text='Add Link' icon-name='rich-text:link' label='C2E input with no header' on-blur='$ctrl.checkC2EValue2()' on-button-click='$ctrl.toggleC2EState2()' on-change-value='$ctrl.checkC2EValue2()' on-icon-click='$ctrl.toggleC2EState2()' placeholder='&#39;Edit me&#39;' show-button='!$ctrl.c2eState2' show-header='false' show-icon='$ctrl.c2eState2' value='$ctrl.c2eValue2'></c2-text-input>\n<c2-text-input label='C2M input (mobile)' mobile='true' on-toggle='$ctrl.maskChange()' value-tooltip='hidden_item' value='$ctrl.richTextMobile'></c2-text-input>\n</cc-panel-frame>\n<cc-panel-frame class='-with-p16a-header -with-control-higlights' label='Sliders' ng-if='$ctrl.isVisible(&#39;Sliders&#39;)' on-close='$ctrl.close()' on-return='$ctrl.return()' show-close-button='true' show-return-button='!$ctrl.ccFlags.cardsToPanels'>\n<c16-slider label='' max='100' min='0' on-value-change='$ctrl.onSliderValueChange(&quot;slider component&quot;, value)' step='1' stepper='false' units='&#39;%&#39;' value='$ctrl.sliders.values[0]'></c16-slider>\n<c16-slider help-tooltip='playground.tooltip' label='Stepper' max='100' min='0' on-value-change='$ctrl.onSliderValueChange(&quot;stepper&quot;, value)' show-help-button='true' step='25' stepper='true' value='$ctrl.sliders.values[1]'></c16-slider>\n<c16-slider category-labels='$ctrl.sliders.categoryLabels' category-title='Size' clickable-icons='true' horizontal='false' icon-after='design:font-size-large' icon-before='design:font-size-small' max='3' min='-3' on-value-change='$ctrl.onSliderValueChange(&quot;slider with icons changed&quot;, value)' show-divider='true' slider-type='p5a' step='1' stepper='true' value='$ctrl.sliders.values[2]'></c16-slider>\n<c16-slider category-labels='$ctrl.sliders.categoryLabels' category-title='Size' clickable-icons='true' horizontal='true' icon-after='design:font-size-large' icon-before='design:font-size-small' label='Horizontal slider' max='3' min='-3' on-value-change='$ctrl.onSliderValueChange(&quot;Horizontal slider changed&quot;, value)' show-divider='true' slider-type='p5a' step='1' stepper='true' value='$ctrl.sliders.values[3]'></c16-slider>\n<c16-slider category-labels='$ctrl.sliders.categoryLabels' category-title='Size' clickable-icons='true' horizontal='true' icon-after='design:font-size-large' icon-before='design:font-size-small' max='3' min='-3' on-value-change='$ctrl.onSliderValueChange(&quot;Horizontal slider without a label changed&quot;, value)' show-divider='true' slider-type='p5a' step='1' stepper='true' value='$ctrl.sliders.values[4]'></c16-slider>\n</cc-panel-frame>\n<cc-panel-frame class='-with-p16b-header' label='New Media Preview' ng-if='$ctrl.isVisible(&#39;New Media Preview&#39;)' on-return='$ctrl.return()' show-return-button='!$ctrl.ccFlags.cardsToPanels'>\n<div class='p8-label cc-panel-content'>%c24-media-preview</div>\n<br>\n<div class='p8-label cc-panel-content'>basic</div>\n<c24-media-preview current-media='$ctrl.currentMedia' disable-media-change-button='$ctrl.disableMediaChangeButton' label='Awesome label' on-info='alert(&#39;info&#39;)' on-media-change='$ctrl.onMediaChange(mediaType)' on-media-type-change='$ctrl.onMediaTypeChange(mediaType)' show-edit-panel='false' show-header='true' show-tabs='false'></c24-media-preview>\n<div class='p8-label cc-panel-content'>big</div>\n<c24-media-preview color-button-text='Color' current-media='$ctrl.currentMedia2' current-tab='6' disable-media-change-button='$ctrl.disableMediaChangeButton' on-info='alert(&#39;info&#39;)' on-media-change='$ctrl.onMediaChange(mediaType)' on-toggle='$ctrl.onMediaPreviewToggled(visibility)' organize-media-button-text='Organize Media' show-edit-panel='false' show-tabs='true' size='big' visible-tabs='$ctrl.c24VisibleTabs'></c24-media-preview>\n<div class='p8-label cc-panel-content'>big + customize</div>\n<c24-media-preview color-button-text='Color' current-media='$ctrl.currentMedia2' current-tab='6' disable-media-change-button='$ctrl.disableMediaChangeButton' on-info='alert(&#39;info&#39;)' on-media-change='$ctrl.onMediaChange(mediaType)' on-toggle='$ctrl.onMediaPreviewToggled(visibility)' organize-media-button-text='Organize Media' show-customize='true' show-edit-panel='false' show-tabs='true' size='big' visible-tabs='$ctrl.c24VisibleTabs'></c24-media-preview>\n<div class='p8-label cc-panel-content'>logo</div>\n<c24-media-preview current-media='$ctrl.currentMediaLogo' current-tab='4' on-info='alert(&#39;info&#39;)' organize-media-button-text='Organize Media' show-edit-panel='false' show-tabs='true' visible-tabs='$ctrl.c24VisibleTabsLogo'></c24-media-preview>\n<div class='p8-label cc-panel-content'>replace with opetions</div>\n<c24-media-preview current-media='$ctrl.currentMedia2' current-tab='6' on-info='alert(&#39;info&#39;)' on-toggle='$ctrl.onMediaPreviewToggled(visibility)' replace-button-text='replace' replace-options='true' show-customize='false' show-edit-panel='false' show-tabs='true' size='big' visible-tabs='$ctrl.c24VisibleTabs'>\n<options>\n<div>replace with opetions</div>\n<div>replace with opetions</div>\n<div>replace with opetions</div>\n</options>\n</c24-media-preview>\n<p0-spacer></p0-spacer>\n</cc-panel-frame>\n<cc-panel-frame class='-with-p16b-header' label='Media Preview' ng-if='$ctrl.isVisible(&#39;Media Preview&#39;)' on-return='$ctrl.return()' show-return-button='!$ctrl.ccFlags.cardsToPanels'>\n<c4-media-preview current-tab='0' disable-media-change-button='$ctrl.disableMediaChangeButton' dont-crop-toggle-text='Show Entire Image' dont-crop='true' media='$ctrl.media' on-dont-crop-change='$ctrl.maskChange(value)' on-info='alert(&#39;info&#39;)' on-media-change='$ctrl.onMediaChange(mediaType)' on-toggle='$ctrl.onMediaPreviewToggled(visibility)' show-dont-crop='true' show-edit-panel='false' show-tabs='true' visible-tabs='[0,1,2]'></c4-media-preview>\n<p0-spacer></p0-spacer>\n<c4-media-preview current-tab='3' disable-media-change-button='$ctrl.disableMediaChangeButton' media='$ctrl.media' on-info='alert(&#39;info&#39;)' on-media-change='$ctrl.onMediaChange(mediaType)' on-toggle='$ctrl.onMediaPreviewToggled(visibility)' show-edit-panel='false' show-tabs='true' visible-tabs='[3,4,5]'></c4-media-preview>\n<p0-spacer></p0-spacer>\n<c4-media-preview current-tab='0' disable-media-change-button='true' media='$ctrl.media' on-info='alert(&#39;info&#39;)' on-toggle='$ctrl.onMediaPreviewToggled(visibility)' show-edit-panel='false' show-tabs='false' type='c4m'></c4-media-preview>\n</cc-panel-frame>\n<cc-panel-frame class='-with-control-higlights' label='Lists 1' ng-if='$ctrl.isVisible(&#39;Lists 1&#39;)'>\n<c6-list help-tooltip='playground.tooltip' item-type='p10' items='$ctrl.listItems' label='C6 list of P10 (draggable) items' on-is-valid='$ctrl.customDraggableItemValidation(item)' on-order-change='$ctrl.onListOrderChange(event)' show-help-button='true'></c6-list>\n<c6-list item-type='p10a' items='$ctrl.listItemsA' label='C6 list of P10a (section states)' on-edit='$ctrl.listItemP10aEdit(item)' on-is-valid='$ctrl.customDraggableItemValidation(item)' on-item-click='$ctrl.listItemP10aClick(item)' on-order-change='$ctrl.onListOrderChange(event)'></c6-list>\n<c6-list item-type='p10b' items='$ctrl.listItemsB' label='C6 list of P10b (editable)' on-is-valid='$ctrl.customDraggableItemValidation(item)' on-order-change='$ctrl.onListOrderChange(event)'></c6-list>\n<c6-list item-type='p10c' items='$ctrl.listItemsC' label='C6 list of P10c (noneditable)' on-is-valid='$ctrl.customDraggableItemValidation(item)' on-order-change='$ctrl.onListOrderChange(event)'></c6-list>\n<c6-list item-type='p10m' items='$ctrl.listItemsM' label='C6 list of P10m' on-is-valid='$ctrl.customDraggableItemValidation(item)' on-order-change='$ctrl.onListOrderChange(event)'></c6-list>\n<c6-list add-new-title='Add Item Custom Label' disable-list-link='true' disable-toggle='false' item-type='p10l' items='$ctrl.listItemsL' label='C6 list of P10l' on-is-valid='$ctrl.customDraggableItemValidation(item)' on-order-change='$ctrl.onListOrderChange(event)'></c6-list>\n<c6-list add-new-title='Add Item Custom Label' disable-list-link='false' disable-toggle='false' item-type='p10l' items='[$ctrl.listItemsL[0]]' label='C6 list of P10l' on-is-valid='$ctrl.customDraggableItemValidation(item)' on-order-change='$ctrl.onListOrderChange(event)'></c6-list>\n</cc-panel-frame>\n<cc-panel-frame class='-with-control-higlights' label='Lists 2' ng-if='$ctrl.isVisible(&#39;Lists 2&#39;)'>\n<c6-list invalid-tooltip='&#39;playground.simple&#39;' item-type='p10d' items='$ctrl.listItemsD' label='C6 list of P10d (social links)' on-is-valid='$ctrl.customDraggableItemValidation(item)' on-order-change='$ctrl.onListOrderChange(event)'></c6-list>\n<c6-list invalid-tooltip='&#39;playground.simple&#39;' item-type='p10d' items='$ctrl.listItemsD' label-filter='$ctrl.labelFilter' label='C6 list of P10d (social links) - with filter on the labels (show only the first letter)' on-is-valid='$ctrl.customDraggableItemValidation(item)' on-order-change='$ctrl.onListOrderChange(event)'></c6-list>\n<c6-list item-type='p10e' items='$ctrl.listItemsE' label='C6 list of P10e (social share)' on-is-valid='$ctrl.customDraggableItemValidation(item)' on-order-change='$ctrl.onListOrderChange(event)'></c6-list>\n<div class='p8-label'>cc-menu-item:</div>\n<cc-menu-item icon='cc-icon-edit' label='with cc-icon'></cc-menu-item>\n<cc-menu-item label='with cc-svg-icon' svg-icon='coloration:magic-wand'></cc-menu-item>\n<cc-menu-item label='with cc-svg-icon and a hover icon' svg-icon-hover='coloration:light' svg-icon='coloration:dark'></cc-menu-item>\n<cc-menu-item label='with complex cc-svg-icon and a hover icon' svg-icon-from-inline='true' svg-icon-hover='design:listbg_hover' svg-icon='design:listbg'></cc-menu-item>\n<div class='p8-label'>cc-menu-item with overrideColor:</div>\n<cc-menu-item icon='cc-icon-edit' label='with cc-icon and color override' override-color='red'></cc-menu-item>\n<cc-menu-item highlight-color='#b0b3b7' icon='cc-icon-edit' label='with cc-icon and color override and highlight' override-color='green' override-hover-color='white'></cc-menu-item>\n<cc-menu-item highlight-color='#b0b3b7' label='with cc-svg-icon and color override and highlight' override-color='green' override-hover-color='white' svg-icon='coloration:magic-wand'></cc-menu-item>\n</cc-panel-frame>\n<cc-panel-frame class='-with-p16a-header -with-control-higlights' label='e2e - key catcher' ng-if='$ctrl.isVisible(&#39;e2e - key catcher&#39;)' on-close='$ctrl.close()' on-return='$ctrl.return()' show-close-button='true' show-return-button='!$ctrl.ccFlags.cardsToPanels'>\n<div ng-keydown='$ctrl.keyCatcher($event)'>\n<div id='keyCatcherOutput'>{{ $ctrl.keyCatcherOutput }}</div>\n<c2-text-input is-disabled='false' label='C2 Regular Input' on-change-value='$ctrl.valueChange(value)' value='$ctrl.c2ValueForE2E'></c2-text-input>\n<c23-rich-text-input label='C23 Rich Text Input' on-change-value='$ctrl.valueChange(value)' styles-manager='$ctrl.richTextStylesManager' value='$ctrl.c23ValueForE2E'></c23-rich-text-input>\n</div>\n</cc-panel-frame>\n<cc-panel-frame class='-with-p16b-header' label='Misc 1' ng-if='$ctrl.isVisible(&#39;Misc 1&#39;)' on-return='$ctrl.return()' show-return-button='!$ctrl.ccFlags.cardsToPanels'>\n<c17-tabs items='$ctrl.tabsItems' on-item-change='$ctrl.onTabsItemChange(item)'></c17-tabs>\n<c8-label-action action-text='&#39;Action text&#39;' label='Label with text action' on-action-click='$ctrl.onActionClick()'></c8-label-action>\n<c8b-label-graphic help-tooltip='playground.tooltip' item-validator='$ctrl.validateGraphicItems(item)' items='$ctrl.labelGraphicItems' label='Label with Graphic actions' paragraph='&quot;line1&lt;br/&gt;line2&quot;' show-help-button='true'></c8b-label-graphic>\n<cc-generic-menu-item click-handler='$ctrl.genericMenuItemClick()' label='Generic menu item'></cc-generic-menu-item>\n<c5-link-input help-tooltip='playground.tooltip' hide-link-on-toggle='true' hide-toggle='true' label='Link' link='{value:&#39;https://www.wix.com/website/templates&#39;,state:false}' show-help-button='true'></c5-link-input>\n<c10-item-navigation count='4' current='$ctrl.currentStep' next-tooltip='playground.next' previous-tooltip='playground.previous'></c10-item-navigation>\n<c11-paragraph html='$ctrl.singleLine'></c11-paragraph>\n<c11-paragraph class='style-d' html='$ctrl.singleLine'></c11-paragraph>\n<c11-paragraph html='$ctrl.richText'></c11-paragraph>\n<c11-paragraph class='error' html='$ctrl.richText'></c11-paragraph>\n<c7-multi-field-group help-tooltip='playground.tooltip' label='multi field group label' on-toggle='$ctrl.onGroupToggled(visibility)' show-help-button='true'>\n<c2-text-input label='Text input inside group' value='&#39;edit me&#39;'></c2-text-input>\n</c7-multi-field-group>\n<cc-panel-footer>\n<c10-item-navigation count='4' current='$ctrl.currentStep' next-tooltip='playground.next' previous-tooltip='playground.previous'></c10-item-navigation>\n</cc-panel-footer>\n</cc-panel-frame>\n<cc-panel-frame class='-with-p16b-header' label='Misc 2' ng-if='$ctrl.isVisible(&#39;Misc 2&#39;)' on-return='$ctrl.return()' show-return-button='!$ctrl.ccFlags.cardsToPanels'>\n<cc-button-editor link='{value:&#39;None&#39;,state:false}' on-toggle='$ctrl.onGroupToggled(visibility)' text='&#39;Click Me!&#39;'></cc-button-editor>\n<cc-button-editor-link is-linked='false' on-toggle='$ctrl.onGroupToggled(visibility)' text='&#39;Click Me!&#39;'></cc-button-editor-link>\n<cc-button-editor-link is-linked='true' on-toggle='$ctrl.onGroupToggled(visibility)' text='&#39;Click Me!&#39;'></cc-button-editor-link>\n<c26-image-position body='Choose what part of&lt;br&gt;the image will be visible.' footer-content-text='Footer' footer-link='$ctrl.goToPreview()' header-title='Title' on-close='$ctrl.hideDropDown()' on-position-clicked='$ctrl.positionClicked({index})' rectangles-count-each-row='3' rectangles-count='9' selected-rectangle='2' show-footer='true'></c26-image-position>\n<c3-dropdown-list container-class='my-container-class' help-tooltip='playground.tooltip' items='$ctrl.dropdownListItems' label-key='label' label='C3 Dropdown list' on-selection-change='$ctrl.onDropdownListSelectionChange(item)' placeholder='test' show-help-button='true' show-titles='true' value='$ctrl.selectedDropDownItem'></c3-dropdown-list>\n<c3-dropdown-list class='gray-label' container-class='my-container-class' help-tooltip='playground.tooltip' items='$ctrl.dropdownListItems' label-key='label' label='C3 Dropdown list Gray label' on-selection-change='$ctrl.onDropdownListSelectionChange(item)' placeholder='test' show-help-button='true' show-titles='true' value='$ctrl.selectedDropDownItem'></c3-dropdown-list>\n<c3-dropdown-list button-text='&quot;hit me&quot;' button-tooltip='&quot;playground.tooltip&quot;' container-class='my-container-class' help-tooltip='playground.tooltip' items='$ctrl.dropdownListItems' label-key='label' label='C3 Dropdown list with button' on-button-click='$ctrl.onC3ButtonClick()' on-selection-change='$ctrl.onDropdownListSelectionChange(item)' placeholder='test' show-button='true' show-help-button='true' show-titles='true' value='$ctrl.selectedDropDownItem'></c3-dropdown-list>\n<c3-dropdown-list button-text='&quot;toggle&quot;' container-class='my-container-class' disable-toggle='true' dont-open-for-one='true' items='$ctrl.singleOptionDropdownOptions' label-key='label' label='C3 Dropdown list with 1 item' no-hover='true' on-button-click='$ctrl.toggleDropdownItems()' show-button='true' show-titles='true' value='$ctrl.singleOptionDropdownOptions[0]'></c3-dropdown-list>\n<c3-dropdown-list always-show-select='true' container-class='my-container-class' disable-toggle='true' dont-open-for-one='true' items='$ctrl.singleOptionDropdownOptions' label-key='label' label='C3 Dropdown list with 1 item shows always' link-title='new item' no-hover='true' on-link-click='$ctrl.onDropdownListSelectionChange(&#39;link clicked&#39;)' show-titles='true' value='$ctrl.singleOptionDropdownOptions[0]'></c3-dropdown-list>\n<c12-thumbnails label='{{ $ctrl.c12Thumbnails.label }}' on-select='$ctrl.c12Thumbnails.onSelect(item)' thumbnails='$ctrl.c12Thumbnails.thumbnails'></c12-thumbnails>\n<div class='p8-label'>%c20-graphic-radio-control</div>\n<c20-graphic-radio-control label='Graphic Radio Control - Big' radio-items='$ctrl.c20GraphicRadioControl.radioElements' size='big'></c20-graphic-radio-control>\n<c20-graphic-radio-control label='G. Radio Control - Small &amp; Selected' radio-items='$ctrl.c20GraphicRadioControl.radioElements' selected-radio='$ctrl.c20GraphicRadioControl.radioElements[1]' size='small'></c20-graphic-radio-control>\n<c20-graphic-radio-control header-toggle-active='true' help-tooltip='playground.tooltip' label='G. Radio C. - Help &amp; toggle' radio-items='$ctrl.c20GraphicRadioControl.radioElements' show-help-button='true' show-toggle-button='true' size='small'></c20-graphic-radio-control>\n</cc-panel-frame>\n<cc-panel-frame class='-with-p16b-header' label='Misc 3' ng-if='$ctrl.isVisible(&#39;Misc 3&#39;)' on-return='$ctrl.return()' show-return-button='!$ctrl.ccFlags.cardsToPanels'>\n<c15-radio-buttons help-tooltip='playground.tooltip' items='$ctrl.radioButtons' label='Radio' on-value-change='$ctrl.onRadioValueChange(&quot;component&quot;, value)' show-help-button='true' value='$ctrl.radioValue'></c15-radio-buttons>\n<c19-toggle help-tooltip='playground.tooltip' label='Toggle type c19a' on-value-change='$ctrl.onToggleValueChange(value)' type='c19a' value='$ctrl.toggleValue'></c19-toggle>\n<c19-toggle label='Toggle type c19a long long long long' on-value-change='$ctrl.onToggleValueChange(value)' toggle-tooltip='playground.tooltip' type='c19a' value='$ctrl.toggleValue'></c19-toggle>\n<c19-toggle label='Toggle type c19b' on-value-change='$ctrl.onToggleValueChange(value)' type='c19b' value='$ctrl.toggleValue'></c19-toggle>\n<c19-toggle help-tooltip='playground.tooltip' label='Toggle type c19b long long long long' on-value-change='$ctrl.onToggleValueChange(value)' type='c19b' value='$ctrl.toggleValue'></c19-toggle>\n<c19-toggle label='Toggle type c19m' left-icon='$ctrl.toggleLeftIcon' on-value-change='$ctrl.onToggleValueChange(value)' right-icon='$ctrl.toggleRightIcon' toggle-tooltip='playground.tooltip' type='c19m' value='$ctrl.toggleValue'></c19-toggle>\n<c19-toggle label='Toggle type c19c' left-icon='$ctrl.toggleLeftIcon' on-value-change='$ctrl.onToggleValueChange(value)' right-icon='$ctrl.toggleRightIcon' toggle-tooltip='playground.tooltip' type='c19c' value='$ctrl.toggleValue'></c19-toggle>\n<c19-toggle help-tooltip='playground.tooltip' label='Toggle type c19c long long long long' left-icon='$ctrl.toggleLeftIcon' on-value-change='$ctrl.onToggleValueChange(value)' right-icon='$ctrl.toggleRightIcon' type='c19c' value='$ctrl.toggleValue'></c19-toggle>\n<c14-checkbox item='$ctrl.checkbox' on-toggle='$ctrl.onCheckboxToggle(item)'></c14-checkbox>\n<c13-checkbox-list items='$ctrl.checkboxItems' label='Checkbox' on-item-change='$ctrl.onCheckboxListItemChange(item)'></c13-checkbox-list>\n<div class='p8-label'>%c25-background-preview</div>\n<c25-background-preview data='{type: &#39;color&#39;, value: &#39;#000&#39;}' label='awesome background' on-edit='$ctrl.backgroundPreviewEdit()'></c25-background-preview>\n</cc-panel-frame>\n<cc-panel-frame label='Popups, tips, modals' ng-if='$ctrl.isVisible(&#39;Popups, tips, modals&#39;)'>\n<div class='cc-panel-content' ignore-this-element-and-dont-use-it-in-your-code-its-only-for-the-playground>\n<div class='p8-label'>Tips</div>\n<button class='cc-x-height p9b-text-button -medium' ng-click='$ctrl.displayTip()'>\n<div class='cc-x-height'>Show Tip</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='cc-x-height p9b-text-button -medium' ng-click='$ctrl.updateTipContent()'>\n<div class='cc-x-height'>Update current Tip content</div>\n</button>\n<p0-spacer></p0-spacer>\n<p17-divider></p17-divider>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>Default popups</div>\n<p0-spacer></p0-spacer>\n<button class='cc-x-height p9-primary -medium -purple' ng-click='$ctrl.displayModal({ popup: &#39;showFirstTimeNotice&#39;, model: &#39;firstTimeNotice&#39; })'>\n<div class='cc-x-height'>First time notice</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='cc-x-height p9-primary -medium' ng-click='$ctrl.displayModal({ popup: &#39;showPositiveConfirmation&#39;, model: &#39;positiveConfirmation&#39; })'>\n<div class='cc-x-height'>Positive confirmation</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='cc-x-height p9-primary -medium -red' ng-click='$ctrl.displayModal({ popup: &#39;showNegativeConfirmation&#39;, model: &#39;negativeConfirmation&#39; })'>\n<div class='cc-x-height'>Negative confirmation</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='cc-x-height p9-primary -medium' ng-click='$ctrl.displayModal({ popup: &#39;showPositiveContinuedAction&#39;, model: &#39;continuedAction&#39; })'>\n<div class='cc-x-height'>Positive continued action</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='cc-x-height p9-primary -medium -red' ng-click='$ctrl.displayModal({ popup: &#39;showNegativeContinuedAction&#39;, model: &#39;continuedAction&#39; })'>\n<div class='cc-x-height'>Negative continued action</div>\n</button>\n<p0-spacer></p0-spacer>\n<button class='cc-x-height p9-primary -medium' ng-click='$ctrl.displayModal({ popup: &#39;showMultiPagePopup&#39;, model: &#39;multiPagePopup&#39; })'>\n<div class='cc-x-height'>Multi page popup</div>\n</button>\n<p0-spacer></p0-spacer>\n<p17-divider></p17-divider>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>Iframe display</div>\n<p0-spacer></p0-spacer>\n<button class='cc-x-height p9-primary -medium' ng-click='$ctrl.onOpenIframe()'>Open Iframe</button>\n<p0-spacer></p0-spacer>\n<button class='cc-x-height p9-primary -medium' ng-click='$ctrl.onOpenSupportIframe()'>Open Support Iframe</button>\n<p0-spacer></p0-spacer>\n<p17-divider></p17-divider>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>Tooltips</div>\n<p0-spacer></p0-spacer>\n<button cc-tooltip-position='right' cc-tooltip='playground.simple' class='c9-cta cc-x-height'>\nSimple tooltip\n</button>\n<p0-spacer></p0-spacer>\n<button cc-tooltip-position='bottom' cc-tooltip='playground.complex' class='c9-cta cc-x-height'>\nRich tooltip\n</button>\n<p0-spacer></p0-spacer>\n<button cc-tooltip-options='{{ {delay: 0, offsetX: 60} }}' cc-tooltip-position='bottom' cc-tooltip='playground.complex' class='c9-cta cc-x-height'>\nCustom options tooltip\n</button>\n<p0-spacer></p0-spacer>\n<button cc-tooltip-position='bottom' cc-tooltip='playground.compile' class='c9-cta cc-x-height'>\nCompiled tooltip\n</button>\n<p0-spacer></p0-spacer>\n<p17-divider></p17-divider>\n<p0-spacer></p0-spacer>\n</div>\n</cc-panel-frame>\n<cc-panel-frame label='Popups, tips, modals 2' ng-if='$ctrl.isVisible(&#39;Popups, tips, modals&#39;)'>\n<div class='cc-panel-content' ignore-this-element-and-dont-use-it-in-your-code-its-only-for-the-playground>\n<div class='p8-label'>Visible Tooltips</div>\n<p0-spacer></p0-spacer>\n<cc-visible-tooltip displayed-r-t-t-sections='$ctrl.displayedRTTSections' on-link-command='$ctrl.simulateRichTextLinkDialog(linkId)' type='rich'></cc-visible-tooltip>\n<p0-spacer></p0-spacer>\n<cc-visible-tooltip displayed-r-t-t-sections='$ctrl.displayedRTTSections' on-link-command='$ctrl.simulateRichTextLinkDialog(linkId)' type='hint'></cc-visible-tooltip>\n</div>\n</cc-panel-frame>\n<cc-panel-frame label='{{iconsPage.label}}' ng-if='$ctrl.isVisible(iconsPage.label)' ng-repeat='iconsPage in $ctrl.iconsPages'>\n<table class='playground-table'>\n<thead>\n<tr>\n<td class='p8-label' width='150'>css</td>\n<td class='p8-label' width='150'>normal</td>\n<td class='p8-label'>circle</td>\n<td class='p8-label'>white</td>\n<td class='p8-label'>disabled</td>\n</tr>\n</thead>\n<tbody>\n<tr ng-repeat='icon in iconsPage.icons'>\n<td>cc-icon-{{icon}}</td>\n<td>\n<i class='cc-icon-{{icon}}'></i>\n</td>\n<td class='bg'>\n<i class='cc-icon-circle cc-icon-{{icon}}'></i>\n</td>\n<td class='bg'>\n<i class='cc-icon-white cc-icon-{{icon}}'></i>\n</td>\n<td>\n<i class='cc-icon-{{icon}}' disabled='disabled'></i>\n</td>\n</tr>\n</tbody>\n</table>\n</cc-panel-frame>\n<cc-panel-frame label='SVG Icons' ng-if='$ctrl.isVisible(&#39;svg-icons&#39;)'>\n<table class='playground-table'>\n<tr>\n<td class='p8-label' style='width:100px'>name</td>\n<td class='p8-label' style='width:100px'>normal</td>\n<td class='p8-label' style='width:100px'>active</td>\n<td class='p8-label' style='width:100px'>disabled</td>\n</tr>\n<tr ng-repeat='icon in $ctrl.svgIcons'>\n<td>\n{{icon}}\n</td>\n<td>\n<cc-svg-icon class='cc-svg-icon-circle' icon='{{icon}}'></cc-svg-icon>\n</td>\n<td>\n<cc-svg-icon class='cc-svg-icon-circle -active' icon='{{icon}}'></cc-svg-icon>\n</td>\n<td>\n<cc-svg-icon class='cc-svg-icon-circle' disabled icon='{{icon}}'></cc-svg-icon>\n</td>\n</tr>\n</table>\n<p22-rich-text-toolbar command-state='$ctrl.getRTTCommandState(command)' displayed-sections='$ctrl.displayedRTTSections2' is-disabled='$ctrl.isRTTCommandDisabled(command)' on-click='$ctrl.toggleRTTCommand(command)'></p22-rich-text-toolbar>\n<c22-edit-text-toolbar align-state='$ctrl.getETTAlign()' command-state='$ctrl.getRTTCommandState(command)' displayed-sections='$ctrl.displayedRTTSections2' is-disabled='$ctrl.isRTTCommandDisabled(command)' on-align-click='$ctrl.setETTAlign(align)' on-click='$ctrl.toggleRTTCommand(command)'></c22-edit-text-toolbar>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n</cc-panel-frame>\n<cc-panel-frame label='Complex SVG Icons' ng-if='$ctrl.isVisible(&#39;complex-svg-icons&#39;)'>\n<div class='cc-panel-content' ignore-this-element-and-dont-use-it-in-your-code-its-only-for-the-playground>\n<div class='p8-label'>Other complex icons</div>\n<div ng-repeat='icon in $ctrl.complexSvgIcons'>\n<cc-svg-icon from-inline='true' icon='{{icon}}'></cc-svg-icon>\n{{icon}}\n</div>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n</div>\n</cc-panel-frame>\n<cc-panel-frame label='Graphic Buttons' ng-if='$ctrl.isVisible(&#39;graphic-buttons&#39;)'>\n<div class='cc-panel-content' ignore-this-element-and-dont-use-it-in-your-code-its-only-for-the-playground>\n<div class='p8-label'>Animation icons</div>\n<div class='cc-primitives-in-row align-top flex-wrap'>\n<c20-graphic-radio icon='&#39;animation:&#39; + icon' label='icon' ng-repeat-start='icon in $ctrl.animationIcons'></c20-graphic-radio>\n<c20-graphic-radio icon='&#39;animation:&#39; + icon + &#39;Selected&#39;' is-selected='true' label='icon + &#39;Selected&#39;' ng-repeat-end=''></c20-graphic-radio>\n</div>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>Background image options</div>\n<div class='cc-primitives-in-row align-top flex-wrap'>\n<c20-graphic-radio icon='&#39;background-options:&#39; + icon' label='icon' ng-repeat-start='icon in $ctrl.backgroundImageOptionsIcons'></c20-graphic-radio>\n<c20-graphic-radio icon='&#39;background-options:&#39; + icon + &#39;Selected&#39;' is-selected='true' label='icon + &#39;Selected&#39;' ng-repeat-end=''></c20-graphic-radio>\n</div>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>Pro-Gallery icons</div>\n<div class='cc-primitives-in-row align-top flex-wrap'>\n<c20-graphic-radio complex='false' icon='&#39;pro-gallery:1x1&#39;' label='&#39;1x1&#39;' small='true'></c20-graphic-radio>\n<c20-graphic-radio complex='false' icon='&#39;pro-gallery:3x4&#39;' is-selected='true' label='&#39;3x4&#39;' small='true'></c20-graphic-radio>\n<c20-graphic-radio complex='false' icon='&#39;pro-gallery:4x3&#39;' label='&#39;4x3&#39;' small='true'></c20-graphic-radio>\n<c20-graphic-radio complex='false' icon='&#39;pro-gallery:9x16&#39;' label='&#39;9x16&#39;' small='true'></c20-graphic-radio>\n<c20-graphic-radio complex='false' icon='&#39;pro-gallery:16x9&#39;' label='&#39;16x9&#39;' small='true'></c20-graphic-radio>\n</div>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>Alignment</div>\n<div class='cc-primitives-in-row align-top flex-wrap'>\n<c20-graphic-radio complex='false' icon='&#39;alignment:AlignLeft&#39;' label='&#39;left&#39;' small='true'></c20-graphic-radio>\n<c20-graphic-radio complex='false' icon='&#39;alignment:AlignCenter&#39;' is-selected='true' label='&#39;center&#39;' small='true'></c20-graphic-radio>\n<c20-graphic-radio complex='false' icon='&#39;alignment:AlignRight&#39;' label='&#39;right&#39;' small='true'></c20-graphic-radio>\n<c20-graphic-radio complex='false' icon='&#39;alignment:AlignRight&#39;' label='&#39;right&#39;' small='true'></c20-graphic-radio>\n</div>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>Split</div>\n<div class='cc-primitives-in-row align-top flex-wrap'>\n<c20-graphic-radio complex='false' icon='&#39;split:ParagraphMerge&#39;' label='&#39;merge&#39;' small='true'></c20-graphic-radio>\n<c20-graphic-radio complex='false' icon='&#39;split:ParagraphSplit  &#39;' is-selected='true' label='&#39;split&#39;' small='true'></c20-graphic-radio>\n</div>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>Coloration Modes</div>\n<div class='cc-primitives-in-row align-top flex-wrap'>\n<c20-graphic-radio complex='true' icon='&#39;coloration-modes:Light&#39;' label='&#39;Light&#39;' small='true'></c20-graphic-radio>\n<c20-graphic-radio complex='true' icon='&#39;coloration-modes:Dark&#39;' label='&#39;Dark&#39;' small='true'></c20-graphic-radio>\n<c20-graphic-radio complex='true' icon='&#39;coloration-modes:Mixed&#39;' is-selected='true' label='&#39;Mixed&#39;' small='true'></c20-graphic-radio>\n</div>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>Coloration Levels</div>\n<div class='cc-primitives-in-row align-top flex-wrap'>\n<c20-graphic-radio complex='true' icon='&#39;coloration-levels:NoColorx10&#39;' label='&#39;Plain&#39;' small='true'></c20-graphic-radio>\n<c20-graphic-radio complex='true' icon='&#39;coloration-levels:SoftTintx10&#39;' label='&#39;Tinted&#39;' small='true'></c20-graphic-radio>\n<c20-graphic-radio complex='true' icon='&#39;coloration-levels:Colorfulx10&#39;' label='&#39;Colorful&#39;' small='true'></c20-graphic-radio>\n<c20-graphic-radio complex='true' icon='&#39;coloration-levels:Vibrantx10&#39;' is-selected='true' label='&#39;Vibrant&#39;' small='true'></c20-graphic-radio>\n</div>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>Header Design</div>\n<div class='cc-primitives-in-row align-top flex-wrap'>\n<c20-graphic-radio hover-img-url='&#39;/images/animated/header-design/x2/&#39; + icon + &#39;.gif&#39;' icon='&#39;header-design:&#39; + icon' label='icon' ng-repeat='icon in $ctrl.headerDesign'></c20-graphic-radio>\n<c20-graphic-radio disabled-icon='&#39;header-design:transparent-disabled&#39;' hover-img-url='&#39;/images/animated/header-design/x2/transparent-disabled.gif&#39;' icon='&#39;header-design:transparent&#39;' label='&#39;transparent-disabled&#39;' ng-disabled='true'></c20-graphic-radio>\n</div>\n</div>\n</cc-panel-frame>\n<cc-panel-frame label='image positions' ng-if='$ctrl.isVisible(&#39;image positions&#39;)'>\n<div class='cc-panel-content'>\n<div class='p8-label'>Image positions (3X3)</div>\n<div class='cc-primitives-in-row'>\n<div class='rectangles-container'>\n<p26-image-position letter-of-selected='T' rectangles-count-each-row='3' rectangles-count='9' selected-rectangle='2'></p26-image-position>\n</div>\n</div>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<p0-spacer></p0-spacer>\n<div class='p8-label'>Image positions (2X2)</div>\n<div class='cc-primitives-in-row'>\n<div class='rectangles-container'>\n<p26-image-position rectangles-count-each-row='2' rectangles-count='4' selected-rectangle='1'></p26-image-position>\n</div>\n</div>\n</div>\n<div class='cc-panel-content'>\n<div class='p8-label'>Font-Resize active</div>\n<c27-increase-decrease current-index='$ctrl.currentIndex' max-index='$ctrl.maxIndex2'></c27-increase-decrease>\n<div class='p8-label'>Font-Resize disable</div>\n<c27-increase-decrease current-index='$ctrl.currentIndex' max-index='$ctrl.maxIndex'></c27-increase-decrease>\n</div>\n</cc-panel-frame>\n<cc-panel-frame class='-with-p16a-header' help-tooltip='playground.tooltip' label='Panel Frame that can disabled scroll' ng-if='$ctrl.isVisible(&#39;Disabled Scroll Panel Frame&#39;)' on-close='$ctrl.close()' on-help='$ctrl.help()' scroll-disabled='$ctrl.scrollDisabled' show-close-button='true' show-return-button='!$ctrl.ccFlags.cardsToPanels'>\n<cc-panel-fixed-top></cc-panel-fixed-top>\n<c11-paragraph html='&quot;&lt;p&gt;&lt;strong&gt;Panel Header&lt;/strong&gt;&lt;/p&gt;Each panel frame comes with an integrated header. The header can be configured via the attributes &amp;quot;API&amp;quot; (see examples in this playground). In addition, there are 3 variations of the header: the default one, &lt;code&gt;p16a&lt;/code&gt; (with return button on the left) and &lt;code&gt;p16b&lt;/code&gt; (for narrow sub panels). Use them by applying one of these specific classes to &lt;code&gt;&amp;lt;cc-panel-frame&amp;gt;&lt;/code&gt;: &lt;code&gt;-with-p16a-header&lt;/code&gt; and &lt;code&gt;-with-p16b-header&lt;/code&gt;.&quot;'></c11-paragraph>\n<c11-paragraph html='&quot;&lt;p&gt;&lt;strong&gt;Panel Fixed Top&lt;/strong&gt;&lt;/p&gt;The panel is scrollable, but it may have a fixed area on the top. To include a fixed top area in your panel frame, add the &lt;code&gt;&amp;lt;cc-panel-fixed-top&amp;gt&lt;/code&gt; element with desired content inside it. It looks like &lt;strong&gt;Panel Frame&lt;/strong&gt; paragraph above.&quot;'></c11-paragraph>\n<c11-paragraph html='&quot;&lt;p&gt;&lt;strong&gt;Panel Footer&lt;/strong&gt;&lt;/p&gt;The footer is not built-in to the panel frame and is optional. To include a footer in your panel frame, simply add the &lt;code&gt;&amp;lt;cc-panel-footer&amp;gt&lt;/code&gt; element with your element of choice inside it (usually a button primitive).&quot;'></c11-paragraph>\n<c11-paragraph html='&quot;&lt;p&gt;&lt;strong&gt;Panel Footer&lt;/strong&gt;&lt;/p&gt;The footer is not built-in to the panel frame and is optional. To include a footer in your panel frame, simply add the &lt;code&gt;&amp;lt;cc-panel-footer&amp;gt&lt;/code&gt; element with your element of choice inside it (usually a button primitive).&quot;'></c11-paragraph>\n<c11-paragraph html='&quot;&lt;p&gt;&lt;strong&gt;Panel Footer&lt;/strong&gt;&lt;/p&gt;The footer is not built-in to the panel frame and is optional. To include a footer in your panel frame, simply add the &lt;code&gt;&amp;lt;cc-panel-footer&amp;gt&lt;/code&gt; element with your element of choice inside it (usually a button primitive).&quot;'></c11-paragraph>\n<c11-paragraph html='&quot;&lt;p&gt;&lt;strong&gt;Panel Footer&lt;/strong&gt;&lt;/p&gt;The footer is not built-in to the panel frame and is optional. To include a footer in your panel frame, simply add the &lt;code&gt;&amp;lt;cc-panel-footer&amp;gt&lt;/code&gt; element with your element of choice inside it (usually a button primitive).&quot;'></c11-paragraph>\n<c11-paragraph html='&quot;&lt;p&gt;&lt;strong&gt;Panel Footer&lt;/strong&gt;&lt;/p&gt;The footer is not built-in to the panel frame and is optional. To include a footer in your panel frame, simply add the &lt;code&gt;&amp;lt;cc-panel-footer&amp;gt&lt;/code&gt; element with your element of choice inside it (usually a button primitive).&quot;'></c11-paragraph>\n<c11-paragraph html='&quot;&lt;p&gt;&lt;strong&gt;Panel Footer&lt;/strong&gt;&lt;/p&gt;The footer is not built-in to the panel frame and is optional. To include a footer in your panel frame, simply add the &lt;code&gt;&amp;lt;cc-panel-footer&amp;gt&lt;/code&gt; element with your element of choice inside it (usually a button primitive).&quot;'></c11-paragraph>\n<c11-paragraph html='&quot;&lt;p&gt;&lt;strong&gt;Panel Footer&lt;/strong&gt;&lt;/p&gt;The footer is not built-in to the panel frame and is optional. To include a footer in your panel frame, simply add the &lt;code&gt;&amp;lt;cc-panel-footer&amp;gt&lt;/code&gt; element with your element of choice inside it (usually a button primitive).&quot;'></c11-paragraph>\n<cc-panel-footer>\n<button class='p9a-secondary cc-x-height -inverse' ng-click='$ctrl.toggleDisableScroll()'>\n<div class='cc-x-height'>{{$ctrl.scrollDisabled ? 'Enable' : 'Disable'}} scroll</div>\n</button>\n</cc-panel-footer>\n</cc-panel-frame>\n<cc-panel-frame label='p19 calendar' ng-if='$ctrl.isVisible(&#39;Calendar&#39;)'>\n<div class='cc-panel-content' ignore-this-element-and-dont-use-it-in-your-code-its-only-for-the-playground>\n<button class='cc-x-height p9-primary -medium -purple' ng-click='$ctrl.onDisplayP19Calendar()'>\n<div class='cc-x-height'>show calendar</div>\n</button>\n</div>\n</cc-panel-frame>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/primitives/p0-spacer.html","<hr class='p0-spacer' ng-class='$ctrl.sizeClass' ng-if='$ctrl.verticalSpacer'>\n<span class='p0-spacer-horizontal' ng-class='$ctrl.sizeClass' ng-if='!$ctrl.verticalSpacer'></span>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/primitives/p1-text-input.html","<input cc-select-on-focus='{{$ctrl.selectOnFocus}}' class='p1-input short cc-ellipsis' data-hook='text-input' focus-delay='500' focus-if='$ctrl.focused' maxlength='{{$ctrl.maxLength}}' ng-blur='$ctrl.onBlur({ $event: $event })' ng-change='$ctrl.onChange()' ng-class='{ &#39;text-invalid&#39;: !$ctrl.isInputValid(), &#39;unselectable&#39;: $ctrl.isDisabled }' ng-disabled='$ctrl.isDisabled' ng-focus='$ctrl.onFocus({ $event: $event })' ng-if='!$ctrl.long' ng-keyup='$ctrl.onTextKeyUp($event)' ng-model-options='$ctrl.modelOptions' ng-model='$ctrl.value' placeholder='{{$ctrl.placeholder}}' type='{{$ctrl.type || &#39;text&#39;}}'>\n<i class='input-icon left-icon' ng-class='$ctrl.leftIconName' ng-if='!$ctrl.long &amp;&amp; $ctrl.leftIconName'></i>\n<i class='input-icon right-icon' ng-class='$ctrl.rightIconName' ng-click='$ctrl.onRightIconClicked()' ng-if='!$ctrl.long &amp;&amp; $ctrl.rightIconName'></i>\n<textarea cc-select-on-focus='{{$ctrl.selectOnFocus}}' class='p1-input long' data-hook='long-text-input' focus-delay='500' focus-if='$ctrl.focused' msd-elastic='' ng-attr-placeholder='{{$ctrl.placeholder}}' ng-blur='$ctrl.onLongTextBlur($event)' ng-change='$ctrl.onChange()' ng-class='{&#39;focused&#39; : this.isLongTextFocused, &#39;text-invalid&#39; : !$ctrl.isInputValid()}' ng-disabled='$ctrl.isDisabled' ng-focus='$ctrl.onLongTextFocus($event)' ng-if='$ctrl.long' ng-keyup='$ctrl.onTextKeyUp($event, true)' ng-model-options='$ctrl.modelOptions' ng-model='$ctrl.value' rows='1'></textarea>\n<div class='p1-error' ng-if='!$ctrl.isInputValid() &amp;&amp; !!$ctrl.validationTooltip'>\n<cc-validation tooltip='{{$ctrl.validationTooltip}}'></cc-validation>\n</div>\n<p17-divider class='cc-control-divider' shorter-divider='!$ctrl.isInputValid() &amp;&amp; !!$ctrl.validationTooltip'></p17-divider>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/primitives/p3-dropdown-list.html","<md-input-container class='cc-md-select' data-hook='dropdown-container' ng-class='{&#39;-with-fake-dropdown&#39;: !$ctrl.shouldShowSelect()}'>\n<div class='p3-dropdown-list-icon-arrow cc-icon-arrow-down' data-hook='arrow-down' ng-if='$ctrl.shouldShowSelect()'></div>\n<md-select cc-tooltip-position='top' cc-tooltip='P3_SELECTED_VALUE' data-hook='p3-md-select' md-container-class='{{$ctrl.mdContainerClass}}' md-on-open='$ctrl.onOpen()' ng-attr-adi-automation='{{$ctrl.automation}}-dropdown' ng-attr-cc-tooltip-options='{{$ctrl.selectTooltipOptions()}}' ng-if='$ctrl.shouldShowSelect()' ng-model-options='{ trackBy: $ctrl.trackByKey ? &#39;$value.&#39; + $ctrl.trackByKey : $value }' ng-model='$ctrl.value' placeholder='{{$ctrl.placeholder}}'>\n<md-option class='cc-x-height' data-hook='dropdown-list-item' ng-attr-adi-automation='{{$ctrl.automation ? $ctrl.automation + &#39;-dropdown-item&#39; : &#39;&#39;}}' ng-attr-title='{{ $ctrl.getTitle(item) }}' ng-class='[{ &#39;-selected&#39;: $ctrl.selectedIndex === $index }, item.class]' ng-click='$ctrl.itemSelected(item, $index)' ng-repeat='item in $ctrl.items' ng-value='item'>\n<img class='p3-item-media' ng-if='item.media' ng-src='{{item.media.relativeUri}}'>\n{{ $ctrl.getItemLabel(item) }}\n</md-option>\n<div class='cc-x-height p3-dropdown-action' data-hook='dropdown-action-link' ng-if='$ctrl.linkTitle' ng-mousedown='$ctrl.onLinkClick()'>\n{{ $ctrl.linkTitle }}\n</div>\n</md-select>\n<div class='fake-dropdown' data-hook='fake-dropdown' ng-if='!$ctrl.shouldShowSelect()'>\n<div class='fake-dropdown-option'>\n<img class='p3-item-media' data-hook='fake-dropdown-image' ng-if='$ctrl.items[0].media' ng-src='{{$ctrl.items[0].media.relativeUri}}'>\n<span data-hook='fake-dropdown-label'>{{ $ctrl.getItemLabel($ctrl.items[0]) }}</span>\n</div>\n</div>\n</md-input-container>\n<div class='cc-aux-menu'>\n<button cc-tooltip-position='top' cc-tooltip='{{:: $ctrl.helpTooltip}}' class='cc-aux-btn' data-hook='help-button' ng-click='$ctrl.onHelp(); $event.stopPropagation()' ng-if='!!$ctrl.helpTooltip || !!$ctrl.onHelp'>\n<i class='cc-icon-info'></i>\n</button>\n</div>\n<button cc-tooltip='{{ $ctrl.buttonTooltip }}' class='p9a-secondary -controlbtn' data-hook='button' ng-attr-adi-automation='{{$ctrl.automation ? $ctrl.automation + &#39;-button&#39; : &#39;&#39;}}' ng-click='$ctrl.onButtonClick()' ng-if='$ctrl.showButton'>{{ $ctrl.buttonText}}</button>\n<p17-divider class='cc-control-divider' data-hook='divider' ng-class='{&#39;-ignore-control-hover&#39;: !$ctrl.shouldShowSelect()}'></p17-divider>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/primitives/p5-slider.html","<div class='p5-slider' ng-class='{&#39;p5-state-stepper&#39;: $ctrl.stepper, &#39;p5a&#39;: $ctrl.type === &#39;p5a&#39;, &#39;p5-stepper-with-ticks&#39;: $ctrl.stepperTicks }'>\n<cc-svg-icon class='p5a-icon before' icon='{{:: $ctrl.iconBefore || &#39;primitives:minus&#39; }}' id='p5a-icon-before' ng-class='{&#39;clickable-icon&#39;: $ctrl.clickableIcons}' ng-if='$ctrl.type === &#39;p5a&#39;' ng-mousedown='$ctrl.onIconClick($event, true)'></cc-svg-icon>\n<div class='p5-total'></div>\n<div class='p5-current'></div>\n<div class='p5-steppers' ng-if='$ctrl.stepper &amp;&amp; $ctrl.stepperTicks'>\n<div class='p5-stepper' ng-class='{&#39;p5-state-filled&#39;: stepper.filled}' ng-repeat='stepper in $ctrl.steppers' ng-style='{&#39;left&#39;: stepper.left + &#39;px&#39;}'></div>\n</div>\n<div class='p5-handle' ng-class='{&#39;p5-state-dragging&#39;: $ctrl.dragging}' style='position: absolute'></div>\n<cc-svg-icon class='p5a-icon after' icon='{{:: $ctrl.iconAfter || &#39;primitives:plus&#39; }}' id='p5a-icon-after' ng-class='{&#39;clickable-icon&#39;: $ctrl.clickableIcons}' ng-if='$ctrl.type === &#39;p5a&#39;' ng-mousedown='$ctrl.onIconClick($event, false)'></cc-svg-icon>\n</div>\n<p1-text-input class='p5-input' ng-class='{&#39;p5-state-stepper&#39;: $ctrl.stepper}' ng-if='$ctrl.type !== &#39;p5a&#39;' on-blur='$ctrl.onInputBlur();$ctrl.onBlur();' on-change-value='$ctrl.onValueChange({value: value})' on-focus='$ctrl.onInputFocus();$ctrl.onFocus();' on-keyup='$ctrl.onInputKeyup($event);' value='$ctrl.label'></p1-text-input>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/primitives/p6-control-header.html","<div class='p8-label' data-hook='control-header-container' ng-class='{ &#39;-toggleable&#39;: !$ctrl.hideToggleButton }' ng-click='$ctrl.toggle($event)'>\n<div cc-tooltip='{{!$ctrl.hideToggleButton &amp;&amp; !$ctrl.active ? &#39;hidden_item&#39; : &#39;&#39;}}' class='p8-label-text' data-hook='label'>\n{{ $ctrl.label }}\n</div>\n<div class='cc-aux-menu'>\n<button cc-tooltip='{{$ctrl.actionTooltip}}' class='p9b-text-button -small cc-aux-action' data-hook='action' ng-class='&#39;{{$ctrl.actionTooltip}}&#39;' ng-click='$ctrl.onAction()' ng-if='$ctrl.showAction'>\n{{$ctrl.actionLabel}}\n</button>\n<button cc-tooltip-position='top' cc-tooltip='{{$ctrl.helpTooltip}}' class='cc-aux-btn' data-hook='help-button' ng-click='$ctrl.onHelp()' ng-if='$ctrl.showHelpButton'>\n<i class='cc-icon-info'></i>\n</button>\n<button cc-tooltip='{{$ctrl.active ? &#39;hide_item&#39; : &#39;show_item&#39;}}' class='cc-aux-btn' data-hook='toggle-button' data-name='toggle-button' ng-if='!$ctrl.hideToggleButton'>\n<i data-hook='toggle-icon' ng-class='$ctrl.active ? &#39;cc-icon-show&#39; : &#39;cc-icon-hide&#39;'></i>\n</button>\n<div class='new-tooltip' data-hook='new-tooltip' ng-if='$ctrl.showNewTooltip'>NEW</div>\n</div>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/primitives/p11-item-navigation.html","<div cc-tooltip-position='top' cc-tooltip='{{$ctrl.previousTooltip}}' class='p11-button cc-icon-arrow-left' data-hook='prev-button' ng-click='$ctrl.goPrevious()' ng-disabled='!$ctrl.canPrev()'></div>\n<div class='p11-pages'>\n<span data-hook='current'>{{ $ctrl.current }}</span>\n<span>/</span>\n<span data-hook='count'>{{ $ctrl.count }}</span>\n</div>\n<div cc-tooltip-position='top' cc-tooltip='{{$ctrl.nextTooltip}}' class='p11-button cc-icon-arrow-right' data-hook='next-button' ng-click='$ctrl.goNext()' ng-disabled='!$ctrl.canNext()'></div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/primitives/p13-radio-buttons.html","<label adi-automation='{{item.label}}' class='p13-item' data-hook='label' ng-click='$ctrl.setValue(item.value);' ng-repeat='item in $ctrl.items track by item.value'>\n<input class='p13-button' data-hook='button' name='{{$ctrl.name}}' ng-checked='item.value == $ctrl.value' type='radio'>\n<span class='p13-icon'></span>\n<span class='p13-label'>{{item.label}}</span>\n</label>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/primitives/p14-checkbox.html","<div class='p14-checkbox p14-checkbox-ml'>\n<div class='required' data-hook='required' ng-class='{ &quot;-required&quot;: $ctrl.item.required }' ng-click='$ctrl.toggleRequire()'></div>\n<label>\n<div class='input-wrapper'>\n<input data-hook='checkbox' id='{{$ctrl.randomId}}' ng-change='$ctrl.valueChanged(value)' ng-model='$ctrl.item.checked' type='checkbox'>\n<div class='p14-checkbox-inner'></div>\n</div>\n<div class='p14-checkbox-label' data-hook='label'>{{ $ctrl.item.label }}</div>\n</label>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/primitives/p15-toggle.html","<div ng-class='{&#39;with-icons&#39;: $ctrl.leftIcon}'>\n<div class='p15-indicator' ng-if='$ctrl.value !== undefined'></div>\n<div class='p15-icons' ng-if='$ctrl.leftIcon'>\n<cc-svg-icon class='p15-icon' icon='{{$ctrl.leftIcon}}' ng-class='{&#39;indicated&#39;: !$ctrl.value}'></cc-svg-icon>\n<cc-svg-icon class='p15-icon' icon='{{$ctrl.rightIcon}}' ng-class='{&#39;indicated&#39;: !!$ctrl.value}' ng-if='$ctrl.rightIcon'></cc-svg-icon>\n</div>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/primitives/p16-panel-header.html","<div class='p16-panel-header' ng-class='{&#39;-with-nested&#39;: $ctrl.shouldShowBackArrow()}'>\n<div class='cc-headline'>\n<div class='cc-aux-menu -left' ng-if='!!$ctrl.showReturnButton &amp;&amp; !$ctrl.ccFlags.cardsToPanels'>\n<button class='cc-aux-btn' data-hook='return-button' ng-click='$ctrl.onReturn()'>\n<i class='cc-icon-arrow-left'></i>\n</button>\n</div>\n<span data-hook='label'>\n<span data-hook='label-text' ng-class='{&#39;animate-if&#39;: $ctrl.ccFlags.cardsToPanels}' ng-if='!$ctrl.shouldShowBackArrow()'>{{ $ctrl.label }}</span>\n<button class='cc-aux-btn animate-if' data-hook='return-button' ng-click='$ctrl.onReturn()' ng-if='$ctrl.shouldShowBackArrow()'>\n<i class='cc-icon-intro-back-arrow'></i>\n<span>{{ $ctrl.getLabel() }}</span>\n</button>\n</span>\n<span class='p16-number' data-hook='number' ng-if='$ctrl.hasNumber()'>{{ $ctrl.number }}</span>\n<div class='cc-aux-menu -right'>\n<div class='action-shourtcut-container' ng-if='!!$ctrl.actionShourtcut' ng-mouseenter='$ctrl.showActionShourtcut()' ng-mouseleave='$ctrl.hideActionShourtcut()'>\n<button adi-automation='action-shourtcut' class='cc-icon-actions action-shourtcut-button' data-hook='action-shourtcut'></button>\n<div aria-describedby='list-item-menu' class='p4-action-menu action-shourtcut-menu' ng-click='$ctrl.hideActionShourtcut()' ng-if='$ctrl.showActionShourcutMenu' ng-mouseleave='$ctrl.hideActionShourtcut()' role='menu' tabindex='-1'>\n<div class='action-shourtcut-content' ng-transclude='shourtcut'></div>\n</div>\n</div>\n<button adi-automation='reset-button' cc-tooltip='design_kit_reset' class='p9b-text-button -medium' data-hook='reset-button' ng-click='$ctrl.onReset()' ng-if='!!$ctrl.showResetButton'>\n{{:: 'design.kit.reset.button' | translate }}\n</button>\n<button cc-tooltip-position='top' cc-tooltip='{{:: $ctrl.helpTooltip || &#39;help&#39; }}' class='cc-aux-btn' data-hook='help-button' ng-click='$ctrl.onHelp()' ng-if='!!$ctrl.helpTooltip || !!$ctrl.showHelpButton'>\n<i class='cc-icon-help-12x7'></i>\n</button>\n<button class='cc-aux-btn' data-hook='close-button' ng-click='$ctrl.onClose()' ng-if='!!$ctrl.showCloseButton'>\n<i class='cc-icon-close-12'></i>\n</button>\n<button cc-tooltip-position='top' cc-tooltip='back' class='cc-aux-btn' data-hook='return-sub-button' ng-click='$ctrl.onReturn()' ng-if='!!$ctrl.showReturnButton'>\n<i class='cc-icon-arrow-left'></i>\n</button>\n</div>\n</div>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/primitives/p17-divider.html","<hr class='p17-divider' ng-class='{ &#39;shorter-divider&#39;: $ctrl.shorterDivider}'>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/primitives/p19-calendar.html","<div class='calendar' data-hook='calendar'>\n<div class='calendar-picked-date'>{{$ctrl.date  | date:'MM/dd/yyyy'}}</div>\n<md-calendar md-min-date='$ctrl.minDate' md-placeholder='Enter date' ng-model='$ctrl.date'></md-calendar>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/primitives/p20-link.html","<div class='c5-link cc-action cc-x-height' data-hook='link' ng-class='{&#39;hovered&#39;:$ctrl.isHover}' ng-click='$ctrl.onLinkClick({ link: $ctrl.link.value })'>\n<span class='c5-link-label cc-x-height cc-ellipsis'>\n<span class='cc-pointer' data-hook='linkDescription'>{{ $ctrl.link.state ? $ctrl.link.value : $ctrl.isHover ? $ctrl.connectLabel : $ctrl.noLinkLabel }}</span>\n</span>\n<i class='c5-link-icon cc-icon-link' ng-if='$ctrl.link.state'></i>\n<cc-svg-icon class='c5-link-negative-validation' icon='misc:negative-validation-outline' ng-if='!$ctrl.link.state &amp;&amp; !$ctrl.isHover'></cc-svg-icon>\n</div>\n<p17-divider class='cc-control-divider'></p17-divider>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/primitives/p21-color-tag.html","<div cc-tooltip-options='{&quot;offsetY&quot;: {{:: -2 + ($ctrl.size === &quot;lg&quot; &amp;&amp; !$ctrl.isPlaceholder ? -$ctrl.buttonOffsetLarge : 0)}} }' cc-tooltip='{{:: $ctrl.tooltip }}' class='p21-color-tag' data-hook='color-tag' ng-class='[&#39;p21-color-tag-{{ $ctrl.size }}&#39;, {&#39;p21-color-tag-selected&#39;: $ctrl.isSelected, &#39;p21-placeholder-tag&#39;: $ctrl.isPlaceholder}]' ng-click='$ctrl.handleClick($event)' ng-style='{backgroundColor: $ctrl.color}'>\n<cc-svg-icon icon='coloration:selected' is-corner-icon='true' ng-if='$ctrl.isSelected'></cc-svg-icon>\n<span class='p21-color-tag-overlay' data-hook='p21-color-tag-overlay' ng-show='$ctrl.showIcon || $ctrl.isPlaceholder'>\n<cc-svg-icon icon='coloration:{{$ctrl.getIcon()}}' module='coloration' ng-if='!$ctrl.isPlaceholder'></cc-svg-icon>\n<cc-svg-icon icon='coloration:{{:: $ctrl.placeholderIcon}}' module='coloration' ng-if='$ctrl.isPlaceholder'></cc-svg-icon>\n</span>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/primitives/p22-rich-text-toolbar.html","<div class='p22-rich-text-toolbar'>\n<span class='p22-rich-text-toolbar-section' ng-if='$ctrl.isBUISectionVisible()'>\n<cc-svg-icon cc-tooltip-position='top' cc-tooltip='richtext_bold' class='cc-svg-icon-circle' data-hook='bold' icon='rich-text:bold' ng-class='{&#39;-active&#39;: $ctrl.isActive(&#39;bold&#39;)}' ng-click='$ctrl.buttonClick(&#39;bold&#39;)' ng-disabled='$ctrl.commandDisabled(&#39;bold&#39;)'></cc-svg-icon>\n<cc-svg-icon cc-tooltip-position='top' cc-tooltip='richtext_italic' class='cc-svg-icon-circle' data-hook='italic' icon='rich-text:italic' ng-class='{&#39;-active&#39;: $ctrl.isActive(&#39;italic&#39;)}' ng-click='$ctrl.buttonClick(&#39;italic&#39;)' ng-disabled='$ctrl.commandDisabled(&#39;italic&#39;)'></cc-svg-icon>\n<cc-svg-icon cc-tooltip-position='top' cc-tooltip='richtext_underline' class='cc-svg-icon-circle' data-hook='underline' icon='rich-text:underline' ng-class='{&#39;-active&#39;: $ctrl.isActive(&#39;underline&#39;)}' ng-click='$ctrl.buttonClick(&#39;underline&#39;)' ng-disabled='$ctrl.commandDisabled(&#39;underline&#39;)'></cc-svg-icon>\n<div class='p22-section-divider' data-hook='p22-section-divider'></div>\n</span>\n<span class='p22-rich-text-toolbar-section' ng-if='$ctrl.isListingSectionVisible()'>\n<cc-svg-icon cc-tooltip-position='top' cc-tooltip='richtext_bullets' class='cc-svg-icon-circle' data-hook='bullets' icon='rich-text:bullets' ng-class='{&#39;-active&#39;: $ctrl.isActive(&#39;bullets&#39;)}' ng-click='$ctrl.buttonClick(&#39;bullets&#39;)' ng-disabled='$ctrl.commandDisabled(&#39;bullets&#39;)'></cc-svg-icon>\n<cc-svg-icon cc-tooltip-position='top' cc-tooltip='richtext_numbers' class='cc-svg-icon-circle' data-hook='numbers' icon='rich-text:numbers' ng-class='{&#39;-active&#39;: $ctrl.isActive(&#39;numbers&#39;)}' ng-click='$ctrl.buttonClick(&#39;numbers&#39;)' ng-disabled='$ctrl.commandDisabled(&#39;numbers&#39;)'></cc-svg-icon>\n<div class='p22-section-divider'></div>\n</span>\n<span class='p22-rich-text-toolbar-section' ng-if='$ctrl.isLinkingSectionVisible()'>\n<cc-svg-icon cc-tooltip-position='top' cc-tooltip='{{ $ctrl.getLinkTooltip() }}' class='cc-svg-icon-circle' data-hook='link' icon='rich-text:link' ng-class='{&#39;-active&#39;: $ctrl.isActive(&#39;link&#39;)}' ng-click='$ctrl.buttonClick(&#39;link&#39;)' ng-disabled='$ctrl.commandDisabled(&#39;link&#39;)'></cc-svg-icon>\n<div class='p22-section-divider'></div>\n</span>\n<span class='p22-rich-text-toolbar-section' ng-if='$ctrl.isClearFormattingSectionVisible()'>\n<cc-svg-icon cc-tooltip-position='top' cc-tooltip='richtext_clear-formatting' class='cc-svg-icon-circle' data-hook='clear-formatting' icon='rich-text:clear-formatting' ng-class='{&#39;-active&#39;: $ctrl.isActive(&#39;clear-formatting&#39;)}' ng-click='$ctrl.buttonClick(&#39;clear-formatting&#39;)' ng-disabled='$ctrl.commandDisabled(&#39;clear-formatting&#39;)'></cc-svg-icon>\n</span>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/primitives/p23-rich-text-input.html","<div class='p23-rich-text-input' p23-rich-text-input-inline></div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/primitives/p24-palette.html","<div class='p24-palette' ng-class='{&#39;-selectable&#39;: $ctrl.isSelectable, &#39;-selected&#39;: $ctrl.isSelected}'>\n<div class='p24-palette-swatch' ng-repeat='color in $ctrl.colors track by $index' ng-style='{backgroundColor: color}'></div>\n<cc-svg-icon data-hook='selected-icon' icon='coloration:selected' is-corner-icon='true' ng-if='$ctrl.isSelected'></cc-svg-icon>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/primitives/p25-background-preview.html","<div class='p25-background-preview-inner' data-hook='preview-container' ng-class='[$ctrl.cls, &#39;-&#39; + $ctrl.size, {&#39;-clickable&#39;: $ctrl.onClick, &#39;selected&#39;: $ctrl.isSelected}]' ng-click='$ctrl.onClick()' ng-mouseenter='$ctrl.mouseEnter()' ng-mouseleave='$ctrl.mouseLeave()' ng-style='::$ctrl.style'>\n<cc-svg-icon data-hook='selected-indicator' icon='coloration:selected' is-corner-icon='true' ng-if='$ctrl.isSelected'></cc-svg-icon>\n<div class='preview-container'>\n<div adi-automation='{{:: $ctrl.data.type}}' cc-tooltip='{{$ctrl.data.type}}' class='type-icon'>\n<cc-svg-icon data-hook='icon' icon='background-preview:{{:: $ctrl.data.type}}'></cc-svg-icon>\n</div>\n<div class='video-wrapper' data-hook='video-container' ng-if='$ctrl.isVideo'>\n<video autostart='false' class='video-tag' data-hook='video-tag' loop>\n<source data-hook='video-source' ng-src='{{$ctrl.data.value}}'>\n</video>\n</div>\n<div class='gallery-wrapper' data-hook='gallery-container' ng-class='[$ctrl.data.metaData.galleryType]' ng-if='$ctrl.isGallery'>\n<div class='gallery-viewport'>\n<div class='gallery-item' data-hook='gallery-item' ng-repeat='item in $ctrl.data.value | limitTo: $ctrl.slidesLimit track by $index'>\n<img ng-src='{{$ctrl.getGalleryURL(item)}}'>\n</div>\n</div>\n<div class='gallery-dots' data-hook='slideshow-dots' ng-if='$ctrl.isSlideshow'>\n<div class='gallery-dot' ng-class='{&#39;active&#39;: $index === 0}' ng-repeat='item in $ctrl.data.value | limitTo: $ctrl.dotsLimit track by $index'></div>\n</div>\n</div>\n</div>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/primitives/p26-image-position.html","<div class='p26-image-position' ng-class='$ctrl.getClasses(index)' ng-click='$ctrl.selectPosition(index)' ng-repeat='index in $ctrl.getElementsIndices() track by $index'>\n<span class='rectangle-sign' ng-if='$ctrl.isSelectedIndex(index)'>{{ $ctrl.letterOfSelected }}</span>\n<div class='icon-wrapper' ng-if='$ctrl.isSelectedIndex(index)'>\n<cc-svg-icon class='-small' data-hook='selected-indicator' icon='coloration:selected' is-corner-icon='true'></cc-svg-icon>\n</div>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/primitives/p27-palette-color-picker.html","<div class='p27-palette-color-picker'>\n<div class='p27-palette-color-picker-swatch' data-hook='color-swatch-{{$index}}' ng-class='$ctrl.getClass($index, color)' ng-click='$ctrl.setColor($index); $event.stopPropagation();' ng-repeat='color in $ctrl.colors track by $index' ng-style='$ctrl.getStyle(color)'>\n<div class='icon-wrapper' ng-if='$ctrl.isSelectedColor({$index})'>\n<cc-svg-icon class='-small' data-hook='selected-indicator' icon='coloration:selected' is-corner-icon='false'></cc-svg-icon>\n</div>\n</div>\n<c11-paragraph class='p27-message' compile='$ctrl.notification' ng-show='$ctrl.notification'></c11-paragraph>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c2-text-input.html","<div class='c2-text-input' data-hook='container' ng-class='{ &#39;-active&#39;: $ctrl.active, &#39;-suggestions-visible&#39;: $ctrl.showMediaAutocomplete &amp;&amp; $ctrl.matchCount &gt; 0 || $ctrl.showTextAutocomplete, &#39;-prefixed&#39;: $ctrl.prefix, &#39;-c2e&#39;: (($ctrl.showIcon || $ctrl.showButton) &amp;&amp; $ctrl.active), &#39;-c2m&#39;: $ctrl.mobile }'>\n<p6-control-header action-label='$ctrl.actionLabel' action-tooltip='{{$ctrl.actionTooltip}}' active='$ctrl.active' class='c2-header' data-hook='p6-control-header' help-tooltip='{{$ctrl.helpTooltip}}' hide-toggle-button='$ctrl.headerToggleDisabled' label='$ctrl.label' ng-if='!$ctrl.noHeader' on-action='$ctrl.onAction()' on-help='$ctrl.onHelp()' on-toggle='$ctrl.toggle()' show-action='$ctrl.showAction' show-help-button='$ctrl.showHelpButton'></p6-control-header>\n<div class='cc-action' ng-class='{ &#39;-long&#39;: $ctrl.long }'>\n<div class='c2-prefix' data-hook='prefix' ng-if='$ctrl.prefix'>{{ $ctrl.prefix }}</div>\n<p1-text-input change-value-on-blur='$ctrl.changeValueOnBlur' data-hook='p1-text-input' debounce-delay='$ctrl.debounceDelay' focused='$ctrl.focused' is-disabled='$ctrl.isDisabled' is-show-validator-error='$ctrl.isShowValidatorError' long='$ctrl.long' max-length='{{$ctrl.maxLength}}' ng-if='!$ctrl.mobile' ng-keydown='$event.stopPropagation()' on-blur='$ctrl.onInputBlur($event)' on-change-value='$ctrl.onChange(value)' on-focus='$ctrl.onInputFocus($event)' on-keyup='$ctrl.onKeyUp($event)' on-submit='$ctrl.onSubmit()' placeholder='$ctrl.placeholder' type='{{$ctrl.type}}' validation='$ctrl.validation' value='$ctrl.value'></p1-text-input>\n<cc-autocomplete data-hook='autocomplete' hovered-index='$ctrl.autocompleteHoveredIndex' ignore-value='$ctrl.ignoreValueForAutoComplete' items='$ctrl.autocomplete' link-label='{{$ctrl.autocompleteLinkLabel}}' ng-if='$ctrl.showTextAutocomplete' on-item-select='$ctrl.autocompleteItemSelect(item)' on-link-click='$ctrl.onAutocompleteLinkClick()' on-match-change='$ctrl.matchChange(matches)' rand-id='{{$ctrl.randId}}' value='$ctrl.value'></cc-autocomplete>\n<cc-autocomplete-media data-hook='autocomplete-media' hovered-index='$ctrl.autocompleteHoveredIndex' ignore-value='$ctrl.ignoreValueForAutoComplete' items='$ctrl.autocomplete' ng-if='$ctrl.showMediaAutocomplete' on-item-select='$ctrl.autocompleteMediaItemSelect(item)' on-match-change='$ctrl.matchChange(matches)' rand-id='{{$ctrl.randId}}' value='$ctrl.value'></cc-autocomplete-media>\n<div adi-automation='mobile-text-input' cc-tooltip-position='top' cc-tooltip='{{$ctrl.valueTooltip}}' class='cc-ellipsis c2-text-label' compile='$ctrl.value' data-hook='p1-text-label' ng-if='$ctrl.mobile'></div>\n<span class='c2e-icon' data-hook='c2e-icon' ng-class='&#39;cc-icon-&#39; + $ctrl.iconName' ng-click='$ctrl.onIconClick()' ng-if='$ctrl.showIcon &amp;&amp; !$ctrl.isIconSvg'></span>\n<cc-svg-icon class='c2e-icon-svg cc-svg-icon-circle -active' data-hook='c2e-svg-icon' icon='{{$ctrl.iconName}}' ng-click='$ctrl.onIconClick()' ng-if='$ctrl.showIcon &amp;&amp; $ctrl.isIconSvg'></cc-svg-icon>\n<button class='c2e-button p9-primary -controlbtn' data-hook='c2e-button' ng-click='$ctrl.onButtonClick()' ng-if='$ctrl.showButton'>{{ $ctrl.buttonText }}</button>\n<button cc-tooltip='{{$ctrl.active ? &#39;hide_item&#39; : &#39;show_item&#39;}}' class='c2-dynamic-toggle cc-aux-btn' data-hook='toggle-button' data-name='toggle-button' ng-click='$ctrl.toggle()' ng-hide='$ctrl.disableToggle' ng-if='$ctrl.mobile'>\n<i data-hook='toggle-icon' ng-class='$ctrl.active ? &#39;cc-icon-show&#39; : &#39;cc-icon-hide&#39;'></i>\n</button>\n</div>\n<p17-divider ng-class='{&#39;cc-hidden-marker&#39;: !$ctrl.showIcon &amp;&amp; !$ctrl.showButton &amp;&amp; !$ctrl.mobile}'></p17-divider>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c3-dropdown-list.html","<div class='c3-dropdown' ng-class='{ &#39;-active&#39;: $ctrl.active, &#39;-dropdown-open&#39;: $ctrl.showList }'>\n<p6-control-header active='$ctrl.active' data-hook='dropdown-header' help-tooltip='{{$ctrl.helpTooltip}}' hide-toggle-button='$ctrl.disableToggle' label='$ctrl.label' on-help='$ctrl.onHelp()' on-toggle='$ctrl.toggle()' show-help-button='$ctrl.showHelpButton'></p6-control-header>\n<p3-dropdown-list always-show-select='$ctrl.alwaysShowSelect' automation='{{$ctrl.automation}}' button-text='$ctrl.buttonText' button-tooltip='$ctrl.buttonTooltip' container-class='{{ $ctrl.containerClass }}' data-hook='dropdown' dont-open-for-one='$ctrl.dontOpenForOne' items='$ctrl.items' label-key='{{ $ctrl.labelKey }}' link-title='{{ $ctrl.linkTitle }}' ng-show='$ctrl.active' no-hover='$ctrl.noHover' on-button-click='$ctrl.onButtonClick()' on-link-click='$ctrl.onLinkClick()' on-selection-change='$ctrl.onSelectionChange({item: item})' placeholder='{{$ctrl.placeholder}}' show-button='$ctrl.showButton' show-titles='$ctrl.showTitles' track-by-key='{{ $ctrl.trackByKey }}' value='$ctrl.value'></p3-dropdown-list>\n<p17-divider class='cc-control-divider -ignore-control-hover' data-hook='divider' ng-show='!$ctrl.active'></p17-divider>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c4-media-preview.html","<div class='c4-media-preview' data-hook='container' ng-class='{ &#39;-active&#39;: $ctrl.active, &#39;c4m&#39;: $ctrl.type === &#39;c4m&#39; }'>\n<div class='p8-label' ng-class='{ &#39;-toggleable&#39;: $ctrl.type === &#39;c4m&#39; &amp;&amp; !$ctrl.disableToggle }' ng-if='$ctrl.showTabs || $ctrl.type === &quot;c4m&quot;'>\n<div class='p8-label-text cc-x-height' data-hook='tabs' ng-if='$ctrl.showTabs &amp;&amp; $ctrl.type !== &quot;c4m&quot;'>\n<span class='cc-label-tab cc-pointer' data-hook='inactive-tab' ng-if='!$ctrl.active'>{{ $ctrl.label }}</span>\n<i class='cc-icon cc-icon-intro-v-checkbox' ng-hide='!$ctrl.active || !$ctrl.imageSelected'></i>\n<span adi-automation='media preview image' cc-tooltip='C4_IMAGE' class='cc-label-tab cc-pointer' data-hook='image-tab' ng-class='{ &#39;-active&#39;: $ctrl.imageSelected }' ng-click='$ctrl.showImage()' ng-if='$ctrl.isImageTabVisible'>{{ $ctrl.getTabLabel(0) }}</span>\n<div class='cc-label-separator cc-x-height' ng-if='$ctrl.showTabSeparator(1)'></div>\n<i class='cc-icon cc-icon-intro-v-checkbox' ng-hide='!$ctrl.active || !$ctrl.gallerySelected'></i>\n<span adi-automation='media preview gallery' cc-tooltip='C4_GALLERY' class='cc-label-tab cc-pointer' data-hook='gallery-tab' ng-class='{ &#39;-active&#39;: $ctrl.gallerySelected }' ng-click='$ctrl.showGallery()' ng-if='$ctrl.isGalleryTabVisible'>{{ $ctrl.getTabLabel(1) }}</span>\n<div class='cc-label-separator cc-x-height' ng-if='$ctrl.showTabSeparator(2)'></div>\n<i class='cc-icon cc-icon-intro-v-checkbox' ng-hide='!$ctrl.active || !$ctrl.videoSelected'></i>\n<span adi-automation='media preview video' cc-tooltip='C4_VIDEO' class='cc-label-tab cc-pointer' data-hook='video-tab' ng-class='{ &#39;-active&#39;: $ctrl.videoSelected }' ng-click='$ctrl.showVideo()' ng-if='$ctrl.isVideoTabVisible'>{{ $ctrl.getTabLabel(2) }}</span>\n<div class='cc-label-separator cc-x-height' ng-if='$ctrl.showTabSeparator(3)'></div>\n<i class='cc-icon cc-icon-intro-v-checkbox' ng-hide='!$ctrl.active || !$ctrl.extVideoSelected'></i>\n<span adi-automation='media preview video' cc-tooltip='C4_VIDEO' class='cc-label-tab cc-pointer' data-hook='ext-video-tab' ng-class='{ &#39;-active&#39;: $ctrl.extVideoSelected }' ng-click='$ctrl.showExtVideo()' ng-if='$ctrl.isExtVideoTabVisible'>{{ $ctrl.getTabLabel(3) }}</span>\n<i class='cc-icon cc-icon-intro-v-checkbox' ng-hide='!$ctrl.active || !$ctrl.inlineVideoSelected'></i>\n<span adi-automation='media preview video' cc-tooltip='C4_VIDEO' class='cc-label-tab cc-pointer' data-hook='inline-video-tab' ng-class='{ &#39;-active&#39;: $ctrl.inlineVideoSelected }' ng-click='$ctrl.showInlineVideo()' ng-if='$ctrl.isInlineVideoTabVisible'>{{ $ctrl.getTabLabel(7) }}</span>\n<div class='cc-label-separator cc-x-height' ng-if='$ctrl.showTabSeparator(4)'></div>\n<i class='cc-icon cc-icon-intro-v-checkbox' ng-hide='!$ctrl.active || !$ctrl.clipartSelected'></i>\n<span adi-automation='media preview clipart' cc-tooltip='C4_IMAGE' class='cc-label-tab cc-pointer' data-hook='clipart-tab' ng-class='{ &#39;-active&#39;: $ctrl.clipartSelected }' ng-click='$ctrl.showClipart()' ng-if='$ctrl.isClipArtTabVisible'>{{ $ctrl.getTabLabel(4) }}</span>\n<div class='cc-label-separator cc-x-height' ng-if='$ctrl.showTabSeparator(5)'></div>\n<i class='cc-icon cc-icon-intro-v-checkbox' ng-hide='!$ctrl.active || !$ctrl.shapeSelected'></i>\n<span adi-automation='media preview shape' cc-tooltip='C4_SHAPE' class='cc-label-tab cc-pointer' data-hook='shape-tab' ng-class='{ &#39;-active&#39;: $ctrl.shapeSelected }' ng-click='$ctrl.showShape()' ng-if='$ctrl.isShapeTabVisible'>{{ $ctrl.getTabLabel(5) }}</span>\n</div>\n<div class='p8-label-text cc-x-height' data-hook='mobile-label' ng-click='$ctrl.toggle()' ng-if='$ctrl.type === &quot;c4m&quot;'>\n{{ $ctrl.getActiveLabel() }}\n</div>\n<div class='cc-aux-menu' data-hook='c2-aux-menu' ng-hide='$ctrl.prefix' ng-if='!($ctrl.type === &quot;c4m&quot; &amp;&amp; $ctrl.active)'>\n<button cc-tooltip='{{$ctrl.active ? &#39;hide_item&#39; : &#39;show_item&#39;}}' class='cc-aux-btn' data-hook='toggle-button' ng-click='$ctrl.toggle()' ng-hide='$ctrl.disableToggle'>\n<i data-hook='toggle-icon' ng-class='$ctrl.active ? &#39;cc-icon-show&#39; : &#39;cc-icon-hide&#39;'></i>\n</button>\n</div>\n</div>\n<div class='c4-body' data-hook='preview-container' ng-show='$ctrl.active'>\n<div cc-tooltip='{{$ctrl.mediaTooltip}}' class='c4-preview-wrapper' data-hook='preview-content' ng-mouseenter='$ctrl.hoveringEditPanel = true;' ng-mouseleave='$ctrl.hoveringEditPanel = false;'>\n<img alt='{{$ctrl.previewMediaAlt}}' class='preview is-image' data-hook='single-image-thumb' ng-if='$ctrl.imageSelected' ng-src='{{$ctrl.previewMediaUrl}}' title='{{$ctrl.previewMediaTitle}}'>\n<img class='preview is-gallery' data-hook='gallery-thumbs' ng-if='$ctrl.gallerySelected' ng-src='{{$ctrl.previewMediaUrl}}' title='{{$ctrl.previewMediaTitle}}'>\n<img class='preview is-video' data-hook='video-thumb' ng-if='$ctrl.videoSelected' ng-src='{{$ctrl.previewMediaUrl}}' title='{{$ctrl.previewMediaTitle}}'>\n<img class='preview is-ext-video' data-hook='ext-video-thumb' ng-if='$ctrl.extVideoSelected' ng-src='{{$ctrl.previewMediaUrl}}' title='{{$ctrl.previewMediaTitle}}'>\n<img class='preview is-video' data-hook='video-thumb' ng-if='$ctrl.inlineVideoSelected' ng-src='{{$ctrl.previewMediaUrl}}' title='{{$ctrl.previewMediaTitle}}'>\n<img class='preview is-shape' data-hook='shape-thumb' ng-if='$ctrl.shapeSelected' ng-src='{{$ctrl.previewMediaUrl}}' title='{{$ctrl.previewMediaTitle}}'>\n<img class='preview is-clipart' data-hook='clipart-thumb' ng-if='$ctrl.clipartSelected' ng-src='{{$ctrl.previewMediaUrl}}' title='{{$ctrl.previewMediaTitle}}'>\n<div class='c4-overlay preview' data-hook='overlay-controls' ng-if='$ctrl.type !== &quot;c4m&quot;' ng-show='!$ctrl.noHover &amp;&amp; ($ctrl.showEditPanel || $ctrl.hoveringEditPanel)'>\n<div class='c4-overlay-default-buttons' ng-if='!$ctrl.gallerySelected'><button class='p9c-primary cc-x-height' data-hook='replace-menu' ng-class='{&#39;-disabled&#39;: $ctrl.disableMediaChangeButton}' ng-click='$ctrl.replaceMedia()' ng-disabled='$ctrl.disableMediaChangeButton' ng-if='$ctrl.replaceButtonText != &quot;&quot;'><span class='cc-x-height font-t2' ng-bind-html='$ctrl.replaceButtonText'></span></button><button class='p9c-primary -icon-only' data-hook='crop-menu' ng-click='$ctrl.onCrop()' ng-show='$ctrl.imageSelected &amp;&amp; $ctrl.imageCrop'><i cc-tooltip-position='top' cc-tooltip='crop' class='cc-icon-circle cc-icon-crop'></i></button><button class='p9c-primary -icon-only' data-hook='info-menu' ng-click='$ctrl.onInfo()' ng-hide='$ctrl.videoSelected' ng-if='$ctrl.showInfo'><i cc-tooltip-position='top' cc-tooltip='settings' class='cc-icon-circle cc-icon-settings'></i></button></div>\n<div class='c4-overlay-gallery-buttons' ng-if='$ctrl.gallerySelected'><button class='p9c-primary cc-x-height' data-hook='organize-media' ng-class='{&#39;-disabled&#39;: $ctrl.disableMediaChangeButton}' ng-click='$ctrl.replaceMedia()' ng-disabled='$ctrl.disableMediaChangeButton'><span class='cc-x-height font-t2'>{{:: 'cc.media-preview.gallery.select' | translate }}</span></button><div class='bottom-text'><button class='p9c-text-button cc-x-height' data-hook='change-type' ng-click='$ctrl.onChangeGallery()'><span class='cc-x-height font-t2'>{{:: 'cc.media-preview.gallery.change' | translate }}</span></button></div></div>\n</div>\n</div>\n<div class='c4m-controls' data-hook='side-controls' ng-if='$ctrl.type === &quot;c4m&quot; &amp;&amp; $ctrl.active'><button class='c4m-controls-crop p9-primary -controlbtn -with-icon cc-x-height' data-hook='crop-menu' ng-click='$ctrl.onCrop()' ng-show='$ctrl.imageSelected &amp;&amp; $ctrl.imageCrop'><i cc-tooltip-position='top' cc-tooltip='settings' class='cc-icon-crop'></i>Crop</button><div class='cc-aux-menu' data-hook='c2-aux-menu' ng-hide='$ctrl.prefix'>\n<button cc-tooltip='hide_item' class='cc-aux-btn' data-hook='toggle-button' ng-click='$ctrl.toggle()' ng-hide='$ctrl.disableToggle'>\n<i class='cc-icon-show' data-hook='toggle-icon'></i>\n</button>\n</div>\n</div>\n</div>\n<c19-toggle class='c19-toggle-container' data-hook='dont-crop' label='{{::$ctrl.dontCropToggleText}}' ng-if='$ctrl.active &amp;&amp; $ctrl.showDontCrop &amp;&amp; $ctrl.imageSelected' on-value-change='$ctrl.onDontCropChange({value: value})' type='c19a' value='$ctrl.dontCrop'></c19-toggle>\n<p17-divider ng-class='{&#39;cc-hidden-marker&#39;: $ctrl.type !== &#39;c4m&#39;}'></p17-divider>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c5-link-input.html","<div class='c5-link-input' data-hook='link-input' ng-class='{ &#39;-active&#39;: $ctrl.active }' ng-mouseenter='$ctrl.setIsHover(true)' ng-mouseleave='$ctrl.setIsHover(false)'>\n<p6-control-header active='$ctrl.active' help-tooltip='{{$ctrl.helpTooltip}}' hide-toggle-button='$ctrl.disableToggle' label='$ctrl.label' on-help='$ctrl.onHelp()' on-toggle='$ctrl.toggle()' show-help-button='$ctrl.showHelpButton'></p6-control-header>\n<p20-link data-hook='p20-link' is-hover='$ctrl.isHover' link='$ctrl.link' ng-show='!$ctrl.hideLinkOnToggle || $ctrl.active' on-link-click='$ctrl.onEditLink({ link: link })'></p20-link>\n<p17-divider class='cc-control-divider -ignore-control-hover' data-hook='divider' ng-show='$ctrl.hideLinkOnToggle &amp;&amp; !$ctrl.active'></p17-divider>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c6-list-item.html","<div class='c6-list-item' data-hook='list-item' item-type='{{ $ctrl.itemType }}' ng-class='{ &#39;-active&#39;: !$ctrl.item.hidden, &#39;-menu-visible&#39;: $ctrl.showMenu, &#39;-draggable&#39;: $ctrl.isItemDraggable, &#39;-selectable&#39;: $ctrl.isSelectable, &#39;-selected&#39;: $ctrl.item.selected, &#39;-invalid&#39;: !$ctrl.isValid(), &#39;-hide-eye-when-active&#39;: $ctrl.shouldHideEyeWhenActive}'>\n<i as-sortable-item-handle class='c6-drag-handle cc-icon-dragsquare' ng-if='$ctrl.isItemDraggable'></i>\n<i class='c6-list-item-icon cc-icon-{{$ctrl.icon}}' data-hook='list-item-icon' ng-if='$ctrl.icon'></i>\n<span class='cc-ellipsis' data-hook='list-item-label' ng-class='{ &#39;-would-edit-if-clicked&#39;: $ctrl.editInPlace }' ng-click='$ctrl.itemClicked()' ng-dblclick='$ctrl.itemDoubleClicked()' ng-hide='$ctrl.inEditMode'>\n<label ng-bind='$ctrl.getLabel($ctrl.label)'></label>\n</span>\n<p1-text-input class='c6-list-item-editable-label' data-hook='editable-label' focused='$ctrl.inEditMode' ng-show='$ctrl.inEditMode' on-blur='$ctrl.disableEditMode()' on-change-value='$ctrl.onEditText(value)' on-submit='$ctrl.disableEditMode()' value='$ctrl.label'></p1-text-input>\n<i class='c6-list-item-arrow cc-icon-arrow-right'></i>\n<div class='cc-aux-menu' ng-class='{ &#39;item-style&#39;: $ctrl.isShowItemListNewDesign }' ng-hide='$ctrl.inEditMode'>\n<button cc-tooltip-position='top' cc-tooltip='{{$ctrl.item.helpTooltip}}' class='cc-aux-btn c6-help-button cc-icon-info' data-hook='help-button' ng-click='$ctrl.item.onHelp()' ng-if='!!$ctrl.item.helpTooltip || !!$ctrl.item.onHelp'></button>\n<button cc-tooltip-position='top' cc-tooltip='settings' class='cc-aux-btn' data-hook='cog' ng-class='{ &#39;cog-visible&#39;: $ctrl.showMenu || $ctrl.cogAlwaysVisible, &#39;cog-icon-order&#39;: $ctrl.isShowItemListNewDesign }' ng-click='$ctrl.openMenu($event); $event.stopPropagation()' ng-dblclick='$event.stopPropagation()' ng-if='$ctrl.itemType !== &#39;p10f&#39;' ng-show='!$ctrl.noMenu'>\n<i class='cc-icon-settings'></i>\n</button>\n<button cc-tooltip='{{ $ctrl.item.hidden ? &#39;show_item&#39; : &#39;hide_item&#39;}}' class='cc-aux-btn c6-eyecon' data-hook='eye' ng-class='{ &#39;-hide-eye-when-active&#39;: $ctrl.shouldHideEyeWhenActive, &#39;-eye-icon-requested&#39;: $ctrl.showEyeIcon, &#39;cc-icon-hide&#39;: $ctrl.isHideIconEnabled, &#39;cc-icon-show&#39;: $ctrl.isShowIconEnabled, &#39;cc-icon-hide-eye&#39;: $ctrl.isHideEyeIconEnabled, &#39;cc-icon-show-eye&#39;: $ctrl.isShowEyeIconEnabled, &#39;toggle-icon-disabled&#39;: $ctrl.isItemDisabled() }' ng-click='$ctrl.toggle(); $event.stopPropagation()' ng-if='!$ctrl.isShowItemListNewDesign'></button>\n<button cc-tooltip-position='top' cc-tooltip='edit' class='cc-aux-btn' data-hook='edit-icon' ng-class='{&#39;edit-icon-order&#39;: $ctrl.isShowItemListNewDesign, &#39;edit-visible&#39;: $ctrl.editAlwaysVisible}' ng-click='$ctrl.editIconClicked(); $event.stopPropagation()' ng-show='$ctrl.showEditIcon || $ctrl.isShowItemListNewDesign'>\n<i class='cc-icon-edit'></i>\n</button>\n<i cc-tooltip='{{$ctrl.getInvalidTooltip()}}' class='c6-list-item-invalid-icon cc-icon-negative-validation' data-hook='invalid-icon'></i>\n</div>\n<p17-divider class='cc-control-divider -ignore-control-hover' ng-if='$ctrl.itemType === &#39;p10d&#39;'></p17-divider>\n</div>\n<button cc-tooltip='{{$ctrl.getTooltipName()}}' class='list-item-toggle-button cc-aux-btn' data-hook='toggle-button' data-name='toggle-button' ng-class='{&#39;-disabled&#39;: $ctrl.isItemDisabled()}' ng-click='$ctrl.toggle(); $event.stopPropagation()' ng-if='$ctrl.isShowItemListNewDesign &amp;&amp; $ctrl.itemType !== &#39;p10m&#39;'>\n<i class='toggle-icon' data-hook='toggle-icon' ng-class='$ctrl.showOrHideItem'></i>\n</button>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c6-list-item-p10l.html","<div class='c6-list-item-p10l' data-hook='list-item' item-type='{{ $ctrl.itemType }}' ng-class='{ &#39;-active&#39;: !$ctrl.item.hidden,&#39;-draggable&#39;: $ctrl.isItemDraggable, &#39;-single&#39;: $ctrl.isSingleItem, &#39;-selected&#39;: $ctrl.item.selected}'>\n<i as-sortable-item-handle class='c6-drag-handle cc-icon-dragsquare' data-hook='drag-handle' ng-if='$ctrl.isItemDraggable'></i>\n<c2-text-input button-text='{{::$ctrl.buttonText}}' change-value-on-blur='true' data-hook='editable-input' debounce-delay='::$ctrl.debounceDelay' focused='$ctrl.focused' icon-name='{{::$ctrl.icon}}' no-header='true' on-blur='$ctrl.handleOnBlur($event)' on-button-click='$ctrl.handleOnButtonClick()' on-change-value='$ctrl.handleOnChangeValue(value)' on-icon-click='$ctrl.handleOnIconClick()' placeholder='::$ctrl.placeholder' show-button='::$ctrl.isButtonVisible' show-header='false' show-icon='::$ctrl.isIconVisible' value='::$ctrl.value'></c2-text-input>\n<button class='list-item-p10l-delete-button cc-aux-btn' data-hook='delete-button' data-name='delete-button' ng-click='$ctrl.handleOnDelete(); $event.stopPropagation()' ng-if='!$ctrl.noDelete'>\n<i class='cc-icon-delete' data-hook='delete-icon' ng-class='$ctrl.showOrHideItem'></i>\n</button>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c6-list.html","<div class='c6-list' ng-class='{&quot;-active&quot;: $ctrl.active, &quot;-link-bottom&quot;: $ctrl.linkBottom}'>\n<p6-control-header active='$ctrl.active' data-hook='c6-list-label' edit-tooltip='{{$ctrl.editTooltip}}' help-tooltip='{{$ctrl.helpTooltip}}' hide-toggle-button='$ctrl.disableToggle' label='$ctrl.label' ng-show='$ctrl.label' on-help='$ctrl.onHelp()' on-toggle='$ctrl.onToggle()' show-help-button='$ctrl.showHelpButton'></p6-control-header>\n<div class='c6-list-link' data-hook='add-new-item' ng-click='$ctrl.onAddNew()' ng-show='$ctrl.addNewTitle &amp;&amp; !$ctrl.disableListLink'>\n<button class='cc-x-height' data-hook='add-new-item-button'>\n<i class='c6-add-icon cc-icon-add-small'></i>\n<span class='cc-x-height'>{{ $ctrl.addNewTitle | cleanAddNewTitle }}</span>\n</button>\n</div>\n<ul as-sortable='$ctrl.sortableOptions' class='c6-list-items' data-hook='c6-list-items' data-ng-model='$ctrl.items' is-disabled='!$ctrl.isDraggable' ng-class='{&quot;-draggable&quot;: $ctrl.isDraggable, &quot;-drag-in-progress&quot;: $ctrl.isDragInProgress}' ng-if='$ctrl.active'>\n<li as-sortable-item ng-repeat='(key, item) in $ctrl.items'>\n<c6-list-item cog-always-visible='$ctrl.cogAlwaysVisible' data-hook='c6-list-item' edit-always-visible='$ctrl.editAlwaysVisible' edit-in-place='$ctrl.editInPlace' icon-property='$ctrl.itemIconProperty' invalid-tooltip='$ctrl.invalidTooltip' is-draggable='$ctrl.isDraggable' is-selectable='$ctrl.isSelectable' item-type='$ctrl.itemType' item-validator='$ctrl.itemValidator({item: item})' item='item' label-filter='$ctrl.labelFilter' label-property='$ctrl.itemLabelProperty' ng-class='{&#39;list-item-style&#39;: $ctrl.isShowItemListNewDesign }' ng-if='$ctrl.itemType !== &quot;p10l&quot;' no-delete='!$ctrl.enableDeleteOnSingleItem &amp;&amp; $ctrl.items.length === 1 || $ctrl.noDelete' no-duplicate='$ctrl.noDuplicate' no-edit='$ctrl.noEdit' no-hide='$ctrl.noHide' no-item-to-page='$ctrl.noItemToPage' no-menu='$ctrl.noMenu' on-click='$ctrl.onItemClick({item: item})' on-delete='$ctrl.onDelete({item: item})' on-double-click='$ctrl.onItemDoubleClick({item: item})' on-duplicate='$ctrl.onDuplicate({item: item})' on-edit='$ctrl.onEdit({item: item})' on-item-to-page='$ctrl.onItemToPage({item: item})' on-toggle='$ctrl.onToggle({item: item})' show-edit-icon='$ctrl.showEditIcon' show-eye-icon='$ctrl.showEyeIcon'></c6-list-item>\n<c6-list-item-p10l data-hook='c6-list-item-p10l' debounce-delay='::$ctrl.debounceDelay' focused='$ctrl.focused &amp;&amp; key === $ctrl.focusIndex' is-draggable='$ctrl.isDraggable &amp;&amp; $ctrl.items.length &gt; 1' is-single-item='$ctrl.items.length === 1' item-type='$ctrl.itemType' item='item' ng-class='{&#39;list-item-style&#39;: &#39;true&#39;}' ng-if='$ctrl.itemType === &quot;p10l&quot;' no-delete='!$ctrl.enableDeleteOnSingleItem &amp;&amp; $ctrl.items.length === 1 || $ctrl.noDelete' on-blur='$ctrl.handleOnBlur(key, value)' on-button-click='$ctrl.handleOnEdit(key)' on-change-value='$ctrl.handleOnChangeValue(key, value)' on-delete='$ctrl.handleOnDelete(key)' on-icon-click='$ctrl.handleOnEdit(key)'></c6-list-item-p10l>\n</li>\n</ul>\n<p17-divider></p17-divider>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c7-multi-field-group.html","<div class='c7-multi-field-group' data-hook='multi-field-group' ng-class='{ &#39;-active&#39;: $ctrl.active }'>\n<p6-control-header active='$ctrl.active' data-hook='header' help-tooltip='{{$ctrl.helpTooltip}}' hide-toggle-button='$ctrl.disableToggle' label='$ctrl.label' on-help='$ctrl.onHelp()' on-toggle='$ctrl.toggle()' show-help-button='$ctrl.showHelpButton'></p6-control-header>\n<div class='cc-group-content' data-hook='group-content' ng-if='$ctrl.active'>\n<ng-transclude></ng-transclude>\n</div>\n<p17-divider class='cc-hidden-marker'></p17-divider>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c8-label-action.html","<div class='c8a-action-label -active' data-hook='label'>\n<div class='p8-label' data-hook='label'>\n{{ $ctrl.label }}\n</div>\n<div class='c8-label cc-action cc-x-height' data-hook='action' ng-click='$ctrl.onActionClick()'>\n<span class='cc-x-height cc-ellipsis'>\n<span class='cc-pointer'>{{ $ctrl.actionText }}</span>\n</span>\n</div>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c8b-label-graphic.html","<div class='c8-graphic-label' data-hook='label' ng-class='{ &#39;-active&#39;: $ctrl.active, &#39;-is-invalid&#39;: !$ctrl.isValid() }' ng-click='$ctrl.onClick($event)'>\n<p6-control-header active='$ctrl.active' data-hook='header' help-tooltip='{{$ctrl.helpTooltip}}' hide-toggle-button='$ctrl.disableToggle' label='$ctrl.label' on-help='$ctrl.onHelp()' on-toggle='$ctrl.toggle($event)' show-help-button='$ctrl.showHelpButton'></p6-control-header>\n<c11-paragraph html='$ctrl.paragraph' ng-if='$ctrl.paragraph &amp;&amp; $ctrl.active'></c11-paragraph>\n<ul class='cc-icon-list cc-action'>\n<i class='c8-arrow-icon cc-icon-arrow-right'></i>\n<li class='cc-icon-label' data-hook='list-item' ng-click='$ctrl.onClick($event, item)' ng-model='item' ng-repeat='item in $ctrl.items | limitTo:7'>\n<i class='{{item.cssClass}}' data-hook='list-item-icon'></i>\n{{ item.text }}\n</li>\n<li>\n<cc-validation is-valid='$ctrl.isValid()' tooltip='{{$ctrl.validationTooltip}}'></cc-validation>\n</li>\n</ul>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c9-action-button.html","<div class='c9-action-button'>\n<button class='c9-cta cc-x-height' data-hook='action-button' ng-click='$ctrl.onClick()'>\n<span class='cc-x-height'>{{ $ctrl.label }}</span>\n</button>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c10-item-navigation.html","<p11-item-navigation count='$ctrl.count' current='$ctrl.current' next-tooltip='{{$ctrl.nextTooltip}}' on-next='$ctrl.onNext({current: current})' on-previous='$ctrl.onPrevious({current: current})' previous-tooltip='{{$ctrl.previousTooltip}}'></p11-item-navigation>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c11-paragraph.html","<p class='c11-paragraph' data-hook='paragraph' ng-bind-html='$ctrl.html'></p>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c13-checkbox-list.html","<div class='c14-checkbox-list'>\n<div class='checkbox-list-title' data-hook='label'>\n{{ $ctrl.label }}\n</div>\n<div class='checkbox-list-items'>\n<c14-checkbox item='item' ng-repeat='item in $ctrl.items' on-required-change='$ctrl.requiredChange(item)' on-toggle='$ctrl.checkedChange(item)'></c14-checkbox>\n</div>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c14-checkbox.html","<div class='c14-checkbox'>\n<p14-checkbox data-hook='p14-checkbox' item='$ctrl.item' on-required-change='$ctrl.onRequiredChange({ item: $ctrl.item })' on-toggle='$ctrl.onToggle({ item: $ctrl.item })'></p14-checkbox>\n<p17-divider></p17-divider>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c15-radio-buttons.html","<div class='c15-radio-buttons' ng-class='{ &#39;-active&#39;: $ctrl.active }'>\n<p6-control-header active='$ctrl.active' help-tooltip='{{$ctrl.helpTooltip}}' hide-toggle-button='true' label='$ctrl.label' on-help='$ctrl.onHelp()' show-help-button='$ctrl.showHelpButton'></p6-control-header>\n<div class='cc-action'>\n<p13-radio-buttons items='$ctrl.items' on-value-change='$ctrl.onValueChange({value: value})' value='$ctrl.value'></p13-radio-buttons>\n</div>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c16-slider.html","<div class='c16-slider cc-no-animation'>\n<p6-control-header active='true' data-hook='header' help-tooltip='{{$ctrl.helpTooltip}}' hide-toggle-button='true' label='$ctrl.label' ng-if='$ctrl.label.length &gt; 0' on-help='$ctrl.onHelp()' show-help-button='$ctrl.showHelpButton'></p6-control-header>\n<div class='slider-container'>\n<div ng-class='{&#39;horizontal-slider&#39;: $ctrl.horizontal}'>\n<div class='category-labels p8-label' data-hook='label' ng-if='!!$ctrl.categoryLabels'>{{ $ctrl.categoryTitle }}: {{ $ctrl.categoryLabels[$ctrl.value]}}</div>\n<p5-slider clickable-icons='$ctrl.clickableIcons' data-hook='slider' icon-after='{{:: $ctrl.iconAfter }}' icon-before='{{:: $ctrl.iconBefore }}' max='$ctrl.max' min='$ctrl.min' ng-class='{&#39;horizontal-slider-control&#39;: $ctrl.horizontal}' on-value-change='$ctrl.onValueChangeDebounce({value: value})' on-value-settle='$ctrl.onValueSettle({value: value})' step='$ctrl.step' stepper-ticks='false' stepper='$ctrl.stepper' type='{{:: $ctrl.sliderType }}' units='$ctrl.units' value='$ctrl.value'></p5-slider>\n</div>\n</div>\n<p17-divider ng-if='$ctrl.showDivider'></p17-divider>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c17-tabs.html","<div class='c17-tabs'>\n<div class='p8-label c17-tab-head cc-ellipsis' data-hook='tab' ng-class='{&quot;-selected&quot;: $ctrl.selectedItem === $ctrl.items[$index]}' ng-click='$ctrl.itemChange(item)' ng-repeat='item in $ctrl.items'>{{ item.label }}</div>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c18-panel-button.html","<div class='c18b-panel-button'>\n<button class='p9b-text-button' data-hook='button' ng-click='$ctrl.onClick()'><div class='c18b-label cc-ellipsis'><i class='c18b-label-icon cc-icon-add-small'></i>\n&nbsp;\n{{ $ctrl.label }}</div></button>\n<p17-divider class='cc-control-divider -ignore-control-hover'></p17-divider>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c19-toggle.html","<div class='c19-toggle' ng-class='{ &#39;c19a&#39;: !$ctrl.type || $ctrl.type === &#39;c19a&#39;, &#39;c19b&#39;: $ctrl.type === &#39;c19b&#39;, &#39;c19c&#39;: $ctrl.type === &#39;c19c&#39;, &#39;c19m&#39;: $ctrl.type === &#39;c19m&#39;, &#39;-on&#39;: $ctrl.value,   &#39;-off&#39; : !$ctrl.value, &#39;-active&#39;: $ctrl.value }'>\n<p15-toggle cc-tooltip-position='top' cc-tooltip='{{$ctrl.toggleTooltip}}' data-hook='toggle-switch' left-icon='$ctrl.leftIcon' ng-if='$ctrl.type === &#39;c19c&#39;' on-value-change='$ctrl.onValueChange({value: value})' right-icon='$ctrl.rightIcon' value='$ctrl.value'></p15-toggle>\n<p6-control-header active='$ctrl.value' help-tooltip='{{$ctrl.helpTooltip}}' hide-toggle-button='$ctrl.disableToggle' label='$ctrl.label' ng-if='$ctrl.type === &#39;c19b&#39; || $ctrl.type === &#39;c19m&#39;' show-help-button='!!$ctrl.helpTooltip || !!$ctrl.onHelp'></p6-control-header>\n<div class='c19-label cc-ellipsis' data-hook='c19-label' ng-if='!$ctrl.type || $ctrl.type === &#39;c19a&#39; || $ctrl.type === &#39;c19c&#39;'>{{$ctrl.label}}</div>\n<div class='cc-aux-menu' ng-if='!$ctrl.type || $ctrl.type === &#39;c19a&#39; || $ctrl.type === &#39;c19c&#39;'>\n<button cc-tooltip-position='top' cc-tooltip='{{$ctrl.helpTooltip}}' class='cc-aux-btn' data-hook='help-button' ng-click='$ctrl.onHelp(); $event.stopPropagation()' ng-if='!!$ctrl.helpTooltip || !!$ctrl.onHelp'>\n<i class='cc-icon-info'></i>\n</button>\n<button cc-tooltip='{{$ctrl.toggleTooltip}}' class='cc-aux-btn' data-hook='toggle-button' data-name='toggle-button' ng-if='$ctrl.type === &#39;c19m&#39;'>\n<i data-hook='toggle-icon' ng-class='$ctrl.value ? &#39;cc-icon-show&#39; : &#39;cc-icon-hide&#39;'></i>\n</button>\n<p15-toggle cc-tooltip='{{$ctrl.toggleTooltip}}' data-hook='toggle-switch' ng-if='!$ctrl.type || $ctrl.type === &#39;c19a&#39;' on-value-change='$ctrl.onValueChange({value: value})' value='$ctrl.value'></p15-toggle>\n</div>\n<p17-divider class='cc-control-divider -ignore-control-hover' ng-if='!$ctrl.type || $ctrl.type === &#39;c19a&#39; || $ctrl.type === &#39;c19b&#39; || $ctrl.type === &#39;c19m&#39;'></p17-divider>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c20-graphic-radio.html","<div class='c20-graphic-radio' data-hook='element' ng-attr-adi-automation='{{$ctrl.automation}}' ng-class='{&#39;selected&#39;: $ctrl.isSelected, &#39;-small&#39;: $ctrl.small, &#39;disabled&#39;: $ctrl.isDisabled}' ng-click='$ctrl.onClick()'>\n<div class='icon-wrapper' data-hook='icon-wrapper' ng-class='[$ctrl.backgroundColor ? &#39;color-icon&#39; : &#39;&#39;, $ctrl.customClass]' ng-style='{&#39;backgroundColor&#39;: $ctrl.backgroundColor}'>\n<cc-svg-icon class='the-icon' data-hook='the-icon' from-inline=':: $ctrl.complex' icon='{{$ctrl.displayedIcon}}' ng-if='!$ctrl.url'></cc-svg-icon>\n<img class='the-image' data-hook='img-url' ng-if='!!$ctrl.url' ng-src='{{$ctrl.url}}'>\n<div class='hover-img' data-hook='hover-img-url' ng-if='!!$ctrl.hoverImgUrl' ng-style='{&#39;background-image&#39;: &#39;url(&#39; + $ctrl.hoverImgUrl + &#39;)&#39;}'></div>\n</div>\n<cc-svg-icon class='selected-icon' data-hook='selected-indicator' icon='coloration:selected' is-corner-icon=':: true' ng-class='$ctrl.getSelectedIconSize()' ng-if='$ctrl.isSelected'></cc-svg-icon>\n<div class='label-wrapper'>\n<div cc-tooltip-position='bottom' class='label' data-hook='label' ng-attr-cc-tooltip='{{!$ctrl.showTooltipIcon ? $ctrl.tooltip : undefined}}'>\n{{:: $ctrl.label }}\n<div cc-tooltip-position='bottom' cc-tooltip='{{:: $ctrl.tooltip}}' class='cc-icon-info' data-hook='help-button' ng-if='$ctrl.showTooltipIcon'></div>\n</div>\n</div>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c20-addable-list.html","<div class='c20-addable-list'>\n<c20-graphic-radio-control label='{{$ctrl.label}}' on-select='$ctrl.onSelect()' post-radio-items='$ctrl.postRadioItems' radio-items='$ctrl.radioItems' selected-icon-size='medium' selected-radio='$ctrl.selectedRadio' size='big'></c20-graphic-radio-control>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c20-graphic-radio-control.html","<div class='c20-graphic-radio-control-wrapper'>\n<p6-control-header active='$ctrl.headerToggleActive' help-tooltip='{{$ctrl.helpToolTip}}' hide-toggle-button='!$ctrl.showToggleButton' label='$ctrl.label' on-help='$ctrl.onHelp()' on-toggle='$ctrl.onToggle()' show-help-button='$ctrl.showHelpButton'></p6-control-header>\n<div class='cc-primitives-in-row flex-wrap radio-thumbnails -section' data-hook='radios-wrapper' ng-class='$ctrl.size || &#39;big&#39;'>\n<c20-graphic-radio automation='{{:: item.automation}}' background-color=':: item.backgroundColor' complex=':: item.complex' custom-class='{{:: item.class}}' disabled-icon=':: item.disabledIcon' icon=':: item.icon' is-selected='item === $ctrl.selectedRadio' label=':: item.label' ng-disabled='item.isDisabled' ng-mouseenter='$ctrl.onMouseEnter({item})' ng-repeat='item in $ctrl.radioItems' on-click='$ctrl.setSelected(item)' on-tooltip-click='item.onTooltipClick()' selected-icon-size='{{$ctrl.selectedIconSize}}' selected-icon=':: item.selectedIcon' show-tooltip-icon='item.showTooltipIcon' small=':: $ctrl.small' tooltip='{{:: item.tooltip}}' url=':: item.url'></c20-graphic-radio>\n<c20-graphic-radio automation='{{:: item.automation}}' background-color=':: item.backgroundColor' complex=':: item.complex' custom-class='{{:: item.class}}' disabled-icon=':: item.disabledIcon' icon=':: item.icon' is-selected='item === $ctrl.selectedRadio' label=':: item.label' ng-disabled='item.isDisabled' ng-mouseenter='$ctrl.onMouseEnter({item})' ng-repeat='item in $ctrl.postRadioItems' on-click='$ctrl.setSelected(item)' on-tooltip-click='item.onTooltipClick()' selected-icon-size='{{$ctrl.selectedIconSize}}' selected-icon=':: item.selectedIcon' show-tooltip-icon='item.showTooltipIcon' small=':: $ctrl.small' tooltip='{{:: item.tooltip}}' url=':: item.url'></c20-graphic-radio>\n</div>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c22-edit-text-toolbar.html","<div class='c22-edit-text-toolbar'>\n<div class='c22-supersection'>\n<div class='c22-section' ng-if='$ctrl.isSizeVisible()'>\n<div class='c22-nested'>\n<cc-svg-icon cc-tooltip-position='top' cc-tooltip='edit-text.size' class='c22-item' data-hook='size' icon='edit-text:text-size'></cc-svg-icon>\n<div class='c22-nested-bar'>\n<cc-svg-icon class='c22-item' data-hook='size' icon='edit-text:text-size-decrease' ng-click='$ctrl.decreaseSize()'></cc-svg-icon>\n<cc-svg-icon class='c22-item' data-hook='size' icon='edit-text:text-size-increase' ng-click='$ctrl.increaseSize()'></cc-svg-icon>\n</div>\n</div>\n</div>\n<div class='c22-section' ng-if='$ctrl.isBUICSectionVisible()'>\n<cc-svg-icon cc-tooltip-position='top' cc-tooltip='edit-text.bold' class='c22-item' data-hook='bold' icon='edit-text:text-format-bold' ng-class='{&#39;-active&#39;: $ctrl.isActive(&#39;bold&#39;)}' ng-click='$ctrl.handleCommandClick(&#39;bold&#39;)' ng-disabled='$ctrl.commandDisabled(&#39;bold&#39;)'></cc-svg-icon>\n<cc-svg-icon cc-tooltip-position='top' cc-tooltip='edit-text.italic' class='c22-item' data-hook='italic' icon='edit-text:text-format-italic' ng-class='{&#39;-active&#39;: $ctrl.isActive(&#39;italic&#39;)}' ng-click='$ctrl.handleCommandClick(&#39;italic&#39;)' ng-disabled='$ctrl.commandDisabled(&#39;italic&#39;)'></cc-svg-icon>\n<cc-svg-icon cc-tooltip-position='top' cc-tooltip='edit-text.underline' class='c22-item' data-hook='underline' icon='edit-text:text-format-underline' ng-class='{&#39;-active&#39;: $ctrl.isActive(&#39;underline&#39;)}' ng-click='$ctrl.handleCommandClick(&#39;underline&#39;)' ng-disabled='$ctrl.commandDisabled(&#39;underline&#39;)'></cc-svg-icon>\n<div class='c22-nested'>\n<cc-svg-icon cc-tooltip-position='top' cc-tooltip='edit-text.color' class='c22-item' data-hook='color' icon='edit-text:text-color'></cc-svg-icon>\n<div class='c22-nested-bar'>\n<cc-svg-icon class='c22-item' data-hook='color' icon='edit-text:text-color' ng-click='$ctrl.setColor(&#39;1&#39;)'></cc-svg-icon>\n<cc-svg-icon class='c22-item' data-hook='color' icon='edit-text:text-color' ng-click='$ctrl.setColor(&#39;2&#39;)'></cc-svg-icon>\n<cc-svg-icon class='c22-item' data-hook='color' icon='edit-text:text-color' ng-click='$ctrl.setColor(&#39;3&#39;)'></cc-svg-icon>\n<cc-svg-icon class='c22-item' data-hook='color' icon='edit-text:text-color' ng-click='$ctrl.setColor(&#39;4&#39;)'></cc-svg-icon>\n<cc-svg-icon class='c22-item' data-hook='color' icon='edit-text:text-color' ng-click='$ctrl.setColor(&#39;5&#39;)'></cc-svg-icon>\n<cc-svg-icon class='c22-item' data-hook='color' icon='edit-text:text-color' ng-click='$ctrl.setColor(&#39;6&#39;)'></cc-svg-icon>\n</div>\n</div>\n</div>\n<div class='c22-section'>\n<div class='c22-nested'>\n<cc-svg-icon cc-tooltip-position='top' cc-tooltip='edit-text.align' class='c22-item' data-hook='align' icon='edit-text:text-align-{{$ctrl.getAlign()}}'></cc-svg-icon>\n<div class='c22-nested-bar'>\n<cc-svg-icon class='c22-item' data-hook='align-left' icon='edit-text:text-align-left' ng-class='{&#39;-active&#39;: $ctrl.getAlign() === &#39;left&#39;}' ng-click='$ctrl.setAlign(&#39;left&#39;)'></cc-svg-icon>\n<cc-svg-icon class='c22-item' data-hook='align-center' icon='edit-text:text-align-center' ng-class='{&#39;-active&#39;: $ctrl.getAlign() === &#39;center&#39;}' ng-click='$ctrl.setAlign(&#39;center&#39;)'></cc-svg-icon>\n<cc-svg-icon class='c22-item' data-hook='align-right' icon='edit-text:text-align-right' ng-class='{&#39;-active&#39;: $ctrl.getAlign() === &#39;right&#39;}' ng-click='$ctrl.setAlign(&#39;right&#39;)'></cc-svg-icon>\n</div>\n</div>\n<div class='c22-nested' ng-if='$ctrl.isListingSectionVisible()'>\n<cc-svg-icon cc-tooltip-position='top' cc-tooltip='edit-text.list' class='c22-item' data-hook='list' icon='edit-text:text-list-{{$ctrl.isActive(&#39;bullets&#39;) ? &#39;bulleted&#39; : &#39;numbered&#39;}}' ng-class='{&#39;-active&#39;: $ctrl.isActive(&#39;bullets&#39;) || $ctrl.isActive(&#39;numbers&#39;)}'></cc-svg-icon>\n<div class='c22-nested-bar'>\n<cc-svg-icon cc-tooltip-position='top' cc-tooltip='edit-text.bullets' class='c22-item' data-hook='bullets' icon='edit-text:text-list-bulleted' ng-class='{&#39;-active&#39;: $ctrl.isActive(&#39;bullets&#39;)}' ng-click='$ctrl.handleCommandClick(&#39;bullets&#39;)' ng-disabled='$ctrl.commandDisabled(&#39;bullets&#39;)'></cc-svg-icon>\n<cc-svg-icon cc-tooltip-position='top' cc-tooltip='edit-text.numbers' class='c22-item' data-hook='numbers' icon='edit-text:text-list-numbered' ng-class='{&#39;-active&#39;: $ctrl.isActive(&#39;numbers&#39;)}' ng-click='$ctrl.handleCommandClick(&#39;numbers&#39;)' ng-disabled='$ctrl.commandDisabled(&#39;numbers&#39;)'></cc-svg-icon>\n</div>\n</div>\n</div>\n<div class='c22-section' ng-if='$ctrl.isLinkingSectionVisible()'>\n<cc-svg-icon cc-tooltip-position='top' cc-tooltip='{{ $ctrl.getLinkTooltip() }}' class='c22-item' data-hook='link' icon='edit-text:text-link' ng-class='{&#39;-active&#39;: $ctrl.isActive(&#39;link&#39;)}' ng-click='$ctrl.handleCommandClick(&#39;link&#39;)' ng-disabled='$ctrl.commandDisabled(&#39;link&#39;)'></cc-svg-icon>\n</div>\n<div class='c22-section' ng-if='$ctrl.isClearFormattingSectionVisible()'>\n<cc-svg-icon cc-tooltip-position='top' cc-tooltip='edit-text.clear-formatting' class='c22-item' data-hook='clear-formatting' icon='edit-text:text-clear-formatting' ng-class='{&#39;-active&#39;: $ctrl.isActive(&#39;clear-formatting&#39;)}' ng-click='$ctrl.handleCommandClick(&#39;clear-formatting&#39;)' ng-disabled='$ctrl.commandDisabled(&#39;clear-formatting&#39;)'></cc-svg-icon>\n</div>\n<div class='c22-section'>\n<div class='c22-action' ng-click='$ctrl.handleActionClick()'>\n{{:: $ctrl.actionLabel }}\n</div>\n</div>\n</div>\n<div class='c22-supersection'>\n<cc-svg-icon cc-tooltip-position='top' cc-tooltip='edit-text.hide' class='c22-item' data-hook='hide' icon='edit-text:text-hide' ng-click='$ctrl.handleHideClick()'></cc-svg-icon>\n</div>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c23-rich-text-input.html","<div class='c23-rich-text-input' data-hook='container' ng-class='{ &#39;-active&#39;: $ctrl.active, &#39;-focused&#39;: $ctrl.inFocus }' ng-mouseenter='$ctrl.onMouseEnter()' ng-mouseleave='$ctrl.onMouseLeave()'>\n<p6-control-header action-label='$ctrl.actionLabel' action-tooltip='{{$ctrl.actionTooltip}}' active='$ctrl.active' data-hook='p6-control-header' help-tooltip='{{$ctrl.helpTooltip}}' hide-toggle-button='$ctrl.disableToggle' label='$ctrl.label' on-action='$ctrl.onAction()' on-help='$ctrl.onHelp()' on-toggle='$ctrl.toggle()' show-action='$ctrl.showAction' show-help-button='$ctrl.showHelpButton'></p6-control-header>\n<div class='cc-action' ng-class='{&#39;focus&#39;: $ctrl.inFocus}' ng-if='$ctrl.active'>\n<p22-rich-text-toolbar command-state='$ctrl.getCommandState(command)' data-hook='p22-rich-text-toolbar' displayed-sections='$ctrl.displayedRTTSections' ng-class='{&#39;in-focus&#39;: $ctrl.inFocus}' on-click='$ctrl.runCommand(command)'></p22-rich-text-toolbar>\n<p23-rich-text-input change-value-on-blur='$ctrl.changeValueOnBlur' command-state='$ctrl.getCommandState(command)' data-hook='p23-rich-text-input' debounce-delay='$ctrl.debounceDelay' default-formatting='$ctrl.defaultFormatting' focus-on-init='$ctrl.focusOnInit' focused='$ctrl.focused' force-focus='$ctrl.forceFocus' ignore-blur-and-focus='$ctrl.ignoreBlurAndFocus' is-disabled='$ctrl.isDisabled' links-manager='$ctrl.linksManager' max-length='{{$ctrl.maxLength}}' on-blur='$ctrl.onInputBlur($event, $value)' on-change-value='$ctrl.onChange(value)' on-external-paste='$ctrl.onExternalPaste(value)' on-focus='$ctrl.onInputFocus($event)' on-link-command='$ctrl.onLinkCommand({linkId: linkId})' on-ready='$ctrl.onEditorReady()' placeholder='$ctrl.placeholder' register-command-runner='$ctrl.registerCommandRunner(runner, utilFuncs)' styles-manager='$ctrl.stylesManager' validation='$ctrl.validation' value='$ctrl.value'></p23-rich-text-input>\n</div>\n<p17-divider></p17-divider>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c24-media-preview.html","<div adi-automation='media-container' class='c24-media-preview' data-hook='container' ng-class='$ctrl.cssClass'>\n<p6-control-header active='$ctrl.active' class='c2-header' data-hook='header' label='$ctrl.label' ng-if='$ctrl.showHeader' on-toggle='$ctrl.toggle()'></p6-control-header>\n<div adi-automation='media-tabs' class='c24-tabs' data-hook='tabs' ng-if=':: $ctrl.showTabs'>\n<c20-graphic-radio-control class='part-of' data-hook='options' label='{{::$ctrl.label}}' ng-if='$ctrl.active' on-select='$ctrl.showTab(item.id)' radio-items='$ctrl.options' selected-radio='$ctrl.selectedTab()' size='small'></c20-graphic-radio-control>\n</div>\n<div class='c24-body' data-hook='preview-container' ng-show='$ctrl.active'>\n<div class='c24-preview-wrapper' data-hook='preview-content' ng-mouseenter='$ctrl.hoveringEditPanel = true;' ng-mouseleave='$ctrl.hoveringEditPanel = false;'>\n<img alt='{{$ctrl.previewMediaAlt}}' class='preview is-image' data-hook='single-image-thumb' ng-if='$ctrl.imageSelected' ng-src='{{$ctrl.previewMediaUrl}}' title='{{$ctrl.previewMediaTitle}}'>\n<img class='preview is-gallery' data-hook='gallery-thumbs' ng-if='$ctrl.gallerySelected' ng-src='{{$ctrl.previewMediaUrl}}' title='{{$ctrl.previewMediaTitle}}'>\n<img class='preview is-video' data-hook='video-thumb' ng-if='$ctrl.videoSelected' ng-src='{{$ctrl.previewMediaUrl}}' title='{{$ctrl.previewMediaTitle}}'>\n<img class='preview is-ext-video' data-hook='ext-video-thumb' ng-if='$ctrl.extVideoSelected' ng-src='{{$ctrl.previewMediaUrl}}' title='{{$ctrl.previewMediaTitle}}'>\n<img class='preview is-video' data-hook='ext-video' ng-if='$ctrl.inlineVideoSelected' ng-src='{{$ctrl.previewMediaUrl}}' title='{{$ctrl.previewMediaTitle}}'>\n<img class='preview is-shape' data-hook='shape-thumb' ng-if='$ctrl.shapeSelected' ng-src='{{$ctrl.previewMediaUrl}}' title='{{$ctrl.previewMediaTitle}}'>\n<img class='preview is-clipart' data-hook='clipart-thumb' ng-if='$ctrl.clipartSelected' ng-src='{{$ctrl.previewMediaUrl}}' title='{{$ctrl.previewMediaTitle}}'>\n<div class='preview is-pattern' data-hook='pattern-thumb' ng-if='$ctrl.patternSelected' ng-style='$ctrl.patternStyle'></div>\n<div class='c24-overlay preview'>\n<div class='c24-overlay-default-buttons' ng-if='$ctrl.showCustomize'>\n<button adi-automation='customize-media-button' class='p9-primary cc-x-height' data-hook='customize-button' ng-class='::{&#39;-small&#39;: $ctrl.isSmall, &#39;-medium&#39;: !$ctrl.isSmall}' ng-click='$ctrl.onCustomize()'>\n<span class='cc-x-height font-t2' ng-bind-html='$ctrl.customizeButtonText'></span>\n</button>\n</div>\n<div class='c24-overlay-default-buttons' ng-if='!$ctrl.showCustomize &amp;&amp; !$ctrl.gallerySelected'><button adi-automation='replace-button' class='p9a-secondary cc-x-height -medium' data-hook='replace-button' ng-class='{&#39;-disabled&#39;: $ctrl.disableMediaChangeButton}' ng-click='$ctrl.replaceMedia()' ng-disabled='$ctrl.disableMediaChangeButton' ng-if='$ctrl.showReplaceButton'><span class='cc-x-height font-t2' ng-bind-html='$ctrl.replaceButtonText'></span></button><div class='replace-options-menu-container' ng-if='$ctrl.showReplaceOptionsButton' ng-mouseenter='$ctrl.showReplaceOptions()' ng-mouseleave='$ctrl.hideReplaceOptions()'><button adi-automation='replace-button' class='p9a-secondary cc-x-height -medium' data-hook='replace-button' ng-class='{&#39;-disabled&#39;: $ctrl.disableMediaChangeButton}' ng-disabled='$ctrl.disableMediaChangeButton' ng-if='$ctrl.showReplaceOptionsButton'><span class='cc-x-height font-t2' ng-bind-html='$ctrl.replaceButtonText'></span>\n<div class='cc-icon-arrow-down'></div></button><div aria-describedby='list-item-menu' class='p4-action-menu replace-options-menu' ng-click='$ctrl.hideReplaceOptions()' ng-if='$ctrl.showReplaceOptionsMenu' ng-mouseleave='$ctrl.hideReplaceOptions()' role='menu' tabindex='-1'>\n<div class='replace-options-menu-content' ng-transclude='options'></div>\n</div>\n</div>\n</div>\n<div class='c24-overlay-default-buttons' ng-if='!$ctrl.showCustomize &amp;&amp; $ctrl.patternSelected'><button adi-automation='media-color-button' class='p9a-secondary cc-x-height -medium' data-hook='color-button' ng-click='$ctrl.onColorClick()'><span class='cc-x-height font-t2' ng-bind-html='$ctrl.colorButtonText'></span></button></div>\n<div class='c24-overlay-gallery-buttons' ng-if='!$ctrl.showCustomize &amp;&amp; $ctrl.gallerySelected'>\n<button adi-automation='organize-media-button' class='p9a-secondary cc-x-height -medium' data-hook='organize-media-button' ng-class='{&#39;-disabled&#39;: $ctrl.disableMediaChangeButton}' ng-click='$ctrl.replaceMedia()' ng-disabled='$ctrl.disableMediaChangeButton'>\n<span class='cc-x-height font-t2' ng-bind-html='$ctrl.organizeMediaButtonText'></span>\n</button>\n</div>\n</div>\n</div>\n<div class='c24m-controls' data-hook='side-controls' ng-if='$ctrl.type === &quot;c24m&quot; &amp;&amp; $ctrl.active'><button class='c24m-controls-crop p9-primary -controlbtn -with-icon cc-x-height' data-hook='crop-menu' ng-click='$ctrl.onCrop()' ng-show='$ctrl.imageSelected &amp;&amp; $ctrl.imageCrop'><i cc-tooltip-position='top' cc-tooltip='settings' class='cc-icon-crop'></i>Crop</button><div class='cc-aux-menu' data-hook='c2-aux-menu' ng-hide='$ctrl.prefix'>\n<button cc-tooltip='hide_item' class='cc-aux-btn' data-hook='toggle-button' ng-click='$ctrl.toggle()' ng-hide='$ctrl.disableToggle'>\n<i class='cc-icon-show' data-hook='toggle-icon'></i>\n</button>\n</div>\n</div>\n<div adi-automation='{{:: $ctrl.mediaType}}' cc-tooltip='{{mediaType}}' class='type-icon' data-hook='type-icon' ng-class='{&#39;-with-small-media&#39;: $ctrl.isSmallMedia}'>\n<cc-svg-icon cc-tooltip='{{$ctrl.indicatorIcon}}' data-hook='indicator' icon='section-media:{{ $ctrl.mediaType}}'></cc-svg-icon>\n</div>\n</div>\n<p17-divider ng-class='{&#39;cc-hidden-marker&#39;: $ctrl.type !== &#39;c24m&#39;}'></p17-divider>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c25-background-preview.html","<div class='c25-background-preview-inner' data-hook='inner-element' ng-click='$ctrl.onEdit()'>\n<header class='-active'>\n<p6-control-header class='p6-control-header' data-hook='label' hide-toggle-button='true' label='$ctrl.label'></p6-control-header>\n<button class='-controlbtn p9a-secondary edit-button'>Edit</button>\n</header>\n<p25-background-preview data='$ctrl.data'></p25-background-preview>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c26-image-position.html","<div class='c26-image-position' ng-class='{&quot;with-footer&quot;: $ctrl.showFooter}'>\n<p16-panel-header class='header-style' label='{{$ctrl.headerTitle}}' on-close='$ctrl.onClose()' show-close-button='true'></p16-panel-header>\n<c11-paragraph class='header-body' html='$ctrl.body' ng-if='$ctrl.body'></c11-paragraph>\n<div class='rectangles-container'>\n<p26-image-position on-position-clicked='$ctrl.onPositionClicked({index})' rectangles-count-each-row='$ctrl.rectanglesCountEachRow' rectangles-count='$ctrl.rectanglesCount' selected-rectangle='$ctrl.selectedRectangle'></p26-image-position>\n</div>\n<c11-paragraph class='footer-content' html='$ctrl.footerContentText' ng-click='$ctrl.footerLinkClicked($event)' ng-if='$ctrl.showFooter'></c11-paragraph>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c27-increase-decrease.html","<div class='icons-container'>\n<cc-svg-icon class='icon' data-hook='decrease-icon' icon='{{$ctrl.decreaseIcon}}' ng-click='$ctrl.decrease()' ng-disabled='$ctrl.decreaseShouldDisable()'></cc-svg-icon>\n<cc-svg-icon class='icon' data-hook='increase-icon' icon='{{$ctrl.increaseIcon}}' ng-click='$ctrl.increase()' ng-disabled='$ctrl.increaseShouldDisable()'></cc-svg-icon>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/c28-dropdown-action.html","<div class='c28-dropdown-action cc-container'>\n<p16-panel-header help-tooltip='{{::$ctrl.helpTooltip}}' label='{{::$ctrl.headline}}' on-close='$ctrl.close()' on-help='$ctrl.onHelp()' show-close-button='true' show-help-button='$ctrl.showHelpButton'></p16-panel-header>\n<c11-paragraph html='$ctrl.description'></c11-paragraph>\n<c3-dropdown-list data-hook='pages-dropdown' disable-toggle='true' items='$ctrl.optionsList' label-key='name' label='{{::$ctrl.dropDownTitle}}' track-by-key='value' value='$ctrl.selectedOption'></c3-dropdown-list>\n<div class='footer-buttons'>\n<button adi-automation='dialog.cancel' class='p9b-text-button -large' data-hook='dialog.cancel' ng-class='{&#39;-red&#39;: $ctrl.negative}' ng-click='$ctrl.close()'>\n{{::$ctrl.closeLabel}}\n</button>\n<button adi-automation='dialog.ok' class='p9-primary -small' data-hook='dialog.ok' ng-class='{&#39;-red&#39;: $ctrl.negative}' ng-click='$ctrl.done()'>\n<span class='cc-x-height'>\n{{::$ctrl.doneLabel}}\n</span>\n</button>\n</div>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/autocomplete.html","<ul cc-scrollbar class='cc-autocomplete' data-hook='autocomplete' ng-attr-id='{{$ctrl.randId}}'>\n<li class='cc-suggestion' data-hook='autocomplete-item' ng-attr-id='{{&#39;ac-&#39; + $ctrl.randId + &#39;-item-&#39; + $index}}' ng-class='{&quot;-selected&quot;: $ctrl.hoveredIndex === $index}' ng-mousedown='$ctrl.onItemSelect({ item: match })' ng-repeat='match in $ctrl.matches'>\n{{ match }}\n</li>\n<li class='cc-autocomplete-action cc-x-height' data-hook='autocomplete-action-link' ng-class='{&quot;-selected&quot;: $ctrl.hoveredIndex === $ctrl.matches.length}' ng-if='$ctrl.linkLabel' ng-mousedown='$ctrl.onLinkClick()'>\n<span class='cc-x-height'>{{ $ctrl.linkLabel }}</span>\n</li>\n</ul>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/autocomplete-media.html","<ul cc-scrollbar class='cc-autocomplete cc-autocomplete-media' data-hook='autocomplete' ng-attr-id='{{$ctrl.randId}}' ng-if='$ctrl.matches.length'>\n<li class='cc-media-suggestion cc-x-height' data-hook='autocomplete-item' ng-attr-id='{{&#39;ac-&#39; + $ctrl.randId + &#39;-item-&#39; + $index}}' ng-class='{&quot;-selected&quot;: $ctrl.hoveredIndex === $index}' ng-mousedown='$ctrl.onItemSelect({ item: match })' ng-repeat='match in $ctrl.matches'>\n<img class='cc-media-suggestion-icon' data-hook='item-media' ng-class='{ &#39;-circle&#39;: $ctrl.isImage(match.media)}' ng-src='{{ $ctrl.mediaUrl.generate(match.media) }}'>\n<span class='cc-media-suggestion-text cc-x-height' data-hook='item-text'>{{ match.text }}</span>\n</li>\n</ul>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/button-editor.html","<c7-multi-field-group active='$ctrl.active' data-hook='editor-group' disable-toggle='$ctrl.disableToggle' label='{{:: $ctrl.label}}' on-toggle='$ctrl.onToggle({visibility: visibility})'>\n<c2-text-input data-hook='button-text-input' debounce-delay=':: $ctrl.debounceDelay' disable-toggle='true' focused='$ctrl.focused' label='{{:: &quot;cc.button-editor.button-text.label&quot; | translate }}' on-blur='$ctrl.onBlur($event)' on-change-value='$ctrl.onTextChange({value: value})' value='$ctrl.text'></c2-text-input>\n<c5-link-input data-hook='button-link-input' disable-toggle='true' label='{{:: &quot;cc.button-editor.button-link.label&quot; | translate }}' link='$ctrl.link' on-edit-link='$ctrl.onEditLink({link: link})'></c5-link-input>\n</c7-multi-field-group>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/button-editor-link.html","<c2-text-input active='$ctrl.active' button-text='{{:: &quot;cc.button-editor-link.button-text-link.label&quot; | translate }}' data-hook='button-text-input' debounce-delay=':: $ctrl.debounceDelay' disable-toggle='$ctrl.disableToggle' focused='$ctrl.focused' icon-name='rich-text:link' label='{{:: $ctrl.label}}' no-header='!$ctrl.showHeader' on-blur='$ctrl.onBlur($event)' on-button-click='$ctrl.onEditLink()' on-change-value='$ctrl.onTextChange({value: value})' on-icon-click='$ctrl.onEditLink()' on-toggle='$ctrl.onToggle({visibility: visibility})' show-button='!$ctrl.isLinked' show-icon='$ctrl.isLinked' value='$ctrl.text'></c2-text-input>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/menu-item.html","<div class='p4-item cc-x-height contains-child-hover-icons' data-hook='menu-item' ng-click='$ctrl.onClick()'><i class='p4-item-icon' data-hook='menu-item-icon' ng-class='$ctrl.icon' ng-if='$ctrl.icon'></i><cc-svg-icon class='p4-item-icon' data-hook='menu-item-svg-icon' from-inline='$ctrl.svgIconFromInline' hover-icon='{{$ctrl.svgIconHover}}' icon='{{$ctrl.svgIcon}}' ng-if='$ctrl.svgIcon'></cc-svg-icon><span class='cc-x-height'>{{ $ctrl.label }}</span></div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/cc-tip-message.html","<div class='tip-message-container'>\n<div class='title-container'>\n<i class='title-icon' ng-class='$ctrl.titleIcon' ng-if='$ctrl.titleIcon'></i>\n<div class='tip-title'>{{$ctrl.title}}</div>\n<i class='close-icon cc-icon-close-8' ng-click='$ctrl.onCloseTip()' ng-if='$ctrl.enableClose'></i>\n</div>\n<div class='body-container'>\n<span class='tip-description'>{{$ctrl.description}}</span>\n</div>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/visible-tooltip.html","<c15-radio-buttons items='$ctrl.radioButtons' label='visible {{$ctrl.type}} error / info tooltip' on-value-change='$ctrl.onRadioValueChange(value)' value='$ctrl.radioValue'></c15-radio-buttons>\n<p0-spacer></p0-spacer>\n<c23-rich-text-input displayed-r-t-t-sections='$ctrl.displayedRTTSections' label='visible {{$ctrl.type}} tooltip' on-link-command='$ctrl.onLinkCommand()' value='$ctrl.content'></c23-rich-text-input>\n<div class='tooltipster-visible-wrapper'>\n<div class='tooltipster-visible tooltipster-base cc-tooltip tooltipster-fade tooltipster-fade-show' ng-class='[&quot;-&quot; + $ctrl.type, &quot;-&quot; + $ctrl.purpose]'>\n<div class='tooltipster-content'>\n<div class='cc-tooltip' ng-class='&quot;-&quot; + $ctrl.purpose'>\n<div>\n<div class='cc-tooltip-content' ng-bind-html='$ctrl.content'></div>\n</div>\n</div>\n</div>\n<div class='tooltipster-arrow-bottom tooltipster-arrow'>\n<span ng-class='&quot;tooltipster-visible-arrow-&quot; + $ctrl.purpose'></span>\n</div>\n</div>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/cc-panel-frame.html","<div class='cc-panel-frame cc-container' ng-class='{ &#39;-with-p18-footer&#39;: $ctrl.hasFooter()}'>\n<p16-panel-header action-shourtcut='!!$ctrl.showHeaderActionShourtcut' data-hook='panel-header' help-tooltip='{{::$ctrl.helpTooltip}}' label='{{$ctrl.label}}' ng-if='$ctrl.hasHeader()' number='{{$ctrl.number}}' on-close='$ctrl.onClose()' on-help='$ctrl.onHelp()' on-reset='$ctrl.onReset()' on-return='$ctrl.onReturn()' show-close-button='$ctrl.showCloseButton' show-help-button='$ctrl.showHelpButton' show-nested='$ctrl.showNested' show-reset-button='$ctrl.showResetButton' show-return-button='$ctrl.showReturnButton'>\n<shourtcut>\n<div class='header-action-shourtcut' ng-transclude='shourtcut'></div>\n</shourtcut>\n</p16-panel-header>\n<div class='cc-panel-fixed-top' data-hook='panel-fixed-top' ng-if='!$ctrl.ccFlags.cardsToPanels &amp;&amp; $ctrl.hasFixedTop()' ng-transclude='fixedTop'></div>\n<ng-transclude cc-scrollbar cc-scrollbar-disable='{{$ctrl.scrollDisabled}}' class='cc-panel-body' data-hook='default-transclude' ng-class='{&#39;scroll-disabled&#39;: $ctrl.scrollDisabled}' ng-if='!$ctrl.ccFlags.cardsToPanels &amp;&amp; !$ctrl.usesPanelBody()'></ng-transclude>\n<div cc-scrollbar cc-scrollbar-disable='{{$ctrl.scrollDisabled}}' class='cc-panel-body' data-hook='panel-body' ng-class='{&#39;scroll-disabled&#39;: $ctrl.scrollDisabled}' ng-if='!$ctrl.ccFlags.cardsToPanels &amp;&amp; $ctrl.usesPanelBody()' ng-transclude='body'></div>\n<div class='p18-panel-footer' data-hook='panel-footer' ng-if='!$ctrl.ccFlags.cardsToPanels &amp;&amp; $ctrl.hasFooter()' ng-transclude='footer'></div>\n<div class='cc-inner-content' data-hook='inner-content' ng-class='{&#39;-initialized&#39;: $ctrl.initialized, &#39;animate-if&#39;: $ctrl.showContentDelay, &#39;-show-nested&#39;: $ctrl.showNested}' ng-if='$ctrl.ccFlags.cardsToPanels &amp;&amp; $ctrl.showContent'>\n<div class='cc-panel-fixed-top' data-hook='panel-fixed-top' ng-if='$ctrl.hasFixedTop()' ng-transclude='fixedTop'></div>\n<ng-transclude cc-scrollbar cc-scrollbar-disable='{{$ctrl.scrollDisabled}}' class='cc-panel-body' data-hook='default-transclude' ng-class='{&#39;scroll-disabled&#39;: $ctrl.scrollDisabled}' ng-if='!$ctrl.usesPanelBody()'></ng-transclude>\n<div cc-scrollbar cc-scrollbar-disable='{{$ctrl.scrollDisabled}}' class='cc-panel-body' data-hook='panel-body' ng-class='{&#39;scroll-disabled&#39;: $ctrl.scrollDisabled}' ng-if='$ctrl.usesPanelBody()' ng-transclude='body'></div>\n<div class='cc-panel-nested' data-hook='nested-panel' ng-if='$ctrl.hasNestedPanel()' ng-transclude='nested'></div>\n<div class='p18-panel-footer' data-hook='panel-footer' ng-if='$ctrl.hasFooter()' ng-transclude='footer'></div>\n</div>\n</div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/cc-validation.html","<div cc-tooltip='{{$ctrl.tooltip}}' class='cc-invalid-icon cc-icon-negative-validation' data-hook='cc-validation' ng-hide='$ctrl.isValid'></div>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/popups/iframe.html","<md-dialog aria-describedby='iframe' aria-label='iframe' class='cc-md-dialog md-transition-in' role='dialog' tabindex='-1'>\n<iframe ng-src='{{$ctrl.link}}'></iframe>\n</md-dialog>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/popups/support-iframe.html","<md-dialog aria-describedby='iframe' aria-label='iframe' class='cc-md-dialog support-iframe md-transition-in' role='dialog' tabindex='-1'>\n<md-progress-circular md-mode='indeterminate' ng-if='!$ctrl.loaded'></md-progress-circular>\n<div class='iframe-container'>\n<button class='cc-aux-btn cc-icon-close-10 cc-icon-circle dialog-close' ng-click='$ctrl.cancel()' ng-hide='!$ctrl.loaded'></button>\n<iframe cc-support-iframe-ready='$ctrl.iframeLoaded()' ng-hide='!$ctrl.loaded' ng-src='{{$ctrl.link}}'></iframe>\n</div>\n</md-dialog>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/popups/first-time-notice.html","<md-dialog aria-describedby='first-time-notice' aria-label='{{ $ctrl.heading }}' class='cc-md-dialog md-transition-in' role='dialog' tabindex='-1'>\n<div class='cc-generic-popup'>\n<div class='cc-popup-header'>\n<div class='cc-aux-menu'>\n<button class='cc-aux-btn cc-icon-help-12x7' ng-click='$ctrl.onHelp()' ng-show='$ctrl.onHelp'></button>\n<button class='cc-aux-btn cc-icon-close-10' ng-click='$ctrl.cancel()' ng-show='$ctrl.cancel'></button>\n</div>\n</div>\n<img class='cc-popup-icon' relative-src='{{$ctrl.icon}}'>\n<div class='text-h4 cc-popup-heading' compile='$ctrl.heading'></div>\n<p class='cc-popup-text' compile='$ctrl.text'></p>\n<button class='cc-x-height p9-primary -medium dialog-close' ng-click='$ctrl.onConfirm()'>\n<span class='cc-x-height'>{{ $ctrl.acceptButtonText }}</span>\n</button>\n<div class='cc-popup-footer'>\n<p14-checkbox item='$ctrl.checkbox' ng-hide='$ctrl.hideFirstTimeCheckBox'></p14-checkbox>\n</div>\n</div>\n</md-dialog>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/popups/positive-confirmation.html","<md-dialog aria-describedby='positive-confirmation' aria-label='{{ $ctrl.heading }}' class='cc-md-dialog md-transition-in' role='dialog' tabindex='-1'>\n<div class='cc-generic-popup'>\n<div class='cc-popup-header'>\n<div class='cc-aux-menu'>\n<button class='cc-aux-btn cc-icon-help-12x7' ng-click='$ctrl.onHelp()' ng-show='$ctrl.onHelp'></button>\n<button class='cc-aux-btn cc-icon-close-10' ng-click='$ctrl.$mdDialog.cancel()' ng-hide='$ctrl.noClose'></button>\n</div>\n</div>\n<img class='cc-popup-icon' ng-if='$ctrl.icon' relative-src='{{$ctrl.icon}}'>\n<div class='cc-popup-icon -positive' ng-if='!$ctrl.icon'></div>\n<div class='text-h4 cc-popup-heading' compile='$ctrl.heading'></div>\n<p class='cc-popup-text' compile='$ctrl.text'></p>\n<button class='cc-x-height cc-popup-accept p9-primary -medium dialog-close' ng-click='$ctrl.onConfirm()'>\n<span class='cc-x-height'>{{ $ctrl.acceptButtonText }}</span>\n</button>\n<button class='cc-x-height p9b-text-button -medium' ng-click='$ctrl.$mdDialog.cancel()' ng-if='$ctrl.rejectButtonText.trim()'>\n<span class='cc-x-height'>{{ $ctrl.rejectButtonText }}</span>\n</button>\n</div>\n</md-dialog>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/popups/positive-continued-action.html","<md-dialog aria-describedby='positive-continued-action' aria-label='{{ $ctrl.heading }}' class='cc-md-dialog md-transition-in' role='dialog' tabindex='-1'>\n<c28-dropdown-action close-label='$ctrl.rejectButtonText' description='$ctrl.description' done-label='$ctrl.acceptButtonText' drop-down-title='$ctrl.text' headline='$ctrl.heading' help-tooltip='{{::$ctrl.helpTooltip}}' on-close='$ctrl.cancel' on-done='$ctrl.hide' on-help='$ctrl.onHelp()' on-select='$ctrl.handleSelectionChange(option)' options-list='$ctrl.dropDownItems' selected-option='$ctrl.dropDown' show-help-button='$ctrl.showHelpButton'></c28-dropdown-action>\n</md-dialog>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/popups/negative-confirmation.html","<md-dialog aria-describedby='negative-confirmation' aria-hidden='true' aria-label='{{ $ctrl.heading }}' class='cc-md-dialog md-transition-in' role='dialog' tabindex='-1'>\n<div class='cc-generic-popup'>\n<div class='cc-popup-header'>\n<div class='cc-aux-menu'>\n<button class='cc-aux-btn cc-icon-help-12x7' ng-click='$ctrl.onHelp()' ng-show='$ctrl.onHelp'></button>\n<button class='cc-aux-btn cc-icon-close-10' ng-click='$ctrl.$mdDialog.cancel()' ng-show='$ctrl.$mdDialog.cancel'></button>\n</div>\n</div>\n<img class='cc-popup-icon' ng-if='$ctrl.icon' relative-src='{{$ctrl.icon}}'>\n<div class='cc-popup-icon -negative' ng-if='!$ctrl.icon'></div>\n<div class='text-h4 cc-popup-heading' compile='$ctrl.heading'></div>\n<p class='cc-popup-text' compile='$ctrl.text'></p>\n<button class='cc-x-height cc-popup-accept p9-primary -medium -red dialog-close' ng-click='$ctrl.onConfirm()'>\n<span class='cc-x-height'>{{ $ctrl.acceptButtonText }}</span>\n</button>\n<button class='cc-x-height p9b-text-button -medium -red' ng-click='$ctrl.$mdDialog.cancel()' ng-if='$ctrl.rejectButtonText'>\n<span class='cc-x-height'>{{ $ctrl.rejectButtonText }}</span>\n</button>\n</div>\n</md-dialog>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/popups/negative-continued-action.html","<md-dialog aria-describedby='negative-continued-action' aria-label='{{ $ctrl.heading }}' class='cc-md-dialog md-transition-in' role='dialog' tabindex='-1'>\n<c28-dropdown-action close-label='$ctrl.rejectButtonText' done-label='$ctrl.acceptButtonText' headline='$ctrl.heading' help-tooltip='$ctrl.helpTooltip' negative='true' on-close='$ctrl.cancel' on-done='$ctrl.hide' on-help='$ctrl.onHelp()' on-select='$ctrl.handleSelectionChange(option)' options-list='$ctrl.dropDownItems' selected-option='$ctrl.dropDown' show-help-button='true' sub-text='$ctrl.text'></c28-dropdown-action>\n</md-dialog>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/popups/multi-page-popup.html","<md-dialog aria-describedby='first-time-mobile-editor-notice' aria-label='{{ $ctrl.heading }}' class='cc-md-dialog md-transition-in' role='dialog' tabindex='-1'>\n<div class='cc-generic-popup cc-multi-page-popup'>\n<div class='cc-popup-header'>\n<div class='cc-aux-menu'>\n<button class='cc-aux-btn cc-icon-close-10' ng-click='$ctrl.cancel()'></button>\n</div>\n</div>\n<img class='cc-popup-icon' ng-if='!$ctrl.isNext' relative-src='{{$ctrl.icon}}'>\n<img class='cc-popup-icon' ng-if='$ctrl.isNext' relative-src='{{$ctrl.iconNext}}'>\n<div class='text-h4 cc-popup-heading' compile='$ctrl.heading' ng-if='!$ctrl.isNext'></div>\n<p class='cc-popup-text' compile='$ctrl.text' ng-if='!$ctrl.isNext'></p>\n<div class='text-h4 cc-popup-heading' compile='$ctrl.headingNext' ng-if='$ctrl.isNext' ng-style='{opacity:0}'></div>\n<p class='cc-popup-text' compile='$ctrl.textNext' ng-if='$ctrl.isNext' ng-style='{opacity:0}'></p>\n<div class='cc-popup-footer cc-multi-page-popup-footer'>\n<button class='cc-x-height p9b-text-button -medium cc-multi-page-popup-cancel' ng-click='$ctrl.cancel()' ng-if='$ctrl.showCancelButton &amp;&amp; !$ctrl.isNext'>\n<span class='cc-x-height'>{{ $ctrl.cancelButtonText }}</span>\n</button>\n<button class='cc-x-height p9-primary -medium' ng-click='$ctrl.next()' ng-if='!$ctrl.isNext'>\n<span class='cc-x-height'>{{ $ctrl.nextButtonText }}</span>\n</button>\n<button class='cc-x-height p9-primary -medium' ng-click='$ctrl.hide()' ng-if='$ctrl.isNext'>\n<span class='cc-x-height'>{{ $ctrl.gotItButtonText }}</span>\n</button>\n</div>\n</div>\n</md-dialog>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/popups/c6-list-item-menu.html","<md-dialog aria-describedby='list-item-menu' aria-label='{{ $ctrl.item.label }}' class='p4-action-menu md-transition-in' data-hook='list-item-menu' ng-style='::$ctrl.getDynamicPosition()' role='menu' tabindex='-1'>\n<cc-menu-item data-hook='menu-edit' icon='cc-icon-edit' label='{{:: &quot;cc.c6-list-item-menu.edit.label&quot; | translate }}' ng-click='$ctrl.$mdDialog.hide(); $ctrl.onEdit({item: $ctrl.item});' ng-hide='$ctrl.noEdit'></cc-menu-item>\n<cc-menu-item data-hook='menu-duplicate' icon='cc-icon-duplicate' label='{{:: &quot;cc.c6-list-item-menu.duplicate.label&quot; | translate }}' ng-click='$ctrl.$mdDialog.hide(); $ctrl.onDuplicate({item: $ctrl.item})' ng-hide='$ctrl.noDuplicate || $ctrl.item.hidden'></cc-menu-item>\n<cc-menu-item data-hook='menu-hide' icon='cc-icon-hide-eye' label='{{:: &quot;cc.c6-list-item-menu.hide.label&quot; | translate }}' ng-click='$ctrl.$mdDialog.hide(); $ctrl.onToggle({item: $ctrl.item})' ng-hide='$ctrl.noHide || $ctrl.item.hidden || $ctrl.item.canHide === false'></cc-menu-item>\n<cc-menu-item data-hook='menu-show' icon='cc-icon-show-eye' label='{{:: &quot;cc.c6-list-item-menu.show.label&quot; | translate }}' ng-click='$ctrl.$mdDialog.hide(); $ctrl.onToggle({item: $ctrl.item})' ng-show='!$ctrl.noHide &amp;&amp; $ctrl.item.hidden &amp;&amp; $ctrl.item.canHide !== false'></cc-menu-item>\n<cc-menu-item data-hook='menu-delete' icon='cc-icon-delete' label='{{:: &quot;cc.c6-list-item-menu.delete.label&quot; | translate }}' ng-click='$ctrl.$mdDialog.hide(); $ctrl.onDelete({item: $ctrl.item})' ng-hide='$ctrl.noDelete'></cc-menu-item>\n<cc-menu-item data-hook='menu-item-to-page' icon='cc-icon-move-to' label='{{:: &quot;cc.c6-list-item-menu.item-to-show.label&quot; | translate }}' ng-click='$ctrl.$mdDialog.hide(); $ctrl.onItemToPage({item: $ctrl.item})' ng-hide='$ctrl.noItemToPage'></cc-menu-item>\n</md-dialog>\n")}]);try{angular.module("commonControlsPreload")}catch(e){angular.module("commonControlsPreload",[])}function Me(e){e.perfectScrollbar("update")}angular.module("commonControlsPreload").run(["$templateCache",function(e){e.put("views/tips/example.html","This is where you list the things you offer. People want to know you have what they're looking for.\n")}]),angular.module("commonControlsAppInternal").directive("focusIf",["$timeout",function(e){return{restrict:"A",link:function(t,i,n){var o=function(o){o&&e(function(){i[0].focus()},t.$eval(n.focusDelay)||0)};n.focusIf?t.$watch(n.focusIf,o):o(!0)}}}]),angular.module("commonControlsAppInternal").directive("compile",["$compile",function(e){return function(t,i,n){t.$watch(function(e){return e.$eval(n.compile)},function(n){i.html(n),e(i.contents())(t)})}}]),angular.module("commonControlsAppInternal").directive("ccScrollbar",["$rootScope",function(e){return{restrict:"A",link:function(e,t,i){if(t[0].hasAttribute("cc-scrollbar")){var n=_.debounce(function(){Me(t)},200);t.addClass("cc-scrollbar"),i.$observe("ccScrollbarDisable",function(i){e.$eval(i)?t.perfectScrollbar("destroy"):o()}),o(),e.$watch(function(){return t.prop("scrollHeight")},function(e){return e&&Me(t)}),e.$watch(function(){return t.prop("scrollWidth")},function(e){return e&&Me(t)}),t.on("mouseenter",function(){return Me(t)}),window.addEventListener("resize",n),e.$on("$destroy",function(){window.removeEventListener("resize",n),t.perfectScrollbar("destroy")})}function o(){e.$evalAsync(function(){t.perfectScrollbar(),Me(t)})}}}}]),angular.module("commonControlsAppInternal").directive("ccTooltipOnOverflow",["$parse",function(e){return{restrict:"A",link:function(e,t,i){e.$watch(function(){return t[0].offsetWidth<t[0].scrollWidth},function(e){return function(e){e?i.$set("ccHideTooltip",void 0):i.$set("ccHideTooltip","true")}(e)})}}}]),angular.module("commonControlsAppInternal").directive("ccSelectOnFocus",["$timeout",function(e){return{restrict:"A",link:function(t,i,n){function o(){i.select()}"false"!==n.ccSelectOnFocus&&i.bind("focus",function(){e(o)})}}}]);var Le=this;angular.module("commonControlsAppInternal").directive("ccTooltip",["ccTooltipManager","$compile",function(e,t){return{restrict:"A",link:function(i,n,o){var r;function a(){var a={};n.hasClass("tooltipstered")&&n.tooltipster("destroy"),r=e.getTooltip(o.ccTooltip);var s=o.ccHideTooltip;if(r&&"true"!==s){a.position=o.ccTooltipPosition||"top",a.delay=250,r.shouldCompile?a.content=t(r.template)(i):a.content=r.template,a.contentAsHTML=!0,a.interactive=r.interactive,a.functionBefore=function(t,i){var n="error"===r.appearance,o=void 0!==e.isSilent&&e.isSilent();!n&&o||i()};var l=o.ccTooltipCustomClass||"";a.theme="cc-tooltip "+(r.appearance?"-"+r.appearance:"")+" "+(r.type?"-"+r.type:"")+" "+l,a.autoClose=!0,r.hasTitle&&(a.theme+=" -with-title"),function(e,t){if("top"===e.position||"bottom"===e.position){var i=t.hasClass("p9b-text-button")||t.hasClass("p9c-text-button");e.offsetY=i?-7:-2}else"right"!==e.position&&"left"!==e.position||(e.offsetX=-2)}(a,n);var c=_.assign(a,JSON.parse(o.ccTooltipOptions||"{}"));c.restoration=c.restoration||"none",n.tooltipster(c)}}o.$observe("ccTooltip",function(){return a()}),o.$observe("ccTooltipOptions",function(){return a()}),o.$observe("ccHideTooltip",function(){return a()}),a.call(Le)}}}]);var ke=function(){function e(e,t,i){var n=this;this.$scope=e,this.$element=t,this.$timeout=i,e.$watch(function(){return t.text()},function(e,t){e!==t&&n.classSequence()})}return e.$inject=["$scope","$element","$timeout"],e.prototype.classSequence=function(){var e=this;this.$element.addClass("cc-tip-text-has-changed"),this.$timeout(function(){e.$element.removeClass("cc-tip-text-has-changed")},600)},e}();function _e(e){return{restrict:"A",scope:{ccSupportIframeReady:"&"},link:function(t,i){var n=function(e){(function(e){return!!/^(http|https):\/\/(\w+\.)?wix\.com/.test(e.origin)&&e.data.articleId})(e)&&(t.ccSupportIframeReady(),e.target.removeEventListener(e.type,n))};e.addEventListener("message",n,!1)}}}angular.module("commonControlsAppInternal").directive("ccTipTextChangeClass",function(){return{controller:ke,controllerAs:"ccTipTextChangeClass",bindToController:!0,restrict:"A"}}),angular.module("commonControlsAppInternal").directive("ccSupportIframeReady",_e);var $e=function(){function e(e,t){this.$scope=e,this.$element=t,this.appendRelativeToChildren();t.prepend('\n      <div class="cc-dynamic-background">\n        <div class="cc-dynamic-background-pink"></div>\n        \x3c!--<div class="cc-dynamic-background-blue"></div>--\x3e\n      </div>\n    '),t.css({position:"relative"})}return e.$inject=["$scope","$element"],e.prototype.appendRelativeToChildren=function(){this.$element.children().each(function(e,t){var i=angular.element(t);"static"===i.css("position")&&i.css("position","relative")})},e}();angular.module("commonControlsAppInternal").directive("ccDynamicBackground",function(){return{controller:$e,controllerAs:"ccDynamicBackground",bindToController:!0,restrict:"A"}});s=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};var Ae=function(){function e(e,t,i,n){this.$q=e,this.$mdDialog=t,this.$sce=i,this.$window=n}return e.$inject=["$q","$mdDialog","$sce","$window"],e.prototype.setIsSilentCallback=function(e){this.isSilent=e},e.prototype.templateUrl=function(e){return"views/popups/"+e+".html"},e.prototype.createMdDialog=function(e){var t=s({},e.locals);t.onConfirm=function(){e.locals.onConfirm&&e.locals.onConfirm(),this.$mdDialog.hide()};var i={autoWrap:!1,templateUrl:this.templateUrl(e.template),locals:t,bindToController:!0,biDialogName:e.biDialogName,biDialogTargetName:e.biDialogTargetName,controller:e.controller||["$scope","$timeout","$mdDialog",function(e,t,i){var n=this;this.$mdDialog=i,this.autoHideTimeout&&(this.autoHideTimer=t(function(){return n.$mdDialog.hide()},this.autoHideTimeout),e.$on("$destroy",function(){return t.cancel(n.autoHideTimer)}))}],controllerAs:"$ctrl",onShowing:e.onShowing,hasBackdrop:!_.isBoolean(e.hasBackdrop)||e.hasBackdrop,clickOutsideToClose:e.clickOutsideToClose,skipHide:e.skipHide,customBi:e.customBi};return this.show(i)},e.prototype.show=function(e){return this.$mdDialog.show(e)},e.prototype.hide=function(e){return this.$mdDialog.hide(e)},e.prototype.cancel=function(e){this.$mdDialog.cancel(e)},e.prototype.showFirstTimeNotice=function(e){return this.isSilent&&this.isSilent()?this.$q.when({}):this.createMdDialog({template:"first-time-notice",locals:e,biDialogName:e.biDialogName,biDialogTargetName:e.biDialogTargetName,controller:["$mdDialog",function(t){var i=this;this.$mdDialog=t,this.checkbox={label:this.dontBotherMeText,checked:this.dontBotherMe,required:!1},this.hide=function(){t.hide({dontBotherMe:i.dontBotherMe})},this.cancel=function(){t.cancel({dontBotherMe:i.dontBotherMe})},this.runCallback=function(t){e.callback&&(i.hide(),e.callback(t))}}]})},e.prototype.showListItemMenu=function(e){var t=this;return e.getDynamicPosition=function(){return t.getDynamicPosition(e.clientPos)},this.createMdDialog({template:"c6-list-item-menu",locals:e,hasBackdrop:!1,clickOutsideToClose:!0})},e.prototype.getDynamicPosition=function(e){var t=angular.element('[data-hook="list-item-menu"]').height()-30,i=this.$window.innerHeight-e.clientY-t,n=(i<0?Math.abs(i):0)+30;return{top:e.clientY-n+"px",left:e.clientX+16+"px"}},e.prototype.showPositiveConfirmation=function(e){return this.isSilent&&this.isSilent()?this.$q.when():this.createMdDialog({template:"positive-confirmation",locals:e,biDialogName:e.biDialogName,biDialogTargetName:e.biDialogTargetName})},e.prototype.showNegativeConfirmation=function(e){return this.isSilent&&this.isSilent()?this.$q.when():this.createMdDialog({template:"negative-confirmation",locals:e,biDialogName:e.biDialogName,biDialogTargetName:e.biDialogTargetName})},e.prototype.showPositiveContinuedAction=function(e,t){return this.createMdDialog({template:"positive-continued-action",locals:e,biDialogName:e.biDialogName,biDialogTargetName:e.biDialogTargetName,controller:["$mdDialog",function(e){this.$mdDialog=e,this.hide=function(t){e.hide({selected:t,biDialogTargetName:t.value})},this.cancel=function(t){e.cancel({selected:t})}}]})},e.prototype.showMultiPagePopup=function(e){var t;return this.createMdDialog({template:"multi-page-popup",locals:e,customBi:!!e.biEvents,onShowing:function(e,i){t=i},controller:["$mdDialog","$timeout",function(i,n){var o=this;this.$mdDialog=i,this.isNext=!1,e.biEvents&&e.biEvents.onShow&&e.biEvents.onShow(this.isNext,e.dialogName);this.next=function(){var i=t.find(".cc-multi-page-popup");i.css({"max-height":i.outerHeight(),"min-height":i.outerHeight(),transition:"max-height 500ms ease-in-out, min-height 500ms ease-in-out"});var r=function(e,i){var r=t.find(".cc-popup-icon"),a=t.find(".cc-popup-heading"),s=t.find(".cc-popup-text"),l=t.find(".cc-popup-footer");[a,s].forEach(function(t){return t.css({position:"relative",left:e?"0":"20px",opacity:e?"1":"0",transition:"opacity 250ms ease-in-out, left 250ms ease-in-out"})}),[r,l].forEach(function(t){return t.css({opacity:e?"1":"0",transition:"opacity 250ms ease-in-out"})}),n(function(){[a,s].forEach(function(t){return t.css({opacity:e?"0":"1",left:e?"-20px":"0"})}),[r,l].forEach(function(t){return t.css({opacity:e?"0":"1"})}),i&&(n(function(){o.isNext=!0},250),n(i,300))})};r(!0,function(){e.biEvents&&e.biEvents.onNextClick&&(e.biEvents.onNextClick(e.dialogName),e.biEvents.onShow(o.isNext)),i.css({"max-height":900,"min-height":0}),r(!1)})},this.hide=function(){e.biEvents&&e.biEvents.onHide&&e.biEvents.onHide(),i.hide()},this.cancel=function(){e.biEvents&&e.biEvents.onCancel&&e.biEvents.onCancel(o.isNext,e.dialogName),i.cancel()}}]})},e.prototype.showNegativeContinuedAction=function(e,t){return this.createMdDialog({template:"negative-continued-action",locals:e,biDialogName:e.biDialogName,biDialogTargetName:e.biDialogTargetName,controller:["$mdDialog",function(e){this.$mdDialog=e,this.hide=function(t){e.hide({selected:t,biDialogTargetName:t.value})},this.cancel=function(t){e.cancel({selected:t})}}]})},e.prototype.showIframe=function(e){return this.createMdDialog({template:"iframe",locals:{link:this.$sce.trustAsResourceUrl(e)}})},e.prototype.showSupportIframe=function(e,t){return this.createMdDialog({template:"support-iframe",locals:{link:this.$sce.trustAsResourceUrl(e)},hasBackdrop:!1,skipHide:!0,biDialogName:t,controller:["$timeout","$mdDialog",function(e,t){var i=this;i.iframeLoaded=function(){e(function(){i.loaded=!0},0)},i.cancel=function(){t.cancel()}}]})},e}();angular.module("commonControlsAppInternal").service("CcDialogBuilder",Ae),angular.module("commonControlsAppInternal").factory("ccDebounce",["$timeout",function(e){return function(t,i,n){var o,r,a,s,l=!0,c=this;function d(){a=i.apply(r||c,o||[]),r=o=null,l=!0}function u(){s&&(e.cancel(s),s=null)}function p(){r=c,o=arguments,n?l&&(l=!1,s=e(d,t)):(u(),s=e(d,t))}function h(){var e=!!r;return e&&(u(),d()),e}return p.flush=function(){return h()||s||d(),a},p.flushPending=function(){return h(),a},p.cancel=u,p}}]);var Ee=function(){function e(){}return e.prototype.generate=function(t,i,n){return void 0===i&&(i=100),void 0===n&&(n=70),"shape"===t.mediaType?e.MEDIA_BASE_URL+(t.relativeUri.match(/^shapes\//)?"":"shapes/")+t.relativeUri.replace(/\.js$/,".svg"):"extVideo"===t.mediaType?t.thumbnailUrl:"video"===t.mediaType||"inlineVideo"===t.mediaType?t.posters&&t.posters.length>0?this.buildUrlFromRelative(t.posters[0].uri,i,n):t.fileOutput?this.buildUrlFromRelative(t.fileOutput.image[0].url,i,n,!0):t.thumbnailUrl:this.buildUrlFromRelative(t.relativeUri,i,n)},e.prototype.buildUrlFromRelative=function(t,i,n,o){return void 0===o&&(o=!1),e.MEDIA_BASE_URL+(o?"":"media/")+t+"_srz_p_"+Math.round(i)+"_"+Math.round(n)+"_75_22_0.50_1.20_0.00_jpg_srz"},e.MEDIA_BASE_URL="//static.wixstatic.com/",e}();angular.module("commonControlsAppInternal").service("mediaUrl",Ee);var De=function(){function e(e){this.$translate=e,this.tooltips={}}return e.$inject=["$translate"],e.prototype.setToolTip=function(e,t){t.content=t.content||this.$translate.instant("tooltips."+e),this.tooltips[e]=new Fe(t)},e.prototype.getTooltip=function(e){return this.tooltips[e]},e.prototype.setIsSilentCallback=function(e){this.isSilent=e},e}(),Fe=function(){function e(e){this.tooltipData=e,this.linkRegexp=/<a.*>.*<\/a>/}return Object.defineProperty(e.prototype,"template",{get:function(){var e;return"hint"===this.tooltipData.type?e=this.getHintTemplate():"rich"!==this.tooltipData.type&&"popup"!==this.tooltipData.type||(e=this.getRichTemplate()),'\n      <div class="cc-tooltip -'+this.tooltipData.appearance.toLowerCase()+'">\n        '+e+"\n      </div>"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"interactive",{get:function(){if(this.tooltipData.interactive)return!0;var e=this.template,t=this.linkRegexp.test(e);return"rich"===this.tooltipData.type&&t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appearance",{get:function(){return this.tooltipData.appearance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.tooltipData.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasTitle",{get:function(){return"rich"===this.tooltipData.type&&!!this.tooltipData.title},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldCompile",{get:function(){return!!this.tooltipData.compiled},enumerable:!0,configurable:!0}),e.prototype.getHintTemplate=function(){return"<div>"+this.tooltipData.content+"<div>"},e.prototype.getRichTemplate=function(){var e="",t="",i="",n=this.tooltipData;return n.title&&(e='<div class="cc-tooltip-title">'+n.title+"</div>"),n.link&&(t='<div class="cc-tooltip-link"><a target="_blank" href="'+n.link.url+'">'+n.link.label+"</a></div>"),n.content&&(i='<div class="cc-tooltip-content">'+n.content+"</div>"),"\n      <div>\n        "+e+"\n        "+i+"\n        "+t+"\n      </div>\n    "},e}();angular.module("commonControlsAppInternal").service("ccTooltipManager",De);var Be=function(){function e(e,t,i,n,o,r){this.$document=e,this.$compile=t,this.$rootScope=i,this.$sce=n,this.$templateCache=o,this.$timeout=r,this.baseTemplate='\n      <div class="cc-tip" ng-style="style">\n        <div class="cc-tip-contact" ng-if="contact">\n          <img class="cc-tip-contact-image" ng-src="{{contact.img}}" />\n          <div class="cc-tip-contact-details">\n            <div class="cc-tip-contact-name" cc-tip-text-change-class>{{contact.name}}</div>\n            <div class="cc-tip-contact-profession" cc-tip-text-change-class>{{contact.profession}}</div>\n          </div>\n        </div>\n        <div class="cc-tip-title" ng-if="title" cc-tip-text-change-class>{{title}}</div>\n        <div class="cc-tip-content" ng-bind-html="content" cc-tip-text-change-class></div>\n        <a class="cc-tip-content-link" ng-if="contentLink" ng-href="{{contentLink.url}}" cc-tip-text-change-class>{{contentLink.text}}</a>\n        <div class="cc-tip-footer" ng-if="footer">\n          <button class="cc-tip-footer-close-button p9-primary -small cc-x-height" ng-if="footer.closeButton" ng-click="hide($event)" cc-tip-text-change-class>\n            <span class="cc-x-height">{{footer.closeButton}}</span>\n          </button>\n        </div>\n      </div>\n    '}return e.$inject=["$document","$compile","$rootScope","$sce","$templateCache","$timeout"],e.prototype.build=function(e){var t=this,i={};i.parent=angular.element(this.$document[0].body);var n=this.$rootScope.$new();return i.scope=n,i.element=this.createTip(e,n),i.onHide=e.onHide||angular.noop,n.hide=function(e){t.hide(i,e)},i},e.prototype.show=function(e){e.parent.append(e.element),this.$timeout(function(){e.element.addClass("cc-tip-visible")},0)},e.prototype.hide=function(e,t){e.element.removeClass("cc-tip-visible"),e.onHide(t),this.$timeout(function(){e.element.remove()},200)},e.prototype.update=function(e,t){return t.scope.content=this.getContent(t.template,t.templateUrl),angular.extend(e.scope,t.scope),e},e.prototype.createTip=function(e,t){return t.style=e.style,t.content=this.getContent(e.template,e.templateUrl),angular.extend(t,e.scope),this.$compile(this.baseTemplate)(t)},e.prototype.getContent=function(e,t){return this.$sce.trustAsHtml(e||this.$templateCache.get(t))},e}();angular.module("commonControlsAppInternal").service("ccTip",Be);var Oe=function(){function e(e){this.isIE=e.navigator.userAgent.match(/Trident\/|MSIE /)}return e.$inject=["$window"],e}();angular.module("commonControlsAppInternal").service("osUtils",Oe),angular.module("commonControlsAppInternal").directive("osUtils",function(){return{restrict:"A",controller:Oe,controllerAs:"$os"}}),angular.module("commonControlsAppInternal").provider("ccFlags",function(){var e=this;e.$get=function(){return e};var t=location.hash.split("?");t.length>1&&t[1].match(/([^=&]+)?=([^&]*)|([^=&]+)/g).forEach(function(t){!function(t){e[t[0]]=function(e){try{return JSON.parse(e)}catch(t){return e}}(t[1])}(t.split("="))})});var He=function(){return function(){}}();angular.module("commonControlsAppInternal").component("ccWave",{template:'<div class="cc-wave">\n                <div class="cc-wave-cradle">\n                  <div class="cc-wave-svg cc-wave-sidekick"></div>\n                </div>\n                <div class="cc-wave-effect-shadow"></div>\n                <div class="cc-wave-cradle cc-wave-cradle-second">\n                  <div class="cc-wave-svg cc-wave-main"></div>\n                </div>\n                <div class="cc-wave-effect-shadow cc-wave-effect-shadow-reverse"></div>\n               </div>',controller:He});var Re=function(){return function(){}}();angular.module("commonControlsAppInternal").component("c18PanelButton",{templateUrl:"views/c18-panel-button.html",controller:Re,bindings:{label:"=",onClick:"&"}}),t.cc=d,t.commonControls=U,t.P23RichTextInput=L,t.CcPanelFrame=Te},476:function(e,t){e.exports=$},477:function(e,t){angular.module("dndLists",[]).directive("dndDraggable",["$parse","$timeout","dndDropEffectWorkaround","dndDragTypeWorkaround",function(e,t,i,n){return function(o,r,a){r.attr("draggable","true"),a.dndDisableIf&&o.$watch(a.dndDisableIf,function(e){r.attr("draggable",!e)}),r.on("dragstart",function(s){if(s=s.originalEvent||s,"false"==r.attr("draggable"))return!0;s.dataTransfer.setData("Text",angular.toJson(o.$eval(a.dndDraggable))),s.dataTransfer.effectAllowed=a.dndEffectAllowed||"move",r.addClass("dndDragging"),t(function(){r.addClass("dndDraggingSource")},0),i.dropEffect="none",n.isDragging=!0,n.dragType=a.dndType?o.$eval(a.dndType):void 0,s._dndHandle&&s.dataTransfer.setDragImage&&s.dataTransfer.setDragImage(r[0],0,0),e(a.dndDragstart)(o,{event:s}),s.stopPropagation()}),r.on("dragend",function(s){s=s.originalEvent||s;var l=i.dropEffect;o.$apply(function(){switch(l){case"move":e(a.dndMoved)(o,{event:s});break;case"copy":e(a.dndCopied)(o,{event:s});break;case"none":e(a.dndCanceled)(o,{event:s})}e(a.dndDragend)(o,{event:s,dropEffect:l})}),r.removeClass("dndDragging"),t(function(){r.removeClass("dndDraggingSource")},0),n.isDragging=!1,s.stopPropagation()}),r.on("click",function(t){a.dndSelected&&(t=t.originalEvent||t,o.$apply(function(){e(a.dndSelected)(o,{event:t})}),t.stopPropagation())}),r.on("selectstart",function(){this.dragDrop&&this.dragDrop()})}}]).directive("dndList",["$parse","$timeout","dndDropEffectWorkaround","dndDragTypeWorkaround",function(e,t,i,n){return function(o,r,a){var s=function(){var e;return angular.forEach(r.children(),function(t){var i=angular.element(t);i.hasClass("dndPlaceholder")&&(e=i)}),e||angular.element("<li class='dndPlaceholder'></li>")}(),l=s[0],c=r[0];s.remove();var d=a.dndHorizontalList&&o.$eval(a.dndHorizontalList),u=a.dndExternalSources&&o.$eval(a.dndExternalSources);function p(e,t,i){var n=d?e.offsetX||e.layerX:e.offsetY||e.layerY,o=d?t.offsetWidth:t.offsetHeight,r=d?t.offsetLeft:t.offsetTop;return n<(r=i?r:0)+o/2}function h(){return Array.prototype.indexOf.call(c.children,l)}function g(e){if(!n.isDragging&&!u)return!1;if(!function(e){if(!e)return!0;for(var t=0;t<e.length;t++)if("Text"===e[t]||"text/plain"===e[t])return!0;return!1}(e.dataTransfer.types))return!1;if(a.dndAllowedTypes&&n.isDragging){var t=o.$eval(a.dndAllowedTypes);if(angular.isArray(t)&&-1===t.indexOf(n.dragType))return!1}return!a.dndDisableIf||!o.$eval(a.dndDisableIf)}function m(){return s.remove(),r.removeClass("dndDragover"),!0}function f(t,i,r,a){return e(t)(o,{event:i,index:r,item:a||void 0,external:!n.isDragging,type:n.isDragging?n.dragType:void 0})}r.on("dragenter",function(e){if(!g(e=e.originalEvent||e))return!0;e.preventDefault()}),r.on("dragover",function(e){if(!g(e=e.originalEvent||e))return!0;if(l.parentNode!=c&&r.append(s),e.target!==c){for(var t=e.target;t.parentNode!==c&&t.parentNode;)t=t.parentNode;t.parentNode===c&&t!==l&&(p(e,t)?c.insertBefore(l,t):c.insertBefore(l,t.nextSibling))}else if(p(e,l,!0))for(;l.previousElementSibling&&(p(e,l.previousElementSibling,!0)||0===l.previousElementSibling.offsetHeight);)c.insertBefore(l,l.previousElementSibling);else for(;l.nextElementSibling&&!p(e,l.nextElementSibling,!0);)c.insertBefore(l,l.nextElementSibling.nextElementSibling);return a.dndDragover&&!f(a.dndDragover,e,h())?m():(r.addClass("dndDragover"),e.preventDefault(),e.stopPropagation(),!1)}),r.on("drop",function(e){if(!g(e=e.originalEvent||e))return!0;e.preventDefault();var t,n=e.dataTransfer.getData("Text")||e.dataTransfer.getData("text/plain");try{t=JSON.parse(n)}catch(e){return m()}var r=h();return a.dndDrop&&!(t=f(a.dndDrop,e,r,t))?m():(!0!==t&&o.$apply(function(){o.$eval(a.dndList).splice(r,0,t)}),f(a.dndInserted,e,r,t),"none"===e.dataTransfer.dropEffect?"copy"===e.dataTransfer.effectAllowed||"move"===e.dataTransfer.effectAllowed?i.dropEffect=e.dataTransfer.effectAllowed:i.dropEffect=e.ctrlKey?"copy":"move":i.dropEffect=e.dataTransfer.dropEffect,m(),e.stopPropagation(),!1)}),r.on("dragleave",function(e){e=e.originalEvent||e,r.removeClass("dndDragover"),t(function(){r.hasClass("dndDragover")||s.remove()},100)})}}]).directive("dndNodrag",function(){return function(e,t,i){t.attr("draggable","true"),t.on("dragstart",function(e){(e=e.originalEvent||e)._dndHandle||(e.dataTransfer.types&&e.dataTransfer.types.length||e.preventDefault(),e.stopPropagation())}),t.on("dragend",function(e){(e=e.originalEvent||e)._dndHandle||e.stopPropagation()})}}).directive("dndHandle",function(){return function(e,t,i){t.attr("draggable","true"),t.on("dragstart dragend",function(e){(e=e.originalEvent||e)._dndHandle=!0})}}).factory("dndDragTypeWorkaround",function(){return{}}).factory("dndDropEffectWorkaround",function(){return{}}),angular.module("organizeMediaDialog",["organizeMediaTranslations","organizeMediaPreload","wixAngular","commonControlsApp","wix.common.bi","dndLists","ngMaterial"]).config(["CCSvgIconServiceProvider",function(e){e.setSpritePrefix("")}]),angular.module("organizeMediaApp",["organizeMediaDialog"]).config(["$translateProvider",function(e){e.useSanitizeValueStrategy&&e.useSanitizeValueStrategy("sanitize")}]);try{angular.module("organizeMediaPreload")}catch(e){angular.module("organizeMediaPreload",[])}angular.module("organizeMediaPreload").run(["$templateCache",function(e){"use strict";e.put("views/add-more-button.html","<div class='om-add-more-button media-item image-item'>\n<figure>\n<div class='om-add-more-button-container'>\n<div class='om-add-more-button-plus'>+</div>\n<div class='om-add-more-button-text bold'>{{:: 'general.add-more-button' | translate }}</div>\n<div class='om-add-more-button-text'>{{ $ctrl.itemType }}</div>\n</div>\n</figure>\n</div>\n")}]);try{angular.module("organizeMediaPreload")}catch(e){angular.module("organizeMediaPreload",[])}angular.module("organizeMediaPreload").run(["$templateCache",function(e){"use strict";e.put("views/edit-link.html","<div class='om-app-main' data-hook='om-link-editor-container'>\n<div class='om-window-main'>\n<header class='om-header-dialog panel-header'>\n<span class='panel-header-title' data-hook='om-link-editor-title'>Edit Link</span>\n<button class='panel-header-button' data-hook='om-link-editor-close-button' ng-click='$ctrl.close()'>\n<svg height='25px' viewBox='0 0 25 25' width='25px'>\n<path d='M11.7928932,12.5 L8.14644661,8.85355339 L7.79289322,8.5 L8.5,7.79289322 L8.85355339,8.14644661 L12.5,11.7928932 L16.1464466,8.14644661 L16.5,7.79289322 L17.2071068,8.5 L16.8535534,8.85355339 L13.2071068,12.5 L16.8535534,16.1464466 L17.2071068,16.5 L16.5,17.2071068 L16.1464466, 16.8535534 L12.5,13.2071068 L8.85355339,16.8535534 L8.5,17.2071068 L7.79289322,16.5 L8.14644661,16.1464466 L11.7928932,12.5 Z'></path>\n</svg>\n</button>\n</header>\n<main class='om-main-container'>\n<div class='om-main is-link-editor'>\n<div class='om-link-editor-placeholder' data-hook='om-link-editor-placeholder'></div>\n</div>\n</main>\n<footer class='panel-footer'>\n<button class='btn secondary-btn' data-hook='om-link-editor-cancel-button' ng-click='$ctrl.cancel()'>{{::'general.cancel-button' | translate}}</button>\n<button class='btn primary-btn' data-hook='om-link-editor-done-button' ng-click='$ctrl.done()'>{{::'general.save-button' | translate}}</button>\n</footer>\n</div>\n</div>\n")}]);try{angular.module("organizeMediaPreload")}catch(e){angular.module("organizeMediaPreload",[])}angular.module("organizeMediaPreload").run(["$templateCache",function(e){"use strict";e.put("views/image-carousel.html","<div class='om-image-carousel-current'>\n<c4-media-preview media='[$ctrl.getItemForMediaPreview($ctrl.item)]' ng-if='$ctrl.item !== null' no-hover='true' show-edit-panel='false' show-tabs='false'></c4-media-preview>\n<div cc-tooltip-position='top' cc-tooltip='previous' class='om-carousel-navigation is-prev' data-hook='om-carousel-prev' ng-click='$ctrl.onPrev()' ng-if='$ctrl.showNav'>\n<div class='om-carousel-arrow is-prev-arrow'></div>\n</div>\n<div cc-tooltip-position='top' cc-tooltip='next' class='om-carousel-navigation is-next' data-hook='om-carousel-next' ng-click='$ctrl.onNext()' ng-if='$ctrl.showNav'>\n<div class='om-carousel-arrow is-next-arrow'></div>\n</div>\n</div>\n")}]);try{angular.module("organizeMediaPreload")}catch(e){angular.module("organizeMediaPreload",[])}angular.module("organizeMediaPreload").run(["$templateCache",function(e){"use strict";e.put("views/image-item.html","<figure>\n<span class='image-container'>\n<img ng-src='{{$ctrl.getPreviewUrl()}}'>\n</span>\n<figcaption class='item-media-label' data-hook='om-item-index'>{{ $ctrl.index + 1 }}</figcaption>\n<div class='item-media-menu'>\n<image-preview-popup data-hook='om-image-preview-popup-target' item='$ctrl.item'>\n<div class='menu-item' data-hook='om-image-preview-popup-icon'>\n<svg class='bm-icon' height='16px' version='1.1' viewBox='0 0 16 16' width='16px' xmlns:sketch='http://www.bohemiancoding.com/sketch/ns' xmlns='http://www.w3.org/2000/svg'>\n<g fill-rule='evenodd' fill='none' sketch:type='MSPage' stroke-width='1' stroke='none'>\n<path d='M8,5 L7,5 L7,7 L5,7 L5,8 L7,8 L7,10 L8,10 L8,8 L10,8 L10,7 L8,7 L8,5 L8,5 Z M12.646,11.895 C13.711,10.675 14.262,9.167 14.262,7.469 C14.262,3.718 11.221,0.677 7.469,0.677 C3.718,0.677 0.677,3.718 0.677,7.469 C0.677,11.221 3.718,14.262 7.469,14.262 C9.159,14.262 10.733,13.746 11.958,12.697 L14.938,15.677 L15.677,14.938 L12.646,11.895 L12.646,11.895 Z M7.469,13.217 C4.3,13.217 1.722,10.639 1.722,7.469 C1.722,4.3 4.3,1.722 7.469,1.722 C10.639,1.722 13.217,4.3 13.217,7.469 C13.217,10.639 10.639,13.217 7.469,13.217 L7.469,13.217 Z' fill='#FFFFFF' id='L_Zoom-In' sketch:type='MSShapeGroup'></path>\n</g>\n</svg>\n</div>\n</image-preview-popup>\n<div cc-tooltip-position='top' cc-tooltip='remove_image' class='menu-item' data-hook='om-make-inactive' ng-click='$ctrl.onRemove({item: $ctrl.item})'>\n<svg height='15px' viewBox='0 0 13 15' width='13px'>\n<g fill-rule='evenodd' fill='none' stroke-width='1' stroke='none'>\n<path d='M4,11 L5,11 L5,5 L4,5 L4,11 Z M8,11 L9,11 L9,5 L8,5 L8,11 Z M6,11 L7,11 L7,5 L6,5 L6,11 Z M9,2 L9,1.5 C9,0.701 8.248,0 7.392,0 L5.525,0 C4.684,0 4,0.673 4,1.5 L4,2 L0,2 L0,3 L1,3 L1,12 C1,13.657 2.343,15 4,15 L9,15 C10.657,15 12,13.657 12,12 L12,3 L13,3 L13,2 L9,2 L9,2 Z M5,1.5 C5,1.229 5.24,1 5.525,1 L7.392,1 C7.693,1 8,1.252 8,1.5 L8,2 L5,2 L5,1.5 L5,1.5 Z M11,12 C11,13.105 10.105,14 9,14 L4,14 C2.895,14 2,13.105 2,12 L2,3 L11,3 L11,12 L11,12 Z' fill='#FFFFFF'></path>\n</g>\n</svg>\n</div>\n</div>\n</figure>\n")}]);try{angular.module("organizeMediaPreload")}catch(e){angular.module("organizeMediaPreload",[])}angular.module("organizeMediaPreload").run(["$templateCache",function(e){"use strict";e.put("views/image-item-details.html","<cc-panel-frame data-hook='om-item-details-panel' label='{{:: &#39;media-settings.image-settings.title&#39; | translate}}'>\n<div class='om-carousel-label'>\n<div class='p8-label'>{{ ::'media-settings.preview' | translate }}</div>\n</div>\n<image-carousel data-hook='om-image-carousel' item='$ctrl.item' on-next='$ctrl.onNext()' on-prev='$ctrl.onPrev()' show-nav='$ctrl.showCarouselNav'></image-carousel>\n<c2-text-input data-hook='om-item-details-title' disable-toggle='true' is-disabled='$ctrl.item === null' label='{{:: &#39;media-settings.media-title.title&#39; | translate}}' on-change-value='$ctrl.onTitleChange(value)' placeholder=':: &#39;media-settings.title-placeholder&#39; | translate' value='$ctrl.item.Title'></c2-text-input>\n<c2-text-input data-hook='om-item-details-description' disable-toggle='true' is-disabled='$ctrl.item === null' label='{{:: &#39;media-settings.description.title&#39; | translate}}' on-change-value='$ctrl.onDescriptionChange(value)' placeholder=':: &#39;media-settings.description-placeholder&#39; | translate' value='$ctrl.item.Description'></c2-text-input>\n<c5-link-input data-hook='om-item-details-link' disable-toggle='true' label='{{:: &#39;media-settings.link-label&#39; | translate}}' link='$ctrl.linkAsILink' on-edit-link='$ctrl.openLinkEditor()'></c5-link-input>\n</cc-panel-frame>\n")}]);try{angular.module("organizeMediaPreload")}catch(e){angular.module("organizeMediaPreload",[])}angular.module("organizeMediaPreload").run(["$templateCache",function(e){"use strict";e.put("views/image-preview-popup.html","<div class='om-image-preview-popup-button' data-hook='om-image-preview-popup-button' ng-mouseenter='$ctrl.showPopup()' ng-mouseleave='$ctrl.removePopup()'>\n<div ng-transclude></div>\n</div>\n")}]);try{angular.module("organizeMediaPreload")}catch(e){angular.module("organizeMediaPreload",[])}angular.module("organizeMediaPreload").run(["$templateCache",function(e){"use strict";e.put("views/organize-media.html","<div class='om-app-main' data-hook='om-container'>\n<div class='om-window-main'>\n<header class='om-header-dialog panel-header'>\n<span class='panel-header-title' data-hook='om-title'>{{ $ctrl.title }}</span>\n<span>\n<button class='panel-header-button' data-hook='om-close-button' ng-click='$ctrl.close()'>\n<svg height='25px' viewBox='0 0 25 25' width='25px'>\n<path d='M11.7928932,12.5 L8.14644661,8.85355339 L7.79289322,8.5 L8.5,7.79289322 L8.85355339,8.14644661 L12.5,11.7928932 L16.1464466,8.14644661 L16.5,7.79289322 L17.2071068,8.5 L16.8535534,8.85355339 L13.2071068,12.5 L16.8535534,16.1464466 L17.2071068,16.5 L16.5,17.2071068 L16.1464466,16.8535534 L12.5,13.2071068 L8.85355339,16.8535534 L8.5,17.2071068 L7.79289322,16.5 L8.14644661,16.1464466 L11.7928932,12.5 Z'></path>\n</svg>\n</button>\n<button class='panel-header-button' data-hook='om-help-button' ng-click='$ctrl.onHelp()'>?</button>\n</span>\n</header>\n<main class='om-main-container-gallery' ng-switch='$ctrl.mediaType === &#39;image&#39; &amp;&amp; $ctrl.items.length === 0'>\n<div class='om-main' data-hook='om-items-display'>\n<div class='om-main-header' ng-switch='$ctrl.mediaType'>\n<span data-hook='om-subtitle'>{{ $ctrl.subtitle }}</span>\n<button class='btn action-btn' data-hook='om-open-media-gallery' ng-click='$ctrl.openMediaGallery()' ng-switch-when='shape'>{{::'change-shape.button' | translate}}</button>\n<button class='btn action-btn' data-hook='om-open-media-gallery' ng-click='$ctrl.openMediaGallery()' ng-switch-when='clipart'>{{::'change-clipart.button' | translate}}</button>\n<button class='btn action-btn' data-hook='om-open-video-search' ng-click='$ctrl.openVideoSearch()' ng-switch-when='extVideo'>{{::'Search-other-videos.button' | translate}}</button>\n<button class='btn action-btn' data-hook='om-open-media-gallery' ng-click='$ctrl.openMediaGallery()' ng-switch-when='video'>{{::'Search-other-videos.button' | translate}}</button>\n</div>\n<div class='om-main om-messages' data-hook='om-no-images-message' ng-switch-when='true'>\n<svg class='om-no-images-clipart' data-hook='om-no-images-message-image' height='90px' version='1.1' viewbox='0 0 90 90' width='90px' xmlns:xlink='http://www.w3.org/1999/xlink' xmlns='http://www.w3.org/2000/svg'>\n<g fill-rule='evenodd' fill='none' id='Illustrations' stroke-width='1' stroke='none'>\n<g id='Placeholderlogogrey'>\n<path d='M90,45 C90,69.853 69.853,90 45,90 C20.147,90 0,69.853 0,45 C0,20.147 20.147,0 45,0 C69.853,0 90,20.147 90,45' fill='#858F96' id='Fill-1'></path>\n<path d='M31,34 L25,34 L25,31 C25,30.448 25.448,30 26,30 L30,30 C30.552,30 31,30.448 31,31 L31,34 Z' fill='#E0E3E5' id='Fill-3'></path>\n<path d='M67,61 C68.105,61 69,60.105 69,59 L69,35 C69,33.895 68.105,33 67,33 L57.841,33 C57.201,33 56.601,32.695 56.224,32.178 L53.778,28.822 C53.401,28.305 52.801,28 52.162,28 L37.838,28 C37.199,28 36.599,28.305 36.222,28.822 L33.776,32.178 C33.399,32.695 32.799,33 32.16,33 L23,33 C21.895,33 21,33.895 21,35 L21,59 C21,60.105 21.895,61 23,61 L67,61 Z' fill='#EFF1F2' id='Fill-5'></path>\n<path d='M45,34 C38.373,34 33,39.373 33,46 C33,52.627 38.373,58 45,58 C51.627,58 57,52.627 57,46 C57,39.373 51.627,34 45,34' fill='#A3ABB0' id='Fill-7'></path>\n<path d='M45,37 C49.963,37 54,41.037 54,46 C54,50.963 49.963,55 45,55 C40.037,55 36,50.963 36,46 C36,41.037 40.037,37 45,37' fill='#E0E3E5' id='Fill-9'></path>\n<path d='M66,37.5 C66,38.328 65.328,39 64.5,39 C63.672,39 63,38.328 63,37.5 C63,36.672 63.672,36 64.5,36 C65.328,36 66,36.672 66,37.5' fill='#A3ABB0' id='Fill-11'></path>\n<path d='M51,44 C51,45.105 50.105,46 49,46 C47.895,46 47,45.105 47,44 C47,42.895 47.895,42 49,42 C50.105,42 51,42.895 51,44' fill='#FFFFFF' id='Fill-13'></path>\n</g>\n</g>\n</svg>\n<div class='om-title' data-hook='om-no-images-message-title'>Add some images to your gallery!</div>\n<div class='om-paragraph' data-hook='om-no-images-message-paragraph'>You're gonna need at least two images in order to have a gallery.</div>\n<button class='p9-primary -small' data-hook='om-open-media-gallery' ng-click='$ctrl.openMediaGallery()'>Add Images</button>\n</div>\n<div class='om-items-list' data-hook='om-active-container' dnd-drop='$ctrl.move(index, item)' dnd-horizontal-list='true' dnd-list='$ctrl.items' ng-switch-when='false' ng-switch='$ctrl.viewMode'>\n<image-item class='media-item image-item' data-hook='om-media-item' dnd-draggable='item' dnd-effect-allowed='move' index='$index' item='item' ng-click='$ctrl.selected = item' ng-repeat='item in $ctrl.items track by item.relativeUri' ng-selected='item === $ctrl.selected' ng-switch-when='image' on-remove='$ctrl.makeInactive(item)'></image-item>\n<video-item class='media-item video-item' data-hook='om-media-item' item='item' ng-repeat='item in $ctrl.items track by item.getId()' ng-selected='item === $ctrl.selected' ng-switch-when='video' open-video-foreplay='$ctrl.openVideoForeplay(item)'></video-item>\n<add-more-button data-hook='om-open-media-gallery' dnd-nodrag item-type='{{:: &#39;media-settings.types.images&#39; | translate}}' ng-click='$ctrl.openMediaGallery()' ng-if='$ctrl.mediaType === &#39;image&#39; &amp;&amp; $ctrl.selectionMode === &#39;gallery&#39;'></add-more-button>\n</div>\n</div>\n<aside class='om-main-details' ng-switch-when='false' ng-switch='$ctrl.viewMode'>\n<video-preview data-hook='om-video-preview' item='$ctrl.selected' ng-switch-when='video'></video-preview>\n<image-item-details class='om-item-details' item='$ctrl.selected' link-details-handler='$ctrl.linkDetailsHandler' ng-switch-when='image' on-next='$ctrl.next()' on-prev='$ctrl.prev()' show-carousel-nav='$ctrl.items.length &gt; 1 &amp;&amp; $ctrl.selected'></image-item-details>\n<video-item-details add-item-callback='$ctrl.addItem(item)' class='om-item-details' item='$ctrl.selected' ng-switch-when='video'></video-item-details>\n</aside>\n</main>\n<footer class='panel-footer'>\n<button class='btn secondary-btn' data-hook='om-cancel-button' ng-click='$ctrl.cancel()'>{{::'general.cancel-button' | translate}}</button>\n<button class='btn primary-btn' data-hook='om-done-button' ng-click='$ctrl.done()' ng-disabled='!$ctrl.isDoneEnabled()'>{{::'general.done-button' | translate}}</button>\n</footer>\n</div>\n</div>\n")}]);try{angular.module("organizeMediaPreload")}catch(e){angular.module("organizeMediaPreload",[])}angular.module("organizeMediaPreload").run(["$templateCache",function(e){"use strict";e.put("views/organize-media-app.html","<div class='container'>\n<div class='hero-unit'>\n<div>\n<button data-hook='open-organize-media-gallery' ng-click='$ctrl.openGalleryDialog()'>Open organize media dialog in gallery mode</button>\n</div>\n<div>\n<button data-hook='open-organize-media-extvideo' ng-click='$ctrl.openExtVideoDialog()'>Open organize media dialog with external video type</button>\n</div>\n<div>\n<button data-hook='open-organize-media-wixvideo' ng-click='$ctrl.openWixVideoDialog()'>Open organize media dialog with Wix video type</button>\n</div>\n<div>\n<button data-hook='open-organize-media-shape' ng-click='$ctrl.openShapeDialog()'>Open organize media dialog with shape type</button>\n</div>\n<div>\n<button data-hook='open-organize-media-clipart' ng-click='$ctrl.openClipartDialog()'>Open organize media dialog with clipart type</button>\n</div>\n</div>\n</div>\n")}]);try{angular.module("organizeMediaPreload")}catch(e){angular.module("organizeMediaPreload",[])}angular.module("organizeMediaPreload").run(["$templateCache",function(e){"use strict";e.put("views/video-foreplay.html","<div data-hook='om-video-foreplay-container'>\n<header class='om-header-dialog panel-header'>\n<span class='panel-header-title' data-hook='om-video-foreplay-title'>{{$ctrl.item.Title}}</span>\n<button class='panel-header-button' data-hook='om-video-foreplay-close-button' ng-click='$ctrl.close()'>\n<svg height='21px' viewBox='0 0 25 25' width='21px'>\n<path d='M11.7928932,12.5 L8.14644661,8.85355339 L7.79289322,8.5 L8.5,7.79289322 L8.85355339,8.14644661 L12.5,11.7928932 L16.1464466,8.14644661 L16.5,7.79289322 L17.2071068,8.5 L16.8535534,8.85355339 L13.2071068,12.5 L16.8535534,16.1464466 L17.2071068,16.5 L16.5,17.2071068 L16.1464466, 16.8535534 L12.5,13.2071068 L8.85355339,16.8535534 L8.5,17.2071068 L7.79289322,16.5 L8.14644661,16.1464466 L11.7928932,12.5 Z'></path>\n</svg>\n</button>\n</header>\n<div ng-switch='$ctrl.item.mediaType'>\n<div class='om-video-foreplay-extvideo-div' ng-switch-when='extVideo'>\n<iframe allowfullscreen data-hook='om-video-foreplay-extvideo-video' frameborder='0' mozallowfullscreen ng-attr-height='{{$ctrl.item.getHeightForWidth(644)}}' src='{{$ctrl.item.embedSrc | trustedUrl}}' webkitallowfullscreen width='100%'></iframe>\n</div>\n<div class='om-video-foreplay-wixvideo-div' ng-switch-when='video'>\n<video autoplay='autoplay' class='om-video-foreplay-wixvideo-video' data-hook='om-video-foreplay-wixvideo-video' loop='loop' muted='muted' ng-attr-poster='{{$ctrl.item.posterImage | trustedUrl}}' preload='none'>\n<source data-hook='om-video-foreplay-wixvideo-source' ng-repeat='videoPreviewUrl in $ctrl.item.videoSources' ng-src='{{videoPreviewUrl | trustedUrl}}'>\n</video>\n</div>\n</div>\n</div>\n")}]);try{angular.module("organizeMediaPreload")}catch(e){angular.module("organizeMediaPreload",[])}angular.module("organizeMediaPreload").run(["$templateCache",function(e){"use strict";e.put("views/video-item.html","<figure>\n<img ng-src='{{$ctrl.item.thumbnailUrl}}'>\n<div class='item-video-title'>{{$ctrl.item.Title}}</div>\n<div class='item-video-foreplay-button' data-hook='om-video-foreplay-button' ng-click='$ctrl.openVideoForeplay({item: $ctrl.item})'>&#9654;</div>\n</figure>\n")}]);try{angular.module("organizeMediaPreload")}catch(e){angular.module("organizeMediaPreload",[])}angular.module("organizeMediaPreload").run(["$templateCache",function(e){"use strict";e.put("views/video-item-details.html","<div ng-if='$ctrl.item !== null'>\n<div ng-if='$ctrl.item.videoUrl'>\n<header class='om-details-header' data-hook='om-item-details-header'>Video Info</header>\n<div class='om-details-container'>\n<label class='om-details-label' data-hook='om-details-video-link-label'>What's the video's web address?</label>\n<input class='om-details-value' data-hook='om-details-video-link' ng-change='$ctrl.updateVideo($ctrl.videoUrlToEdit)' ng-model-options='{ updateOn: &#39;blur&#39; }' ng-model='$ctrl.videoUrlToEdit' placeholder='Set your link here' type='text'>\n<div class='om-details-validation' data-hook='om-video-details-url-validation' ng-if='$ctrl.error &amp;&amp; $ctrl.videoUrlToEdit'>{{$ctrl.error}}</div>\n</div>\n</div>\n<header class='om-details-header' data-hook='om-details-video-playmode-header'>{{::'video-box.play-settings.title' | translate}}</header>\n<div class='om-details-container'>\n<div class='om-playmode-container'>\n<span class='om-playmode-label'>{{::'video-box.play-settings.autoplay' | translate}}</span>\n<label class='om-toggle'>\n<input data-hook='om-details-video-playmode-autoplay' ng-model='$ctrl.item.playmode.autoplay' type='checkbox'>\n<span>\n<i class='toggle-circle'></i>\n</span>\n</label>\n</div>\n</div>\n<hr class='om-details-divider'>\n<div class='om-details-container'>\n<div class='om-playmode-container'>\n<span class='om-playmode-label'>{{::'video-box.play-settings.loop' | translate}}</span>\n<label class='om-toggle'>\n<input data-hook='om-details-video-playmode-loop' ng-model='$ctrl.item.playmode.loop' type='checkbox'>\n<span>\n<i class='toggle-circle'></i>\n</span>\n</label>\n</div>\n</div>\n<header class='om-details-header' data-hook='om-details-video-controls-header'>{{::'video-box.play-settings.controls.title' | translate}}</header>\n<div class='om-details-container'>\n<div class='om-controls-container'>\n<label class='om-radio'>\n<input ng-model='$ctrl.item.controls' ng-value='2' type='radio'>\n<span class='om-radio-inner'></span>\n</label>\n<span class='om-radio-label'>{{::'video-box.play-settings.controls.options.always' | translate}}</span>\n</div>\n<div class='om-controls-container'>\n<label class='om-radio'>\n<input ng-model='$ctrl.item.controls' ng-value='0' type='radio'>\n<span class='om-radio-inner'></span>\n</label>\n<span class='om-radio-label'>{{::'video-box.play-settings.controls.options.never' | translate}}</span>\n</div>\n<div class='om-controls-container'>\n<label class='om-radio'>\n<input ng-model='$ctrl.item.controls' ng-value='1' type='radio'>\n<span class='om-radio-inner'></span>\n</label>\n<span class='om-radio-label'>{{::'video-box.play-settings.controls.options.on-hover' | translate}}</span>\n</div>\n</div>\n</div>\n")}]);try{angular.module("organizeMediaPreload")}catch(e){angular.module("organizeMediaPreload",[])}angular.module("organizeMediaPreload").run(["$templateCache",function(e){"use strict";e.put("views/video-preview.html","<div class='om-video-preview-container'>\n<img class='om-video-preview' ng-if='$ctrl.item !== null' ng-src='{{$ctrl.item.thumbnailUrl}}'>\n</div>\n")}]);try{angular.module("organizeMediaPreload")}catch(e){angular.module("organizeMediaPreload",[])}angular.module("organizeMediaPreload").run(["$templateCache",function(e){"use strict";e.put("views/video-search.html","<div class='om-app-main' data-hook='om-video-search-container'>\n<div class='om-window-main'>\n<header class='om-header-dialog panel-header'>\n<span class='panel-header-title' data-hook='om-video-search-title'>{{::'search.title' | translate}}</span>\n<span>\n<button class='panel-header-button' data-hook='om-video-search-close-button' ng-click='$ctrl.close()'>\n<svg height='25px' viewBox='0 0 25 25' width='25px'>\n<path d='M11.7928932,12.5 L8.14644661,8.85355339 L7.79289322,8.5 L8.5,7.79289322 L8.85355339,8.14644661 L12.5,11.7928932 L16.1464466,8.14644661 L16.5,7.79289322 L17.2071068,8.5 L16.8535534,8.85355339 L13.2071068,12.5 L16.8535534,16.1464466 L17.2071068,16.5 L16.5,17.2071068 L16.1464466,      16.8535534 L12.5,13.2071068 L8.85355339,16.8535534 L8.5,17.2071068 L7.79289322,16.5 L8.14644661,16.1464466 L11.7928932,12.5 Z'></path>\n</svg>\n</button>\n<button class='panel-header-button' data-hook='om-video-search-help-button' ng-click='$ctrl.onHelp()'>?</button>\n</span>\n</header>\n<main class='om-main-container'>\n<div class='om-main'>\n<form class='om-vs-search-bar'>\n<input data-hook='om-video-search-query' ng-model='$ctrl.query' om-autofocus='true' placeholder='{{::&#39;search-bar.placeholder&#39; | translate}}' type='text'>\n<svg>\n<path d='M14.25 13.54l-2.84-2.85c1.02-1.17 1.65-2.67 1.65-4.3 0-3.59-3.04-6.64-6.63-6.64S-.25 2.8-.25 6.39s3.06 6.63 6.65 6.63c1.62 0 3.12-.62 4.3-1.62l2.85 2.85.7-.71zM6.4 12.05C3.37 12.05.78 9.43.78 6.39.78 3.36 3.32.75 6.35.75 9.39.75 12 3.36 12 6.39c0 3.04-2.57 5.66-5.6 5.66z' fill-rule='evenodd' fill='#3799EB'></path>\n</svg>\n<button class='btn secondary-btn' data-hook='om-video-search-button' ng-click='$ctrl.startSearch()'>{{::'general.search-button' | translate}}</button>\n</form>\n<div class='om-main-header is-video-search-subtitle' data-hook='om-video-search-subtitle'>\n<span>{{::'search.from' | translate}}</span>\n<input class='om-radio' data-hook='video-search-youtube-source' id='radio1' ng-change='$ctrl.startSearch()' ng-model='$ctrl.source' ng-value='&#39;youtube&#39;' type='radio'>\n<label data-hook='video-search-youtube-source-label' for='radio1'>Youtube</label>\n<input class='om-radio' data-hook='video-search-vimeo-source' id='radio2' ng-change='$ctrl.startSearch()' ng-model='$ctrl.source' ng-value='&#39;vimeo&#39;' type='radio'>\n<label data-hook='video-search-vimeo-source-label' for='radio2'>Vimeo</label>\n</div>\n<div class='om-vs-center-messages-area' ng-class='{&#39;center-items&#39;: $ctrl.videos.length === 0}'>\n<div alt='No search results displayed' class='om-vs-no-videos-drawing' data-hook='om-video-search-drawing' ng-if='$ctrl.videos.length === 0'>\n<svg height='133px' version='1.1' viewBox='0 0 85 85' width='121px' xmlns='http://www.w3.org/2000/svg'>\n<g fill-rule='evenodd' fill='none' stroke-width='1' stroke='none'>\n<path d='M18.5,48.11 L2.5,48.11 C1.395,48.11 0.5,47.214 0.5,46.11 L0.5,38.89 C0.5,37.786 1.395,36.89 2.5,36.89 L18.5,36.89 C19.605,36.89 20.5,37.786 20.5,38.89 L20.5,46.11 C20.5,47.214 19.605,48.11 18.5,48.11' fill='#D3ECF4'></path>\n<path d='M1.964,38.354 L3.427,38.354 L3.427,39.817 L1.964,39.817 L1.964,38.354 Z' fill='#FFFFFF'></path>\n<path d='M1.964,41.768 L3.427,41.768 L3.427,43.231 L1.964,43.231 L1.964,41.768 Z' fill='#FFFFFF'></path>\n<path d='M1.964,45.183 L3.427,45.183 L3.427,46.646 L1.964,46.646 L1.964,45.183 Z' fill='#FFFFFF'></path>\n<path d='M17.573,38.354 L19.036,38.354 L19.036,39.817 L17.573,39.817 L17.573,38.354 Z' fill='#FFFFFF'></path>\n<path d='M17.573,41.768 L19.036,41.768 L19.036,43.231 L17.573,43.231 L17.573,41.768 Z' fill='#FFFFFF'></path>\n<path d='M17.573,45.183 L19.036,45.183 L19.036,46.646 L17.573,46.646 L17.573,45.183 Z' fill='#FFFFFF'></path>\n<path d='M4.89,38.354 L16.11,38.354 L16.11,46.647 L4.89,46.647 L4.89,38.354 Z' fill='#FFFFFF'></path>\n<path d='M9,40.514 L12.902,42.709 L9,44.904 L9,40.514' fill='#A7E3FA'></path>\n<path d='M56.854,11.487 C47.11,1.743 31.312,1.743 21.568,11.487 C19.611,13.444 18.071,15.653 16.901,18 C13.29,25.241 13.412,33.857 17.283,41 C18.093,42.494 19.051,43.929 20.188,45.266 C20.625,45.782 21.081,46.287 21.568,46.774 C31.312,56.518 47.11,56.518 56.854,46.774 C61.211,42.417 63.614,36.85 64.074,31.155 C64.644,24.112 62.241,16.875 56.854,11.487' fill='#FFFFFF'></path>\n<path d='M54,39 L54,20 C54,18.895 53.105,18 52,18 L16.901,18 C13.29,25.241 13.412,33.857 17.283,41 L52,41 C53.105,41 54,40.105 54,39' fill='#D3ECF4'></path>\n<path d='M23.918,16.757 C28.517,12.159 34.557,9.862 40.598,9.862 C46.636,9.862 52.677,12.16 57.276,16.757 C61.188,20.67 63.555,25.716 64.074,31.155 C64.644,24.112 62.241,16.875 56.854,11.487 C47.11,1.743 31.312,1.743 21.568,11.487 C12.31,20.745 11.854,35.463 20.188,45.266 C18.118,41.711 17.01,37.659 17.01,33.436 C17.01,27.136 19.464,21.212 23.918,16.757' fill='#EBEBEB'></path>\n<path d='M16,21 L19,21 L19,24 L16,24 L16,21 Z' fill='#FFFFFF'></path>\n<path d='M16,28 L19,28 L19,31 L16,31 L16,28 Z' fill='#FFFFFF'></path>\n<path d='M16,35 L19,35 L19,38 L16,38 L16,35 Z' fill='#FFFFFF'></path>\n<path d='M48,21 L51,21 L51,24 L48,24 L48,21 Z' fill='#FFFFFF'></path>\n<path d='M48,28 L51,28 L51,31 L48,31 L48,28 Z' fill='#FFFFFF'></path>\n<path d='M48,35 L51,35 L51,38 L48,38 L48,35 Z' fill='#FFFFFF'></path>\n<path d='M22,21 L45,21 L45,38 L22,38 L22,21 Z' fill='#FFFFFF'></path>\n<path d='M30,25.428 L38,29.928 L30,34.428 L30,25.428' fill='#A7E3FA'></path>\n<path d='M76.268,65.912 C77.084,65.095 77.31,64.208 77.31,63.137 C77.31,62.067 76.72,61.18 75.903,60.363 L61.966,46.426 C65.8,41.249 67.568,35.404 67.568,29.434 C67.568,22.078 64.786,14.704 59.186,9.103 C47.985,-2.097 29.77,-2.106 18.569,9.094 C7.368,20.295 7.664,38.223 18.864,49.424 C29.108,59.666 44.86,60.86 56.752,51.725 L70.647,65.62 C72.279,67.253 74.636,67.544 76.268,65.912 L76.268,65.912 Z M53.73,48.179 C44.337,55.608 30.626,55.001 21.956,46.332 C12.618,36.994 12.618,21.801 21.956,12.464 C31.294,3.126 46.488,3.126 55.826,12.464 C64.409,21.048 65.078,34.571 57.879,43.954 C57.248,44.777 56.579,45.579 55.826,46.332 C55.158,47 54.453,47.607 53.73,48.179 L53.73,48.179 Z' fill='#A7E3FA'></path>\n<path d='M68.588,82.767 C68.588,83.872 56.052,84.767 40.588,84.767 C25.124,84.767 12.588,83.872 12.588,82.767 C12.588,81.663 25.124,80.767 40.588,80.767 C56.052,80.767 68.588,81.663 68.588,82.767' fill='#D3ECF4'></path>\n</g>\n</svg>\n</div>\n<div ng-switch='$ctrl.searchStatus'>\n<div class='om-vs-search-results-empty' data-hook='om-video-search-message' ng-switch-when='beforeSearch'>{{ 'search-video.text' | translate: {source: $ctrl.source.charAt(0).toUpperCase() + $ctrl.source.substr(1).toLowerCase()} }}</div>\n<div class='om-vs-search-results-empty' data-hook='om-video-search-message' ng-switch-when='noResultsFound'>{{:: 'search-video.no-results' | translate }}</div>\n</div>\n<div class='om-vs-search-results om-items-list' ng-if='$ctrl.videos.length' om-infinite-scroll='$ctrl.search()'>\n<video-item class='media-item video-item' data-hook='om-video-search-result-item' item='item' ng-click='$ctrl.selected = item' ng-dblclick='$ctrl.done()' ng-repeat='item in $ctrl.videos' ng-selected='item === $ctrl.selected' open-video-foreplay='$ctrl.openVideoForeplay(item)'></video-item>\n</div>\n</div>\n</div>\n</main>\n<footer class='panel-footer'>\n<button class='btn secondary-btn' data-hook='om-video-search-cancel-button' ng-click='$ctrl.cancel()'>{{::'general.cancel-button' | translate}}</button>\n<button class='btn primary-btn' data-hook='om-video-search-done-button' ng-click='$ctrl.done()' ng-disabled='!$ctrl.selected'>{{::'general.add-button' | translate}}</button>\n</footer>\n</div>\n</div>\n")}]),angular.module("organizeMediaApp").constant("customData",{title:"Recommended",sections:[{title:"Recommended especially for your section",data:[{id:"95dca3_67abe669f76b452db3d344d73b95ed88.jpg",folderId:"5ef09de742b21f8978aa5aa578edf9ae",name:"11084017_10206669551480456_1435141193163919894_o.jpg 2015-9-11-22:52:50",mediaType:"picture",fileUrl:"/media/95dca3_67abe669f76b452db3d344d73b95ed88.jpg",createdAt:1442001170,labels:[],tags:["edited image"],width:1049,height:1500,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_67abe669f76b452db3d344d73b95ed88.jpg/v1/fill/w_210,h_210/95dca3_67abe669f76b452db3d344d73b95ed88.jpg",previewUrl:"//static.wixstatic.com/media/95dca3_67abe669f76b452db3d344d73b95ed88.jpg/v1/fit/w_375,h_375/95dca3_67abe669f76b452db3d344d73b95ed88.jpg",originalUrl:"//static.wixstatic.com/media/95dca3_67abe669f76b452db3d344d73b95ed88.jpg",videoPreviewUrl:null}]},{title:"Images from your business",action:{url:"private",title:"Show All"},data:[{id:"95dca3_28695c6cd1564c059451211f0df8a732.jpg",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"twittwer-and-facebook-profile-2.jpg",mediaType:"picture",fileUrl:"media/95dca3_28695c6cd1564c059451211f0df8a732.jpg",createdAt:1462178276,labels:["font","logo","area","artwork","brand"],tags:[],width:400,height:400,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_28695c6cd1564c059451211f0df8a732.jpg/v1/fill/w_210,h_210/95dca3_28695c6cd1564c059451211f0df8a732.jpg",previewUrl:"//static.wixstatic.com/media/95dca3_28695c6cd1564c059451211f0df8a732.jpg/v1/fit/w_375,h_375/95dca3_28695c6cd1564c059451211f0df8a732.jpg",originalUrl:"//static.wixstatic.com/media/95dca3_28695c6cd1564c059451211f0df8a732.jpg",videoPreviewUrl:null},{id:"95dca3_34aeb8de5c774a2eb964402f3d4c6108.png",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"image_FT.png",mediaType:"picture",fileUrl:"media/95dca3_34aeb8de5c774a2eb964402f3d4c6108.png",createdAt:1461752139,labels:["art","font","diagram","document","area"],tags:[],width:538,height:306,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_34aeb8de5c774a2eb964402f3d4c6108.png/v1/fill/w_210,h_210/95dca3_34aeb8de5c774a2eb964402f3d4c6108.png",previewUrl:"//static.wixstatic.com/media/95dca3_34aeb8de5c774a2eb964402f3d4c6108.png/v1/fit/w_375,h_375/95dca3_34aeb8de5c774a2eb964402f3d4c6108.png",originalUrl:"//static.wixstatic.com/media/95dca3_34aeb8de5c774a2eb964402f3d4c6108.png",videoPreviewUrl:null},{id:"95dca3_f133807c4c0a48bea1c7e4a491fa5cc9.png",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"engage_m.png",mediaType:"picture",fileUrl:"media/95dca3_f133807c4c0a48bea1c7e4a491fa5cc9.png",createdAt:1461748979,labels:["aqua","label","circle","logo","clip art"],tags:[],width:120,height:120,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_f133807c4c0a48bea1c7e4a491fa5cc9.png/v1/fill/w_210,h_210/95dca3_f133807c4c0a48bea1c7e4a491fa5cc9.png",previewUrl:"//static.wixstatic.com/media/95dca3_f133807c4c0a48bea1c7e4a491fa5cc9.png/v1/fit/w_375,h_375/95dca3_f133807c4c0a48bea1c7e4a491fa5cc9.png",originalUrl:"//static.wixstatic.com/media/95dca3_f133807c4c0a48bea1c7e4a491fa5cc9.png",videoPreviewUrl:null},{id:"95dca3_9765a7e3e8b84f1fa963d9ea4914ccb6.png",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"react.png",mediaType:"picture",fileUrl:"media/95dca3_9765a7e3e8b84f1fa963d9ea4914ccb6.png",createdAt:1457092216,labels:["area","clip art","mp3 player accessory","baby toys","Packaging"],tags:[],width:600,height:537,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_9765a7e3e8b84f1fa963d9ea4914ccb6.png/v1/fill/w_210,h_210/95dca3_9765a7e3e8b84f1fa963d9ea4914ccb6.png",previewUrl:"//static.wixstatic.com/media/95dca3_9765a7e3e8b84f1fa963d9ea4914ccb6.png/v1/fit/w_375,h_375/95dca3_9765a7e3e8b84f1fa963d9ea4914ccb6.png",originalUrl:"//static.wixstatic.com/media/95dca3_9765a7e3e8b84f1fa963d9ea4914ccb6.png",videoPreviewUrl:null},{id:"95dca3_354b3a6e4fd1455fbe2f5e5d37717474.png",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"react_native.png",mediaType:"picture",fileUrl:"media/95dca3_354b3a6e4fd1455fbe2f5e5d37717474.png",createdAt:1457092064,labels:["black","t shirt","blue","text","logo"],tags:[],width:1900,height:1267,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_354b3a6e4fd1455fbe2f5e5d37717474.png/v1/fill/w_210,h_210/95dca3_354b3a6e4fd1455fbe2f5e5d37717474.png",previewUrl:"//static.wixstatic.com/media/95dca3_354b3a6e4fd1455fbe2f5e5d37717474.png/v1/fit/w_375,h_375/95dca3_354b3a6e4fd1455fbe2f5e5d37717474.png",originalUrl:"//static.wixstatic.com/media/95dca3_354b3a6e4fd1455fbe2f5e5d37717474.png",videoPreviewUrl:null},{id:"95dca3_d9df2ec8a1f743899abdb2c956360f0d.png",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"react-js-communication_0.png",mediaType:"picture",fileUrl:"media/95dca3_d9df2ec8a1f743899abdb2c956360f0d.png",createdAt:1457091452,labels:["blue","text","display device","logo","symbol"],tags:[],width:661,height:317,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_d9df2ec8a1f743899abdb2c956360f0d.png/v1/fill/w_210,h_210/95dca3_d9df2ec8a1f743899abdb2c956360f0d.png",previewUrl:"//static.wixstatic.com/media/95dca3_d9df2ec8a1f743899abdb2c956360f0d.png/v1/fit/w_375,h_375/95dca3_d9df2ec8a1f743899abdb2c956360f0d.png",originalUrl:"//static.wixstatic.com/media/95dca3_d9df2ec8a1f743899abdb2c956360f0d.png",videoPreviewUrl:null}]},{title:"Free from Wix",action:{url:"public",title:"Show All"},data:[{id:"95dca3_28695c6cd1564c059451211f0df8a732.jpg",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"twittwer-and-facebook-profile-2.jpg",mediaType:"picture",fileUrl:"media/95dca3_28695c6cd1564c059451211f0df8a732.jpg",createdAt:1462178276,labels:["font","logo","area","artwork","brand"],tags:[],width:400,height:400,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_28695c6cd1564c059451211f0df8a732.jpg/v1/fill/w_210,h_210/95dca3_28695c6cd1564c059451211f0df8a732.jpg",previewUrl:"//static.wixstatic.com/media/95dca3_28695c6cd1564c059451211f0df8a732.jpg/v1/fit/w_375,h_375/95dca3_28695c6cd1564c059451211f0df8a732.jpg",originalUrl:"//static.wixstatic.com/media/95dca3_28695c6cd1564c059451211f0df8a732.jpg",videoPreviewUrl:null},{id:"95dca3_34aeb8de5c774a2eb964402f3d4c6108.png",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"image_FT.png",mediaType:"picture",fileUrl:"media/95dca3_34aeb8de5c774a2eb964402f3d4c6108.png",createdAt:1461752139,labels:["art","font","diagram","document","area"],tags:[],width:538,height:306,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_34aeb8de5c774a2eb964402f3d4c6108.png/v1/fill/w_210,h_210/95dca3_34aeb8de5c774a2eb964402f3d4c6108.png",previewUrl:"//static.wixstatic.com/media/95dca3_34aeb8de5c774a2eb964402f3d4c6108.png/v1/fit/w_375,h_375/95dca3_34aeb8de5c774a2eb964402f3d4c6108.png",originalUrl:"//static.wixstatic.com/media/95dca3_34aeb8de5c774a2eb964402f3d4c6108.png",videoPreviewUrl:null},{id:"95dca3_f133807c4c0a48bea1c7e4a491fa5cc9.png",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"engage_m.png",mediaType:"picture",fileUrl:"media/95dca3_f133807c4c0a48bea1c7e4a491fa5cc9.png",createdAt:1461748979,labels:["aqua","label","circle","logo","clip art"],tags:[],width:120,height:120,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_f133807c4c0a48bea1c7e4a491fa5cc9.png/v1/fill/w_210,h_210/95dca3_f133807c4c0a48bea1c7e4a491fa5cc9.png",previewUrl:"//static.wixstatic.com/media/95dca3_f133807c4c0a48bea1c7e4a491fa5cc9.png/v1/fit/w_375,h_375/95dca3_f133807c4c0a48bea1c7e4a491fa5cc9.png",originalUrl:"//static.wixstatic.com/media/95dca3_f133807c4c0a48bea1c7e4a491fa5cc9.png",videoPreviewUrl:null},{id:"95dca3_9765a7e3e8b84f1fa963d9ea4914ccb6.png",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"react.png",mediaType:"picture",fileUrl:"media/95dca3_9765a7e3e8b84f1fa963d9ea4914ccb6.png",createdAt:1457092216,labels:["area","clip art","mp3 player accessory","baby toys","Packaging"],tags:[],width:600,height:537,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_9765a7e3e8b84f1fa963d9ea4914ccb6.png/v1/fill/w_210,h_210/95dca3_9765a7e3e8b84f1fa963d9ea4914ccb6.png",previewUrl:"//static.wixstatic.com/media/95dca3_9765a7e3e8b84f1fa963d9ea4914ccb6.png/v1/fit/w_375,h_375/95dca3_9765a7e3e8b84f1fa963d9ea4914ccb6.png",originalUrl:"//static.wixstatic.com/media/95dca3_9765a7e3e8b84f1fa963d9ea4914ccb6.png",videoPreviewUrl:null},{id:"95dca3_354b3a6e4fd1455fbe2f5e5d37717474.png",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"react_native.png",mediaType:"picture",fileUrl:"media/95dca3_354b3a6e4fd1455fbe2f5e5d37717474.png",createdAt:1457092064,labels:["black","t shirt","blue","text","logo"],tags:[],width:1900,height:1267,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_354b3a6e4fd1455fbe2f5e5d37717474.png/v1/fill/w_210,h_210/95dca3_354b3a6e4fd1455fbe2f5e5d37717474.png",previewUrl:"//static.wixstatic.com/media/95dca3_354b3a6e4fd1455fbe2f5e5d37717474.png/v1/fit/w_375,h_375/95dca3_354b3a6e4fd1455fbe2f5e5d37717474.png",originalUrl:"//static.wixstatic.com/media/95dca3_354b3a6e4fd1455fbe2f5e5d37717474.png",videoPreviewUrl:null},{id:"95dca3_d9df2ec8a1f743899abdb2c956360f0d.png",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"react-js-communication_0.png",mediaType:"picture",fileUrl:"media/95dca3_d9df2ec8a1f743899abdb2c956360f0d.png",createdAt:1457091452,labels:["blue","text","display device","logo","symbol"],tags:[],width:661,height:317,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_d9df2ec8a1f743899abdb2c956360f0d.png/v1/fill/w_210,h_210/95dca3_d9df2ec8a1f743899abdb2c956360f0d.png",previewUrl:"//static.wixstatic.com/media/95dca3_d9df2ec8a1f743899abdb2c956360f0d.png/v1/fit/w_375,h_375/95dca3_d9df2ec8a1f743899abdb2c956360f0d.png",originalUrl:"//static.wixstatic.com/media/95dca3_d9df2ec8a1f743899abdb2c956360f0d.png",videoPreviewUrl:null},{id:"95dca3_51c4da6f32524be2ab352620c4ff278b.jpg",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"Untitled",mediaType:"picture",fileUrl:"media/95dca3_51c4da6f32524be2ab352620c4ff278b.jpg",createdAt:1455622986,labels:[],tags:["_imported","_site_builder"],width:450,height:470,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_51c4da6f32524be2ab352620c4ff278b.jpg/v1/fill/w_210,h_210/95dca3_51c4da6f32524be2ab352620c4ff278b.jpg",previewUrl:"//static.wixstatic.com/media/95dca3_51c4da6f32524be2ab352620c4ff278b.jpg/v1/fit/w_375,h_375/95dca3_51c4da6f32524be2ab352620c4ff278b.jpg",originalUrl:"//static.wixstatic.com/media/95dca3_51c4da6f32524be2ab352620c4ff278b.jpg",videoPreviewUrl:null},{id:"95dca3_9563f0947359471bb7ab3306ec3f6583.png",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"Untitled",mediaType:"picture",fileUrl:"media/95dca3_9563f0947359471bb7ab3306ec3f6583.png",createdAt:1455622984,labels:[],tags:["_imported","_site_builder"],width:458,height:380,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_9563f0947359471bb7ab3306ec3f6583.png/v1/fill/w_210,h_210/95dca3_9563f0947359471bb7ab3306ec3f6583.png",previewUrl:"//static.wixstatic.com/media/95dca3_9563f0947359471bb7ab3306ec3f6583.png/v1/fit/w_375,h_375/95dca3_9563f0947359471bb7ab3306ec3f6583.png",originalUrl:"//static.wixstatic.com/media/95dca3_9563f0947359471bb7ab3306ec3f6583.png",videoPreviewUrl:null},{id:"95dca3_c0526effd09749ddb69f0a580766085d.jpg",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"Untitled",mediaType:"picture",fileUrl:"media/95dca3_c0526effd09749ddb69f0a580766085d.jpg",createdAt:1455622185,labels:[],tags:["_imported","_site_builder"],width:450,height:470,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_c0526effd09749ddb69f0a580766085d.jpg/v1/fill/w_210,h_210/95dca3_c0526effd09749ddb69f0a580766085d.jpg",previewUrl:"//static.wixstatic.com/media/95dca3_c0526effd09749ddb69f0a580766085d.jpg/v1/fit/w_375,h_375/95dca3_c0526effd09749ddb69f0a580766085d.jpg",originalUrl:"//static.wixstatic.com/media/95dca3_c0526effd09749ddb69f0a580766085d.jpg",videoPreviewUrl:null},{id:"95dca3_2b5f9533f0a64e52819bf007832c14aa.png",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"Untitled",mediaType:"picture",fileUrl:"media/95dca3_2b5f9533f0a64e52819bf007832c14aa.png",createdAt:1455622183,labels:["finger","tattoo","facial expression","cartoon","hand"],tags:["_imported","_site_builder"],width:458,height:380,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_2b5f9533f0a64e52819bf007832c14aa.png/v1/fill/w_210,h_210/95dca3_2b5f9533f0a64e52819bf007832c14aa.png",previewUrl:"//static.wixstatic.com/media/95dca3_2b5f9533f0a64e52819bf007832c14aa.png/v1/fit/w_375,h_375/95dca3_2b5f9533f0a64e52819bf007832c14aa.png",originalUrl:"//static.wixstatic.com/media/95dca3_2b5f9533f0a64e52819bf007832c14aa.png",videoPreviewUrl:null},{id:"95dca3_631612911d9d454e98dc821c87b48e06.jpg",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"272134_2248517135433_1439249_o.jpg",mediaType:"picture",fileUrl:"media/95dca3_631612911d9d454e98dc821c87b48e06.jpg",createdAt:1448308744,labels:[],tags:[],width:1024,height:1368,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_631612911d9d454e98dc821c87b48e06.jpg/v1/fill/w_210,h_210/95dca3_631612911d9d454e98dc821c87b48e06.jpg",previewUrl:"//static.wixstatic.com/media/95dca3_631612911d9d454e98dc821c87b48e06.jpg/v1/fit/w_375,h_375/95dca3_631612911d9d454e98dc821c87b48e06.jpg",originalUrl:"//static.wixstatic.com/media/95dca3_631612911d9d454e98dc821c87b48e06.jpg",videoPreviewUrl:null},{id:"95dca3_9d15663865954b4e842c706281dfc5da.png",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"wix-invoices-logo-01.png",mediaType:"picture",fileUrl:"media/95dca3_9d15663865954b4e842c706281dfc5da.png",createdAt:1448177954,labels:[],tags:[],width:600,height:85,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_9d15663865954b4e842c706281dfc5da.png/v1/fill/w_210,h_210/95dca3_9d15663865954b4e842c706281dfc5da.png",previewUrl:"//static.wixstatic.com/media/95dca3_9d15663865954b4e842c706281dfc5da.png/v1/fit/w_375,h_375/95dca3_9d15663865954b4e842c706281dfc5da.png",originalUrl:"//static.wixstatic.com/media/95dca3_9d15663865954b4e842c706281dfc5da.png",videoPreviewUrl:null},{id:"95dca3_3adbbc2bb23a41ec8a8c886ccedc37a4.png",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"Screen Shot 2015-10-15 at 13.10.38.png",mediaType:"picture",fileUrl:"media/95dca3_3adbbc2bb23a41ec8a8c886ccedc37a4.png",createdAt:1444904334,labels:[],tags:[],width:954,height:708,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_3adbbc2bb23a41ec8a8c886ccedc37a4.png/v1/fill/w_210,h_210/95dca3_3adbbc2bb23a41ec8a8c886ccedc37a4.png",previewUrl:"//static.wixstatic.com/media/95dca3_3adbbc2bb23a41ec8a8c886ccedc37a4.png/v1/fit/w_375,h_375/95dca3_3adbbc2bb23a41ec8a8c886ccedc37a4.png",originalUrl:"//static.wixstatic.com/media/95dca3_3adbbc2bb23a41ec8a8c886ccedc37a4.png",videoPreviewUrl:null},{id:"95dca3_5445d6869d4a4ad494ebe34804861972.png",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"logo.png",mediaType:"picture",fileUrl:"media/95dca3_5445d6869d4a4ad494ebe34804861972.png",createdAt:1442148779,labels:[],tags:[],width:1e3,height:700,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_5445d6869d4a4ad494ebe34804861972.png/v1/fill/w_210,h_210/95dca3_5445d6869d4a4ad494ebe34804861972.png",previewUrl:"//static.wixstatic.com/media/95dca3_5445d6869d4a4ad494ebe34804861972.png/v1/fit/w_375,h_375/95dca3_5445d6869d4a4ad494ebe34804861972.png",originalUrl:"//static.wixstatic.com/media/95dca3_5445d6869d4a4ad494ebe34804861972.png",videoPreviewUrl:null},{id:"95dca3_fe4e97931617447592e514417560451b.jpg",folderId:"e299203d48894d55b19eb8c9b5d354ad",name:"blueprints  and planning.jpg",mediaType:"picture",fileUrl:"media/95dca3_fe4e97931617447592e514417560451b.jpg",createdAt:1442125968,labels:[],tags:["_paid","_bigstock","_bigstock_80666213","_bigstock_80666213_l"],width:2800,height:1860,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_fe4e97931617447592e514417560451b.jpg/v1/fill/w_210,h_210/95dca3_fe4e97931617447592e514417560451b.jpg",previewUrl:"//static.wixstatic.com/media/95dca3_fe4e97931617447592e514417560451b.jpg/v1/fit/w_375,h_375/95dca3_fe4e97931617447592e514417560451b.jpg",originalUrl:"//static.wixstatic.com/media/95dca3_fe4e97931617447592e514417560451b.jpg",videoPreviewUrl:null},{id:"95dca3_4c1fad6abd7240c3a003f6838de76fa6.png",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"github-01.png",mediaType:"picture",fileUrl:"media/95dca3_4c1fad6abd7240c3a003f6838de76fa6.png",createdAt:1442124648,labels:[],tags:[],width:200,height:200,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_4c1fad6abd7240c3a003f6838de76fa6.png/v1/fill/w_210,h_210/95dca3_4c1fad6abd7240c3a003f6838de76fa6.png",previewUrl:"//static.wixstatic.com/media/95dca3_4c1fad6abd7240c3a003f6838de76fa6.png/v1/fit/w_375,h_375/95dca3_4c1fad6abd7240c3a003f6838de76fa6.png",originalUrl:"//static.wixstatic.com/media/95dca3_4c1fad6abd7240c3a003f6838de76fa6.png",videoPreviewUrl:null},{id:"95dca3_28fc6f9b09d14fafa7791f736c5ccbe0.png",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"Screen Shot 2015-09-12 at 00.39.48 .png",mediaType:"picture",fileUrl:"media/95dca3_28fc6f9b09d14fafa7791f736c5ccbe0.png",createdAt:1442007746,labels:[],tags:[],width:1768,height:996,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_28fc6f9b09d14fafa7791f736c5ccbe0.png/v1/fill/w_210,h_210/95dca3_28fc6f9b09d14fafa7791f736c5ccbe0.png",previewUrl:"//static.wixstatic.com/media/95dca3_28fc6f9b09d14fafa7791f736c5ccbe0.png/v1/fit/w_375,h_375/95dca3_28fc6f9b09d14fafa7791f736c5ccbe0.png",originalUrl:"//static.wixstatic.com/media/95dca3_28fc6f9b09d14fafa7791f736c5ccbe0.png",videoPreviewUrl:null},{id:"95dca3_59bb4b61c59247b7ad713f983cbfd2fc.jpg",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"10996085_1595967644024070_38828596761427860_o.jpg",mediaType:"picture",fileUrl:"media/95dca3_59bb4b61c59247b7ad713f983cbfd2fc.jpg",createdAt:1442006226,labels:[],tags:[],width:2048,height:1324,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_59bb4b61c59247b7ad713f983cbfd2fc.jpg/v1/fill/w_210,h_210/95dca3_59bb4b61c59247b7ad713f983cbfd2fc.jpg",previewUrl:"//static.wixstatic.com/media/95dca3_59bb4b61c59247b7ad713f983cbfd2fc.jpg/v1/fit/w_375,h_375/95dca3_59bb4b61c59247b7ad713f983cbfd2fc.jpg",originalUrl:"//static.wixstatic.com/media/95dca3_59bb4b61c59247b7ad713f983cbfd2fc.jpg",videoPreviewUrl:null},{id:"95dca3_67abe669f76b452db3d344d73b95ed88.jpg",folderId:"5ef09de742b21f8978aa5aa578edf9ae",name:"11084017_10206669551480456_1435141193163919894_o.jpg 2015-9-11-22:52:50",mediaType:"picture",fileUrl:"/media/95dca3_67abe669f76b452db3d344d73b95ed88.jpg",createdAt:1442001170,labels:[],tags:["edited image"],width:1049,height:1500,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_67abe669f76b452db3d344d73b95ed88.jpg/v1/fill/w_210,h_210/95dca3_67abe669f76b452db3d344d73b95ed88.jpg",previewUrl:"//static.wixstatic.com/media/95dca3_67abe669f76b452db3d344d73b95ed88.jpg/v1/fit/w_375,h_375/95dca3_67abe669f76b452db3d344d73b95ed88.jpg",originalUrl:"//static.wixstatic.com/media/95dca3_67abe669f76b452db3d344d73b95ed88.jpg",videoPreviewUrl:null},{id:"95dca3_38139dd208b741da85cd10cf4e87f567.jpg",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"11084017_10206669551480456_1435141193163919894_o.jpg",mediaType:"picture",fileUrl:"media/95dca3_38139dd208b741da85cd10cf4e87f567.jpg",createdAt:1442000404,labels:[],tags:[],width:1432,height:2048,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_38139dd208b741da85cd10cf4e87f567.jpg/v1/fill/w_210,h_210/95dca3_38139dd208b741da85cd10cf4e87f567.jpg",previewUrl:"//static.wixstatic.com/media/95dca3_38139dd208b741da85cd10cf4e87f567.jpg/v1/fit/w_375,h_375/95dca3_38139dd208b741da85cd10cf4e87f567.jpg",originalUrl:"//static.wixstatic.com/media/95dca3_38139dd208b741da85cd10cf4e87f567.jpg",videoPreviewUrl:null},{id:"95dca3_c1fa817b61254b75a37d20e8808291d8.jpg",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"Untitled",mediaType:"picture",fileUrl:"media/95dca3_c1fa817b61254b75a37d20e8808291d8.jpg",createdAt:1441998704,labels:[],tags:["_social","_imported","_facebook","_facebook_10206453747165483"],width:720,height:224,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_c1fa817b61254b75a37d20e8808291d8.jpg/v1/fill/w_210,h_210/95dca3_c1fa817b61254b75a37d20e8808291d8.jpg",previewUrl:"//static.wixstatic.com/media/95dca3_c1fa817b61254b75a37d20e8808291d8.jpg/v1/fit/w_375,h_375/95dca3_c1fa817b61254b75a37d20e8808291d8.jpg",originalUrl:"//static.wixstatic.com/media/95dca3_c1fa817b61254b75a37d20e8808291d8.jpg",videoPreviewUrl:null},{id:"95dca3_f711c8752d0b48b886438d73fc0eed24.jpg",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"Untitled",mediaType:"picture",fileUrl:"media/95dca3_f711c8752d0b48b886438d73fc0eed24.jpg",createdAt:1441998655,labels:[],tags:["_social","_imported","_facebook","_facebook_4597681623077"],width:720,height:472,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_f711c8752d0b48b886438d73fc0eed24.jpg/v1/fill/w_210,h_210/95dca3_f711c8752d0b48b886438d73fc0eed24.jpg",previewUrl:"//static.wixstatic.com/media/95dca3_f711c8752d0b48b886438d73fc0eed24.jpg/v1/fit/w_375,h_375/95dca3_f711c8752d0b48b886438d73fc0eed24.jpg",originalUrl:"//static.wixstatic.com/media/95dca3_f711c8752d0b48b886438d73fc0eed24.jpg",videoPreviewUrl:null},{id:"95dca3_d63ea2e1cfac42aebfd0258c05cb5703.png",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"YGLFConf_date.png",mediaType:"picture",fileUrl:"media/95dca3_d63ea2e1cfac42aebfd0258c05cb5703.png",createdAt:1431499482,labels:[],tags:[],width:1200,height:1200,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_d63ea2e1cfac42aebfd0258c05cb5703.png/v1/fill/w_210,h_210/95dca3_d63ea2e1cfac42aebfd0258c05cb5703.png",previewUrl:"//static.wixstatic.com/media/95dca3_d63ea2e1cfac42aebfd0258c05cb5703.png/v1/fit/w_375,h_375/95dca3_d63ea2e1cfac42aebfd0258c05cb5703.png",originalUrl:"//static.wixstatic.com/media/95dca3_d63ea2e1cfac42aebfd0258c05cb5703.png",videoPreviewUrl:null},{id:"95dca3_988a2e68ca0f41c38cc7cecdfde70281.png",folderId:"0f2943238ddbc89388ec7bbc6f761f98",name:"YGLFConf.png",mediaType:"picture",fileUrl:"media/95dca3_988a2e68ca0f41c38cc7cecdfde70281.png",createdAt:1431499105,labels:[],tags:[],width:1196,height:1198,fileInfo:null,fileInput:null,fileOutput:null,thumbnailUrl:"//static.wixstatic.com/media/95dca3_988a2e68ca0f41c38cc7cecdfde70281.png/v1/fill/w_210,h_210/95dca3_988a2e68ca0f41c38cc7cecdfde70281.png",previewUrl:"//static.wixstatic.com/media/95dca3_988a2e68ca0f41c38cc7cecdfde70281.png/v1/fit/w_375,h_375/95dca3_988a2e68ca0f41c38cc7cecdfde70281.png",originalUrl:"//static.wixstatic.com/media/95dca3_988a2e68ca0f41c38cc7cecdfde70281.png",videoPreviewUrl:null}]}]}),angular.module("organizeMediaApp").constant("extVideos",[{videoUrl:"https://youtu.be/83nu4yXFcYU",thumbnailUrl:"https://img.youtube.com/vi/83nu4yXFcYU/0.jpg",Title:"Wix Presents: User Stories",Description:"",mediaType:"extVideo",active:!0},{videoUrl:"https://youtu.be/WRU83c06luM",thumbnailUrl:"https://img.youtube.com/vi/WRU83c06luM/0.jpg",Title:"How to Build a Website with Wix.com",Description:"",mediaType:"extVideo",active:!1},{videoUrl:"https://youtu.be/akiVi1sR2rM",thumbnailUrl:"https://img.youtube.com/vi/akiVi1sR2rM/0.jpg",Title:"Louis C K Generation of Spoiled Idiots",Description:"",mediaType:"extVideo",active:!1}]),angular.module("organizeMediaApp").constant("images",[{fileName:"Two Flamingos",relativeUri:"0d5a8583187a44688b918f91298eba80.jpg",width:1920,height:1280,Title:"Two Flamingos",Description:"",Link:{},mediaType:"image",active:!0},{fileName:"Mountain Lake",relativeUri:"a9ff3b_61fe61f3eb4c4adeb5835a166de10689.jpg",width:1920,height:1280,Title:"Mountain Lake",Description:"",Link:{},mediaType:"image",active:!0},{fileName:"Beach Huts",relativeUri:"a9ff3b_5f378900670848919283755eb67a5949.jpg",width:1920,height:1280,Title:"Beach Huts",Description:"",Link:{},mediaType:"image",active:!0},{fileName:"Ferris Wheel",relativeUri:"a9ff3b_7125cf82b18841c2961ce0a241b78826.jpg",width:1920,height:1280,Title:"Ferris Wheel",Description:"",Link:{},mediaType:"image",active:!1},{fileName:"City Cycle",relativeUri:"a9ff3b_f69457ef952c4aa4ba805827a02331c4.jpg",width:1920,height:1280,Title:"City Cycle",Description:"",Link:{},mediaType:"image",active:!1},{fileName:"Palm Trees",relativeUri:"a9ff3b_1d0b83b8723c4dc39192405fd083142a.jpg",width:1920,height:1280,Title:"Palm Trees",Description:"",Link:{},mediaType:"image",active:!1},{fileName:"Misty Slopes",relativeUri:"a9ff3b_f2f5a5f6dac648e8a23cd07144c67530.jpg",width:1920,height:1280,Title:"Misty Slopes",Description:"",Link:{},mediaType:"image",active:!1}]);angular.module("organizeMediaDialog").constant("MEDIA_ITEM_SIZES",{imagePreview:{width:288,height:155},imagePreviewPopup:{width:400,height:400},imageThumbnail:{width:120,height:120},wixVideoThumbnail:{width:288,height:155}});var i={DEFAULTS:{mediaGalleryBaseHost:"https://www.wix.com/_partials/media-gallery-g5/1.519.0/",mediaType:"picture",publicMediaRoot:"photos",path:"public",tabsList:["private","external","public","photoStock"]}};angular.module("organizeMediaDialog").factory("MEDIA_GALLERY_PARAMS",["clientTopology",function(e){return i.DEFAULTS.mediaGalleryBaseHost=e.mediaGalleryUrl,i}]);var n=function(){function e(){this.list=[{name:"remove_image",type:"hint",content:"Delete",appearance:"info"},{name:"previous",type:"hint",content:"Previous",appearance:"info"},{name:"next",type:"hint",content:"Next",appearance:"info"}]}return e.prototype.registerTooltips=function(e){_.each(this.list,function(t){return e.setToolTip(t.name,_.omit(t,"name"))})},e}();angular.module("organizeMediaDialog").constant("organizeMediaDialogTooltips",new n).run(["ccTooltipManager","organizeMediaDialogTooltips",function(e,t){return t.registerTooltips(e)}]);angular.module("organizeMediaDialog").constant("VIMEO_PARAMS",{ACCESS_TOKEN:"180f85653e80e398a35769767b0fe5d6",URL_PATTERN:/^\w*(https?:\/\/)?(?:www)?vimeo\.com(?:\/channels\/\w+)?\/(\d+)$/,MAX_RESULTS:24});angular.module("organizeMediaDialog").constant("YOUTUBE_PARAMS",{API_KEY:"AIzaSyAE5uu6chqqvkw4QrEza09SLauBBNKdPoM",URL_PATTERN:/^.*(?:youtu\.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([a-z0-9-_]*).*/i,MAX_RESULTS:24}),angular.module("organizeMediaApp").constant("wixVideos",[{relativeUri:"11062b_84f0c9aa252b4b2ab1114febc012eacb",fileUrl:"video/11062b_84f0c9aa252b4b2ab1114febc012eacb",thumbnailUrl:"http://static.wixstatic.com/media/11062b_84f0c9aa252b4b2ab1114febc012eacbf002.jpg/v1/fit/w_400,h_400/11062b_84f0c9aa252b4b2ab1114febc012eacbf002.jpg",Title:"Meadow",Description:"",mediaType:"video",active:!0,controls:void 0,fileOutput:{image:[{status:"READY",secure:!1,format:"jpg",url:"media/11062b_84f0c9aa252b4b2ab1114febc012eacbf000.jpg",height:1080,width:1920,key:"poster.0"},{status:"READY",secure:!1,format:"jpg",url:"media/11062b_84f0c9aa252b4b2ab1114febc012eacbf001.jpg",height:1080,width:1920,key:"poster.1"},{status:"READY",secure:!1,format:"jpg",url:"media/11062b_84f0c9aa252b4b2ab1114febc012eacbf002.jpg",height:1080,width:1920,key:"poster.2"},{status:"READY",secure:!1,format:"jpg",url:"media/11062b_84f0c9aa252b4b2ab1114febc012eacbf003.jpg",height:1080,width:1920,key:"poster.3"}],video:[{status:"READY",audioBitrate:-1,secure:!1,fps:25,format:"mp4",url:"video/11062b_84f0c9aa252b4b2ab1114febc012eacb/480p/mp4/file.mp4",height:480,videoBitrate:833,tag:"High",key:"480p.mp4",duration:3e4,displayAspectRatio:"16:9",quality:"480p",width:854},{status:"READY",audioBitrate:-1,secure:!1,fps:25,format:"webm",url:"video/11062b_84f0c9aa252b4b2ab1114febc012eacb/480p/webm/file.webm",height:480,videoBitrate:875,tag:"High",key:"480p.webm",duration:3e4,displayAspectRatio:"16:9",quality:"480p",width:854},{status:"READY",audioBitrate:-1,secure:!1,fps:25,format:"mp4",url:"video/11062b_84f0c9aa252b4b2ab1114febc012eacb/720p/mp4/file.mp4",height:720,videoBitrate:3311,tag:"HD",key:"720p.mp4",duration:3e4,displayAspectRatio:"16:9",quality:"720p",width:1280},{status:"READY",audioBitrate:-1,secure:!1,fps:25,format:"webm",url:"video/11062b_84f0c9aa252b4b2ab1114febc012eacb/720p/webm/file.webm",height:720,videoBitrate:3701,tag:"HD",key:"720p.webm",duration:3e4,displayAspectRatio:"16:9",quality:"720p",width:1280},{status:"READY",audioBitrate:-1,secure:!1,fps:25,format:"mp4",url:"video/11062b_84f0c9aa252b4b2ab1114febc012eacb/1080p/mp4/file.mp4",height:1080,videoBitrate:5843,tag:"HD",key:"1080p.mp4",duration:3e4,displayAspectRatio:"16:9",quality:"1080p",width:1920},{status:"READY",audioBitrate:-1,secure:!1,fps:25,format:"webm",url:"video/11062b_84f0c9aa252b4b2ab1114febc012eacb/1080p/webm/file.webm",height:1080,videoBitrate:6271,tag:"HD",key:"1080p.webm",duration:3e4,displayAspectRatio:"16:9",quality:"1080p",width:1920}]}},{relativeUri:"11062b_9480d9d800bd4bda938057d5ac1ebc42",fileUrl:"video/11062b_9480d9d800bd4bda938057d5ac1ebc42",thumbnailUrl:"http://static.wixstatic.com/media/11062b_9480d9d800bd4bda938057d5ac1ebc42f002.jpg/v1/fit/w_400,h_400/11062b_9480d9d800bd4bda938057d5ac1ebc42f002.jpg",Title:"Melting Ice",Description:"",mediaType:"video",active:!1,fileOutput:{image:[{status:"READY",secure:!1,format:"jpg",url:"media/11062b_9480d9d800bd4bda938057d5ac1ebc42f000.jpg",height:1080,width:1920,key:"poster.0"},{status:"READY",secure:!1,format:"jpg",url:"media/11062b_9480d9d800bd4bda938057d5ac1ebc42f001.jpg",height:1080,width:1920,key:"poster.1"},{status:"READY",secure:!1,format:"jpg",url:"media/11062b_9480d9d800bd4bda938057d5ac1ebc42f002.jpg",height:1080,width:1920,key:"poster.2"},{status:"READY",secure:!1,format:"jpg",url:"media/11062b_9480d9d800bd4bda938057d5ac1ebc42f003.jpg",height:1080,width:1920,key:"poster.3"}],video:[{status:"READY",audioBitrate:-1,secure:!1,fps:25,format:"mp4",url:"video/11062b_9480d9d800bd4bda938057d5ac1ebc42/480p/mp4/file.mp4",height:480,videoBitrate:827,tag:"High",key:"480p.mp4",duration:18160,displayAspectRatio:"16:9",quality:"480p",width:854},{status:"READY",audioBitrate:-1,secure:!1,fps:25,format:"webm",url:"video/11062b_9480d9d800bd4bda938057d5ac1ebc42/480p/webm/file.webm",height:480,videoBitrate:883,tag:"High",key:"480p.webm",duration:18160,displayAspectRatio:"16:9",quality:"480p",width:854},{status:"READY",audioBitrate:-1,secure:!1,fps:25,format:"mp4",url:"video/11062b_9480d9d800bd4bda938057d5ac1ebc42/720p/mp4/file.mp4",height:720,videoBitrate:3435,tag:"HD",key:"720p.mp4",duration:18160,displayAspectRatio:"16:9",quality:"720p",width:1280},{status:"READY",audioBitrate:-1,secure:!1,fps:25,format:"webm",url:"video/11062b_9480d9d800bd4bda938057d5ac1ebc42/720p/webm/file.webm",height:720,videoBitrate:3526,tag:"HD",key:"720p.webm",duration:18160,displayAspectRatio:"16:9",quality:"720p",width:1280},{status:"READY",audioBitrate:-1,secure:!1,fps:25,format:"mp4",url:"video/11062b_9480d9d800bd4bda938057d5ac1ebc42/1080p/mp4/file.mp4",height:1080,videoBitrate:5915,tag:"HD",key:"1080p.mp4",duration:18160,displayAspectRatio:"16:9",quality:"1080p",width:1920},{status:"READY",audioBitrate:-1,secure:!1,fps:25,format:"webm",url:"video/11062b_9480d9d800bd4bda938057d5ac1ebc42/1080p/webm/file.webm",height:1080,videoBitrate:6217,tag:"HD",key:"1080p.webm",duration:18160,displayAspectRatio:"16:9",quality:"1080p",width:1920}]}},{relativeUri:"11062b_41148c6b0dca4f42b8380089fd183012",fileUrl:"video/11062b_41148c6b0dca4f42b8380089fd183012",thumbnailUrl:"http://static.wixstatic.com/media/11062b_41148c6b0dca4f42b8380089fd183012f002.jpg/v1/fit/w_400,h_400/11062b_41148c6b0dca4f42b8380089fd183012f002.jpg",Title:"Underwater",Description:"",mediaType:"video",active:!1,fileOutput:{image:[{status:"READY",secure:!1,format:"jpg",url:"media/11062b_41148c6b0dca4f42b8380089fd183012f000.jpg",height:1080,width:1920,key:"poster.0"},{status:"READY",secure:!1,format:"jpg",url:"media/11062b_41148c6b0dca4f42b8380089fd183012f001.jpg",height:1080,width:1920,key:"poster.1"},{status:"READY",secure:!1,format:"jpg",url:"media/11062b_41148c6b0dca4f42b8380089fd183012f002.jpg",height:1080,width:1920,key:"poster.2"},{status:"READY",secure:!1,format:"jpg",url:"media/11062b_41148c6b0dca4f42b8380089fd183012f003.jpg",height:1080,width:1920,key:"poster.3"}],video:[{status:"READY",audioBitrate:-1,secure:!1,fps:29.97,format:"mp4",url:"video/11062b_41148c6b0dca4f42b8380089fd183012/480p/mp4/file.mp4",height:480,videoBitrate:814,tag:"High",key:"480p.mp4",duration:12612,displayAspectRatio:"16:9",quality:"480p",width:854},{status:"READY",audioBitrate:-1,secure:!1,fps:29.97,format:"webm",url:"video/11062b_41148c6b0dca4f42b8380089fd183012/480p/webm/file.webm",height:480,videoBitrate:826,tag:"High",key:"480p.webm",duration:12612,displayAspectRatio:"16:9",quality:"480p",width:854},{status:"READY",audioBitrate:-1,secure:!1,fps:29.97,format:"mp4",url:"video/11062b_41148c6b0dca4f42b8380089fd183012/720p/mp4/file.mp4",height:720,videoBitrate:3485,tag:"HD",key:"720p.mp4",duration:12612,displayAspectRatio:"16:9",quality:"720p",width:1280},{status:"READY",audioBitrate:-1,secure:!1,fps:29.97,format:"webm",url:"video/11062b_41148c6b0dca4f42b8380089fd183012/720p/webm/file.webm",height:720,videoBitrate:3501,tag:"HD",key:"720p.webm",duration:12612,displayAspectRatio:"16:9",quality:"720p",width:1280},{status:"READY",audioBitrate:-1,secure:!1,fps:29.97,format:"mp4",url:"video/11062b_41148c6b0dca4f42b8380089fd183012/1080p/mp4/file.mp4",height:1080,videoBitrate:6006,tag:"HD",key:"1080p.mp4",duration:12612,displayAspectRatio:"16:9",quality:"1080p",width:1920},{status:"READY",audioBitrate:-1,secure:!1,fps:29.97,format:"webm",url:"video/11062b_41148c6b0dca4f42b8380089fd183012/1080p/webm/file.webm",height:1080,videoBitrate:6066,tag:"HD",key:"1080p.webm",duration:12612,displayAspectRatio:"16:9",quality:"1080p",width:1920}]}}]);var o=function(){function e(){}return e.prototype.setActiveItems=function(e){this.active=e.filter(function(e){return e.active})},e.prototype.setSuggestedItems=function(e){this.suggested=e.filter(function(e){return!e.active})},e.prototype.move=function(e,t,i,n){void 0===n&&(n=-1);var o=t.indexOf(e);-1===n?i.push(e):i.splice(n,0,e),t.splice(o,1)},e.prototype.dtoToObj=function(e,t){switch(t){case"video":return new M(e);case"extVideo":return new P(e);default:return angular.copy(e)}},e.prototype.setData=function(e,t,i){var n=this,o=(e||[]).map(function(e){return n.dtoToObj(e,i)});if("single"===t)for(var r=o.findIndex(function(e){return e.active}),a=0;a<o.length;a+=1)o[a].active=a===r;this.setActiveItems(o),this.setSuggestedItems(o)},e.prototype.makeActive=function(e){e.active=!0,this.move(e,this.suggested,this.active)},e.prototype.makeInactive=function(e,t){void 0===t&&(t=-1),e.active=!1,this.move(e,this.active,this.suggested,t)},e.prototype.replaceActive=function(e){var t=this,i=this.active.length>0&&"Link"in this.active[0]?this.active[0].Link:null,n=this.suggested.findIndex(this.isSameItemAs(e));this.active.forEach(function(e){"Link"in e&&(e.Link=k.getEmptyLinkObj()),t.makeInactive(e,n)}),this.makeActive(e),i&&(e.Link=i)},e.prototype.getId=function(e){return"getId"in e?e.getId():e.relativeUri},e.prototype.isSameItemAs=function(e){var t=this;return function(i){return t.getId(i)===t.getId(e)}},e.prototype.addItem=function(e,t){if(!this.active.some(this.isSameItemAs(e))){var i=this.suggested.some(this.isSameItemAs(e));"gallery"===t?i?this.makeActive(this.suggested.find(this.isSameItemAs(e))):this.active.push(e):i?this.replaceActive(this.suggested.find(this.isSameItemAs(e))):(this.suggested.push(e),this.replaceActive(e))}},Object.defineProperty(e.prototype,"itemCount",{get:function(){return this.active.length},enumerable:!0,configurable:!0}),e.prototype.reorder=function(e,t){var i=this.active.findIndex(this.isSameItemAs(t)),n=this.active.splice(i,1);this.active.splice(e,0,n[0])},e.prototype.removeSuggestion=function(e){var t=this.suggested.indexOf(e);return this.suggested.splice(t,1)},Object.defineProperty(e.prototype,"activeItems",{get:function(){return this.active},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"suggestedItems",{get:function(){return this.suggested},enumerable:!0,configurable:!0}),e}();angular.module("organizeMediaDialog").service("mediaItems",o);var r=function(){function e(e,t,i,n,o){this.YOUTUBE_PARAMS=e,this.VIMEO_PARAMS=t,this.mediaItemCreator=i,this.$http=n,this.$q=o}return e.$inject=["YOUTUBE_PARAMS","VIMEO_PARAMS","mediaItemCreator","$http","$q"],e.prototype.getVimeoVideoId=function(e){return(e.match(this.VIMEO_PARAMS.URL_PATTERN)||["fall","back",""])[2]},e.prototype.getYouTubeVideoId=function(e){return(e.match(this.YOUTUBE_PARAMS.URL_PATTERN)||["fallback",""])[1]},e.prototype.getVimeoVideoInfo=function(e){return this.$http.get("https://api.vimeo.com/videos/"+this.getVimeoVideoId(e),{headers:{Authorization:"bearer "+this.VIMEO_PARAMS.ACCESS_TOKEN}}).then(function(e){return e.data})},e.prototype.getYoutubeVideoInfo=function(e){var t=this;return this.$http.get("https://www.googleapis.com/youtube/v3/videos",{params:{key:this.YOUTUBE_PARAMS.API_KEY,part:"snippet",id:this.getYouTubeVideoId(e)}}).then(function(e){return e.data.items&&e.data.items.length>0?e.data.items[0]:t.$q.reject("No such video found")})},e.prototype.getNewExtVideoItem=function(e){var t=this;return e.match(this.VIMEO_PARAMS.URL_PATTERN)?this.getVimeoVideoInfo(e).then(function(e){return t.mediaItemCreator.fromVimeoVideo(e)}):this.getYoutubeVideoInfo(e).then(function(e){return t.mediaItemCreator.fromYoutubeVideo(e)})},e.prototype.getYoutubeVideos=function(e,t){var i=this;return void 0===t&&(t=""),this.$http.get("https://www.googleapis.com/youtube/v3/search",{params:{part:"snippet",q:e,type:"video",maxResults:this.YOUTUBE_PARAMS.MAX_RESULTS,pageToken:t,key:this.YOUTUBE_PARAMS.API_KEY}}).then(function(e){return{videos:e.data.items.map(function(e){return i.mediaItemCreator.fromYoutubeVideo(e)}),nextPageToken:e.data.nextPageToken}})},e.prototype.getVimeoVideos=function(e,t){var i=this;return void 0===t&&(t="1"),this.$http.get("https://api.vimeo.com/videos",{params:{per_page:this.VIMEO_PARAMS.MAX_RESULTS,query:e,page:t,sort:"relevant"},headers:{Authorization:"bearer "+this.VIMEO_PARAMS.ACCESS_TOKEN}}).then(function(e){return{videos:e.data.data.map(function(e){return i.mediaItemCreator.fromVimeoVideo(e)}),nextPageToken:String(e.data.page+1)}})},e.prototype.getBIGalleryType=function(t){switch(t){case"gallery":return e.BI_GALLERY_TYPE_GALLERY;case"extVideo":return e.BI_GALLERY_TYPE_EXTERNAL_VIDEO;default:return e.BI_GALLERY_TYPE_SINGLE}},e}();r.BI_GALLERY_TYPE_SINGLE="single item",r.BI_GALLERY_TYPE_GALLERY="gallery",r.BI_GALLERY_TYPE_EXTERNAL_VIDEO="external video",angular.module("organizeMediaDialog").service("mediaUtils",r),angular.module("organizeMediaDialog").filter("trustedUrl",["$sce",function(e){return function(t){return e.trustAsResourceUrl(t)}}]);var a=function(){function e(e,t,i,n,o){this.$q=e,this.$rootScope=t,this.$mdDialog=i,this.organizeMediaBiLogger=n,this.mediaUtils=o}return e.$inject=["$q","$rootScope","$mdDialog","organizeMediaBiLogger","mediaUtils"],e.prototype.open=function(e){if(this.options=e,"extVideo"===e.type)return this.openVidSearch(e);var t=this.$rootScope.$new();return t.options=e,this.$mdDialog.show({escapeToClose:!1,template:'\n        <md-dialog class="om-app-main-container">\n          <md-dialog-content>\n            <organize-media options="options"></organize-media>\n          </md-dialog-content>\n        </md-dialog>\n      ',scope:t})},e.prototype.openVidSearch=function(e){var t=this,i=this.$rootScope.$new();return i.openVideoForeplay=this.openVideoForeplay.bind(this),i.helpPage=e.helpPage,this.$mdDialog.show({skipHide:!0,scope:i,preserveScope:!0,escapeToClose:!1,template:'\n        <md-dialog class="om-app-main-container is-video-search-container">\n          <md-dialog-content>\n            <video-search orig-video-foreplay="openVideoForeplay(item)" help-page="{{helpPage}}"></video-search>\n          </md-dialog-content>\n        </md-dialog>\n      '}).then(function(e){return e&&e.videoUrl?t.itemsToDTO([e]):t.$q.reject()})},e.prototype.openVideoForeplay=function(e){this.organizeMediaBiLogger.mediaManagement.previewMediaLoaded("extVideo",r.BI_GALLERY_TYPE_EXTERNAL_VIDEO);var t=this.$rootScope.$new();t.videoItemToForeplay=e,this.$mdDialog.show({skipHide:!0,scope:t,escapeToClose:!1,hasBackdrop:!1,template:'\n        <md-dialog class="is-video-foreplay-container om-white-backdrop">\n          <md-dialog-content>\n            <video-foreplay item="videoItemToForeplay"></video-foreplay>\n          </md-dialog-content>\n        </md-dialog>\n      '})},e.prototype.close=function(e){var t=this.itemsToDTO(e);return this.$mdDialog.hide(t)},e.prototype.cancel=function(e){return this.$mdDialog.cancel(e)},e.prototype.itemsToDTO=function(e){return(e||[]).map(function(e){return"asDTO"in e?e.asDTO():e})},e}();angular.module("organizeMediaDialog").service("organizeMedia",a);var s=function(){function e(e,t,i){this.consumerBiLoggerHelpers=e,this.clientTopology=t,this.mainHelper=i}return e.prototype.replaceMediaWindowIsLoaded=function(e,t,i,n){try{var o=this.consumerBiLoggerHelpers.getInstanceId(),r=this.consumerBiLoggerHelpers.getMetaSiteId(),a=this.consumerBiLoggerHelpers.getStoryRevision(),s=this.consumerBiLoggerHelpers.getStructureId(),l=this.consumerBiLoggerHelpers.getIndustryId(),c=this.consumerBiLoggerHelpers.getEsi(),d=this.consumerBiLoggerHelpers.getEditMode(),u=this.consumerBiLoggerHelpers.organizeMediaNode.getId(),p=this.consumerBiLoggerHelpers.organizeMediaNode.contentElementType,h=this.consumerBiLoggerHelpers.organizeMediaNode.alias,g=this.consumerBiLoggerHelpers.getPageId();return this.mainHelper.validateString(o),this.mainHelper.validateGuid(r),this.mainHelper.validateNumber(a),this.mainHelper.validateString(s),this.mainHelper.validateString(l),this.mainHelper.validateGuid(c),this.mainHelper.validateString(d),this.mainHelper.validateString(u),this.mainHelper.validateString(p),this.mainHelper.validateString(h),this.mainHelper.validateString(g),this.mainHelper.validateString(e),this.mainHelper.validateString(t),this.mainHelper.validateString(i),this.mainHelper.validateNumber(n),this.mainHelper.log({instanceId:o,msid:r,revision:a,structureId:s,industryId:l,esi:c,editMode:d,nodeId:u,sectionType:p,sectionAlias:h,pageId:g,mediaType:e,galleryType:t,origin:i,numTotal:n,evid:400})}catch(e){this.mainHelper.onError("BISafe: failed to report mediaManagement.replaceMediaWindowIsLoaded",e)}},e.prototype.closeMediaWindow=function(e,t,i){try{var n=this.consumerBiLoggerHelpers.getInstanceId(),o=this.consumerBiLoggerHelpers.getMetaSiteId(),r=this.consumerBiLoggerHelpers.getStoryRevision(),a=this.consumerBiLoggerHelpers.getStructureId(),s=this.consumerBiLoggerHelpers.getIndustryId(),l=this.consumerBiLoggerHelpers.getEsi(),c=this.consumerBiLoggerHelpers.getEditMode(),d=this.consumerBiLoggerHelpers.organizeMediaNode.getId(),u=this.consumerBiLoggerHelpers.organizeMediaNode.contentElementType,p=this.consumerBiLoggerHelpers.organizeMediaNode.alias,h=this.consumerBiLoggerHelpers.getPageId();return this.mainHelper.validateString(n),this.mainHelper.validateGuid(o),this.mainHelper.validateNumber(r),this.mainHelper.validateString(a),this.mainHelper.validateString(s),this.mainHelper.validateGuid(l),this.mainHelper.validateString(c),this.mainHelper.validateString(d),this.mainHelper.validateString(u),this.mainHelper.validateString(p),this.mainHelper.validateString(h),this.mainHelper.validateString(e),this.mainHelper.validateString(t),this.mainHelper.validateString(i),this.mainHelper.log({instanceId:n,msid:o,revision:r,structureId:a,industryId:s,esi:l,editMode:c,nodeId:d,sectionType:u,sectionAlias:p,pageId:h,mediaType:e,galleryType:t,origin:i,evid:401})}catch(e){this.mainHelper.onError("BISafe: failed to report mediaManagement.closeMediaWindow",e)}},e.prototype.approveChangesInTheMediaWindow=function(e,t,i,n){try{var o=this.consumerBiLoggerHelpers.getInstanceId(),r=this.consumerBiLoggerHelpers.getMetaSiteId(),a=this.consumerBiLoggerHelpers.getStoryRevision(),s=this.consumerBiLoggerHelpers.getStructureId(),l=this.consumerBiLoggerHelpers.getIndustryId(),c=this.consumerBiLoggerHelpers.getEsi(),d=this.consumerBiLoggerHelpers.getEditMode(),u=this.consumerBiLoggerHelpers.organizeMediaNode.getId(),p=this.consumerBiLoggerHelpers.organizeMediaNode.contentElementType,h=this.consumerBiLoggerHelpers.organizeMediaNode.alias,g=this.consumerBiLoggerHelpers.getPageId();return this.mainHelper.validateString(e),this.mainHelper.validateString(o),this.mainHelper.validateGuid(r),this.mainHelper.validateNumber(a),this.mainHelper.validateString(s),this.mainHelper.validateString(l),this.mainHelper.validateGuid(c),this.mainHelper.validateString(d),this.mainHelper.validateString(u),this.mainHelper.validateString(p),this.mainHelper.validateString(h),this.mainHelper.validateString(g),this.mainHelper.validateString(t),this.mainHelper.validateString(i),this.mainHelper.validateNumber(n),this.mainHelper.log({origin:e,instanceId:o,msid:r,revision:a,structureId:s,industryId:l,esi:c,editMode:d,nodeId:u,sectionType:p,sectionAlias:h,pageId:g,mediaType:t,galleryType:i,numTotal:n,evid:402})}catch(e){this.mainHelper.onError("BISafe: failed to report mediaManagement.approveChangesInTheMediaWindow",e)}},e.prototype.galleryOrganizerClickAddMoreMedia=function(){try{var e=this.consumerBiLoggerHelpers.getInstanceId(),t=this.consumerBiLoggerHelpers.getMetaSiteId(),i=this.consumerBiLoggerHelpers.getStoryRevision(),n=this.consumerBiLoggerHelpers.getStructureId(),o=this.consumerBiLoggerHelpers.getIndustryId(),r=this.consumerBiLoggerHelpers.getEsi(),a=this.consumerBiLoggerHelpers.getEditMode(),s=this.consumerBiLoggerHelpers.organizeMediaNode.getId(),l=this.consumerBiLoggerHelpers.organizeMediaNode.contentElementType,c=this.consumerBiLoggerHelpers.organizeMediaNode.alias,d=this.consumerBiLoggerHelpers.getPageId();return this.mainHelper.validateString(e),this.mainHelper.validateGuid(t),this.mainHelper.validateNumber(i),this.mainHelper.validateString(n),this.mainHelper.validateString(o),this.mainHelper.validateGuid(r),this.mainHelper.validateString(a),this.mainHelper.validateString(s),this.mainHelper.validateString(l),this.mainHelper.validateString(c),this.mainHelper.validateString(d),this.mainHelper.log({instanceId:e,msid:t,revision:i,structureId:n,industryId:o,esi:r,editMode:a,nodeId:s,sectionType:l,sectionAlias:c,pageId:d,evid:403})}catch(e){this.mainHelper.onError("BISafe: failed to report mediaManagement.galleryOrganizerClickAddMoreMedia",e)}},e.prototype.galleryOrganizerMediaAddedToOrganizer=function(e,t){try{var i=this.consumerBiLoggerHelpers.getInstanceId(),n=this.consumerBiLoggerHelpers.getMetaSiteId(),o=this.consumerBiLoggerHelpers.getStoryRevision(),r=this.consumerBiLoggerHelpers.getStructureId(),a=this.consumerBiLoggerHelpers.getIndustryId(),s=this.consumerBiLoggerHelpers.getEsi(),l=this.consumerBiLoggerHelpers.getEditMode(),c=this.consumerBiLoggerHelpers.organizeMediaNode.getId(),d=this.consumerBiLoggerHelpers.organizeMediaNode.contentElementType,u=this.consumerBiLoggerHelpers.organizeMediaNode.alias,p=this.consumerBiLoggerHelpers.getPageId();return this.mainHelper.validateString(i),this.mainHelper.validateGuid(n),this.mainHelper.validateNumber(o),this.mainHelper.validateString(r),this.mainHelper.validateString(a),this.mainHelper.validateGuid(s),this.mainHelper.validateString(l),this.mainHelper.validateString(c),this.mainHelper.validateString(d),this.mainHelper.validateString(u),this.mainHelper.validateString(p),this.mainHelper.validateNumber(e),this.mainHelper.validateNumber(t),this.mainHelper.log({instanceId:i,msid:n,revision:o,structureId:r,industryId:a,esi:s,editMode:l,nodeId:c,sectionType:d,sectionAlias:u,pageId:p,numAdded:e,numTotal:t,evid:404})}catch(e){this.mainHelper.onError("BISafe: failed to report mediaManagement.galleryOrganizerMediaAddedToOrganizer",e)}},e.prototype.galleryOrganizerDeleteMedia=function(e){try{var t=this.consumerBiLoggerHelpers.getInstanceId(),i=this.consumerBiLoggerHelpers.getMetaSiteId(),n=this.consumerBiLoggerHelpers.getStoryRevision(),o=this.consumerBiLoggerHelpers.getStructureId(),r=this.consumerBiLoggerHelpers.getIndustryId(),a=this.consumerBiLoggerHelpers.getEsi(),s=this.consumerBiLoggerHelpers.getEditMode(),l=this.consumerBiLoggerHelpers.organizeMediaNode.getId(),c=this.consumerBiLoggerHelpers.organizeMediaNode.contentElementType,d=this.consumerBiLoggerHelpers.organizeMediaNode.alias,u=this.consumerBiLoggerHelpers.getPageId();return this.mainHelper.validateString(t),this.mainHelper.validateGuid(i),this.mainHelper.validateNumber(n),this.mainHelper.validateString(o),this.mainHelper.validateString(r),this.mainHelper.validateGuid(a),this.mainHelper.validateString(s),this.mainHelper.validateString(l),this.mainHelper.validateString(c),this.mainHelper.validateString(d),this.mainHelper.validateString(u),this.mainHelper.validateNumber(e),this.mainHelper.log({instanceId:t,msid:i,revision:n,structureId:o,industryId:r,esi:a,editMode:s,nodeId:l,sectionType:c,sectionAlias:d,pageId:u,numTotal:e,evid:405})}catch(e){this.mainHelper.onError("BISafe: failed to report mediaManagement.galleryOrganizerDeleteMedia",e)}},e.prototype.externalVideoSearchVideoClick=function(e,t){try{var i=this.consumerBiLoggerHelpers.getInstanceId(),n=this.consumerBiLoggerHelpers.getMetaSiteId(),o=this.consumerBiLoggerHelpers.getStoryRevision(),r=this.consumerBiLoggerHelpers.getStructureId(),a=this.consumerBiLoggerHelpers.getIndustryId(),s=this.consumerBiLoggerHelpers.getEsi(),l=this.consumerBiLoggerHelpers.getEditMode(),c=this.consumerBiLoggerHelpers.organizeMediaNode.getId(),d=this.consumerBiLoggerHelpers.organizeMediaNode.contentElementType,u=this.consumerBiLoggerHelpers.organizeMediaNode.alias,p=this.consumerBiLoggerHelpers.getPageId();return this.mainHelper.validateString(i),this.mainHelper.validateGuid(n),this.mainHelper.validateNumber(o),this.mainHelper.validateString(r),this.mainHelper.validateString(a),this.mainHelper.validateGuid(s),this.mainHelper.validateString(l),this.mainHelper.validateString(c),this.mainHelper.validateString(d),this.mainHelper.validateString(u),this.mainHelper.validateString(p),this.mainHelper.validateString(e),this.mainHelper.validateString(t),this.mainHelper.log({instanceId:i,msid:n,revision:o,structureId:r,industryId:a,esi:s,editMode:l,nodeId:c,sectionType:d,sectionAlias:u,pageId:p,source:e,text:t,evid:406})}catch(e){this.mainHelper.onError("BISafe: failed to report mediaManagement.externalVideoSearchVideoClick",e)}},e.prototype.externalVideoSearchCompleted=function(e,t,i){try{var n=this.consumerBiLoggerHelpers.getInstanceId(),o=this.consumerBiLoggerHelpers.getMetaSiteId(),r=this.consumerBiLoggerHelpers.getStoryRevision(),a=this.consumerBiLoggerHelpers.getStructureId(),s=this.consumerBiLoggerHelpers.getIndustryId(),l=this.consumerBiLoggerHelpers.getEsi(),c=this.consumerBiLoggerHelpers.getEditMode(),d=this.consumerBiLoggerHelpers.organizeMediaNode.getId(),u=this.consumerBiLoggerHelpers.organizeMediaNode.contentElementType,p=this.consumerBiLoggerHelpers.organizeMediaNode.alias,h=this.consumerBiLoggerHelpers.getPageId();return this.mainHelper.validateString(n),this.mainHelper.validateGuid(o),this.mainHelper.validateNumber(r),this.mainHelper.validateString(a),this.mainHelper.validateString(s),this.mainHelper.validateGuid(l),this.mainHelper.validateString(c),this.mainHelper.validateString(d),this.mainHelper.validateString(u),this.mainHelper.validateString(p),this.mainHelper.validateString(h),this.mainHelper.validateString(e),this.mainHelper.validateString(t),this.mainHelper.validateNumber(i),this.mainHelper.log({instanceId:n,msid:o,revision:r,structureId:a,industryId:s,esi:l,editMode:c,nodeId:d,sectionType:u,sectionAlias:p,pageId:h,source:e,text:t,"returnedResults ":i,evid:407})}catch(e){this.mainHelper.onError("BISafe: failed to report mediaManagement.externalVideoSearchCompleted",e)}},e.prototype.externalVideoSwitchSearchSource=function(e){try{var t=this.consumerBiLoggerHelpers.getInstanceId(),i=this.consumerBiLoggerHelpers.getMetaSiteId(),n=this.consumerBiLoggerHelpers.getStoryRevision(),o=this.consumerBiLoggerHelpers.getStructureId(),r=this.consumerBiLoggerHelpers.getIndustryId(),a=this.consumerBiLoggerHelpers.getEsi(),s=this.consumerBiLoggerHelpers.getEditMode(),l=this.consumerBiLoggerHelpers.organizeMediaNode.getId(),c=this.consumerBiLoggerHelpers.organizeMediaNode.contentElementType,d=this.consumerBiLoggerHelpers.organizeMediaNode.alias,u=this.consumerBiLoggerHelpers.getPageId();return this.mainHelper.validateString(t),this.mainHelper.validateGuid(i),this.mainHelper.validateNumber(n),this.mainHelper.validateString(o),this.mainHelper.validateString(r),this.mainHelper.validateGuid(a),this.mainHelper.validateString(s),this.mainHelper.validateString(l),this.mainHelper.validateString(c),this.mainHelper.validateString(d),this.mainHelper.validateString(u),this.mainHelper.validateString(e),this.mainHelper.log({instanceId:t,msid:i,revision:n,structureId:o,industryId:r,esi:a,editMode:s,nodeId:l,sectionType:c,sectionAlias:d,pageId:u,source:e,evid:408})}catch(e){this.mainHelper.onError("BISafe: failed to report mediaManagement.externalVideoSwitchSearchSource",e)}},e.prototype.previewMediaClick=function(e,t){try{var i=this.consumerBiLoggerHelpers.getInstanceId(),n=this.consumerBiLoggerHelpers.getMetaSiteId(),o=this.consumerBiLoggerHelpers.getStoryRevision(),r=this.consumerBiLoggerHelpers.getStructureId(),a=this.consumerBiLoggerHelpers.getIndustryId(),s=this.consumerBiLoggerHelpers.getEsi(),l=this.consumerBiLoggerHelpers.getEditMode(),c=this.consumerBiLoggerHelpers.organizeMediaNode.getId(),d=this.consumerBiLoggerHelpers.organizeMediaNode.contentElementType,u=this.consumerBiLoggerHelpers.organizeMediaNode.alias,p=this.consumerBiLoggerHelpers.getPageId();return this.mainHelper.validateString(i),this.mainHelper.validateGuid(n),this.mainHelper.validateNumber(o),this.mainHelper.validateString(r),this.mainHelper.validateString(a),this.mainHelper.validateGuid(s),this.mainHelper.validateString(l),this.mainHelper.validateString(c),this.mainHelper.validateString(d),this.mainHelper.validateString(u),this.mainHelper.validateString(p),this.mainHelper.validateString(e),this.mainHelper.validateString(t),this.mainHelper.log({instanceId:i,msid:n,revision:o,structureId:r,industryId:a,esi:s,editMode:l,nodeId:c,sectionType:d,sectionAlias:u,pageId:p,mediaType:e,galleryType:t,evid:409})}catch(e){this.mainHelper.onError("BISafe: failed to report mediaManagement.previewMediaClick",e)}},e.prototype.previewMediaLoaded=function(e,t){try{var i=this.consumerBiLoggerHelpers.getInstanceId(),n=this.consumerBiLoggerHelpers.getMetaSiteId(),o=this.consumerBiLoggerHelpers.getStoryRevision(),r=this.consumerBiLoggerHelpers.getStructureId(),a=this.consumerBiLoggerHelpers.getIndustryId(),s=this.consumerBiLoggerHelpers.getEsi(),l=this.consumerBiLoggerHelpers.getEditMode(),c=this.consumerBiLoggerHelpers.organizeMediaNode.getId(),d=this.consumerBiLoggerHelpers.organizeMediaNode.contentElementType,u=this.consumerBiLoggerHelpers.organizeMediaNode.alias,p=this.consumerBiLoggerHelpers.getPageId();return this.mainHelper.validateString(i),this.mainHelper.validateGuid(n),this.mainHelper.validateNumber(o),this.mainHelper.validateString(r),this.mainHelper.validateString(a),this.mainHelper.validateGuid(s),this.mainHelper.validateString(l),this.mainHelper.validateString(c),this.mainHelper.validateString(d),this.mainHelper.validateString(u),this.mainHelper.validateString(p),this.mainHelper.validateString(e),this.mainHelper.validateString(t),this.mainHelper.log({instanceId:i,msid:n,revision:o,structureId:r,industryId:a,esi:s,editMode:l,nodeId:c,sectionType:d,sectionAlias:u,pageId:p,mediaType:e,galleryType:t,evid:410})}catch(e){this.mainHelper.onError("BISafe: failed to report mediaManagement.previewMediaLoaded",e)}},e.prototype.mediaSettingsFieldWasUpdated=function(e,t,i,n,o,r){try{var a=this.consumerBiLoggerHelpers.getInstanceId(),s=this.consumerBiLoggerHelpers.getMetaSiteId(),l=this.consumerBiLoggerHelpers.getStoryRevision(),c=this.consumerBiLoggerHelpers.getStructureId(),d=this.consumerBiLoggerHelpers.getIndustryId(),u=this.consumerBiLoggerHelpers.getEsi(),p=this.consumerBiLoggerHelpers.getEditMode(),h=this.consumerBiLoggerHelpers.organizeMediaNode.getId(),g=this.consumerBiLoggerHelpers.organizeMediaNode.contentElementType,m=this.consumerBiLoggerHelpers.organizeMediaNode.alias,f=this.consumerBiLoggerHelpers.getPageId();return this.mainHelper.validateString(a),this.mainHelper.validateGuid(s),this.mainHelper.validateNumber(l),this.mainHelper.validateString(c),this.mainHelper.validateString(d),this.mainHelper.validateGuid(u),this.mainHelper.validateString(p),this.mainHelper.validateString(h),this.mainHelper.validateString(g),this.mainHelper.validateString(m),this.mainHelper.validateString(f),this.mainHelper.validateString(e),this.mainHelper.validateString(t),this.mainHelper.validateString(i),this.mainHelper.validateString(n),this.mainHelper.validateString(o),this.mainHelper.validateNumber(r),this.mainHelper.log({instanceId:a,msid:s,revision:l,structureId:c,industryId:d,esi:u,editMode:p,nodeId:h,sectionType:g,sectionAlias:m,pageId:f,mediaType:e,galleryType:t,fieldName:i,fieldType:n,fieldValue:o,fieldLength:r,evid:412})}catch(e){this.mainHelper.onError("BISafe: failed to report mediaManagement.mediaSettingsFieldWasUpdated",e)}},e.prototype.galleryOrganizerCloseAddMoreMediaWindow=function(){try{var e=this.consumerBiLoggerHelpers.getEditMode(),t=this.consumerBiLoggerHelpers.getEsi(),i=this.consumerBiLoggerHelpers.getIndustryId(),n=this.consumerBiLoggerHelpers.getInstanceId(),o=this.consumerBiLoggerHelpers.getMetaSiteId(),r=this.consumerBiLoggerHelpers.organizeMediaNode.getId(),a=this.consumerBiLoggerHelpers.getPageId(),s=this.consumerBiLoggerHelpers.getStoryRevision(),l=this.consumerBiLoggerHelpers.organizeMediaNode.alias,c=this.consumerBiLoggerHelpers.organizeMediaNode.contentElementType,d=this.consumerBiLoggerHelpers.getStructureId();return this.mainHelper.validateString(e),this.mainHelper.validateGuid(t),this.mainHelper.validateString(i),this.mainHelper.validateString(n),this.mainHelper.validateGuid(o),this.mainHelper.validateString(r),this.mainHelper.validateString(a),this.mainHelper.validateNumber(s),this.mainHelper.validateString(l),this.mainHelper.validateString(c),this.mainHelper.validateString(d),this.mainHelper.log({editMode:e,esi:t,industryId:i,instanceId:n,msid:o,nodeId:r,pageId:a,revision:s,sectionAlias:l,sectionType:c,structureId:d,evid:414})}catch(e){this.mainHelper.onError("BISafe: failed to report mediaManagement.galleryOrganizerCloseAddMoreMediaWindow",e)}},e}(),l=function(){function e(e,t,i){var n=function(e,i){t.production||console.error(e,i)},o={validateNumber:function(e){null===e||isFinite(e)||n("invalid number",e)},validateString:function(e){null!==e&&"string"!=typeof e&&n("Invalid string",e)},validateGuid:function(e){null===e||"string"==typeof e&&/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/.test(e.toLowerCase())||n("Invalid guid",e)},onError:n,log:function(e){return e.src=66,i.log(_.pick(e,function(e){return null!==e}))}};this.mediaManagement=new s(e,t,o)}return e.$inject=["consumerBiLoggerHelpers","clientTopology","wixBiLogger"],e}();angular.module("organizeMediaDialog").service("organizeMediaBiLogger",l);var c=function(){function e(e){this.MEDIA_ITEM_SIZES=e}return e.$inject=["MEDIA_ITEM_SIZES"],e.prototype.getShapePreviewUrl=function(e){return"https://static.wixstatic.com/"+("svg"===e.substr(e.length-3)?e:e.substr(0,e.length-2)+"svg")},e.prototype.getImagePreviewUrl=function(e,t){switch(t){case"shape":return this.getShapePreviewUrl(e);default:return"https://static.wixstatic.com/media/"+e+"_srz_p_"+this.MEDIA_ITEM_SIZES.imagePreview.width+"_"+this.MEDIA_ITEM_SIZES.imagePreview.height+"_75_22_0.50_1.20_0.00_jpg_srz"}},e.prototype.getImagePreviewPopupUrl=function(e,t){switch(t){case"shape":return this.getShapePreviewUrl(e);default:return"https://static.wixstatic.com/media/"+e+"/v1/fit/w_"+this.MEDIA_ITEM_SIZES.imagePreviewPopup.width+",h_"+this.MEDIA_ITEM_SIZES.imagePreviewPopup.height+"/"+e}},e.prototype.getImageThumbnailUrl=function(e,t){switch(t){case"shape":return this.getShapePreviewUrl(e);default:return"https://static.wixstatic.com/media/"+e+"_srz_p_"+this.MEDIA_ITEM_SIZES.imageThumbnail.width+"_"+this.MEDIA_ITEM_SIZES.imageThumbnail.height+"_75_22_0.50_1.20_0.00_jpg_srz"}},e.prototype.getWixVideoThumbnailUrl=function(e){var t=e.split("/")[1];return"https://static.wixstatic.com/"+e+"/v1/fit/w_"+this.MEDIA_ITEM_SIZES.wixVideoThumbnail.width+",h_"+this.MEDIA_ITEM_SIZES.wixVideoThumbnail.height+"/"+t},e}();angular.module("organizeMediaDialog").service("previewUrls",c),angular.module("organizeMediaDialog").component("addMoreButton",{templateUrl:"views/add-more-button.html",bindings:{itemType:"@"}});var d=function(){function e(e){this.$mdDialog=e,this.linkClone=angular.copy(this.item.Link),this.functions=this.editLinkCallback({selector:".om-link-editor-placeholder",linkObj:this.linkClone})}return e.$inject=["$mdDialog"],e.prototype.done=function(){var e=this;return this.functions&&"save"in this.functions?this.functions.save().then(function(t){return e.$mdDialog.hide(t)}):this.$mdDialog.hide(this.linkClone)},e.prototype.close=function(e){return this.$mdDialog.hide(this.item.Link)},e.prototype.cancel=function(e){return this.$mdDialog.hide(this.item.Link)},e}();angular.module("organizeMediaDialog").component("editLink",{templateUrl:"views/edit-link.html",controller:d,bindings:{item:"=",editLinkCallback:"&"}});var u=function(){function e(e){this.previewUrls=e}return e.$inject=["previewUrls"],e.prototype.getItemForMediaPreview=function(e){var t=angular.copy(e);return"picture"===t.mediaType&&(t.mediaType="image"),t},e.prototype.getPreviewUrl=function(){return this.previewUrls.getImagePreviewUrl(this.item.relativeUri,this.item.mediaType)},e}();angular.module("organizeMediaDialog").component("imageCarousel",{templateUrl:"views/image-carousel.html",controller:u,bindings:{item:"=",showNav:"=",onPrev:"&",onNext:"&"}});var p=function(){function e(e){this.previewUrls=e}return e.$inject=["previewUrls"],e.prototype.getPreviewUrl=function(){return this.previewUrls.getImageThumbnailUrl(this.item.relativeUri,this.item.mediaType)},e}();angular.module("organizeMediaDialog").component("imageItem",{templateUrl:"views/image-item.html",controller:p,bindings:{index:"=",item:"=",onRemove:"&"}});var h=function(){function e(e,t,i,n){var o=this;this.$mdDialog=e,this.$element=t,this.$scope=i,this.organizeMediaBiLogger=n,this.updateILink(),i.$watch("$ctrl.item.Link",function(){return o.updateILink()})}return e.$inject=["$mdDialog","$element","$scope","organizeMediaBiLogger"],e.prototype.updateILink=function(){this.linkAsILink=this.linkDetailsHandler.linkDetailsToILink(this.item.Link)},e.mockLinkDetailsToILink=function(e){return{state:!!e.targetUrl,value:e.targetUrl}},e.prototype.openLinkEditor=function(){var e=this;this.$mdDialog.show({parent:this.$element,skipHide:!0,scope:this.$scope,preserveScope:!0,escapeToClose:!1,hasBackdrop:!1,template:'\n        <md-dialog class="om-app-main-container is-link-editor-container om-white-backdrop">\n          <md-dialog-content>\n            <edit-link item="$ctrl.item" edit-link-callback="$ctrl.linkDetailsHandler.editLinkCallback(selector, linkObj)"></edit-link>\n          </md-dialog-content>\n        </md-dialog>\n      '}).then(function(t){if(t){e.item.Link=t,e.updateILink();var i=t;e.organizeMediaBiLogger.mediaManagement.mediaSettingsFieldWasUpdated("image",r.BI_GALLERY_TYPE_GALLERY,"link","link",null,i.url?i.url.length:0)}})},e.prototype.onTitleChange=function(e){this.organizeMediaBiLogger.mediaManagement.mediaSettingsFieldWasUpdated("image",r.BI_GALLERY_TYPE_GALLERY,"title","text",null,e?e.length:0)},e.prototype.onDescriptionChange=function(e){this.organizeMediaBiLogger.mediaManagement.mediaSettingsFieldWasUpdated("image",r.BI_GALLERY_TYPE_GALLERY,"description","text",null,e?e.length:0)},e}();angular.module("organizeMediaDialog").component("imageItemDetails",{templateUrl:"views/image-item-details.html",controller:h,bindings:{item:"=",linkDetailsHandler:"=",onPrev:"&",onNext:"&",showCarouselNav:"="}});var g=function(){function e(e,t,i){this.previewUrls=e,this.$element=t,this.MEDIA_ITEM_SIZES=i}return e.$inject=["previewUrls","$element","MEDIA_ITEM_SIZES"],e.prototype.calcPreviewImgSize=function(){var e;return e=this.item.width/this.MEDIA_ITEM_SIZES.imagePreviewPopup.width<this.item.height/this.MEDIA_ITEM_SIZES.imagePreviewPopup.height?this.MEDIA_ITEM_SIZES.imagePreviewPopup.height/this.item.height:this.MEDIA_ITEM_SIZES.imagePreviewPopup.width/this.item.width,e=Math.min(1,e),{width:(this.item.width||this.MEDIA_ITEM_SIZES.imagePreviewPopup.width)*e,height:(this.item.height||this.MEDIA_ITEM_SIZES.imagePreviewPopup.height)*e}},e.prototype.getPreviewPopupUrl=function(){return this.item?this.previewUrls.getImagePreviewPopupUrl(this.item.relativeUri,this.item.mediaType):""},e.prototype.createPopup=function(){this.popupId="id_"+Math.random();var e=this.calcPreviewImgSize(),t="<div id='"+this.popupId+"' class='om-image-preview-popup-box' data-hook='om-image-preview-popup-box' style=\"position: absolute\">\n        <img data-hook='om-image-preview-popup-img' src='"+this.getPreviewPopupUrl()+"' width='"+e.width+"' height='"+e.height+"'\">\n        <div class='caption' data-hook='om-image-preview-popup-img-title'>"+this.item.Title+"</div>\n        <div class='caption' data-hook='om-image-preview-popup-img-dims' "+(0===this.item.width?"hidden":"")+">"+this.item.width+" x "+this.item.height+"</div>\n      </div>";$("body").append(t)},e.prototype.popupElement=function(){return $('[id="'+this.popupId+'"]')},e.prototype.organizeMediaContainer=function(){return $(".om-app-main")},e.prototype.calcPopupPosition=function(){var e=this.organizeMediaContainer()[0].getBoundingClientRect(),t=this.$element[0].getBoundingClientRect(),i=this.popupElement()[0].getBoundingClientRect(),n=t.left+t.width+7;n+i.width+7>e.right&&i.width+7<t.left&&(n=t.left-i.width-7);var o=t.top+t.height+7;o+i.height>e.bottom&&(o=e.top+Math.max(0,e.height-7-i.height)),this.popupElement().css({opacity:1,left:n+"px",top:o+"px"})},e.prototype.showPopup=function(){this.createPopup(),this.calcPopupPosition()},e.prototype.removePopup=function(){this.popupElement().remove()},e}();angular.module("organizeMediaDialog").component("imagePreviewPopup",{templateUrl:"views/image-preview-popup.html",controller:g,transclude:!0,bindings:{item:"="}});var m=function(){function e(e,t,i,n,o,r,a,s,l){this.organizeMedia=e,this.mediaItems=t,this.mediaUtils=i,this.mediaItemCreator=n,this.$window=o,this.$scope=r,this.CcDialogBuilder=a,this.organizeMediaBiLogger=s,this.$translate=l,this.title="",this.subtitle="",this.suggestionsTitle="",this.mediaType="",this.title=this.options.title,this.subtitle=this.options.subtitle,this.suggestionsTitle=this.options.suggestionsTitle,this.mediaType=this.options.type,this.selectionMode=this.options.mode||"single",this.linkDetailsHandler=this.options.linkDetailsHandler||{editLinkCallback:void 0,linkDetailsToILink:function(e){return{state:!0,value:"can't add link"}}},this.helpPage=this.options.helpPage,this.customData=this.options.customData,this.setViewMode(this.mediaType),t.setData(this.options.dataSource,this.selectionMode,this.mediaType),this.items=t.activeItems,this.suggestedItems=t.suggestedItems,this.selected=this.items.length>0?this.items[0]:null,this.options=null}return e.$inject=["organizeMedia","mediaItems","mediaUtils","mediaItemCreator","$window","$scope","CcDialogBuilder","organizeMediaBiLogger","$translate"],e.prototype.setViewMode=function(e){switch(e){case"video":case"extVideo":this.viewMode="video";break;case"image":case"shape":case"clipart":default:this.viewMode="image"}},e.prototype.close=function(){this.organizeMedia.cancel()},e.prototype.done=function(){this.organizeMedia.close(this.items.concat(this.suggestedItems))},e.prototype.cancel=function(){this.organizeMedia.cancel()},e.prototype.isDoneEnabled=function(){var e="gallery"===this.selectionMode?2:1;return this.items.length>=e},e.prototype.updateSelectedItem=function(e){void 0===e&&(e=-1),this.items.length>0?this.selected=-1!==e?this.items[Math.min(e,this.items.length-1)]:this.items[this.items.length-1]:this.selected=null},e.prototype.makeActive=function(e){"single"===this.selectionMode?this.mediaItems.replaceActive(e):(this.mediaItems.makeActive(e),this.organizeMediaBiLogger.mediaManagement.galleryOrganizerMediaAddedToOrganizer(1,this.mediaItems.itemCount)),this.updateSelectedItem(this.curSelectedPos())},e.prototype.makeInactive=function(e){var t=this.curSelectedPos();this.mediaItems.makeInactive(e),e===this.selected&&this.updateSelectedItem(t),this.organizeMediaBiLogger.mediaManagement.galleryOrganizerDeleteMedia(this.mediaItems.itemCount)},e.prototype.replaceActive=function(e){this.mediaItems.replaceActive(e),this.selected=this.items[0]},e.prototype.removeSuggestion=function(e){this.mediaItems.removeSuggestion(e)},e.prototype.openMediaGallery=function(){this.organizeMediaBiLogger.mediaManagement.galleryOrganizerClickAddMoreMedia(),this.openMediaManager(),this.organizeMediaBiLogger.mediaManagement.replaceMediaWindowIsLoaded(this.mediaType,"gallery","gallery organizer",this.mediaItems.itemCount)},e.prototype.openMediaManager=function(){var e=this,t=window.MediaManager,i=window.MediaManagerApi,n={onSuccess:function(t){return e.onMediaGalleryApprove(t)},onCancel:function(){return e.onMediaGalleryCancel()},multiSelect:!0,recommended:this.customData&&this.customData.sections&&this.customData.sections.map(function(e){return{sectionTitle:e.title,sectionItems:e.data}}),translation:{submitButton:this.$translate.instant("general.apply")}};t.open(t.categories.IMAGE,i.origins.ADI,n)},e.prototype.onMediaGalleryCancel=function(){this.organizeMediaBiLogger.mediaManagement.galleryOrganizerCloseAddMoreMediaWindow(),this.organizeMediaBiLogger.mediaManagement.closeMediaWindow(this.mediaType,"gallery","gallery organizer")},e.prototype.onMediaGalleryApprove=function(e){this.mediaGalleryResultsHandler(e)},e.prototype.mediaGalleryResultsHandler=function(e){var t=this;e.items.forEach(function(e){var i="video"===t.mediaType?t.mediaItemCreator.fromMediaGalleryVideo(e):t.mediaItemCreator.fromMediaGalleryImage(e);t.addItem(i)}),this.organizeMediaBiLogger.mediaManagement.galleryOrganizerMediaAddedToOrganizer(e.items.length,this.mediaItems.itemCount),this.organizeMediaBiLogger.mediaManagement.approveChangesInTheMediaWindow("gallery organizer",this.mediaType,this.mediaUtils.getBIGalleryType(this.mediaType),this.mediaItems.itemCount),this.$scope.$apply()},e.prototype.openVideoForeplay=function(e){this.organizeMedia.openVideoForeplay(e)},e.prototype.prev=function(){var e=this.items.indexOf(this.selected);this.selected=this.items[(e-1+this.items.length)%this.items.length]},e.prototype.next=function(){var e=this.items.indexOf(this.selected);this.selected=this.items[(e+1)%this.items.length]},e.prototype.move=function(e,t){this.mediaItems.reorder(e,t)},e.prototype.addItem=function(e){this.mediaItems.addItem(e,this.selectionMode),this.updateSelectedItem(-1)},e.prototype.curSelectedPos=function(){return this.items.indexOf(this.selected)},e.prototype.onHelp=function(){this.helpPage&&this.CcDialogBuilder.showSupportIframe(this.helpPage,"organize-media-help-page")},e}();angular.module("organizeMediaDialog").component("organizeMedia",{templateUrl:"views/organize-media.html",controller:m,bindings:{options:"="}});var f=function(){function e(e,t,i,n,o){this.images=e,this.extVideos=t,this.wixVideos=i,this.organizeMedia=n,this.customData=o,this.initMediaManager()}return e.$inject=["images","extVideos","wixVideos","organizeMedia","customData"],e.prototype.initMediaManager=function(){if(window.MediaManagerApi){var e=window.MediaManagerApi.create({version:"G5",languageCode:"en",siteMediaToken:"",origin:window.MediaManagerApi.origins.ADI});e.warmup(),window.MediaManager=e}},e.mockLinkDetailsHandler=function(){return{editLinkCallback:e.mockEditLinkCallback,linkDetailsToILink:h.mockLinkDetailsToILink}},e.prototype.openGalleryDialog=function(){this.organizeMedia.open({title:"Organize Your Gallery Images",subtitle:"Drag and drop your media into position to get your gallery nicely organized.",suggestionsTitle:"Other suggested images, select an image to add it to your gallery",dataSource:this.images,type:"image",mode:"gallery",linkDetailsHandler:e.mockLinkDetailsHandler(),helpPage:"//www.wix.com/support/html5/widget/63ff21be-9556-4f52-9ac9-4d441bd3dae4/article/5a7fb24b-d999-4017-b337-7efbf5d63c5c",customData:angular.copy(this.customData)}).then(function(e){console.log(e)})},e.prototype.openShapeDialog=function(){this.organizeMedia.open({title:"Organize Your Gallery Shapes",subtitle:"The chosen shape",suggestionsTitle:"Other suggested shapes, select a shape to replace the one on top",dataSource:this.images,type:"shape",linkDetailsHandler:e.mockLinkDetailsHandler()}).then(function(e){console.log(e)})},e.prototype.openClipartDialog=function(){this.organizeMedia.open({title:"Organize Your Gallery Cliparts",subtitle:"The chosen clipart",suggestionsTitle:"Other suggested cliparts, select a clipart to replace the one on top",dataSource:this.images,type:"clipart",mode:"single",linkDetailsHandler:e.mockLinkDetailsHandler()}).then(function(e){console.log(e)})},e.prototype.openExtVideoDialog=function(){this.organizeMedia.open({title:"Video Box",subtitle:"The chosen video",suggestionsTitle:"Other suggested videos, select a video to replace the one on top",dataSource:this.extVideos,type:"extVideo",helpPage:"https://www.wix.com/support/html5/widget/63ff21be-9556-4f52-9ac9-4d441bd3dae4/article/04a0f5e0-bbe3-4d09-99c5-857b4043f160"}).then(function(e){console.log(e)})},e.prototype.openWixVideoDialog=function(){this.organizeMedia.open({title:"Video Box",subtitle:"The chosen video",suggestionsTitle:"Other suggested videos, select a video to replace the one on top",dataSource:this.wixVideos,type:"video"}).then(function(e){console.log(e)})},e}();f.mockEditLinkCallback=function(e,t){return console.log("Called mockEditLinkCallback with:"),console.log("selector: "+e),console.log("linkObj: "+JSON.stringify(t)),{save:function(){console.log("Save() called for Link Editor!");var e={targetUrl:"New mock link target"};return new Promise(function(t){t(e)})}}},angular.module("organizeMediaApp").component("organizeMediaApp",{templateUrl:"views/organize-media-app.html",controller:f});var v=function(){function e(e){this.$mdDialog=e}return e.$inject=["$mdDialog"],e.prototype.close=function(e){return this.$mdDialog.hide(e)},e}();angular.module("organizeMediaDialog").component("videoForeplay",{templateUrl:"views/video-foreplay.html",controller:v,bindings:{item:"="}});var y,b=function(){return function(){}}();angular.module("organizeMediaDialog").component("videoItem",{templateUrl:"views/video-item.html",controller:b,bindings:{item:"=",openVideoForeplay:"&"}}),function(e){e[e.NEVER=0]="NEVER",e[e.ON_HOVER=1]="ON_HOVER",e[e.ALWAYS=2]="ALWAYS"}(y||(y={}));var S=function(){function e(e,t){var i=this;this.$scope=e,this.mediaUtils=t,e.$watch("$ctrl.item",function(){i.error=void 0,i.item&&(void 0===i.item.controls&&(i.item.controls="extVideo"===i.item.mediaType?y.ALWAYS:y.NEVER),void 0!==i.item.playmode&&void 0!==i.item.playmode.autoplay&&void 0!==i.item.playmode.loop||(i.item.playmode={autoplay:"video"===i.item.mediaType,loop:"video"===i.item.mediaType}))}),e.$watch("$ctrl.item.videoUrl",function(){i.videoUrlToEdit=i.item?i.item.videoUrl:void 0})}return e.$inject=["$scope","mediaUtils"],e.prototype.updateVideo=function(e){var t=this;this.error=this.error?" ":void 0,this.mediaUtils.getNewExtVideoItem(e).then(function(e){e.controls=angular.copy(t.item.controls),e.playmode=angular.copy(t.item.playmode),t.addItemCallback({item:e}),t.videoUrlToEdit=e.videoUrl,t.error=void 0}).catch(function(e){t.error="Invalid URL (YouTube & Vimeo only)"})},e}();angular.module("organizeMediaDialog").component("videoItemDetails",{templateUrl:"views/video-item-details.html",controller:S,bindings:{item:"=",addItemCallback:"&"}});var C,w=function(){return function(){}}();angular.module("organizeMediaDialog").component("videoPreview",{templateUrl:"views/video-preview.html",controller:w,bindings:{item:"="}}),function(e){e[e.beforeSearch=0]="beforeSearch",e[e.searching=1]="searching",e[e.resultsFound=2]="resultsFound",e[e.noResultsFound=3]="noResultsFound"}(C||(C={}));var T=function(){function e(e,t,i,n){this.$mdDialog=e,this.mediaUtils=t,this.CcDialogBuilder=i,this.organizeMediaBiLogger=n,this.query="",this.videos=[],this.selected=null,this.source="youtube",this.status=C.beforeSearch}return e.$inject=["$mdDialog","mediaUtils","CcDialogBuilder","organizeMediaBiLogger"],Object.defineProperty(e.prototype,"searchStatus",{get:function(){return C[this.status]},enumerable:!0,configurable:!0}),e.prototype.done=function(){var e=angular.copy(this.selected);return e&&e.$$hashkey&&delete e.$$hashKey,this.$mdDialog.hide(e)},e.prototype.close=function(e){return this.$mdDialog.hide(e)},e.prototype.cancel=function(e){return this.$mdDialog.hide(e)},e.prototype.onHelp=function(){this.helpPage&&this.CcDialogBuilder.showSupportIframe(this.helpPage,"organize-media-video-search-help")},e.prototype.startSearch=function(){if(this.organizeMediaBiLogger.mediaManagement.externalVideoSwitchSearchSource(this.source),0!==this.query.length)return this.videos=[],this.status=C.searching,this.nextCursor=void 0,this.search()},e.prototype.search=function(){var e,t=this;this.organizeMediaBiLogger.mediaManagement.externalVideoSearchVideoClick(this.source,this.query),"youtube"===this.source?e=this.mediaUtils.getYoutubeVideos(this.query,this.nextCursor):"vimeo"===this.source&&(e=this.mediaUtils.getVimeoVideos(this.query,this.nextCursor)),e.then(function(e){t.selected=null,t.videos=t.videos.concat(e.videos),t.status=t.videos.length?C.resultsFound:C.noResultsFound,t.organizeMediaBiLogger.mediaManagement.externalVideoSearchCompleted(t.source,t.query,t.videos.length),t.nextCursor=e.nextPageToken})},e.prototype.openVideoForeplay=function(e){this.organizeMediaBiLogger.mediaManagement.previewMediaClick("extVideo",r.BI_GALLERY_TYPE_EXTERNAL_VIDEO),this.origVideoForeplay({item:e})},e}();angular.module("organizeMediaDialog").component("videoSearch",{templateUrl:"views/video-search.html",controller:T,bindings:{origVideoForeplay:"&",helpPage:"@"}}),angular.module("organizeMediaDialog").directive("omInfiniteScroll",function(){return{restrict:"A",scope:!0,link:function(e,t,i){t.on("scroll",function(){$(this).scrollTop()+$(this).innerHeight()>=$(this)[0].scrollHeight&&e.$eval(i.omInfiniteScroll)})}}}),angular.module("organizeMediaDialog").directive("omAutofocus",["$timeout",function(e){return{scope:!0,link:function(t,i){e(function(){i[0].focus()})},restrict:"A"}}]);var I=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),x=function(){return function(e){var t=this;this.asDTO=function(){return JSON.parse(JSON.stringify(t))},Object.assign(this,e)}}(),P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return I(t,e),t.prototype.getId=function(){return this.videoUrl},Object.defineProperty(t.prototype,"isVimeo",{get:function(){return null!==this.videoUrl.toLowerCase().match("vimeo")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cleanId",{get:function(){return this.isVimeo?this.uri.split("/").pop():this.videoId||this.videoUrl.split("?")[0].split("/").pop()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"embedSrc",{get:function(){return this.isVimeo?"https://player.vimeo.com/video/"+this.cleanId+"?autoplay=1":"https://www.youtube.com/embed/"+this.cleanId+"?autoplay=1"},enumerable:!0,configurable:!0}),t.prototype.getWidthForHeight=function(e){return this.width?this.width/this.height*e:16*e/9},t.prototype.getHeightForWidth=function(e){return this.width?this.height/this.width*e:9*e/16},t}(x),M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return I(t,e),t.prototype.getId=function(){return this.fileUrl},Object.defineProperty(t.prototype,"videoSources",{get:function(){return this.fileOutput?this.fileOutput.video.map(function(e){return"//video.wixstatic.com/"+e.url}):[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"posterImage",{get:function(){var e=this.fileOutput?this.fileOutput.image[Math.min(2,this.fileOutput.image.length-1)].url:"";return e?"//static.wixstatic.com/"+e+"/v1/fit/w_644,h_644/"+e.split("/")[1]:""},enumerable:!0,configurable:!0}),t}(x),L=function(){return function(){}}(),k=function(){function e(e){this.previewUrls=e}return e.$inject=["previewUrls"],e.getEmptyLinkObj=function(){return{}},e.prototype.fromMediaGalleryImage=function(t){var i=new L;return i.fileName=t.title||"",i.relativeUri=("shape"===t.mediaType?t.fileUrl:t.uri)||"",i.width=Number(t.width)||0,i.height=Number(t.height)||0,i.Title=t.title||"",i.Description="",i.Link=e.getEmptyLinkObj(),i.mediaType=t.mediaType,i.active=!0,i},e.prototype.fromMediaGalleryVideo=function(e){return new M(Object.assign(e,{relativeUri:e.uri,thumbnailUrl:this.previewUrls.getWixVideoThumbnailUrl(e.fileOutput.image[Math.min(2,e.fileOutput.image.length-1)].url),Title:e.title,Description:"",mediaType:"video",controls:y.NEVER,playmode:{autoplay:!0,loop:!0},active:!0}))},e.prototype.fromYoutubeVideo=function(e){var t=e.id.videoId||e.id;return new P({videoUrl:"https://youtu.be/"+t,videoId:t,thumbnailUrl:e.snippet.thumbnails.high.url,width:e.snippet.thumbnails.high.width,height:e.snippet.thumbnails.high.height,Title:e.snippet.title,Description:e.snippet.description,mediaType:"extVideo",active:!0,controls:y.ALWAYS,playmode:{autoplay:!1,loop:!1}})},e.prototype.fromVimeoVideo=function(e){return new P({videoUrl:e.link||"",uri:e.uri,thumbnailUrl:e.pictures&&e.pictures.uri?"https://i.vimeocdn.com/video/"+e.pictures.uri.split("/")[4]+"_185x130.jpg?r=pad":"none",width:e.width,height:e.height,Title:e.name||"",Description:e.description||"",mediaType:"extVideo",active:!0,controls:y.ALWAYS,playmode:{autoplay:!1,loop:!1}})},e}();angular.module("organizeMediaDialog").service("mediaItemCreator",k)},478:function(e,t,i){"use strict";try{angular.module("jsSdkCommonsPreload")}catch(e){angular.module("jsSdkCommonsPreload",[])}angular.module("sdkCommonsConstants",[]),angular.module("sdkCommons",["jsSdkCommonsPreload","wixAngular","wix.common.bi","sdkCommonsConstants"]).config(["dashboardSdkProvider",function(e){e.registerHandler("openMediaDialog","sdkMediaGallery","openMediaDialog","Dashboard"),e.registerHandler("getProducts","sdkBilling","getProducts","Billing"),e.registerHandler("superAppsOpenMediaDialog","sdkMediaGallery","openAsSuperApp","Settings"),e.registerHandler("echo","dashboardSdkEchoHandler"),e.registerHandler("scrollTo","dashboardSdkScrollToHandler"),e.registerHandler("appEngaged","sdkAppEngaged","sendEngagedBI")}]).config(["wixBiLoggerProvider",function(e){e.setConfig({eventMap:{APP_ENGAGED:{src:75,evid:13,adapter:"app-sdk"}}})}]),function(){angular.module("sdkCommons").provider("dashboardSdk",function(){var e,t={},i={_getSdkNamespaces:function(){return t}};this.registerHandler=function(n,o,r,a){i[n]=function(){if(e.has(o)){var t=e.get(o);r&&(t=t[r].bind(t)),t.apply(this,arguments)}},a&&(t[a]||(t[a]={}),t[a][r]=i[n])},this.registerDefaultHandlers=angular.noop,this.$get=["$injector",function(t){return e=t,i}],this.$get.$inject=["$injector"]})}();var n=function(){function e(){var e=this;this.newMediaManager=!1,this.useNewMediaManager=function(){return e.newMediaManager=!0}}return e.prototype.registerAppDefIdGetter=function(e){this.appDefIdGetter=e},e.prototype.registerAppInstanceIdGetter=function(e){this.appInstanceIdGetter=e},e.prototype.registerMediaGalleryUrlGetter=function(e){this.mediaGalleryUrlGetter=e},e.prototype.isInvocable=function(){return Array.isArray(this.mediaGalleryUrlGetter)||"function"==typeof this.mediaGalleryUrlGetter},e.prototype.$get=function(e){var t=this;return{getAppDefId:function(){return e.invoke(t.appDefIdGetter)},getAppInstanceId:function(){return e.invoke(t.appInstanceIdGetter)},getMediaGalleryG5StaticsUrl:function(){return t.isInvocable()?e.invoke(t.mediaGalleryUrlGetter):"//static.parastorage.com/services/media-gallery-g5/libs-releases-local/"},isNewMediaManager:function(){return t.newMediaManager}}},e.prototype.$get.$inject=["$injector"],e}();angular.module("sdkCommons").provider("sdkConfig",n),function(){function e(e,t,i){var n={TPA_MESSAGE:"TPA2",TPA_RESPONSE:"TPA_RESPONSE"},o={},r=!1,a=!1,s=t;var l=function(e){return o[e]||r};function c(e){return!(!e||e.intent!==n.TPA_MESSAGE)&&(function(e){return s[e]}(e.type)&&l(e.compId))}function d(e){var t;if(e&&"string"==typeof e.data)try{t=JSON.parse(e.data)}catch(e){}c(t)&&s[t.type](t.data,function(e,t){return function(i){try{e.source.postMessage(JSON.stringify({intent:n.TPA_RESPONSE,callId:t.callId,type:t.type,res:i,status:!0}),"*")}catch(e){}}}(e,t))}var u=function(){a&&e.removeEventListener("message",d),a=!1};this.init=function(t){void 0===t&&(t=null),t?o[t]=!0:r=!0,a||(e.addEventListener("message",d),a=!0)},i.$on("$destroy",u),this.unload=function(e){void 0===e&&(e=null),e?delete o[e]:r=!1,r||0!==Object.keys(o).length||u()}}e.$inject=["$window","dashboardSdk","$rootScope"],angular.module("sdkCommons").service("sdkHandler",e)}();var o=function(){function e(){this.visionsMap={faces:"face",labels:"label",dominantColors:"color",cropHints:"crop_hint"}}return e.prototype.convertToVision=function(e){return this.visionsMap[e]},e.prototype.getVisionValue=function(e){var t=this;return void 0===e&&(e={}),Object.keys(e).filter(function(i){return!!e[i]&&!!t.convertToVision(i)}).map(function(e){return t.convertToVision(e)})},e}();angular.module("sdkCommons").service("mediaGalleryHelper",o),angular.module("sdkCommonsConstants").constant("premiumIntents",["NEUTRAL","FREE","PAID"]),angular.module("sdkCommons").service("dashboardSdkEchoHandler",function(){return function(e,t){t(e)}}),function(){function e(e,t,i,n,o,r,a){var s=this;this.openMediaDialog=function(t,i,n){return e.isNewMediaManager()?a.get("sdkMediaManager").openMediaManager(t,i,n):s.openMediaManager(t,i,n)},this.openMediaManager=function(a,s,l){var c=a.options||{},d={photos:"picture",clipart:"picture",backgrounds:"picture",audio:"music",music:"music",documents:"document",swf:"swf",video:"video",shape:"shape",secure_music:"secure_music"},u={photos:"photos",backgrounds:"backgrounds",video:"videos",shape:"shapes",clipart:"clipart"},p={photos:a.multiSelection?"multiple_images":"single_image",backgrounds:"background",clipart:"clipart"};d[a.mediaType]||(a.mediaType="photos");var h=e.getMediaGalleryG5StaticsUrl();n.open(angular.extend({baseHost:"wix.com",i18nCode:i.id,mediaType:d[a.mediaType],i18nPrefix:p[a.mediaType]||d[a.mediaType],selectionType:a.multiSelection?"multiple":"single",mediaGalleryBaseHost:t.calcPartialsUrl(h,!0),siteMediaToken:r.getSiteToken()},u[a.mediaType]?{publicMediaRoot:u[a.mediaType]}:{},"secure_music"===a.mediaType||"video"===a.mediaType||"documents"===a.mediaType?{tabsList:["private"]}:{},l?{vision:o.getVisionValue(c.imageAnalysis)}:{})).one("close",s.bind(void 0,{wasCancelled:!0})).one("items",function(e){var t=l?function(e){return e.map(function(e){return"secure_music"===e.mediaType?e:Object.assign({},e,{relativeUri:e.uri})})}(e.items):function(e){return e.map(function(e){var t={};if(t.fileName=e.title||"","secure_music"===e.mediaType){var i=e.fileOutput&&e.fileOutput.audio,n=i&&i.filter(function(e){return"preview-short"===e.tag})[0];t.shortPreviewFileName=n&&n.url||"",t.previewFileName=e.previewFileName||"",t.fileUrl=e.fileUrl||""}else t.relativeUri=e.fileName||"",t.width=Number(e.width)||0,t.height=Number(e.height)||0;return t})}(e.items);s(a.multiSelection?t:t[0])})},this.open=this.openMediaDialog,this.openAsSuperApp=function(e,t){this.openMediaDialog(e,t,!0)}}e.$inject=["sdkConfig","wixAngularTopology","$locale","MediaFrame","mediaGalleryHelper","permissionsManager","$injector"],angular.module("sdkCommons").service("sdkMediaGallery",e).factory("MediaFrame",["sdkConfig",function(e){return e.isNewMediaManager()?{}:MediaFrame}])}(),function(){function e(e,t){var i=this,n={photos:e.categories.IMAGE,clipart:e.categories.IMAGE,backgrounds:e.categories.BG_IMAGE,audio:e.categories.MUSIC,music:e.categories.MUSIC,documents:e.categories.DOCUMENT,swf:e.categories.FLASH,video:e.categories.VIDEO,shape:e.categories.VECTOR_ART};this.openMediaManager=function(i,o,r){n[i.mediaType]||(i.mediaType="photos"),e.open(n[i.mediaType],t.origins.ADI,{onSuccess:function(e){var t=r?function(e){return e.map(function(e){return"secure_music"===e.mediaType?e:Object.assign({},e,{relativeUri:e.uri})})}(e.items):function(e){return e.map(function(e){var t={};if(t.fileName=e.title||"","secure_music"===e.mediaType){var i=e.fileOutput&&e.fileOutput.audio,n=i&&i.filter(function(e){return"preview-short"===e.tag})[0];t.shortPreviewFileName=n&&n.url||"",t.previewFileName=e.previewFileName||"",t.fileUrl=e.fileUrl||""}else t.relativeUri=e.fileName||"",t.width=Number(e.width)||0,t.height=Number(e.height)||0;return t})}(e.items);o(i.multiSelection?t:t[0])},onCancel:function(){return o({wasCancelled:!0})},multiSelect:!!i.multiSelection})},this.open=this.openMediaManager,this.openAsSuperApp=function(e,t){return i.openMediaManager(e,t,!0)}}e.$inject=["MediaManager","MediaManagerApi"],angular.module("sdkCommons").service("sdkMediaManager",e).factory("MediaManager",function(){return MediaManager}).factory("MediaManagerApi",function(){return MediaManagerApi})}(),angular.module("sdkCommons").service("dashboardSdkScrollToHandler",["$window",function(e){return function(t){e.scrollTo(t.x,t.y)}}]);var r=function(){function e(e,t,i){this.$injector=e,this.$http=t,this.sdkConfig=i}return e.$inject=["$injector","$http","sdkConfig"],e.prototype.hasPrice=function(e){return!!e&&0!==parseFloat(e)},e.prototype.buildPackageUrl=function(e,t,i,n,o){return e+"?appInstanceId="+n+"&appDefinitionId="+i+"&paymentCycle="+o.toUpperCase()+"&vendorProductId="+t},e.prototype.getProducts=function(e,t){var i=this,n=e.appDefinitionId||this.sdkConfig.getAppDefId();if(n){var o=this.sdkConfig.getAppInstanceId()(n);this.$http.get("/_api/app-market-api/apps/"+n+"/priced-app",{params:{fields:["price","packages","purchaseStartUrl","billingPanelType"].toString()}}).then(function(e){var r=e.data.packages,a=e.data.purchaseStartUrl;return r.forEach(function(t){var r=_.curry(i.buildPackageUrl)(a,t.id,n,o);t.monthly.url=i.hasPrice(t.monthly.price)&&r("MONTHLY"),t.yearly.url=i.hasPrice(t.yearly.price)&&r("YEARLY"),t.oneTime.url=i.hasPrice(t.oneTime.price)&&r("ONE_TIME"),t.currencyCode=e.data.price.currencyCode,t.currencySymbol=e.data.price.currencySymbol}),t({packages:r})})}else t({error:!0,message:"Invalid application definition id"})},e}();angular.module("sdkCommons").service("sdkBilling",r);var a=function(){function e(e,t,i){this.wixBiLogger=e,this.premiumIntents=t,this.sdkConfig=i}return e.$inject=["wixBiLogger","premiumIntents","sdkConfig"],e.prototype.sendEngagedBI=function(e){var t=this.sdkConfig.getAppDefId(),i=this.sdkConfig.getAppInstanceId()(t);e&&e.premiumIntent&&this.premiumIntents.indexOf(e.premiumIntent)>-1&&this.wixBiLogger.log(this.wixBiLogger.events.APP_ENGAGED,{app_id:t,instance_id:i,premium_intent:e.premiumIntent})},e}();angular.module("sdkCommons").service("sdkAppEngaged",a)},479:function(e,i,n){!function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=188)}({0:function(e,t){e.exports=_},100:function(e,t,i){var n=i(101),o=i(191);for(var r in(t=e.exports=function(e,t){return new o(t).process(e)}).FilterCSS=o,n)t[r]=n[r];"undefined"!=typeof window&&(window.filterCSS=e.exports)},101:function(e,t){function i(){var e={"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1};return e}t.whiteList=i(),t.getDefaultWhiteList=i,t.onAttr=function(e,t,i){},t.onIgnoreAttr=function(e,t,i){}},102:function(e,t){e.exports={indexOf:function(e,t){var i,n;if(Array.prototype.indexOf)return e.indexOf(t);for(i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1},forEach:function(e,t,i){var n,o;if(Array.prototype.forEach)return e.forEach(t,i);for(n=0,o=e.length;n<o;n++)t.call(i,e[n],n,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(e){return String.prototype.trimRight?e.trimRight():e.replace(/(\s*$)/g,"")}}},103:function(e,t,i){var n=i(62);function o(e){var t=e.indexOf(" ");if(-1===t)var i=e.slice(1,-1);else i=e.slice(1,t+1);return"/"===(i=n.trim(i).toLowerCase()).slice(0,1)&&(i=i.slice(1)),"/"===i.slice(-1)&&(i=i.slice(0,-1)),i}function r(e){return"</"===e.slice(0,2)}var a=/[^a-zA-Z0-9_:\.\-]/gim;function s(e,t){for(;t<e.length;t++){var i=e[t];if(" "!==i)return"="===i?t:-1}}function l(e,t){for(;t>0;t--){var i=e[t];if(" "!==i)return"="===i?t:-1}}function c(e){return function(e){return'"'===e[0]&&'"'===e[e.length-1]||"'"===e[0]&&"'"===e[e.length-1]}(e)?e.substr(1,e.length-2):e}t.parseTag=function(e,t,i){"user strict";var n="",a=0,s=!1,l=!1,c=0,d=e.length,u="",p="";for(c=0;c<d;c++){var h=e.charAt(c);if(!1===s){if("<"===h){s=c;continue}}else if(!1===l){if("<"===h){n+=i(e.slice(a,c)),s=c,a=c;continue}if(">"===h){n+=i(e.slice(a,s)),p=o(u=e.slice(s,c+1)),n+=t(s,n.length,p,u,r(u)),a=c+1,s=!1;continue}if(('"'===h||"'"===h)&&"="===e.charAt(c-1)){l=h;continue}}else if(h===l){l=!1;continue}}return a<e.length&&(n+=i(e.substr(a))),n},t.parseAttr=function(e,t){"user strict";var i=0,o=[],r=!1,d=e.length;function u(e,i){if(!((e=(e=n.trim(e)).replace(a,"").toLowerCase()).length<1)){var r=t(e,i||"");r&&o.push(r)}}for(var p=0;p<d;p++){var h,g=e.charAt(p);if(!1!==r||"="!==g)if(!1===r||p!==i||'"'!==g&&"'"!==g||"="!==e.charAt(p-1))if(" "!==g);else{if(!1===r){if(-1===(h=s(e,p))){u(n.trim(e.slice(i,p))),r=!1,i=p+1;continue}p=h-1;continue}if(-1===(h=l(e,p-1))){u(r,c(n.trim(e.slice(i,p)))),r=!1,i=p+1;continue}}else{if(-1===(h=e.indexOf(g,p+1)))break;u(r,n.trim(e.slice(i+1,h))),r=!1,i=(p=h)+1}else r=e.slice(i,p),i=p+1}return i<e.length&&(!1===r?u(e.slice(i)):u(r,c(n.trim(e.slice(i))))),n.trim(o.join(" "))}},188:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.assign(window,{core:window.core||{},ob:window.ob||{}});var n=i(0),o=i(189);n.filterHtmlString=o.filterHtmlString,i(195),i(63),i(64),i(66)},189:function(e,t,i){"use strict";var n=i(0),o=i(190),r=i(194),a=["style","class","dir","wix-comp"],s={iframe:["frameborder","height","width","src","marginheight","marginwidth","name","scrolling","longdesc"].concat(a)},l={meta:["content","property","scheme","name","charset","id","http-equiv","accesskey","dir","lang","title"].concat(a),link:["rel","href"].concat(a)},c=function(){var e=n.assign({},o.whiteList);return n.assign(e,{strike:[],hatul:[],wline:[]}),e.a.push("data-anchor"),e.a.push("dataquery"),e.a.push("data-content"),e.a.push("data-no-physical-url"),e.a.push("data-type"),e.a.push("id"),e.a.push("rel"),n.forOwn(e,function(e){e.push.apply(e,a)}),e}();Object.freeze(a),Object.freeze(s),Object.freeze(l),Object.freeze(c),function(e){n.forEach(["color","background-color","font-size","font-family","font-style","text-decoration","line-height","text-shadow","direction","position","z-index","top","left"],function(t){e.cssFilter.options.whiteList[t]=!0})}(o),Object.freeze(o),e.exports={filterHtmlString:function(e,t){var i=!1;t=t||{};var a=n.assign({},c);t.allowIframes&&n.assign(a,s),t.allowHeadTags&&n.assign(a,l);var d=o(e,{whiteList:a,stripIgnoreTagBody:!t.allowHeadTags,safeAttrValue:function(e,t,i,n){var r=function(e,t,i,n){return function(e,t,i){if("a"===e&&"href"===t){if(/^tel:[^A-Za-z]+$/i.test(i))return!0;if(/^ftp:\/\/[^\s]*$/.test(i))return!0}return!1}(e,t,i)?i:o.safeAttrValue(e,t,i,n)}(e,t,i,n);return r||""},onIgnoreTag:t.allowHeadTags?function(e,o,a){var s=function(e,t){var i=!0,o=[];return r(e,{start:function(e,t){i&&(o=t,i=!1)}}),n.get(n.find(o,{name:t}),"value")}(o,"type");return t.allowHeadTags&&!a.isClosing&&"script"===e&&n.isEqual(s,"application/ld+json")?(i=!0,'<script type="application/ld+json">'):a.isClosing&&i?(i=!1,o):""}:void 0});return t.allowOneSelfClosingMetaTag&&(d=d.replace(/(<meta[^<]*?)\s?\/?\s?>.*/,"$1 />")),d}}},190:function(e,t,i){var n=i(99),o=i(103),r=i(193);for(var a in(t=e.exports=function(e,t){return new r(t).process(e)}).FilterXSS=r,n)t[a]=n[a];for(var a in o)t[a]=o[a];"undefined"!=typeof window&&(window.filterXSS=e.exports)},191:function(e,t,i){var n=i(101),o=i(192);i(102);function r(e){return void 0===e||null===e}function a(e){(e=e||{}).whiteList=e.whiteList||n.whiteList,e.onAttr=e.onAttr||n.onAttr,e.onIgnoreAttr=e.onIgnoreAttr||n.onIgnoreAttr,this.options=e}a.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t=this.options,i=t.whiteList,n=t.onAttr,a=t.onIgnoreAttr;return o(e,function(e,t,o,s,l){var c=i[o],d=!1;!0===c?d=c:"function"==typeof c?d=c(s):c instanceof RegExp&&(d=c.test(s)),!0!==d&&(d=!1);var u,p={position:t,sourcePosition:e,source:l,isWhite:d};return d?r(u=n(o,s,p))?o+":"+s:u:r(u=a(o,s,p))?void 0:u})},e.exports=a},192:function(e,t,i){var n=i(102);e.exports=function(e,t){";"!==(e=n.trimRight(e))[e.length-1]&&(e+=";");var i=e.length,o=!1,r=0,a=0,s="";function l(){if(!o){var i=n.trim(e.slice(r,a)),l=i.indexOf(":");if(-1!==l){var c=n.trim(i.slice(0,l)),d=n.trim(i.slice(l+1));if(c){var u=t(r,s.length,c,d,i);u&&(s+=u+"; ")}}}r=a+1}for(;a<i;a++){var c=e[a];if("/"===c&&"*"===e[a+1]){var d=e.indexOf("*/",a+2);if(-1===d)break;r=(a=d+1)+1,o=!1}else"("===c?o=!0:")"===c?o=!1:";"===c?o||l():"\n"===c&&l()}return n.trim(s)}},193:function(e,t,i){var n=i(100).FilterCSS,o=i(99),r=i(103),a=r.parseTag,s=r.parseAttr,l=i(62);function c(e){return void 0===e||null===e}function d(e){(e=e||{}).stripIgnoreTag&&(e.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),e.onIgnoreTag=o.onIgnoreTagStripAll),e.whiteList=e.whiteList||o.whiteList,e.onTag=e.onTag||o.onTag,e.onTagAttr=e.onTagAttr||o.onTagAttr,e.onIgnoreTag=e.onIgnoreTag||o.onIgnoreTag,e.onIgnoreTagAttr=e.onIgnoreTagAttr||o.onIgnoreTagAttr,e.safeAttrValue=e.safeAttrValue||o.safeAttrValue,e.escapeHtml=e.escapeHtml||o.escapeHtml,e.css=e.css||{},this.options=e,this.cssFilter=new n(e.css)}d.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t=this.options,i=t.whiteList,n=t.onTag,r=t.onIgnoreTag,d=t.onTagAttr,u=t.onIgnoreTagAttr,p=t.safeAttrValue,h=t.escapeHtml,g=this.cssFilter;t.stripBlankChar&&(e=o.stripBlankChar(e)),t.allowCommentTag||(e=o.stripCommentTag(e));var m=!1;if(t.stripIgnoreTagBody){m=o.StripTagBody(t.stripIgnoreTagBody,r);r=m.onIgnoreTag}var f=a(e,function(e,t,o,a,m){var f,v={sourcePosition:e,position:t,isClosing:m,isWhite:o in i};if(!c(f=n(o,a,v)))return f;if(v.isWhite){if(v.isClosing)return"</"+o+">";var y=function(e){var t=e.indexOf(" ");if(-1===t)return{html:"",closing:"/"===e[e.length-2]};var i="/"===(e=l.trim(e.slice(t+1,-1)))[e.length-1];return i&&(e=l.trim(e.slice(0,-1))),{html:e,closing:i}}(a),b=i[o],S=s(y.html,function(e,t){var i,n=-1!==l.indexOf(b,e);return c(i=d(o,e,t,n))?n?(t=p(o,e,t,g))?e+'="'+t+'"':e:c(i=u(o,e,t,n))?void 0:i:i});a="<"+o;return S&&(a+=" "+S),y.closing&&(a+=" /"),a+=">"}return c(f=r(o,a,v))?h(a):f},h);return m&&(f=m.remove(f)),f},e.exports=d},194:function(e,t,i){"use strict";var n=/^<([-A-Za-z0-9_?:]+)((?:\s+(?:x:)?[-A-Za-z0-9_]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,o=/^<\/([-A-Za-z0-9_?:]+)[^>]*>/,r=/((?:x:)?[-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,a=h("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed"),s=h("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul"),l=h("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),c=h("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),d=h("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),u=h("script,style");function p(e,t){return t=t.replace(/<!--(.*?)-->/g,"$1").replace(/<!\[CDATA\[(.*?)]]>/g,"$1"),this.chars&&this.chars(t),""}function h(e){for(var t={},i=e.split(","),n=0;n<i.length;n++)t[i[n]]=!0;return t}e.exports=function(e,t){var i=void 0,h=void 0,g=void 0,m=e,f=[];for(f.last=function(){return this[this.length-1]};e;){if(h=!0,f.last()&&u[f.last()])e=e.replace(new RegExp("(.*)</"+f.last()+"[^>]*>","i"),p.bind(t)),b(0,f.last());else if(0===e.indexOf("\x3c!--")?(i=e.indexOf("--\x3e"))>=0&&(t.comment&&t.comment(e.substring(4,i)),e=e.substring(i+3),h=!1):0===e.indexOf("</")?(g=e.match(o))&&(e=e.substring(g[0].length),g[0].replace(o,b),h=!1):0===e.indexOf("<")&&(g=e.match(n))&&(e=e.substring(g[0].length),g[0].replace(n,y),h=!1),h){var v=(i=e.indexOf("<"))<0?e:e.substring(0,i);e=i<0?"":e.substring(i),t.chars&&t.chars(v)}if(e===m)throw"Parse Error: "+e;m=e}function y(e,i,n,o){if(i=i.toLowerCase(),s[i])for(;f.last()&&l[f.last()];)b(0,f.last());if(c[i]&&f.last()===i&&b(0,i),(o=a[i]||!!o)||f.push(i),t.start){var u=[];n.replace(r,function(e,t){for(var i=null,n=2;n<5;n++)if(null===i&&arguments[n]){i=arguments[n];break}null===i&&d[t]&&(i=t),null===i&&(i=""),u.push({name:t,value:i,escaped:i.replace(/(^|[^\\])"/g,'$1\\"')})}),t.start&&t.start(i,u,o,e)}}function b(e,i){var n=void 0;if(i)for(n=f.length-1;n>=0&&f[n]!==i;n--);else n=0;if(n>=0){for(var o=f.length-1;o>=n;o--)t.end&&t.end(f[o]);f.length=n}}b()}},195:function(e,t){var i;!function(e){e.deepClone=function(e){return angular.copy(e)},e.set=function(e,t,i){for(var n,o=e,r=t.slice();r.length>1;)o[n=r.shift()]=o[n]||{},o=o[n];return o[n=r[0]]=i,e},angular.module("adiCoreAppInternal",["wixAngular","sdkCommons","adiCorePreload"]).run(["flags","urlStateKeeper",function(e,t){}]),angular.module("adiAppCore",["adiCoreAppInternal"]).run(["sdkHandler","flags",function(e,t){e.init()}])}(i||(i={})),window.ob&&Object.assign(window.ob,i)},62:function(e,t){e.exports={indexOf:function(e,t){var i,n;if(Array.prototype.indexOf)return e.indexOf(t);for(i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1},forEach:function(e,t,i){var n,o;if(Array.prototype.forEach)return e.forEach(t,i);for(n=0,o=e.length;n<o;n++)t.call(i,e[n],n,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")}}},63:function(e,t){var i;!function(e){var t=function(){function e(e,t,i,n,o,r){this.platformService=e,this.documentServices=t,this.$p=i,this.trace=n,this.consumerSave=o,this.applicationParameters=r,n&&(this.documentServices=this.wrapApi(this.documentServices,"documentServices"))}return e.prototype.wrapApi=function(e,t,i){var n=this;if("function"==typeof e)return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];n.trace.apply(n,[t].concat(o));var a=e.apply(i,o);if(a){if(a.then){var s=n.$p.defer();return a.then(function(e){n.trace(t,"<==",e),s.resolve(e)}),s.promise}console.info("<==",a)}return a};if(!_.isObject(e))return e;t=t?t+".":"";for(var o={},r=0,a=Object.keys(e);r<a.length;r++){var s=a[r];o[s]=this.wrapApi(e[s],t+s,e)}return o},e.prototype.createApi=function(){var e=this,t={setAppAPI:function(e){return Promise.resolve()},selection:{deselectComponents:function(){return null},getSelectedComponents:function(){return[]},selectComponentByCompRef:function(){return null}},environment:{getLocale:this.getLocale.bind(this)},save:this.save.bind(this),info:{getEditorMode:this.getEditorMode.bind(this),getEditorSessionId:this.getEditorSessionId.bind(this),getMetaSiteId:this.getMetaSiteId.bind(this),getSiteId:this.getSiteId.bind(this),isSiteSaved:this.isSiteSaved.bind(this)},showNotification:this.showNotification.bind(this)},i={document:{application:{install:this.applicationInstall.bind(this)},components:{add:this.addComponent.bind(this)},pagesGroup:{create:this.createPagesGroup.bind(this),addPageToPagesGroup:this.addPageToGroup.bind(this),remove:this.removePageGroup.bind(this)},pages:{add:this.addPage.bind(this),remove:this.removePage.bind(this),navigateTo:this.navigateToPage.bind(this)},history:{add:this.addHistory.bind(this)},environment:{getLocale:this.getLocale.bind(this)},tpa:{add:{application:this.addTpaApplication.bind(this),component:this.addTpaComponent.bind(this)},isApplicationInstalled:this.isTpaApplicationInstalled.bind(this),isAppSectionInstalled:this.isTpaAppSectionInstalled.bind(this)}},editor:t};return["editor.info.getDashboardUrl","editor.info.getMetaSiteId","editor.info.getEditorSessionId","editor.info.getSiteId","editor.info.getEditorReadyTimestamp","editor.info.getEditorMode","editor.info.getAppDefinitionId","editor.info.isSitePublished","editor.info.getLanguage","editor.info.isSiteSaved","editor.ide.openFile","editor.ide.navigateToCollection","editor.ide.treePane.isOpen","editor.ide.treePane.toggle","editor.preview.navigateTo","editor.userPreferences.get","editor.userPreferences.set","editor.utils.getLinkAsString","editor.showNotification","editor.openPanel","editor.openComponentPanel","editor.openModalPanel","editor.openToolPanel","editor.openPagePanel","editor.openPagesPanel","editor.openFullStagePanel","editor.openLinkPanel","editor.openMediaPanel","editor.openHelpPanel","editor.updatePanelOptions","editor.closePanel"].forEach(function(t){_.get(i,t)||_.set(i,t,function(t){return function(){return e.trace("Unexpected call to: "+t),Promise.reject("Unexpected call to: "+t)}}(t))}),this.trace&&(i=this.wrapApi(i,"platform")),_.merge(i,i.document,i.editor)},e.prototype.isSiteSaved=function(){return!0},e.prototype.showNotification=function(e,t,i){var n=i.title,o=i.message;i.type,i.link;return this.trace("ShowNotification",n,o),Promise.resolve()},e.prototype.getMetaSiteId=function(){this.documentServices.generalInfo.getMetaSiteId()},e.prototype.getSiteId=function(){return this.documentServices.generalInfo.getSiteId()},e.prototype.getEditorSessionId=function(){return this.applicationParameters.clientTopology.esi},e.prototype.applicationInstall=function(e,t,i){var n=this,o=_.get(i,"appDefinitionId");if(!o)return this.$p.reject(new Error("options must contain appDefinitionId"));var r=o===this.documentServices.platform.editorApps.SANTA_MEMBERS.appDefId;return r&&this.platformService.onMembersAreaInstallStarted(),this.documentServices.platform.provision(i.appDefinitionId,{origin:{type:"APP",info:{appDefinitionId:_.get(i,"initiatorAppDefinitionId")}}}).then(function(e){return r&&n.platformService.onMembersAreaInstallFinished(),e})},e.prototype.addHistory=function(){return this.$p.when()},e.prototype.getEditorMode=function(){return"desktop"},e.prototype.navigateToPage=function(e,t,i){var n=_.get(i,"pageRef.id"),o=_.get(i,"pageLink"),r=n||o;if(r){var a=this.$p.defer();return this.documentServices.pages.navigateTo(r,function(){a.resolve()}),a.promise}},e.prototype.updateCompLayout=function(e,t){_.merge(e.layout,{})},e.prototype.save=function(){var e=this;return this.consumerSave().then(function(t){return e.platformService.scheduleUpdatePages(),t})},e.prototype.addComponent=function(e,t,i){if(_.isEmpty(i.componentDefinition.componentType))return this.$p.reject(new Error("componentDefinition must contain componentType"));var n=this.documentServices.components.buildDefaultComponentStructure(i.componentDefinition.componentType);this.updateCompLayout(n,i),_.merge(n,i.componentDefinition);var o=this.documentServices.components.add(i.pageRef,n,i.customId,void 0,"editorSdk",{showAddToHeaderPanel:!1});return this.$p.when(o)},e.prototype.addPage=function(e,t,i){var n=this.documentServices.pages.add(i.title,i.definition);return this.$p.when(n)},e.prototype.removePage=function(e,t,i){i.routerRef;var n=i.pageRef;return this.documentServices.pages.remove(n.id),this.$p.when()},e.prototype.createPagesGroup=function(e,t,i){var n=this.documentServices.pagesGroup.create({groupName:i.groupName,appId:e.applicationId});return this.$p.when(n)},e.prototype.addPageToGroup=function(e,t,i){var n=i.pagesGroupPointer,o=i.pageId;return this.documentServices.pagesGroup.addPageToPagesGroup(n,o),this.documentServices.pages.data.update(o,{hidePage:!0}),this.platformService.scheduleUpdatePages(),this.$p.when()},e.prototype.removePageGroup=function(e,t,i){var n=this,o=i.pagesGroupPointer;return this.platformService.goToHomePage().then(function(){n.documentServices.pagesGroup.remove(o),n.platformService.scheduleUpdatePages()})},e.prototype.getLocale=function(){return this.platformService.scheduleUpdatePages(),"en"},e.prototype.isTpaApplicationInstalled=function(e,t,i){if(!_.get(i,"appDefinitionId"))return this.$p.reject(new Error("options must contain appDefinitionId"));var n=this.documentServices.tpa.app.isInstalled(i.appDefinitionId);return this.$p.when(n)},e.prototype.addTpaApplication=function(e,t,i){var n=this;return _.get(i,"appDefinitionId")?this.documentServices.tpa.app.isInstalled(i.appDefinitionId)?this.$p.reject(new Error("Application already installed.")):this.documentServices.tpa.appMarket.getDataAsync(i.appDefinitionId).then(function(t){if(!t||t.error)return n.$p.reject(new Error("Application with "+i.appDefinitionId+" appDefinitionId do not exist."));if(!("Wix"===t.by))return n.$p.reject(new Error("Can't add a non Wix application"));var o=n.$p.defer();return i.callback=function(t){if(t.onError)o.reject(new Error(t.onError));else if(e=n.documentServices.tpa.app.getDataByAppDefId(i.appDefinitionId),t.page){var r=n.documentServices.pages.data.get(t.page.id);o.resolve({instanceId:_.get(e,"instanceId"),pageRef:t.page,pageUriSEO:_.get(r,"pageUriSEO"),title:_.get(r,"title")})}else o.resolve({instanceId:_.get(e,"instanceId")})},n.documentServices.tpa.app.add(i.appDefinitionId,i),o.promise}):this.$p.reject(new Error("options must contain appDefinitionId"))},e.prototype.addTpaComponent=function(e,t,i){var n=this;if(!(i=i||{}).componentType)return this.$p.reject(new Error("options must contain componentType"));if(i.appDefinitionId||(i.appDefinitionId=e.appDefinitionId),"WIDGET"===i.componentType){if(!_.isObject(i.widget))return this.$p.reject(new Error("options must contain a widget object"));i.widget.tpaWidgetId=i.widget.widgetId}else if("PAGE"===i.componentType){if(!_.isObject(i.page))return this.$p.reject(new Error("options must contain a page object"));if(i.page.isHidden&&!_.isBoolean(i.page.isHidden))return this.$p.reject(new Error("isHidden param should be of type boolean"))}var o=this.$p.defer();return i.callback=function(e){if(e.onError)o.reject(new Error(e.onError));else if("WIDGET"===i.componentType)o.resolve({compId:e.comp.id});else{var t=n.documentServices.pages.data.get(e.page.id);o.resolve({compId:e.sectionId,pageRef:e.page,pageUriSEO:_.get(t,"pageUriSEO"),title:_.get(t,"title")})}},this.documentServices.tpa.comp.add(i),o.promise},e.prototype.isTpaAppSectionInstalled=function(e,t,i){if(!_.get(i,"sectionId"))return this.$p.reject(new Error("options must contain sectionId"));var n=e.applicationId;if(i.appDefinitionId){var o=this.documentServices.tpa.app.getDataByAppDefId(i.appDefinitionId);n=_.get(o,"applicationId")}var r=this.documentServices.tpa.section.isSectionInstalledByTpaPageId(n,i.sectionId);return this.$p.when(r)},e}();e.PlatformApi=t}(i||(i={})),angular.module("adiCoreAppInternal").factory("platformApi",["$p",function(e){return function(t,n,o,r,a){return new i.PlatformApi(t,n,e,o,r,a)}}])},64:function(e,t,i){var n,o=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){e.done?o(e.value):new i(function(t){t(e.value)}).then(a,s)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var i,n,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};!function(e){var t=i(65),n=function(){function e(e,t,i,n,o,r,a,s,l,c,d,u,p,h,g,m){var f=this;this.flags=e,this.applicationParameters=t,this.modelTree=i,this.tpaTypes=n,this.sitePartTypes=o,this.componentClasses=r,this.documentServicesMediator=a,this.platformApi=s,this.pagesManager=l,this.menuService=c,this.mobileSolutionManager=d,this.tpaSolutionManager=u,this.$p=p,this.storyServices=h,this.$timeout=g,this.spinnerService=m,this.platformInitialized=!1,this.save=function(){},this.ensureCanEnsurePages=function(){},this.deletePageByNode=function(e){},this.biAppStart=function(){},this.biAddTpaSuccess=function(){},this.biRemoveTpaSuccess=function(){},this.biAddPageSuccess=function(e,t,i){},this.onPagesChanged=function(){},this.onFieldsChanged=function(){},this.timeoutToken=void 0,this.trace=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];f.flags.debugMembersArea&&console.info.apply(console,["%c%s: %cPlatform API","color:#aaa",(new Date).toJSON(),"color: magenta"].concat(e))},this.membersTpaTypes=[this.tpaTypes.Blog2,this.tpaTypes.Forum,this.tpaTypes.Stores,this.tpaTypes.Bookings],this.socialTpaTypes=[this.tpaTypes.Blog2,this.tpaTypes.Forum],AdiCoreSanta.setPlatformService(this)}return e.$inject=["flags","applicationParameters","modelTree","tpaTypes","sitePartTypes","componentClasses","documentServicesMediator","platformApi","pagesManager","menuService","mobileSolutionManager","tpaSolutionManager","$p","storyServices","$timeout","spinnerService"],e.prototype.onMembersAreaInstallStarted=function(){this.biAppStart()},e.prototype.onMembersAreaInstallFinished=function(){this.biAddTpaSuccess()},e.prototype.removeNode=function(e){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return this.trace("pagesManager.removePagelink",e.id),[4,this.pagesManager.removePageLink(e.id)];case 1:return t.sent(),this.trace("deletePageByNode",e),[2,this.deletePageByNode(e)]}})})},e.prototype.scheduleUpdatePages=function(){return o(this,void 0,void 0,function(){var e=this;return r(this,function(t){switch(t.label){case 0:return[4,this.ensureCanEnsurePages()];case 1:return t.sent(),this.timeoutToken&&this.$timeout.cancel(this.timeoutToken),this.timeoutToken=this.$timeout(function(){e.timeoutToken=void 0,e.updatePages()},500),[2]}})})},e.prototype.handleAllMembersPage=function(){var e=this.getDocumentServices().pages.getPagesData().find(function(e){return"all_members"===e.tpaPageId});if(e&&!this.modelTree.getPagesNodes().find(function(e){return"AllMembers"===e.tpaSection})){var t=this.modelTree.addPageToTree(e.title);t.tpaSection="AllMembers",this.flags.passoverCleaning||(t.children[0].userHidden=!1),this.menuService.addLinkToPage(t),this.pagesManager.ensurePages()}},e.prototype.addRootNode=function(e){this.trace("modelTree.addPageToTree",e.appDefinitionName);var t=this.modelTree.addPageToTree(e.appDefinitionName);return t.membersArea={isParent:!0},t.hidePage=!0,this.trace("menuService.addLinkToPage",t),this.menuService.addLinkToPage(t),this.onMembersAreaFirstPageAdded(),this.onFieldsChanged(),t},e.prototype.removeAllMembersNodes=function(){return o(this,void 0,void 0,function(){var e,t,i=this;return r(this,function(n){switch(n.label){case 0:return this.onMembersAreaLastPageRemoved(),this.onFieldsChanged(),this.storyServices.recalculateCurrentPage(!0,!1),this.biRemoveTpaSuccess(),e=_.filter(this.modelTree.getPagesNodes(),function(e){return e.membersArea}),t=!1,[4,this.$p.all(e.map(function(e){return t=!0,i.removeNode(e)}))];case 1:return n.sent(),t&&this.onPagesChanged(),this.trace("<== updatePages"),[4,this.goToHomePage()];case 2:return n.sent(),[2]}})})},e.prototype.addPageNodeIfNotExist=function(e,t){var i=_.find(this.modelTree.getPagesNodes(),function(t){return t.membersArea&&!t.membersArea.isParent&&t.membersArea.pageId===e.id});if(!i)return this.trace("modelTree.addPageToTree",e.title),(i=this.modelTree.addPageToTree(e.title)).membersArea={pageId:e.id,tpaPageId:e.tpaPageId,isParent:!1,isPrivate:e.isPrivate},i.hidePage=!0,this.flags.passoverCleaning||(i.children[0].userHidden=!0),this.trace("menuService.addLinkToPage",i,t.id),this.menuService.addLinkToPage(i,t.id),i},e.prototype.addPageSolution=function(e){return o(this,void 0,void 0,function(){var t,i,n,o,a,s,l,c;return r(this,function(r){switch(r.label){case 0:return t=Date.now(),i=this.modelTree.getTpaNodeByType("Members_Page"),n=this.modelTree.duplicateNodeAndContentElementForPresetPreview(i),o=this.modelTree.addNewNode(n,e),a=e.membersArea.pageId,s=this.getDocumentServices().pages.getReference(a),(l=(this.getDocumentServices().components.getChildren(s)||[void 0])[0])&&(o.widgetRef=l,o.membersArea={componentType:this.getDocumentServices().components.getType(l),membersMenu:this.getMembersMenuComponent()}),[4,this.tpaSolutionManager.createTpaPageSolution(o,e)];case 1:return c=r.sent(),[4,this.mobileSolutionManager.createMobileSolution(this.sitePartTypes.BODY,c)];case 2:return r.sent(),this.pagesManager.addStoryPage(e.getId(),a),this.biAddPageSuccess(e.displayName,o,t),[2]}})})},e.prototype.updatePages=function(){return o(this,void 0,void 0,function(){var e,t,i,n,a,s,l,c=this;return r(this,function(d){switch(d.label){case 0:return this.trace("updatePages"),e=this.getDocumentServices().platform.editorApps.SANTA_MEMBERS.appDefId,t=this.getDocumentServices().platform.getAppDataByAppDefId(e),i=this.getAppPages(e),n=_.find(this.modelTree.getPagesNodes(),function(e){return!(!e.membersArea||!e.membersArea.isParent)}),a=!1,n?[3,1]:0===i.length?[2]:(n=this.addRootNode(t),a=!0,[3,3]);case 1:return 0!==i.length?[3,3]:[4,this.removeAllMembersNodes()];case 2:return d.sent(),[2];case 3:return(s=i.map(function(e){return c.addPageNodeIfNotExist(e,n)}).filter(function(e){return!!e})).length&&(a=!0),[4,_.sequencePromises(s,function(e){return o(c,void 0,void 0,function(){return r(this,function(t){return[2,this.addPageSolution(e)]})})})];case 4:return d.sent(),l=_.filter(this.modelTree.getPagesNodes(),function(e){return e.membersArea&&!e.membersArea.isParent}),[4,Promise.all(l.map(function(e){if(!_.find(i,{id:e.membersArea.pageId}))return a=!0,c.removeNode(e)}))];case 5:return d.sent(),this.handleAllMembersPage(),a&&this.onPagesChanged(),this.trace("<== updatePages"),[2]}})})},e.prototype.goToHomePage=function(){return o(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return this.trace("pagesManager.goToHomePage"),[4,this.pagesManager.goToHomePage()];case 1:return e.sent(),this.trace("pagesManager.goToHomePage <=="),[2]}})})},e.prototype.generatePanelToken=function(e){return _.uniqueId("platform_"+e+"_")},e.prototype.initializeBeforeTpaInstall=function(){this.activatePlatformSupport()},e.prototype.activatePlatformSupport=function(){if(!this.platformInitialized&&this.flags.membersArea){this.platformInitialized=!0;var e=this.createApi();this.getDocumentServices().platform.init(e)}},e.prototype.getDocumentServices=function(){return this.documentServicesMediator.documentServices},e.prototype.createApi=function(){return this.platformApi(this,this.getDocumentServices(),this.flags.debugMembersArea&&this.trace,this.save,this.applicationParameters).createApi()},e.prototype.addMembersArea=function(){return o(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return this.spinnerService.waitForMe("addMembersArea"),[4,this.documentServicesMediator.addMembersArea()];case 1:return e.sent(),this.spinnerService.imDone("addMembersArea"),this.storyServices.reRender(this.sitePartTypes.HEADER),[2]}})})},e.prototype.getMembersAppId=function(){return this.getDocumentServices().platform.editorApps.SANTA_MEMBERS.appDefId},e.prototype.getMembersAppPages=function(){return this.getAppPages(this.getMembersAppId())},e.prototype.getAppPages=function(e){var t=[];if(e)for(var i=function(i){if(i.appDefinitionId!==e)return"continue";var n="account"===i.prefix;t=t.concat(i.pages.filter(function(e){return!!e}).map(function(e){return{id:e.id,title:e.title,tpaPageId:e.tpaPageId,isPrivate:n}}))},n=0,o=this.getDocumentServices().routers.pages.getDynamicPagesList();n<o.length;n++){i(o[n])}return t},e.prototype.uninstallMembersArea=function(){return o(this,void 0,void 0,function(){var e,i;return r(this,function(n){switch(n.label){case 0:return this.spinnerService.waitForMe("uninstallMembersArea"),e=this.documentServicesMediator.getPlatformMembersAppDefId(),i=this.documentServicesMediator.getPlatformAppDataByAppDefId(e),[4,t.api.request(i.applicationId,{target:this.documentServicesMediator.getPlatformAppsContainer()})];case 1:return n.sent().uninstall(this.generatePanelToken(e)),[2]}})})},e.prototype.onMembersAreaFirstPageAdded=function(){var e=this.getLoginField();e.value.hasMembersArea=!0,e.value.membersAreaWasInstalled=!0;var t=this.modelTree.getGeneralInformation().getContentElement(),i=t.getArgsMatchingPolicy();i.Login=!0,t.setArgsMatchingPolicy(i)},e.prototype.onMembersAreaLastPageRemoved=function(){this.getLoginField().value.hasMembersArea=!1,this.loginComponentId=void 0,this.loginComponentData=void 0,this.spinnerService.imDone("uninstallMembersArea");var e=this.modelTree.getGeneralInformation().getContentElement(),t=e.getArgsMatchingPolicy();t.Login=!1,e.setArgsMatchingPolicy(t)},e.prototype.onTpaAdded=function(){this.initializeBeforeTpaInstall()},e.prototype.onTpaRemoved=function(){return o(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return this.platformInitialized?[4,this.documentServicesMediator.waitForChanges()]:[3,2];case 1:e.sent(),this.scheduleUpdatePages(),e.label=2;case 2:return[2]}})})},e.prototype.initialize=function(){return o(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return this.flags.membersArea?[4,this.documentServicesMediator.whenInitialized()]:[2];case 1:return e.sent(),this.flags.formBuilder||this.hasMembersArea()?(this.activatePlatformSupport(),[2]):[2]}})})},e.prototype.hasMembersArea=function(){if(!this.flags.membersArea)return!1;var e=this.getLoginField();return e&&e.value.hasMembersArea},e.prototype.membersAreaWasInstalledAtLeastOnce=function(){return this.getLoginField().value.membersAreaWasInstalled},e.prototype.hasSocialLayer=function(){var e=this;return this.socialTpaTypes.some(function(t){return!!e.modelTree.getTpaPageNodeByType(t)})},e.prototype.hasMembersApps=function(){var e=this;return this.membersTpaTypes.some(function(t){return!!e.modelTree.getTpaPageNodeByType(t)})},e.prototype.isMemberAppPage=function(e){return!!this.getMembersChildren().find(function(t){return t.id===e})},e.prototype.suggestMembersArea=function(){return!!this.membersAreaWasInstalledAtLeastOnce()&&(this.hasMembersApps()||this.hasMembersArea())},e.prototype.discoverLoginComponent=function(){if(!this.hasMembersArea())return this.loginComponentId=void 0,void(this.loginComponentData=void 0);if(!this.loginComponentId){var e=this.documentServicesMediator.getAllComponentsByType("wysiwyg.viewer.components.LoginSocialBar");this.loginComponentId=e&&e.length&&e[0],this.loginComponentData=this.documentServicesMediator.serializeComponent(this.loginComponentId);var t=_.get(this.loginComponentData,"data.iconItemsRef.menuRef");this.loginComponentMenu=t&&this.documentServicesMediator.getMenuById(t.substring(1))}},e.prototype.getLoginComponentId=function(){return this.discoverLoginComponent(),this.loginComponentId},e.prototype.getMembersMenuComponent=function(){return this.documentServicesMediator.getComponentRef("SOSP_CONTAINER_CUSTOM_ID")},e.prototype.getLoginComponentDisplayMode=function(){var e=this.getLoginField();if(this.discoverLoginComponent(),this.loginComponentData)switch(e.value.loginBarShow){case"avatarOnly":return(_.get(this.loginComponentMenu,"items.length")||0)>0?"avatarAndIcon":"avatarOnly";case"textOnly":case"avatarAndText":return"memberName"}},e.prototype.getAllMembersNodes=function(){return _.filter(this.modelTree.getPagesNodes(),function(e){return e.membersArea})},e.prototype.getMembersParent=function(){return _.filter(this.modelTree.getPagesNodes(),function(e){return e.membersArea&&e.membersArea.isParent})},e.prototype.getMembersChildren=function(){return _.filter(this.modelTree.getPagesNodes(),function(e){return e.membersArea&&!e.membersArea.isParent})},e.prototype.getLoginField=function(){return this.modelTree.getGeneralInformation().getContentElement().values.Login},e.prototype.renderMobileMembersArea=function(){var e=this.getMembersMenuComponent(),t=this.documentServicesMediator.getMobileComponent(e);if(t){var i=this.updateMobileMembersChildren(t),n=this.documentServicesMediator.getLayout(t);i&&n.height!==i&&this.documentServicesMediator.updateLayout(t,{height:i})}},e.prototype.updateMobileMembersChildren=function(t){var i=this,n=this.documentServicesMediator.getChildren(t);if(n&&0!==n.length){var o=n.find(function(e){return i.documentServicesMediator.getComponentType(e)===i.componentClasses.tpaWidget.comp}),r=_.without(n,o),a=0,s=function(e,t){var n=i.documentServicesMediator.getLayout(e);n.y===a&&0===n.x||i.documentServicesMediator.updateLayout(e,{y:a,x:0}),a+=n.height===p.MINIMUM_COMPONENT_HEIGHT&&t?t:n.height};return s(o,e.defaultMembersProfileHeight),r.forEach(function(e){return s(e)}),a}},e.defaultMembersProfileHeight=123,e}();e.PlatformService=n}(n||(n={})),angular.module("adiCoreAppInternal").service("platformService",n.PlatformService)},65:function(e,t,i){self,e.exports=function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=73)}([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={INVOKE:"invoke",RPC_RESOLVE:"rpc-resolve",RPC_REJECT:"rpc-reject",API_DESCRIPTION:"api-desc",INVOKE_FUNCTION:"invoke-func",RESOLVE:"resolve",REJECT:"reject",REQUEST_API:"request-api"}},function(e,t,i){var n=i(41);e.exports=function(e,t){var i=e.__data__;return n(t)?i["string"==typeof t?"string":"hash"]:i.map}},function(e,t,i){var n=i(19);e.exports=function(e,t){for(var i=e.length;i--;)if(n(e[i][0],t))return i;return-1}},function(e,t,i){var n=i(10)(Object,"create");e.exports=n},function(e,t,i){var n=i(13),o=i(67),r=i(66),a=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?o(e):r(e)}},function(e,t,i){var n=i(71);e.exports=function(e,t,i){var o=null==e?void 0:n(e,t);return void 0===o?i:o}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deserialize=t.serialize=void 0;var n=r(i(5)),o=r(i(25));function r(e){return e&&e.__esModule?e:{default:e}}t.serialize=function(e){return Promise.reject((0,o.default)(e)?{type:(t=e).constructor.name,message:t.message,stack:t.stack}:e);var t},t.deserialize=function(e){return function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).type;return"Error"===e||(0,o.default)((0,n.default)(self,[e,"prototype"]))}(e)?function(e){var t=e.type,i=e.stack,n=e.message,o=new(self[t]||Error)(n);return o.stack=i,o}(e):e}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendResponse=t.send=void 0;var n=i(17);function o(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}t.send=function(e,t){var i=t.target,r=t.targetOrigin,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return new Promise(function(t){var s=new MessageChannel,l=s.port1,c=s.port2;e.__port=c,(0,n.isWorker)()||i instanceof Worker||i instanceof MessagePort?i.postMessage(e,[c].concat(o(a))):i.postMessage(e,r,[c].concat(o(a))),l.onmessage=function(e){var i=e.data;return t(i)}})},t.sendResponse=function(e,t){return function(i){return e.postMessage({intent:t,result:i})}}},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t,i){var n=i(4),o=i(8);e.exports=function(e){if(!o(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t,i){var n=i(58),o=i(54);e.exports=function(e,t){var i=o(e,t);return n(i)?i:void 0}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,i){var n=i(69),o="object"==typeof self&&self&&self.Object===Object&&self,r=n||o||Function("return this")();e.exports=r},function(e,t,i){var n=i(12).Symbol;e.exports=n},function(e,t,i){var n=i(4),o=i(11);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==n(e)}},function(e,t){var i=Array.isArray;e.exports=i},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i(0),r=(n=o)&&n.__esModule?n:{default:n},a=i(6);t.default=function(e){var t=e.intent,i=e.result;switch(t){case r.default.RESOLVE:return i;case r.default.REJECT:return Promise.reject((0,a.deserialize)(i));default:return Promise.reject()}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWorker=function(){return"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope},t.getChildFrameById=function(e){return document.getElementById(e)}},function(e,t,i){var n=i(14);e.exports=function(e){if("string"==typeof e||n(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,i){var n=i(15),o=i(70),r=i(65),a=i(37);e.exports=function(e,t){return n(e)?e:o(e,t)?[e]:r(a(e))}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=!1;t.addSingleHandler=function(e){n||(n=!0,self.addEventListener("message",e))},t.removeSingleHandler=function(e){self.removeEventListener("message",e),n=!1}},function(e,t){e.exports=function(e,t){return function(i){return e(t(i))}}},function(e,t,i){var n=i(22)(Object.getPrototypeOf,Object);e.exports=n},function(e,t,i){var n=i(4),o=i(23),r=i(11),a=Function.prototype,s=Object.prototype,l=a.toString,c=s.hasOwnProperty,d=l.call(Object);e.exports=function(e){if(!r(e)||"[object Object]"!=n(e))return!1;var t=o(e);if(null===t)return!0;var i=c.call(t,"constructor")&&t.constructor;return"function"==typeof i&&i instanceof i&&l.call(i)==d}},function(e,t,i){var n=i(4),o=i(11),r=i(24);e.exports=function(e){if(!o(e))return!1;var t=n(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!r(e)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deserialize=t.serialize=void 0;var n=s(i(9)),o=i(7),r=s(i(0)),a=s(i(16));function s(e){return e&&e.__esModule?e:{default:e}}t.serialize=function(e){return e.reduce(function(e,t){var i=e.args,a=e.transfer;if((0,n.default)(t)){var s=new MessageChannel,l=s.port1,c=s.port2;l.onmessage=function(e){var i=e.data,n=i.__port;Promise.resolve(t.apply(void 0,function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}(i))).then((0,o.sendResponse)(n,r.default.RESOLVE),(0,o.sendResponse)(n,r.default.REJECT))};var d=a.length;i.push({type:"function",index:d,port:c}),a.push(c)}else i.push({type:"value",value:t});return{args:i,transfer:a}},{args:[],transfer:[]})},t.deserialize=function(e){return e.map(function(e){return"value"===e.type?e.value:function(){for(var t=e.port,i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];return(0,o.send)(n,{target:t}).then(a.default)}})}},function(e,t){var i=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&i.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t,i){var n=i(10),o=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},function(e,t,i){var n=i(28);e.exports=function(e,t,i){"__proto__"==t&&n?n(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}},function(e,t,i){var n=i(29),o=i(19),r=Object.prototype.hasOwnProperty;e.exports=function(e,t,i){var a=e[t];r.call(e,t)&&o(a,i)&&(void 0!==i||t in e)||n(e,t,i)}},function(e,t,i){var n=i(30),o=i(20),r=i(27),a=i(8),s=i(18);e.exports=function(e,t,i,l){if(!a(e))return e;for(var c=-1,d=(t=o(t,e)).length,u=d-1,p=e;null!=p&&++c<d;){var h=s(t[c]),g=i;if(c!=u){var m=p[h];void 0===(g=l?l(m,h,p):void 0)&&(g=a(m)?m:r(t[c+1])?[]:{})}n(p,h,g),p=p[h]}return e}},function(e,t,i){var n=i(31);e.exports=function(e,t,i){return null==e?e:n(e,t,i)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.invokeApiFunction=t.getDescription=t.buildApiFromDescription=void 0;var n=u(i(0)),o=i(7),r=u(i(5)),a=u(i(32)),s=u(i(9)),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(i(26)),c=i(6),d=u(i(16));function u(e){return e&&e.__esModule?e:{default:e}}function p(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}var h=!0;t.buildApiFromDescription=function(e,t,i){return Object.keys(t).sort().reduce(function(t,r){return(0,a.default)(t,r,function(e,t,i){return function(){for(var r=arguments.length,a=Array(r),s=0;s<r;s++)a[s]=arguments[s];var c=l.serialize(a),u=c.args,p=c.transfer;return(0,o.send)({appId:e,call:i,args:u,intent:n.default.INVOKE_FUNCTION},t,p).then(d.default)}}(e,i,r))},{})};var g=function e(t,i){var n=function(e,t){return 0===t.length?e:(0,r.default)(e,t)}(i,t),o=Object.keys(n).reduce(function(n,o){return Object.assign(n,e([].concat(p(t),[o]),i))},{});return Object.assign(function(e,t){return(0,s.default)(e)?(i={},n=t.join("."),o=h,n in i?Object.defineProperty(i,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):i[n]=o,i):{};var i,n,o}(n,t),o)};t.getDescription=function(e){return g([],e)},t.invokeApiFunction=function(e,t){try{var i=l.deserialize(t);return Promise.resolve(e.apply(void 0,p(i))).catch(c.serialize)}catch(e){return(0,c.serialize)(e)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEmpty=t.unregisterApp=t.hasApp=t.getAppData=t.getAppById=t.registerApp=void 0;var n,o=i(5),r=(n=o)&&n.__esModule?n:{default:n},a={};t.registerApp=function(e,t,i){a[e]={app:t,onApiCall:i}},t.getAppById=function(e){return(0,r.default)(a,[e,"app"])},t.getAppData=function(e){return a[e]},t.hasApp=function(e){return Boolean(a[e])},t.unregisterApp=function(e){return delete a[e]},t.isEmpty=function(){return Object.keys(a).length>0}},function(e,t){e.exports=function(e,t){for(var i=-1,n=null==e?0:e.length,o=Array(n);++i<n;)o[i]=t(e[i],i,e);return o}},function(e,t,i){var n=i(13),o=i(35),r=i(15),a=i(14),s=n?n.prototype:void 0,l=s?s.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(r(t))return o(t,e)+"";if(a(t))return l?l.call(t):"";var i=t+"";return"0"==i&&1/t==-1/0?"-0":i}},function(e,t,i){var n=i(36);e.exports=function(e){return null==e?"":n(e)}},function(e,t,i){var n=i(1);e.exports=function(e,t){var i=n(this,e),o=i.size;return i.set(e,t),this.size+=i.size==o?0:1,this}},function(e,t,i){var n=i(1);e.exports=function(e){return n(this,e).has(e)}},function(e,t,i){var n=i(1);e.exports=function(e){return n(this,e).get(e)}},function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,i){var n=i(1);e.exports=function(e){var t=n(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t,i){var n=i(10)(i(12),"Map");e.exports=n},function(e,t,i){var n=i(2);e.exports=function(e,t){var i=this.__data__,o=n(i,e);return o<0?(++this.size,i.push([e,t])):i[o][1]=t,this}},function(e,t,i){var n=i(2);e.exports=function(e){return n(this.__data__,e)>-1}},function(e,t,i){var n=i(2);e.exports=function(e){var t=this.__data__,i=n(t,e);return i<0?void 0:t[i][1]}},function(e,t,i){var n=i(2),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,i=n(t,e);return!(i<0||(i==t.length-1?t.pop():o.call(t,i,1),--this.size,0))}},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,i){var n=i(48),o=i(47),r=i(46),a=i(45),s=i(44);function l(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=o,l.prototype.get=r,l.prototype.has=a,l.prototype.set=s,e.exports=l},function(e,t,i){var n=i(3);e.exports=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=n&&void 0===t?"__lodash_hash_undefined__":t,this}},function(e,t,i){var n=i(3),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return n?void 0!==t[e]:o.call(t,e)}},function(e,t,i){var n=i(3),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(n){var i=t[e];return"__lodash_hash_undefined__"===i?void 0:i}return o.call(t,e)?t[e]:void 0}},function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t){var i=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return i.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t,i){var n=i(12)["__core-js_shared__"];e.exports=n},function(e,t,i){var n,o=i(56),r=(n=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";e.exports=function(e){return!!r&&r in e}},function(e,t,i){var n=i(9),o=i(57),r=i(8),a=i(55),s=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,d=l.toString,u=c.hasOwnProperty,p=RegExp("^"+d.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!r(e)||o(e))&&(n(e)?p:s).test(a(e))}},function(e,t,i){var n=i(3);e.exports=function(){this.__data__=n?n(null):{},this.size=0}},function(e,t,i){var n=i(59),o=i(53),r=i(52),a=i(51),s=i(50);function l(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=o,l.prototype.get=r,l.prototype.has=a,l.prototype.set=s,e.exports=l},function(e,t,i){var n=i(60),o=i(49),r=i(43);e.exports=function(){this.size=0,this.__data__={hash:new n,map:new(r||o),string:new n}}},function(e,t,i){var n=i(61),o=i(42),r=i(40),a=i(39),s=i(38);function l(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=o,l.prototype.get=r,l.prototype.has=a,l.prototype.set=s,e.exports=l},function(e,t,i){var n=i(62),o="Expected a function";function r(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(o);var i=function(){var n=arguments,o=t?t.apply(this,n):n[0],r=i.cache;if(r.has(o))return r.get(o);var a=e.apply(this,n);return i.cache=r.set(o,a)||r,a};return i.cache=new(r.Cache||n),i}r.Cache=n,e.exports=r},function(e,t,i){var n=i(63);e.exports=function(e){var t=n(e,function(e){return 500===i.size&&i.clear(),e}),i=t.cache;return t}},function(e,t,i){var n=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,r=i(64)(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(n,function(e,i,n,r){t.push(n?r.replace(o,"$1"):i||e)}),t});e.exports=r},function(e,t){var i=Object.prototype.toString;e.exports=function(e){return i.call(e)}},function(e,t,i){var n=i(13),o=Object.prototype,r=o.hasOwnProperty,a=o.toString,s=n?n.toStringTag:void 0;e.exports=function(e){var t=r.call(e,s),i=e[s];try{e[s]=void 0;var n=!0}catch(e){}var o=a.call(e);return n&&(t?e[s]=i:delete e[s]),o}},function(e,t){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t,i){(function(t){var i="object"==typeof t&&t&&t.Object===Object&&t;e.exports=i}).call(this,i(68))},function(e,t,i){var n=i(15),o=i(14),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;e.exports=function(e,t){if(n(e))return!1;var i=typeof e;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=e&&!o(e))||a.test(e)||!r.test(e)||null!=t&&e in Object(t)}},function(e,t,i){var n=i(20),o=i(18);e.exports=function(e,t){for(var i=0,r=(t=n(t,e)).length;null!=e&&i<r;)e=e[o(t[i++])];return i&&i==r?e:void 0}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unset=t.request=t.set=void 0;var n=p(i(5)),o=u(i(34)),r=i(17),a=p(i(0)),s=i(33),l=i(7),c=u(i(21)),d=i(6);function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function p(e){return e&&e.__esModule?e:{default:e}}var h=function(e){var t=e.data,i=t.appId,r=t.intent,c=t.call,u=t.args,p=t.__port;switch(r){case a.default.REQUEST_API:var h=o.getAppById(i),g=h?(0,s.getDescription)(h):null;return p.postMessage(g),Promise.resolve();case a.default.INVOKE_FUNCTION:var m=o.getAppData(i);if(!m){var f=new Error("The API for "+i+" has been removed");return(0,l.sendResponse)(p,a.default.REJECT)((0,d.serialize)(f))}m.onApiCall&&m.onApiCall({appId:i,call:c,args:u});var v=(0,n.default)(m.app,c);return(0,s.invokeApiFunction)(v,u).then((0,l.sendResponse)(p,a.default.RESOLVE),(0,l.sendResponse)(p,a.default.REJECT))}return Promise.resolve()};t.set=function(e,t){var i=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).onApiCall;o.hasApp(e)&&o.unregisterApp(e),o.registerApp(e,t,i),c.addSingleHandler(h)},t.request=function(e){var t=function(e){var t=e.target,i=e.initiator;switch(!0){case(0,r.isWorker)():return{target:self,targetOrigin:"*"};case"undefined"!=typeof parent&&t===parent:return{target:parent,targetOrigin:"*"};case t instanceof Worker:return{target:t};case Boolean(t):return t.contentWindow?{target:t.contentWindow,targetOrigin:t.src}:{target:t,targetOrigin:"*"};case Boolean(i):var n=(0,r.getChildFrameById)(i);return{target:n.contentWindow,targetOrigin:n.src};default:throw new Error("Invalid target")}}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});return(0,l.send)({intent:a.default.REQUEST_API,appId:e},t).then(function(i){return i?(0,s.buildApiFromDescription)(e,i,t):Promise.reject(new Error("App with ID "+e+" not found"))})},t.unset=function(e){o.unregisterApp(e),o.isEmpty()&&c.removeSingleHandler(h)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.api=void 0;var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(i(72));t.api=n}])},66:function(e,t){var i;!function(e){var t=function(){function e(e,t,i,n,o,r,a){var s=this;this.flags=e,this.wizardService=t,this.pagesManager=i,this.platformService=n,this.nodeManipulationService=o,this.sitePartTypes=r,this.tpaService=a,this.platformService.save=function(){return s.wizardService.publishStory(void 0,void 0,!0)},this.platformService.ensureCanEnsurePages=function(){return s.tpaService.ensureCanEnsurePages()},this.platformService.deletePageByNode=function(e){return s.flags.coreCleanLssOnRemove?s.nodeManipulationService.deletePage(e,s.sitePartTypes.BODY,function(e){return s.pagesManager.goToPage(e)}):s.nodeManipulationService.deletePageById(e.id,s.sitePartTypes.BODY,function(e){return s.pagesManager.goToPage(e)})}}return e.$inject=["flags","wizardService","pagesManager","platformService","nodeManipulationService","sitePartTypes","tpaService"],e}();e.PlatformTasks=t}(i||(i={})),angular.module("adiCoreAppInternal").service("platformTasks",i.PlatformTasks)},99:function(e,t,i){var n=i(100).FilterCSS,o=i(62);function r(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","colspan","align","valign"],tfoot:["align","valign"],th:["width","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","loop","preload","src","height","width"]}}var a=new n;function s(e){return e.replace(l,"&lt;").replace(c,"&gt;")}var l=/</g,c=/>/g,d=/"/g,u=/&quot;/g,p=/&#([a-zA-Z0-9]*);?/gim,h=/&colon;?/gim,g=/&newline;?/gim,m=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a)\:/gi,f=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,v=/u\s*r\s*l\s*\(.*/gi;function y(e){return e.replace(d,"&quot;")}function b(e){return e.replace(u,'"')}function S(e){return e.replace(p,function(e,t){return"x"===t[0]||"X"===t[0]?String.fromCharCode(parseInt(t.substr(1),16)):String.fromCharCode(parseInt(t,10))})}function C(e){return e.replace(h,":").replace(g," ")}function w(e){for(var t="",i=0,n=e.length;i<n;i++)t+=e.charCodeAt(i)<32?" ":e.charAt(i);return o.trim(t)}function T(e){return e=w(e=C(e=S(e=b(e))))}function I(e){return e=s(e=y(e))}var x=/<!--[\s\S]*?-->/g;t.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","colspan","align","valign"],tfoot:["align","valign"],th:["width","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","loop","preload","src","height","width"]},t.getDefaultWhiteList=r,t.onTag=function(e,t,i){},t.onIgnoreTag=function(e,t,i){},t.onTagAttr=function(e,t,i){},t.onIgnoreTagAttr=function(e,t,i){},t.safeAttrValue=function(e,t,i,n){if(n=n||a,i=T(i),"href"===t||"src"===t){if("#"===(i=o.trim(i)))return"#";if("http://"!==i.substr(0,7)&&"https://"!==i.substr(0,8)&&"mailto:"!==i.substr(0,7)&&"#"!==i[0]&&"/"!==i[0])return""}else if("background"===t){if(m.lastIndex=0,m.test(i))return""}else if("style"===t){if(f.lastIndex=0,f.test(i))return"";if(v.lastIndex=0,v.test(i)&&(m.lastIndex=0,m.test(i)))return"";i=n.process(i)}return i=I(i)},t.escapeHtml=s,t.escapeQuote=y,t.unescapeQuote=b,t.escapeHtmlEntities=S,t.escapeDangerHtml5Entities=C,t.clearNonPrintableCharacter=w,t.friendlyAttrValue=T,t.escapeAttrValue=I,t.onIgnoreTagStripAll=function(){return""},t.StripTagBody=function(e,t){"function"!=typeof t&&(t=function(){});var i=!Array.isArray(e),n=[],r=!1;return{onIgnoreTag:function(a,s,l){if(function(t){return!!i||-1!==o.indexOf(e,t)}(a)){if(l.isClosing){var c="[/removed]",d=l.position+c.length;return n.push([!1!==r?r:l.position,d]),r=!1,c}return r||(r=l.position),"[removed]"}return t(a,s,l)},remove:function(e){var t="",i=0;return o.forEach(n,function(n){t+=e.slice(i,n[0]),i=n[1]}),t+=e.slice(i)}}},t.stripCommentTag=function(e){return e.replace(x,"")},t.stripBlankChar=function(e){var t=e.split("");return(t=t.filter(function(e){var t=e.charCodeAt(0);return!(127===t||t<=31&&10!==t&&13!==t)})).join("")},t.cssFilter=a}});angular.module("adiCoreAppInternal").service("overlayModel",function(){return AdiCoreSanta.overlayModel}).service("overlayModelLookup",function(){return AdiCoreSanta.overlayModelLookup}).service("overlaySerialize",function(){return AdiCoreSanta.overlaySerialize}).service("modelStore",function(){return AdiCoreSanta.modelStore}).service("modelLookup",function(){return AdiCoreSanta.modelLookup}).service("modelSerialize",function(){return AdiCoreSanta.modelSerialize}).service("masterPageOverlayModel",function(){return AdiCoreSanta.masterPageOverlayModel}).service("componentClasses",function(){return AdiCoreSanta.ComponentClasses}).service("catalog",function(){return AdiCoreSanta.catalog}).service("themeCatalogMapping",function(){return AdiCoreSanta.themeCatalogMapping}).service("nodeFilterTypes",function(){return AdiCoreSanta.nodeFilterTypes}).service("fieldSignature",function(){return AdiCoreSanta.fieldSignature}).service("componentStyles",function(){return AdiCoreSanta.componentStyles}).service("animationPatterns",function(){return AdiCoreSanta.animationPatterns}).service("applicationEvents",function(){return AdiCoreSanta.applicationEvents}).service("newThemeExpander",function(){return AdiCoreSanta.newThemeExpander}).service("newThemesCmsMapping",function(){return AdiCoreSanta.newThemesCmsMapping}).service("themesProvider",function(){return AdiCoreSanta.themesProvider}).service("newKitColorationProperties",function(){return AdiCoreSanta.newKitColorationProperties}).service("selections",function(){return AdiCoreSanta.selections}).service("contentElements",function(){return AdiCoreSanta.contentElements}).service("defaultContent",function(){return AdiCoreSanta.defaultContent}).service("tpaTypes",function(){return AdiCoreSanta.tpaTypes}).service("buttonStyleResolver",function(){return AdiCoreSanta.buttonStyleResolver}).service("catalogStyleFetcher",function(){return AdiCoreSanta.catalogStyleFetcher}).service("componentStyleOverrideSolver",function(){return AdiCoreSanta.componentStyleOverrideSolver}).service("modelRenderGoToEditor",function(){return AdiCoreSanta.modelRenderGoToEditor}).service("modelSiteChanges",function(){return AdiCoreSanta.modelSiteChanges}).service("renderedModelApi",function(){return AdiCoreSanta.renderedModelApi}).service("layoutSelectionStoreSelectionsAdapter",function(){return AdiCoreSanta.layoutSelectionStoreSelectionsAdapter}).service("segmentLayoutElements",function(){return AdiCoreSanta.segmentLayoutElements}).service("sectionBackgroundService",function(){return AdiCoreSanta.sectionBackgroundService}).service("sectionInlineMediaService",function(){return AdiCoreSanta.sectionInlineMediaService}).service("tpaDefinition",function(){return AdiCoreSanta.tpaDefinition}).service("applicationParameters",function(){return AdiCoreSanta.applicationParameters}).service("VerticalDefaultValues",function(){return AdiCoreSanta.verticalDefaultValues}).service("modelTree",function(){return AdiCoreSanta.modelTree}).service("modelStyles",function(){return AdiCoreSanta.modelStyles}).service("siteModelData",function(){return AdiCoreSanta.siteModelData}).service("localizedComponentAttributes",function(){return AdiCoreSanta.localizedComponentAttributes}).service("SkinValidator",function(){return AdiCoreSanta.skinValidator}).service("ComponentBuilder",function(){return AdiCoreSanta.componentBuilder}).service("mobileFonts",function(){return AdiCoreSanta.mobileFonts}).service("sectionDesignOverrideService",function(){return AdiCoreSanta.sectionDesignOverrideService}).service("mediaService",function(){return AdiCoreSanta.mediaService}).service("fontCustomizationRules",function(){return AdiCoreSanta.fontCustomizationRules}).service("fontsNotAllowedCapsStyle",function(){return AdiCoreSanta.fontsNotAllowedCapsStyle}).service("fontsNotAllowedItalicStyle",function(){return AdiCoreSanta.fontsNotAllowedItalicStyle}).service("footerLayouts",function(){return AdiCoreSanta.footerLayouts}).service("mobileFooterLayouts",function(){return AdiCoreSanta.mobileFooterLayouts}).service("santaFontMetadata",function(){return AdiCoreSanta.santaFontMetadata}).service("layoutGroups",function(){return AdiCoreSanta.layoutGroups}).service("sitePartTypes",function(){return AdiCoreSanta.sitePartTypes}).service("solutionStatusCodes",function(){return AdiCoreSanta.solutionStatusCodes}).service("designKitParameters",function(){return AdiCoreSanta.designKitParameters}).service("menuService",function(){return AdiCoreSanta.menuService}).service("mediaOpacity",function(){return AdiCoreSanta.mediaOpacity}).service("rendererSeo",function(){return AdiCoreSanta.rendererSeo}).service("richTextLinks",function(){return AdiCoreSanta.richTextLinks}).service("tpaStyleService",function(){return AdiCoreSanta.tpaStyleService}).service("setTpaContentService",function(){return AdiCoreSanta.setTpaContentService}).service("componentExtraStyling",function(){return AdiCoreSanta.componentExtraStyling}).service("RichTextTags",function(){return AdiCoreSanta.RichTextTags}).service("slideshowAnimationParameters",function(){return AdiCoreSanta.slideshowAnimationParameters}).service("themeChooserParameters",function(){return AdiCoreSanta.themeChooserParameters}).service("animationGenerator",function(){return AdiCoreSanta.animationGenerator}).service("animationKitPreview",function(){return AdiCoreSanta.animationKitPreview}).service("animationKit",function(){return AdiCoreSanta.animationKit}).service("masterPageActions",function(){return AdiCoreSanta.masterPageActions}).service("tpaNodeManipulationService",function(){return AdiCoreSanta.tpaNodeManipulationService}).service("lssModifier",function(){return AdiCoreSanta.lssModifier}).service("ContentElement",function(){return AdiCoreSanta.ContentElement}).service("TreeNode",function(){return AdiCoreSanta.TreeNode}).service("richTextUtils",function(){return AdiCoreSanta.richTextUtils}).service("addBlogService",function(){return AdiCoreSanta.addBlogService}).service("linkBuilder",function(){return AdiCoreSanta.linkBuilder}).service("socialLinkManager",function(){return AdiCoreSanta.socialLinkManager}).service("validationCache",function(){return AdiCoreSanta.validationCache}).service("tpaSolutionManager",function(){return AdiCoreSanta.tpaSolutionManager}).service("referenceFields",function(){return AdiCoreSanta.referenceFields}).service("SmartLayoutRuleUtils",function(){return AdiCoreSanta.smartLayoutRuleUtils}).service("contentNormalizer",function(){return AdiCoreSanta.contentNormalizer}).service("SmartLayoutRuleNode",function(){return AdiCoreSanta.SmartLayoutRuleNode}).service("fontSizeCalculationUtils",function(){return AdiCoreSanta.fontSizeCalculationUtils}).service("mediaUpscale",function(){return AdiCoreSanta.mediaUpscale}).service("pagesManager",function(){return AdiCoreSanta.pagesManager}).service("mediaOverrideMixins",function(){return AdiCoreSanta.mediaOverrideMixins}).service("sizeRuleValidationErrorFormatters",function(){return AdiCoreSanta.sizeRuleValidationErrorFormatters}).service("sizeRuleValidationArgumentMakers",function(){return AdiCoreSanta.sizeRuleValidationArgumentMakers}).service("galleryBgPropertiesOverrides",function(){return AdiCoreSanta.galleryBgPropertiesOverrides}).service("galleryDefinition",function(){return AdiCoreSanta.galleryDefinition}).service("sizeRuleValidators",function(){return AdiCoreSanta.sizeRuleValidators}).service("medParameters",function(){return AdiCoreSanta.medParameters}).service("BoxMargins",function(){return AdiCoreSanta.BoxMargins}).service("OnMediaSize",function(){return AdiCoreSanta.OnMediaSize}).service("BoxDecorationData",function(){return AdiCoreSanta.BoxDecorationData}).service("LineDecorationData",function(){return AdiCoreSanta.LineDecorationData}).service("BoxDecorationTypes",function(){return AdiCoreSanta.BoxDecorationTypes}).service("BoxDecorationRules",function(){return AdiCoreSanta.BoxDecorationRules}).service("LayoutDecorationUtils",function(){return AdiCoreSanta.layoutDecorationUtils}).service("LayoutElementFormatting",function(){return AdiCoreSanta.LayoutElementFormatting}).service("PresetMediaType",function(){return AdiCoreSanta.PresetMediaType}).service("MediaPreferences",function(){return AdiCoreSanta.MediaPreferences}).service("LayoutSelectionStore",function(){return AdiCoreSanta.LayoutSelectionStore}).service("createLgDataColumnsDefaults",function(){return AdiCoreSanta.createLgDataColumnsDefaults}).service("layoutSelectionStoreProvider",function(){return AdiCoreSanta.layoutSelectionStoreProvider}).service("clusters",function(){return AdiCoreSanta.clusters}).service("GraphEdges",function(){return AdiCoreSanta.GraphEdges}).service("LayoutGraph",function(){return AdiCoreSanta.LayoutGraph}).service("LayoutUtils",function(){return AdiCoreSanta.layoutUtils}).service("ContactGenerator",function(){return AdiCoreSanta.contactGenerator}).service("generatorHelper",function(){return AdiCoreSanta.generatorHelper}).service("MobileDesignPolicyPlane",function(){return AdiCoreSanta.mobileDesignPolicyPlane}).service("mergedHeaderMergeableChecker",function(){return AdiCoreSanta.mergedHeaderMergeableChecker}).service("designPolicyButton",function(){return AdiCoreSanta.designPolicyButton}).service("DesignPolicyDefaultRules",function(){return AdiCoreSanta.DesignPolicyDefaultRules}).service("DesignPolicyDefaultPlanes",function(){return AdiCoreSanta.designPolicyDefaultPlanes}).service("DesignPolicyPlanes",function(){return AdiCoreSanta.designPolicyPlanes}).service("designPolicyHelper",function(){return AdiCoreSanta.designPolicyHelper}).service("designPolicyService",function(){return AdiCoreSanta.designPolicyService}).service("designPolicyRules",function(){return AdiCoreSanta.designPolicyRules}).service("DesignPolicy",function(){return AdiCoreSanta.DesignPolicyClass}).service("designKitMobile",function(){return AdiCoreSanta.designKitMobile}).service("designKitStrips",function(){return AdiCoreSanta.designKitStrips}).service("userOverrides",function(){return AdiCoreSanta.userOverrides}).service("cropFaceService",function(){return AdiCoreSanta.cropFaceService}).service("mediaOverride",function(){return AdiCoreSanta.mediaOverride}).service("prettyLayoutService",function(){return AdiCoreSanta.prettyLayoutService}).service("sectionHeightService",function(){return AdiCoreSanta.sectionHeightService}).service("simpleSolutionRules",function(){return AdiCoreSanta.simpleSolutionRules}).service("fixedHeaderService",function(){return AdiCoreSanta.fixedHeaderService}).service("Solution",function(){return AdiCoreSanta.Solution}).service("heightMutations",function(){return AdiCoreSanta.heightMutations}).service("backgroundScrollService",function(){return AdiCoreSanta.backgroundScrollService}).service("slideShowService",function(){return AdiCoreSanta.slideShowService}).service("columnsCompatibilityService",function(){return AdiCoreSanta.columnsCompatibilityService}).service("columnService",function(){return AdiCoreSanta.columnService}).service("fontCustomizationService",function(){return AdiCoreSanta.fontCustomizationService}).service("solutionManager",function(){return AdiCoreSanta.solutionManager}).service("componentAttributesBuilder",function(){return AdiCoreSanta.componentAttributesBuilder}).service("mobileSolutionValidator",function(){return AdiCoreSanta.mobileSolutionValidator}).service("mobileSolutionManager",function(){return AdiCoreSanta.mobileSolutionManager}).service("mergedHeaderService",function(){return AdiCoreSanta.mergedHeaderService}).service("colorConfigurationBuilder",function(){return AdiCoreSanta.colorConfigurationBuilder}).service("themeChooserUtils",function(){return AdiCoreSanta.themeChooserUtils}).service("DSHealthCheck",function(){return AdiCoreSanta.dsHealthCheck}).service("patternService",function(){return AdiCoreSanta.patternService}).service("componentElementCreator",function(){return AdiCoreSanta.componentElementCreator}).service("layoutDecoration",function(){return AdiCoreSanta.layoutDecoration}).service("headerLayouts",function(){return AdiCoreSanta.headerLayouts}).service("mobileHeaderLayouts",function(){return AdiCoreSanta.mobileHeaderLayouts}).service("simpleSolutionManager",function(){return AdiCoreSanta.simpleSolutionManager}).service("layoutPresetHelperService",function(){return AdiCoreSanta.layoutPresetHelperService}).service("dataFlags",function(){return AdiCoreSanta.dataFlags}).service("designPolicies",function(){return AdiCoreSanta.designPolicies}).service("StoryLocale",function(){return AdiCoreSanta.StoryLocale}).service("Story",function(){return AdiCoreSanta.Story}).service("spinnerService",function(){return AdiCoreSanta.spinnerService}).service("solutionSantaMediator",function(){return AdiCoreSanta.solutionSantaMediator}).service("nodeManipulationService",function(){return AdiCoreSanta.nodeManipulationService}).service("renderedMediaLayout",function(){return AdiCoreSanta.renderedMediaLayout}).service("tpaUrlBuilder",function(){return AdiCoreSanta.tpaUrlBuilder}).service("presetLogs",function(){return AdiCoreSanta.presetLogs}).service("SitePartSolutions",function(){return AdiCoreSanta.SitePartSolutions}).service("videoProvidersUtils",function(){return AdiCoreSanta.videoProvidersUtils}).service("mobileSectionValidator",function(){return AdiCoreSanta.mobileSectionValidator}),function(e){var t=e._||n(0),i=/\+/g,o=/(?:([^\[]+))|(?:\[(.*?)\])/g,r=function(e){return decodeURIComponent(e.replace(i,"%20"))},a=function(e,i,n){return t.isUndefined(n)&&(n=!0),t.isArray(i)?t.map(i,function(t,i){return a(n?i:e+"[]",t,!1)}).join("&"):t.isObject(i)?t.map(i,function(t,i){return a(n?i:e+"["+i+"]",t,!1)}).join("&"):encodeURIComponent(e)+"="+encodeURIComponent(i)},s={"\n":"<br />","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},l=/[&<>"'\/\n]/g;t.mixin({explode:function(e){return e.split("")},fromQuery:function(e){var i,n,a,s,l,c=e.split("&"),d={};return t.each(c,function(e){for(e=e.split("="),i=r(e[0]),a=i,l=d,o.lastIndex=0;null!==(n=o.exec(i));)t.isUndefined(n[1])?(s=n[2],l[a]=l[a]||(s?{}:[]),l=l[a]):s=n[1],a=s||t.size(l);l[a]=r(e[1])}),d},implode:function(e){return e.join("")},camelCase:function(e){return e.replace(/[-_\s](\w)/g,function(e){return e[1].toUpperCase()})},toDash:function(e){return"-"==(e=e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})).charAt(0)?e.substr(1):e},snakeCase:function(e){return"_"==(e=e.replace(/([A-Z])/g,function(e){return"_"+e.toLowerCase()})).charAt(0)?e.substr(1):e},toQuery:function(e){return a("",e)},strContains:function(e,t){if("string"!=typeof e)throw new TypeError;return-1!=e.indexOf(t)},capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},titleCase:function(e){return e.replace(/(\b.)/g,function(e){return e.toUpperCase()})},slugify:function(e){return e.replace(/ /g,"-").replace(/\./,"").toLowerCase()},regexEscape:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},humanize:function(e){return t.capitalize(e.replace(/_/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/\b([A-Z]+)([A-Z])([a-z])/,"$1 $2$3"))},stripTags:function(e){return e.replace(/<\/?[^<>]*>/gi,"")},htmlEncode:function(e){return e&&e.replace(l,function(e){return s[e]||e})},extractPlainText:function(e){if(!e)return e;var i=document.createElement("div");return i.innerHTML=t.filterHtmlString(e),(i.textContent||"").replace(/\n\s+/g,"\n").replace(/[\u200B-\u200D\uFEFF]/g,"").trim()}})}(this),function(e){function t(t,i){var n=[],o=Promise.resolve();return e.each(t,function(e,t){o=o.then(function(o){return n.push(o),i(e,t)})}),o.then(function(e){return n.push(e),n.slice(1)})}function i(t,i){if(!Array.isArray(t))throw new Error("passed a non-array to _.strictSumBy");return i=e.iteratee(i),e.sumBy(t,function(e){if("number"!=typeof(e=i(e)))throw new Error("iteratee returned a non-number: "+e);return e})}e.mixin({strictSumBy:i,strictAdd:function(e,t){return i([e,t])},strictMaxBy:function(t,i){if(!Array.isArray(t))throw new Error("passed a non-array to _.strictMaxBy");if(t.length>0)return i=e.iteratee(i),e.maxBy(t,function(e){if("number"!=typeof(e=i(e)))throw new Error("iteratee returned a non-number: "+e);return e});throw new Error("passed empty array to _.strictMaxBy")},strictMinBy:function(t,i){if(!Array.isArray(t))throw new Error("passed a non-array to _.strictMinBy");if(t.length>0)return i=e.iteratee(i),e.minBy(t,function(e){if("number"!=typeof(e=i(e)))throw new Error("iteratee returned a non-number: "+e);return e});throw new Error("passed empty array to _.strictMinBy")},sequencePromises:t,filterPromises:function(t,i){return e.sequencePromises(t,i).then(function(i){return e.filter(t,function(e,t){return i[t]})})},matchPromises:function(t,i,n){n=void 0!==n?n:Boolean;var o=Promise.resolve();return e.each(t,function(e,t){o=o.then(function(o){return n(o)?o:i(e,t)})}),o=o.then(function(e){if(n(e))return e})},allPromises:function(t,i){var n=Promise.resolve(!0);return e.each(t,function(e,t){n=n.then(function(n){return!!n&&i(e,t)})}),n.then(function(e){return!!e})},anyPromises:function(t,i){var n=Promise.resolve(!1);return e.each(t,function(e,t){n=n.then(function(n){return!!n||i(e,t)})}),n},collectPromises:function(t,i){var n=e.map(t,i);return Promise.all(n)},whilePromises:function(e,t){return new Promise(function(i,n){var o=function(r){return e(r)?Promise.cast(t()).then(o,n):i(r)};return o()})},sequencePromisesThenAll:function(i,n){return t(i,n).then(e.every)}})}(_),function(e){e.mixin({setObject:function(t,i,n){for(var o=-1,r=(i=function(t){return e.isArray(t)?t:t.split(".")}(i)).length,a=r-1,s=t;void 0!==s&&++o<r;){var l=i[o];e.isObject(s)&&(o===a?s[l]=n:void 0===s[l]&&(s[l]={})),s=s[l]}return t}})}(_),function(e,t){e.Cropper=t()}(window,function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}return i.m=e,i.c=t,i.p="",i(0)}([function(e,t,i){e.exports=i(1)},function(e,t,i){var n=i(2),o=i(4);e.exports={create:function(e,t,i){var r=new n(e,t,i);return new o(r)},Cropper:n,CropperUI:o}},function(e,t,i){function n(e,t){var i=e.width/e.height;return(e=angular.copy(e)).height=t.height*r.maxAdjustedZoom,e.width=i*e.height,e}var o=i(3);function r(e,t,i){if(!(this instanceof r))return new r(e,t,i);this.originalImgData=e,e=n(e,t),i=i||r.getAutoCropArea(e,t),this.imgData=e,this.viewport={top:t.top,left:t.left,width:t.width,height:t.height},this.cropData={x:i.x,y:i.y,w:i.w,h:i.h},this.state={x:0,y:0,width:0,height:0},this.setCrop(i.x,i.y,i.w,i.h)}r.maxAdjustedZoom=10,r.getSmartCropArea=function(e,t,i){o.crop(e,{width:t.width,height:t.height},function(e){i(e)})},r.getAutoCropArea=function(e,t){var i,n,o,r=t.width/t.height;e.width,e.height;return t.width/e.width>t.height/e.height?(o=e.width,n=e.width/r,i={x:0,y:(e.height-n)/2,w:o,h:n}):(o=e.height*r,n=e.height,i={x:(e.width-o)/2,y:0,w:o,h:n}),i},r.prototype.setSmartCrop=function(e){var t=this,i=new Image;i.onload=function(){r.getSmartCropArea(i,t.viewport,function(i){var n=i.topCrop;t.setCrop(n.x,n.y,n.width,n.height),e&&e()})},i.src=this.imgData.uri,i.src&&-1===i.src.indexOf("?")&&(i.src=i.src+"?"+(new Date).getTime(),i.setAttribute("crossOrigin","anonymous"))},r.prototype.getMaxZoomRatio=function(e){var t=this.viewport.width/this.imgData.width,i=this.viewport.height/this.imgData.height;return Math.max(t,i)},r.prototype.setUnadjustedCrop=function(e,t,i,n){var o=this.originalImgData.height/(this.viewport.height*r.maxAdjustedZoom);this.setCrop(e/o,t/o,i/o,n/o)},r.prototype.getUnadjustedCropData=function(e){var t=this.getCropData(),i=this.originalImgData.height/(this.viewport.height*r.maxAdjustedZoom);return{x:i*t.x,y:i*t.y,w:i*t.w,h:i*t.h}},r.prototype.getCropData=function(e){return{x:this.cropData.x,y:this.cropData.y,w:this.cropData.w,h:this.cropData.h}},r.prototype.getZoom=function(){var e=this.getMaxZoomRatio();return(this.state.width/this.imgData.width-e)/(1-e)},r.prototype.setZoom=function(e){var t=this.getMaxZoomRatio();e=t+e*(1-t);var i=this.state.width/this.imgData.width;i=1/i;var n=1*this.cropData.w/i,o=1*this.cropData.h/i,r=1*n/e,a=1*o/e,s=this.cropData.x-(n-this.cropData.w)/2-(r-n)/2,l=this.cropData.y-(o-this.cropData.h)/2-(a-o)/2;this.setCrop(s,l,r,a)},r.prototype.setViewport=function(e,t){var i,n=this.viewport;this.viewport={top:e.top,left:e.left,width:e.width,height:e.height},t?i=r.getAutoCropArea(this.imgData,e):((i=this.cropData).w=i.w*(e.width/n.width),i.h=i.h*(e.height/n.height)),this.setCrop(i.x,i.y,i.w,i.h)},r.prototype.setImgData=function(e){this.originalImgData=e,this.imgData=n(e,this.viewport),this.setCrop(this.cropData.x,this.cropData.y,this.cropData.w,this.cropData.h)},r.prototype.setCrop=function(e,t,i,n){this.imgData.width,this.imgData.height;var o=this.viewport.width/this.viewport.height;o!==i/n&&(this.viewport.width>this.viewport.height?n=i/o:i=n*o),i<this.viewport.width&&(n=(i=this.viewport.width)/o),i>this.imgData.width&&(n=(i=this.imgData.width)/o),n<this.viewport.height&&(i=(n=this.viewport.height)*o),n>this.imgData.height&&(i=(n=this.imgData.height)*o),e=Math.max(Math.min(e,this.imgData.width-i),0),t=Math.max(Math.min(t,this.imgData.height-n),0);var r=this.viewport.width/i,a=this.viewport.height/n,s=e+i/2,l=t+n/2,c=this.viewport.left+this.viewport.width/2,d=this.viewport.top+this.viewport.height/2,u=s*r+this.viewport.left,p=l*a+this.viewport.top;this.cropData.x=e,this.cropData.y=t,this.cropData.w=i,this.cropData.h=n,this.state.width=this.imgData.width*r,this.state.height=this.imgData.height*a,this.state.x=c-u,this.state.y=d-p},e.exports=r},function(e,t){var i=function(){"use strict";function e(t){this.options=function(e){for(var t=1,i=arguments.length;t<i;t++){var n=arguments[t];if(n)for(var o in n)e[o]=n[o]}return e}({},e.DEFAULTS,t)}e.DEFAULTS={width:0,height:0,aspect:0,cropWidth:0,cropHeight:0,detailWeight:.2,skinColor:[.78,.57,.44],skinBias:.01,skinBrightnessMin:.2,skinBrightnessMax:1,skinThreshold:.8,skinWeight:1.8,saturationBrightnessMin:.05,saturationBrightnessMax:.9,saturationThreshold:.4,saturationBias:.2,saturationWeight:.3,scoreDownSample:8,step:8,scaleStep:.1,minScale:.9,maxScale:1,edgeRadius:.4,edgeWeight:-20,outsideImportance:-.5,ruleOfThirds:!0,prescale:!0,canvasFactory:null,debug:!1},e.crop=function(n,o,r){if(o.aspect&&(o.width=o.aspect,o.height=1),n.naturalWidth&&(n.naturalWidth!=n.width||n.naturalHeight!=n.height)){var a=new e(o).canvas(n.naturalWidth,n.naturalHeight),s=a.getContext("2d");a.width=n.naturalWidth,a.height=n.naturalHeight,s.drawImage(n,0,0),n=a}var l=1,c=1;o.width&&o.height&&(l=t(n.width/o.width,n.height/o.height),o.cropWidth=~~(o.width*l),o.cropHeight=~~(o.height*l),o.minScale=t(o.maxScale||e.DEFAULTS.maxScale,i(1/l,o.minScale||e.DEFAULTS.minScale)));var d=new e(o);if(o.width&&o.height&&!1!==o.prescale)if((c=1/l/o.minScale)<1){var u=d.canvas(n.width*c,n.height*c);u.getContext("2d").drawImage(n,0,0,n.width,n.height,0,0,u.width,u.height),n=u,d.options.cropWidth=~~(o.cropWidth*c),d.options.cropHeight=~~(o.cropHeight*c)}else c=1;for(var p=d.analyse(n),h=0,g=p.crops.length;h<g;h++){var m=p.crops[h];m.x=~~(m.x/c),m.y=~~(m.y/c),m.width=~~(m.width/c),m.height=~~(m.height/c)}return r(p),p},e.isAvailable=function(e){try{return"function"==typeof new this(e).canvas(16,16).getContext}catch(e){return!1}},e.prototype={canvas:function(e,t){if(null!==this.options.canvasFactory)return this.options.canvasFactory(e,t);var i=document.createElement("canvas");return i.width=e,i.height=t,i},edgeDetect:function(e,t){for(var i=e.data,n=t.data,o=e.width,r=e.height,a=0;a<r;a++)for(var s=0;s<o;s++){var c,d=4*(a*o+s);c=0===s||s>=o-1||0===a||a>=r-1?l(i,d):4*l(i,d)-l(i,d-4*o)-l(i,d-4)-l(i,d+4)-l(i,d+4*o),n[d+1]=c}},skinDetect:function(e,t){for(var i=e.data,n=t.data,o=e.width,r=e.height,a=this.options,l=0;l<r;l++)for(var c=0;c<o;c++){var d=4*(l*o+c),u=s(i[d],i[d+1],i[d+2])/255,p=this.skinColor(i[d],i[d+1],i[d+2]);p>a.skinThreshold&&u>=a.skinBrightnessMin&&u<=a.skinBrightnessMax?n[d]=(p-a.skinThreshold)*(255/(1-a.skinThreshold)):n[d]=0}},saturationDetect:function(e,t){for(var i=e.data,n=t.data,o=e.width,r=e.height,a=this.options,l=0;l<r;l++)for(var d=0;d<o;d++){var u=4*(l*o+d),p=s(i[u],i[u+1],i[u+2])/255,h=c(i[u],i[u+1],i[u+2]);h>a.saturationThreshold&&p>=a.saturationBrightnessMin&&p<=a.saturationBrightnessMax?n[u+2]=(h-a.saturationThreshold)*(255/(1-a.saturationThreshold)):n[u+2]=0}},crops:function(e){for(var i=[],n=e.width,o=e.height,r=this.options,a=t(n,o),s=r.cropWidth||a,l=r.cropHeight||a,c=r.maxScale;c>=r.minScale;c-=r.scaleStep)for(var d=0;d+l*c<=o;d+=r.step)for(var u=0;u+s*c<=n;u+=r.step)i.push({x:u,y:d,width:s*c,height:l*c});return i},score:function(e,t){for(var i={detail:0,saturation:0,skin:0,total:0},n=this.options,o=e.data,r=n.scoreDownSample,a=1/r,s=e.height*r,l=e.width*r,c=e.width,d=0;d<s;d+=r)for(var u=0;u<l;u+=r){var p=4*(~~(d*a)*c+~~(u*a)),h=this.importance(t,u,d),g=o[p+1]/255;i.skin+=o[p]/255*(g+n.skinBias)*h,i.detail+=g*h,i.saturation+=o[p+2]/255*(g+n.saturationBias)*h}return i.total=(i.detail*n.detailWeight+i.skin*n.skinWeight+i.saturation*n.saturationWeight)/t.width/t.height,i},importance:function(e,t,i){var o=this.options;if(e.x>t||t>=e.x+e.width||e.y>i||i>=e.y+e.height)return o.outsideImportance;t=(t-e.x)/e.width,i=(i-e.y)/e.height;var s=2*n(.5-t),l=2*n(.5-i),c=Math.max(s-1+o.edgeRadius,0),d=Math.max(l-1+o.edgeRadius,0),u=(c*c+d*d)*o.edgeWeight,p=1.41-r(s*s+l*l);return o.ruleOfThirds&&(p+=1.2*Math.max(0,p+u+.5)*(a(s)+a(l))),p+u},skinColor:function(e,t,i){var n=r(e*e+t*t+i*i),o=this.options,a=e/n-o.skinColor[0],s=t/n-o.skinColor[1],l=i/n-o.skinColor[2];return 1-r(a*a+s*s+l*l)},analyse:function(e){var t={},i=this.options,n=this.canvas(e.width,e.height),r=n.getContext("2d");r.drawImage(e,0,0);var a=r.getImageData(0,0,n.width,n.height),s=r.getImageData(0,0,n.width,n.height);this.edgeDetect(a,s),this.skinDetect(a,s),this.saturationDetect(a,s);var l=this.canvas(o(e.width/i.scoreDownSample),o(e.height/i.scoreDownSample)),c=l.getContext("2d");r.putImageData(s,0,0),c.drawImage(n,0,0,n.width,n.height,0,0,l.width,l.height);for(var d=c.getImageData(0,0,l.width,l.height),u=-1/0,p=null,h=this.crops(e),g=0,m=h.length;g<m;g++){var f=h[g];f.score=this.score(d,f),f.score.total>u&&(p=f,u=f.score.total)}if(t.crops=h,t.topCrop=p,i.debug&&p){r.fillStyle="rgba(255, 0, 0, 0.1)",r.fillRect(p.x,p.y,p.width,p.height);for(var v=0;v<s.height;v++)for(var y=0;y<s.width;y++){var b=4*(v*s.width+y),S=this.importance(p,y,v);S>0&&(s.data[b+1]+=32*S),S<0&&(s.data[b]+=-64*S),s.data[b+3]=255}r.putImageData(s,0,0),r.strokeStyle="rgba(255, 0, 0, 0.8)",r.strokeRect(p.x,p.y,p.width,p.height),t.debugCanvas=n}return t}};var t=Math.min,i=Math.max,n=Math.abs,o=Math.ceil,r=Math.sqrt;function a(e){return e=16*((e-1/3+1)%2*.5-.5),Math.max(1-e*e,0)}function s(e,t,i){return.5126*i+.7152*t+.0722*e}function l(e,t){return s(e[t],e[t+1],e[t+2])}function c(e,n,o){var r=i(e/255,n/255,o/255),a=t(e/255,n/255,o/255);if(r===a)return 0;var s=r-a;return(r+a)/2>.5?s/(2-r-a):s/(r+a)}return e}();e.exports=i},function(e,t,i){i(5);var n=i(9);function o(e){this.modal=!0,this.cropper=e,this.unbindEvents=null,this.updating=!1,this.updateDOM=this.updateDOM.bind(this),this.update=this.update.bind(this),this.intialUpdate=!0,this.markup(),this.bindEvents(),this.update()}o.prototype.update=function(e){this.updating||(this.updating=!0,this.intialUpdate||e?this.updateDOM():setTimeout(this.updateDOM,1e3/24))},o.prototype.updateDOM=function(){var e=this.cropper;this.updating=!1,this.intialUpdate=!1,this.$outlineContainer.style.top=e.state.y+e.viewport.top+"px",this.$outlineContainer.style.left=e.state.x+e.viewport.left+"px",this.$outlineContainer.style.width=e.state.width+"px",this.$outlineContainer.style.height=e.state.height+"px",this.$contentImg.style.top=e.state.y+"px",this.$contentImg.style.left=e.state.x+"px",this.$contentImg.style.width=e.state.width+"px",this.$contentImg.style.height=e.state.height+"px",this.$contentContainer.style.top=this.cropper.viewport.top+"px",this.$contentContainer.style.left=this.cropper.viewport.left+"px",this.$contentContainer.style.width=this.cropper.viewport.width+"px",this.$contentContainer.style.height=this.cropper.viewport.height+"px",this.$contentImg.getAttribute("src")!==this.cropper.imgData.uri&&(this.$contentImg.setAttribute("src",this.cropper.imgData.uri),this.$outlineImg.setAttribute("src",this.cropper.imgData.uri)),this.onUpdate&&this.onUpdate()},o.prototype.markup=function(){this.$root=document.createElement("div"),this.$root.className="cropper-tool",this.$overlay=document.createElement("div"),this.$overlay.className="cropper-tool-overlay",this.modal&&this.$root.appendChild(this.$overlay),this.$contentImg=document.createElement("img"),this.$contentImg.className="cropper-tool-content-image",this.$contentImg.src=this.cropper.imgData.uri,this.$contentImg.style.position="absolute",this.$contentContainer=document.createElement("div"),this.$contentContainer.className="cropper-tool-content-container",this.$contentContainer.appendChild(this.$contentImg),this.$contentContainer.style.position="absolute",this.$contentContainer.style.overflow="hidden",this.$outlineContainer=document.createElement("div"),this.$outlineContainer.className="cropper-tool-outline-container",this.$outlineContainer.style.position="absolute",this.$outlineImg=document.createElement("img"),this.$outlineImg.className="cropper-tool-outline-image",this.$outlineImg.src=this.cropper.imgData.uri,this.$outlineImg.style.width="100%",this.$outlineImg.style.height="100%",this.$outlineContainer.appendChild(this.$outlineImg),this.$root.appendChild(this.$outlineContainer),this.$root.appendChild(this.$contentContainer)},o.prototype.bindEvents=function(){var e=this,t=this.cropper;function i(i){i.stopPropagation();var n=t.getZoom();t.setZoom(Math.min(Math.max(i.deltaY<0?n+.1:n-.1,0),1)),e.update()}var o=n(this.$outlineContainer,i,!1),r=n(this.$contentContainer,i,!1),a=this.$root,s=!1,l=1,c=1,d={},u={},p=function(i){i.target!==e.$overlay&&(i.preventDefault(),s=!0,l=t.cropData.w/t.viewport.width,c=t.cropData.h/t.viewport.height,u.x=t.cropData.x,u.y=t.cropData.y,d.x=i.clientX,d.y=i.clientY)},h=function(i){if(s){i.preventDefault(),s=!1;var n=l*(d.x-i.clientX),o=c*(d.y-i.clientY);t.setCrop(u.x+n,u.y+o,t.cropData.w,t.cropData.h),e.update()}},g=function(i){if(s){i.preventDefault();var n=l*(d.x-i.clientX),o=c*(d.y-i.clientY);t.setCrop(u.x+n,u.y+o,t.cropData.w,t.cropData.h),e.update()}};a.addEventListener("mousedown",p,!1),window.addEventListener("mouseup",h,!1),window.addEventListener("mousemove",g,!1),this.unbindEvents=function(){o(),r(),a.removeEventListener("mousedown",p,!1),window.removeEventListener("mouseup",h,!1),window.removeEventListener("mousemove",g,!1)}},o.prototype.destroy=function(){this.$root.parentNode&&this.$root.parentNode.removeChild(this.$root),this.unbindEvents&&this.unbindEvents()},e.exports=o},function(e,t,i){var n=i(6);"string"==typeof n&&(n=[[e.id,n,""]]);i(8)(n,{});n.locals&&(e.exports=n.locals)},function(e,t,i){(e.exports=i(7)()).push([e.id,".cropper-tool-outline-image{\n\topacity: 0.2;\t\n}\n\n.cropper-tool-outline-container,\n.cropper-tool-content-container\n{\n  outline: 1px solid rgba(0,0,0,1);\n}\n.cropper-tool-overlay{\n\tbackground: rgba(0,0,0,0.8);\n\tposition: fixed;\n\twidth: 110%;\n\theight: 110%;\n\tmargin: -5% 0 0 -5%;\n}\n\n.cropper-tool-controls{\n\tz-index: 1;\n\tposition: fixed;\n}",""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var i=this[t];i[2]?e.push("@media "+i[2]+"{"+i[1]+"}"):e.push(i[1])}return e.join("")},e.i=function(t,i){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},o=0;o<this.length;o++){var r=this[o][0];"number"==typeof r&&(n[r]=!0)}for(o=0;o<t.length;o++){var a=t[o];"number"==typeof a[0]&&n[a[0]]||(i&&!a[2]?a[2]=i:i&&(a[2]="("+a[2]+") and ("+i+")"),e.push(a))}},e}},function(e,t,i){var n={},o=function(e){var t;return function(){return void 0===t&&(t=e.apply(this,arguments)),t}},r=o(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),a=o(function(){return document.head||document.getElementsByTagName("head")[0]}),s=null,l=0,c=[];function d(e,t){for(var i=0;i<e.length;i++){var o=e[i],r=n[o.id];if(r){r.refs++;for(var a=0;a<r.parts.length;a++)r.parts[a](o.parts[a]);for(;a<o.parts.length;a++)r.parts.push(m(o.parts[a],t))}else{var s=[];for(a=0;a<o.parts.length;a++)s.push(m(o.parts[a],t));n[o.id]={id:o.id,refs:1,parts:s}}}}function u(e){for(var t=[],i={},n=0;n<e.length;n++){var o=e[n],r=o[0],a={css:o[1],media:o[2],sourceMap:o[3]};i[r]?i[r].parts.push(a):t.push(i[r]={id:r,parts:[a]})}return t}function p(e,t){var i=a(),n=c[c.length-1];if("top"===e.insertAt)n?n.nextSibling?i.insertBefore(t,n.nextSibling):i.appendChild(t):i.insertBefore(t,i.firstChild),c.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");i.appendChild(t)}}function h(e){e.parentNode.removeChild(e);var t=c.indexOf(e);t>=0&&c.splice(t,1)}function g(e){var t=document.createElement("style");return t.type="text/css",p(e,t),t}function m(e,t){var i,n,o;if(t.singleton){var r=l++;i=s||(s=g(t)),n=v.bind(null,i,r,!1),o=v.bind(null,i,r,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(e){var t=document.createElement("link");return t.rel="stylesheet",p(e,t),t}(t),n=function(e,t){var i=t.css;t.media;t.sourceMap&&(i+="\n");var n=new Blob([i],{type:"text/css"}),o=e.href;e.href=URL.createObjectURL(n),o&&URL.revokeObjectURL(o)}.bind(null,i),o=function(){h(i),i.href&&URL.revokeObjectURL(i.href)}):(i=g(t),n=function(e,t){var i=t.css,n=t.media;t.sourceMap;n&&e.setAttribute("media",n);if(e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}.bind(null,i),o=function(){h(i)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else o()}}e.exports=function(e,t){void 0===(t=t||{}).singleton&&(t.singleton=r()),void 0===t.insertAt&&(t.insertAt="bottom");var i=u(e);return d(i,t),function(e){for(var o=[],r=0;r<i.length;r++){var a=i[r];(s=n[a.id]).refs--,o.push(s)}e&&d(u(e),t);for(r=0;r<o.length;r++){var s;if(0===(s=o[r]).refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete n[s.id]}}}};var f=function(){var e=[];return function(t,i){return e[t]=i,e.filter(Boolean).join("\n")}}();function v(e,t,i,n){var o=i?"":n.css;if(e.styleSheet)e.styleSheet.cssText=f(t,o);else{var r=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(r,a[t]):e.appendChild(r)}}},function(e,t){var i=function(e,t){var i,n,o,r="";return e.addEventListener?(i="addEventListener",n="removeEventListener"):(i="attachEvent",n="detachEvent",r="on"),o="onwheel"in t.createElement("div")?"wheel":void 0!==t.onmousewheel?"mousewheel":"DOMMouseScroll",function(t,a,s){return function(t,a,s,l){var c=function(t){!t&&(t=e.event);var i={originalEvent:t,target:t.target||t.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==t.type?0:1,deltaX:0,deltaZ:0,preventDefault:function(){t.preventDefault?t.preventDefault():t.returnValue=!1}};return"mousewheel"==o?(i.deltaY=-.025*t.wheelDelta,t.wheelDeltaX&&(i.deltaX=-.025*t.wheelDeltaX)):i.deltaY=t.detail,s(i)};return t[i](r+a,"wheel"==o?s:c,l||!1),function(){t[n](r+a,"wheel"==o?s:c,l||!1)}}(t,o,a,s)}}(window,document);e.exports=i}])});var o=function(){function e(){}return e.prototype.logColors=function(e,t,i,n){var o,r=_.fill(new Array(i.length),"%c  ").join(""),a=i.map(function(e){return"background-color: "+e+"; font-size: 20px; border: solid #e0e3e5; border-width: 1px 0;"});a[0]+=" border-left-width: 1px;",a[a.length-1]+=" border-right-width: 1px;",(o=n[e]).call.apply(o,[n,t+" "+r].concat(a))},e.prototype.colorDist=function(e,t){var i;return(i=function(e){return e*e})(e[0]-t[0])+i(e[1]-t[1])+i(e[2]-t[2])},e.prototype.colorDistLab=function(e,t){var i=this.rgb2lab(e),n=this.rgb2lab(t);return Math.sqrt(Math.pow(i[0]-n[0],2)+Math.pow(i[1]-n[1],2)+Math.pow(i[2]-n[2],2))},e.prototype.colorDistLabCIE94=function(e,t){var i=this.rgb2lab(e),n=this.rgb2lab(t);return this.deltaE(i,n)},e.prototype.rgb2hex=function(e){return e&&e.length>=3?"#"+("0"+parseInt(e[0],10).toString(16)).slice(-2)+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2):""},e.prototype.rgb2lab=function(e){var t,i,n,o=e[0]/255,r=e[1]/255,a=e[2]/255;return i=(.2126*(o=o>.04045?Math.pow((o+.055)/1.055,2.4):o/12.92)+.7152*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)+.0722*(a=a>.04045?Math.pow((a+.055)/1.055,2.4):a/12.92))/1,n=(.0193*o+.1192*r+.9505*a)/1.08883,t=(t=(.4124*o+.3576*r+.1805*a)/.95047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116)-16,500*(t-i),200*(i-(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116))]},e.prototype.hexToYofXYZ=function(e){var t=chroma(e).rgb().map(function(e){return e/255}).map(function(e){return e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92}),i=t[0],n=t[1],o=t[2];return.2126*i+.7152*n+.0722*o},e.prototype.deltaE=function(e,t){var i=e[0]-t[0],n=e[1]-t[1],o=e[2]-t[2],r=Math.sqrt(e[1]*e[1]+e[2]*e[2]),a=r-Math.sqrt(t[1]*t[1]+t[2]*t[2]),s=n*n+o*o-a*a,l=i/1,c=a/(1+.045*r),d=(s=s<0?0:Math.sqrt(s))/(1+.015*r),u=l*l+c*c+d*d;return u<0?0:Math.sqrt(u)},e.prototype.getColorfulness=function(e){var t=this.rgb2lab(e),i=Math.sqrt(t[1]*t[1]+t[2]*t[2]);return i/Math.sqrt(i*i+t[0]*t[0])},e.prototype.getPaletteNew=function(e,t,i,n,o,r,a,s,l,c,d,u,p,h,g){var m=this;void 0===r&&(r=8),void 0===a&&(a=.05),void 0===s&&(s=.1),void 0===l&&(l=40),void 0===c&&(c=20),void 0===d&&(d=20),void 0===u&&(u=[0,0,0]),void 0===p&&(p=[255,255,255]);var f=this.getPixels(e,t,i,n,o),v=MMCQ.quantize(f,50),y=[],b=[],S=[],C=[],w=[];if(v){var T=v.vboxes.map(function(e){return{count:e.vbox.count(),rgb:e.color,hex:e.hex}});T.sort(function(e,t){return t.count-e.count});var I=(T=T.filter(function(e){return e.count>0})).map(function(e){return e.count}).reduce(function(e,t){return e+t});T.forEach(function(e,t){4===e.rgb[0]&&4===e.rgb[1]&&4===e.rgb[2]&&(e.rgb=[0,0,0]),252===e.rgb[0]&&252===e.rgb[1]&&252===e.rgb[2]&&(e.rgb=[255,255,255]),e.count/=I/100,e.hex=m.rgb2hex(e.rgb)}),g&&this.logColors("info","candidateColors",T.map(function(e){return e.hex}),h);T=T.filter(function(e){return e.count>.5}),g&&this.logColors("info","remove small   ",T.map(function(e){return e.hex}),h),T.forEach(function(e,t){var i=T.slice(0,t);e.distFromPrevious=m.distanceFromGroup(e,i),e.distFromPureBlack=m.colorDistLab(e.rgb,[0,0,0]),e.distFromPureWhite=m.colorDistLab(e.rgb,[255,255,255])});T=T.filter(function(e){return e.distFromPrevious>12||e.distFromPureBlack<12||e.distFromPureWhite<12}),g&&this.logColors("info","remove similar ",T.map(function(e){return e.hex}),h),T.forEach(function(t,i){t.hm=m.colorHomogeneity(e,n,o,t,d,1)});T=T.filter(function(e){return e.hm>2}),g&&this.logColors("info","remove sparse  ",T.map(function(e){return e.hex}),h),T.forEach(function(e,t){e.lum=m.hexToYofXYZ(e.hex),e.hsl=chroma(e.hex).hsl(),e.colorfulness=m.getColorfulness(e.rgb),e.colorfulness<.1||e.lum<.06?e.saturation="dullColor":e.colorfulness>.2&&(e.saturation="vibrantColor")});for(var x=0;x<T.length;x++){var P=[.06,.03,.12,.12,1];switch(T[x].saturation){case"dullColor":P=[.09,.03,.3,.3,-1];break;case"vibrantColor":P=[.09,.03,.07,.07,1]}if(g){var M=[];M[0]=T[x].hex,this.logColors("info","color candidate "+M,M,h)}this.classifyColorToBucket(T[x],y,"blackColor",1,g,.5,P[0])||(this.classifyColorToBucket(T[x],b,"blackSupportive",1,g,.5,P[2])||this.classifyColorToBucket(T[x],S,"whiteColor",1,g,.5,P[1])||this.classifyColorToBucket(T[x],C,"whiteSupportive",1,g,.5,P[3])||this.classifyColorToBucket(T[x],w,"main",3,g,.5,P[4]))}}y.sort(function(e,t){return e.lum-t.lum}),b=y.slice(1).concat(b),S.sort(function(e,t){return t.lum-e.lum}),C=S.slice(1).concat(C);var L=this.constructPalette(w,b,y,C,S),k=this.constructPresentedColors(w,b,y,C,S),_=this.determineColorationLevel(L),$=this.getBGColor(e,r,n,o,50);$.hex=this.rgb2hex($.rgb);var A=this.determineColorationMode(L,$);if(L.unshift($),g){var E=this.getPalette(e,t,i,n,o,r,a,s,l,c,d,u,p);this.logColors("info","old palette",E.map(function(e){return m.rgb2hex(e)}),h),this.logColors("info","new palette",L.map(function(e){return e.hex}),h),this.logColors("info","presented  ",k.map(function(e){return e.hex}),h),console.log("coloration mode = ",A,"coloration level = ",_)}var D={black:L[1].hex,white:L[2].hex,mainColor:L[3].hex,secondaryColor:L[4].hex,thirdColor:L[5].hex,fourthColor:L[6].hex,currentState:A,colorationVersion:1};return{colors:D,mode:A,level:_,mainColors:k.map(function(e){return e.hex})}},e.prototype.classifyColorToBucket=function(e,t,i,n,o,r,a){if(r=t.length<n?r:4*r,e.count>=r){var s=!0;switch(i){case"blackColor":case"blackSupportive":case"main":s=e.lum<a;break;case"whiteColor":case"whiteSupportive":s=1-e.lum<a}if(s&&this.isDistinctColor(e,t))return e.colorType=i,t.push(e),o&&console.log(i),!0}return!1},e.prototype.determineColorationMode=function(e,t){var i=e[0],n=e[1];return(t.rgb[3]>0?this.colorDistLab(t.rgb,i.rgb)<20:n.count>0&&0===i.count)?1:0},e.prototype.determineColorationLevel=function(e){return 0===e[2].count?0:e[3].count>=.5*e[2].count?3:e[2].count>35?2:1},e.prototype.constructPalette=function(e,t,i,n,o){if(e.length<2&&(t.length>0&&t[0].saturation>0&&(e.push(t.shift()),e[e.length-1].colorType="main"),n.length>0&&n[0].saturation>0&&(e.push(n.shift()),e[e.length-1].colorType="main")),1===e.length){var r=e[0].lum>.5?-.1:.1;e.push(this.createColor(e[0].hex,r)),e[e.length-1].colorType="main"}0===e.length&&(e.push(this.createColor("#E1EFF2")),e[e.length-1].colorType="main",e.push(this.createColor("#AABCBF")),e[e.length-1].colorType="main"),0===t.length&&(i.length>1?t.push(i[1]):1===i.length?t.push(this.createColor(i[0].hex,.1)):t.push(this.createColor("#161616"))),0===n.length&&(o.length>1?n.push(o[1]):1===o.length?n.push(this.createColor(o[0].hex,-.1)):n.push(this.createColor("#F0F0F0")));var a=this.createColor("#000000");i.push(a);var s=this.createColor("#FFFFFF");o.push(s);var l=[];return l.push(i[0]),l.push(o[0]),l.push(e[0]),l.push(e[1]),l.push(t[0]),l.push(n[0]),l},e.prototype.constructPresentedColors=function(e,t,i,n,o){var r=[];r=(r=r.concat(e,n,t)).filter(function(e){return e.count>0});var a=[];return a.push(o[0]),a.push(i[0]),r.length=Math.min(r.length,4),r=r.concat(a)},e.prototype.getPixels=function(e,t,i,n,o){var r,a,s,l,c,d,u,p,h,g;for(s=e.getContext("2d").getImageData(t,i,n,o).data,l=[],d=u=i,h=i+o;u<h;d=u+=1)for(a=d*n*4,c=p=t,g=t+n;p<g;c=p+=1)s[(r=a+4*c)+3]>240&&l.push([s[r],s[r+1],s[r+2],s[r+3]]);return l},e.prototype.getBGColor=function(e,t,i,n,o){void 0===o&&(o=6);var r,a,s,l,c,d,u=0;for(s=e.getContext("2d").getImageData(0,0,i,n).data,l=[],d=0;d<n;d++)for(a=d*i*4,c=0;c<t;c++)s[(r=a+4*c)+3]<240?u++:l.push([s[r],s[r+1],s[r+2],s[r+3]]);for(d=0;d<n;d++)for(a=d*i*4,c=i-t-1;c<i;c++)s[(r=a+4*c)+3]<240?u++:l.push([s[r],s[r+1],s[r+2],s[r+3]]);for(d=0;d<t;d++)for(a=d*i*4,c=t;c<i-t;c++)s[(r=a+4*c)+3]<240?u++:l.push([s[r],s[r+1],s[r+2],s[r+3]]);for(d=n-t-1;d<n;d++)for(a=d*i*4,c=t;c<i-t;c++)s[(r=a+4*c)+3]<240?u++:l.push([s[r],s[r+1],s[r+2],s[r+3]]);if(l.length<u)return{rgb:[4,4,4,0],count:u};var p=MMCQ.quantize(l,o).vboxes.map(function(e){return{count:e.vbox.count(),rgb:e.color}});p.sort(function(e,t){return t.count-e.count});var h=p[0];return u>.8*p[0].count?h.rgb.push(0):(4===h.rgb[0]&&4===h.rgb[1]&&4===h.rgb[2]&&(h.rgb=[0,0,0]),252===h.rgb[0]&&252===h.rgb[1]&&252===h.rgb[2]&&(h.rgb=[255,255,255]),h.rgb.push(1)),h},e.prototype.shouldColorizeBG=function(e,t,i,n,o,r,a){var s,l,c,d,u,p=0,h=0,g=0,m=0;for(c=e.getContext("2d").getImageData(0,0,i,n).data,u=0;u<n;u++)for(l=u*i*4,d=0;d<t;d++){var f=[c[s=l+4*d],c[s+1],c[s+2]];this.colorDistLab(f,o)<r&&p++}for(u=0;u<n;u++)for(l=u*i*4,d=i-t;d<i;d++){f=[c[s=l+4*d],c[s+1],c[s+2]];this.colorDistLab(f,o)<r&&h++}for(u=0;u<t;u++)for(l=u*i*4,d=t;d<i-t;d++){f=[c[s=l+4*d],c[s+1],c[s+2]];this.colorDistLab(f,o)<r&&g++}for(u=n-t;u<n;u++)for(l=u*i*4,d=t;d<i-t;d++){f=[c[s=l+4*d],c[s+1],c[s+2]];this.colorDistLab(f,o)<r&&m++}return p/(t*n)>a&&h/(t*n)>a&&g/(t*(i-2*t))>a&&m/(t*(i-2*t))>a},e.prototype.isDistinctColor=function(e,t,i){return void 0===i&&(i=15),this.distanceFromGroup(e,t)>i},e.prototype.distanceFromGroup=function(e,t){for(var i=Number.MAX_VALUE,n=0;n<t.length;n++){var o=this.colorDistLab(e.rgb,t[n].rgb);i=o<i?o:i}return i},e.prototype.colorHomogeneity=function(e,t,i,n,o,r){var a,s,l,c,d,u,p;l=e.getContext("2d").getImageData(0,0,t,i).data;var h=0,g=0;for(d=0;d<i;d++){var m=d*t*4;for(c=0;c<t;c++){var f=[l[a=m+4*c],l[a+1],l[a+2]];if(this.colorDistLab(f,n.rgb)<o)for(h++,p=Math.max(d-r,0);p<Math.min(d+r,i);p++){var v=p*t*4;for(u=Math.max(c-r,0);u<Math.min(c+r,t);u++){var y=[l[s=v+4*u],l[s+1],l[s+2]];this.colorDistLab(y,n.rgb)<o&&g++}}}}return 0!==h?g/h:-1},e.prototype.isBlackReplacement=function(e,t){return void 0===t&&(t=20),this.colorDistLabCIE94(e,[0,0,0])<t},e.prototype.isWhiteReplacement=function(e,t){return void 0===t&&(t=10),this.colorDistLab(e,[255,255,255])<t},e.prototype.createColor=function(e,t){var i;void 0===t&&(t=0),i={count:0,rgb:[0,0,0],hex:e};var n=chroma(e).hsl(),o=n[0],r=n[1],a=n[2];return a=Math.min(1,Math.max(0,a+t)),i.rgb=chroma.hsl(o,r,a).rgb(),i.hsl=[o,r,a],i.hex=this.rgb2hex(i.rgb),i},e.prototype.computePaletteNew=function(e,t,i,n,o){var r=Math.max(2,Math.round(e.width/50));return this.getPaletteNew(e,0,0,e.width,e.height,r,.03,.03,30,20,20,t,i,n,o)},e.prototype.computePalette=function(e,t,i){var n=Math.max(2,Math.round(e.width/50));return this.getPalette(e,0,0,e.width,e.height,n,.03,.03,30,20,20,t,i)},e.prototype.getPalette=function(e,t,i,n,o,r,a,s,l,c,d,u,p){var h,g,m,f,v,y,b,S,C,w;void 0===r&&(r=8),void 0===a&&(a=.05),void 0===s&&(s=.1),void 0===l&&(l=40),void 0===c&&(c=20),void 0===d&&(d=20),void 0===u&&(u=[0,0,0]),void 0===p&&(p=[255,255,255]);var T=this.getBGColor(e,r,n,o,50);for(m=e.getContext("2d").getImageData(t,i,n,o).data,f=[],y=b=i,C=i+o;b<C;y=b+=1)for(g=y*n*4,v=S=t,w=t+n;S<w;v=S+=1)m[(h=g+4*v)+3]>240&&f.push([m[h],m[h+1],m[h+2],m[h+3]]);var I=MMCQ.quantize(f,50);if(I){var x=I.vboxes.map(function(e){return{count:e.vbox.count(),rgb:e.color}});x.sort(function(e,t){return t.count-e.count});for(var P=0,M=0;M<x.length;M++)P+=x[M].count;var L=-1,k=-1,_=[],$=void 0,A=!1,E=0;for(M=0;M<x.length;M++){4===x[M].rgb[0]&&4===x[M].rgb[1]&&4===x[M].rgb[2]&&(x[M].rgb=[0,0,0]),252===x[M].rgb[0]&&252===x[M].rgb[1]&&252===x[M].rgb[2]&&(x[M].rgb=[255,255,255]);var D=this.getColorfulness(x[M].rgb);if(0===M||-1===k){var F=Number.MAX_VALUE;if(void 0!==T&&void 0!==T.rgb&&0!==T.rgb[3]&&(F=this.colorDistLab(T.rgb,x[M].rgb)),!(F>l)){void 0===$&&0!==($=T).rgb[3]&&(A=!0,L=x[M].count/P,k=Math.max(x[M].count*(1-L),.05*P));continue}k=x[M].count,_.push(x[M])}else{var B=a;if(void 0!==$&&(B=s),D<.2&&(B*=2.5),D>.6&&(B*=.8),-1!==k&&x[M].count>k*B){for(var O=Number.MAX_VALUE,H=0;H<_.length;H++){(F=this.colorDistLab(x[M].rgb,_[H].rgb))<O&&(O=F)}if(A)(F=this.colorDistLab($.rgb,x[M].rgb))<O&&(O=F);if(O>c){var R=this.colorHomogeneity(e,n,o,x[M],d,1);if(R>=2){if(D<.05){if(E>0)continue;E++}x[M].hm=R,_.push(x[M])}}}}}$&&A&&_.unshift($),_.unshift(T);var N=!1,U=!1;if(0===T.rgb[3])for(M=0;M<_.length;M++)0!==_[M].rgb[3]&&(N=N||this.isBlackReplacement(_[M].rgb,25),U=U||this.isWhiteReplacement(_[M].rgb,10));var V=!1,z=!1;void 0!==T&&0!==T.rgb[3]&&((V=this.isBlackReplacement(T.rgb,25))&&(u=T.rgb),(z=this.isWhiteReplacement(T.rgb,10))&&(p=T.rgb));var j=[];V&&j.unshift(u),z&&j.unshift(p);var W=[],G=0,K=0,q=!1,Y=!1;for(M=1;M<_.length;M++)_[M].rgb.length!==T.rgb.length||_[M].rgb[0]!==T.rgb[0]||_[M].rgb[1]!==T.rgb[1]||_[M].rgb[2]!==T.rgb[2]||_[M].rgb[3]!==T.rgb[3]?q||!this.isBlackReplacement(_[M].rgb,25)?Y||!this.isWhiteReplacement(_[M].rgb,10)?W.push(_[M].rgb):(p=_[M].rgb,Y=!0):(u=_[M].rgb,q=!0):0===_[M].rgb[3]||V||z||j.push(_[M].rgb);if(V||j.unshift(u),z||j.unshift(p),W.length>0)for(M=0;M<W.length;M++)this.isLight(W[M],u,p)?G<2&&(G++,j.push(W[M])):K<2&&(K++,j.push(W[M]));if(0===T.rgb[3])N&&U&&2===j.length?T.rgb=[128,128,128,1]:N?(T.rgb=p,T.rgb[3]=1):U?(T.rgb=u,T.rgb[3]=1):(T.rgb=p,T.rgb[3]=1);else{var X=this.shouldColorizeBG(e,r,n,o,T.rgb,d,.6);T.rgb[3]=X?1:0}if(this.isBlackReplacement(j[1],25)){var Z=j[1];j[1]=j[0],j[0]=Z}return 2===j.length&&(j.push(j[0]),j.push(j[1])),j.unshift(T.rgb),j}return[p.concat([1]),u,p,u,p]},e.prototype.isLight=function(e,t,i){var n=chroma.rgb.apply(chroma,e);return!(chroma.contrast(n,chroma.rgb.apply(chroma,i))>chroma.contrast(n,chroma.rgb.apply(chroma,t)))},e}();!function(e){var t=function(){function e(e,t,i,n){this.themeChooser=e,this.designKitParameters=t,this.flags=i,this.chroma=n,AdiCoreSanta.setPreviewColors(this)}return e.$inject=["themeChooser","designKitParameters","flags","chroma"],e.prototype.getRGBColor=function(e,t){void 0===t&&(t={});var i,n=t.opacity,o=void 0===n?1:n,r=t.kit;return"#"===e[0]?i=e:("L"===e[0]||"D"===e[0]?e="color_"+this.designKitParameters[e]:"c"!==(e=_.trim(e,["{","}"]))[0]&&(e="color_"+e),i=r?this.themeChooser.getColorByColorTheme(r,e):this.themeChooser.getColorFromActiveColorTheme(e)),o<1?this.hex2rgba(i,o):i},e.prototype.hex2rgba=function(e,t){return"rgba("+parseInt(e.substring(1,3),16)+","+parseInt(e.substring(3,5),16)+","+parseInt(e.substring(5,7),16)+","+t+")"},e}();e.PreviewColors=t,angular.module("adiCoreAppInternal").service("previewColors",t)}(S||(S={})),function(e){var t=function(){function e(e,t,i,n,o,r,a,s,l,c,d,u,p,h,g,m,f,v){this.layoutSolver=e,this.slideShowService=t,this.$p=i,this.flags=n,this.sectionBackgroundService=o,this.LayoutUtils=r,this.clusters=a,this.mediaOverride=s,this.modelTree=l,this.mediaGallery=c,this.cropFaceService=d,this.simpleSolutionManager=u,this.designKit=p,this.themeChooser=h,this.tpaService=g,this.defaultsService=m,this.solutionManager=f,this.sitePartTypes=v}return e.$inject=["layoutSolver","slideShowService","$p","flags","sectionBackgroundService","LayoutUtils","clusters","mediaOverride","modelTree","mediaGallery","cropFaceService","simpleSolutionManager","designKit","themeChooser","tpaService","defaultsService","solutionManager","sitePartTypes"],e.prototype.getNodeBg=function(e,t,i,n,o,r){return void 0===r&&(r=!1),this.hasContentMedia(e,t,i)||r?n.bgForPresetWithContent[o%n.bgForPresetWithContentLength]:n.bgForPresetWithoutContent[o%n.bgForPresetWithoutContentLength]},e.prototype.getBgColorOption=function(){return{mediaType:"color"}},e.prototype.setSectionBackground=function(e,t,i,n){if(e.node.isList()){var o=this.modelTree.getListHeader(e.node),r=void 0,a=void 0;if(this.hasContentMedia(o,e.preset,t.header)||i%2!=0||(r=this.getNodeBg(o,e.preset,t.header,n.headerBg,i),_.isEqual(this.getBgColorOption(),r)||(a=this.getBgColorOption())),!a){var s=_.first(this.modelTree.getListItems(e.node)),l=0===_.filter(e.preset.data.groups,function(e){return e.layouts.length>1}).length;a=this.getNodeBg(s,e.preset,t.item,n.bg,i,l)}e.bg=a,(this.flags.lodash4?_.isEqual:_.eq)(a,r)||(e.headerBg=r)}else e.bg=this.getNodeBg(e.node,e.preset,t,n,i)},e.prototype.convertToBgObj=function(e){if(e){var t={mediaType:e.mediaType};return"color"!==e.mediaType&&(t.mediaId=this.mediaGallery.getItemId(e),"image"===e.mediaType&&(t.alignment=this.cropFaceService.getAlignmentByFacePosition(e),t.hasFaces=[].concat(_.get(e,"fileInput.face")).length>0)),t}},e.prototype.getPresetGroups=function(e,t,i){var n=[t.data.groups[0]];if(i)switch(e.contentElementType){case"ListHeader":n=[t.data.groups[0]];break;case"ListFooter":return void(n=[]);default:n=_.filter(t.data.groups,function(e){return!e.isHeader&&!e.isFooter})}return _.some(_.get(n&&n[0],["columns","singleColumnProps"]),function(e){return"image"===e.backgroundMode})||["image","imageOrColor"].indexOf(_.get(n&&n[0],["columns","backgroundMode"]))>-1?[]:n},e.prototype.hasContentMedia=function(e,t,i){return e.argsMatchingPolicy[i]},e.prototype.isMediaOnMedia=function(e,t,i){var n,o=this.sectionBackgroundService.getBackground(e),r=o&&"color"!==o.mediaType&&"pattern"!==o.mediaType;if(e.isList()){var a=this.modelTree.getListHeader(e),s=_.first(this.modelTree.getListItems(e));n=this.hasContentMedia(s,t,i.item);var l=this.sectionBackgroundService.getBackground(e,"header"),c=this.hasContentMedia(a,t,i.header),d=l&&"color"!==l.mediaType&&"pattern"!==l.mediaType;return n&&r||c&&d}return(n=this.hasContentMedia(e,t,i))&&r},e.prototype.setImageBg=function(e,t,i,n){if(void 0===n&&(n="body"),!t.userHidden){var o=this.sectionBackgroundService.getBackgroundOptions(t),r=o.image[i%o.image.length];"header"===n?e.headerBg=r:e.bg=r}},e.prototype.setConvertedPresetBg=function(e,t){this.flags.newListLayouts&&e.preset.data.sectionSolution&&e.preset.data.sectionSolution.partial?(this.setImageBg(e,e.node,t),e.headerBg=this.getBgColorOption()):(e.preset.convertedPreset&&this.setImageBg(e,e.node,t),e.preset.convertedHeaderPreset&&this.setImageBg(e,e.node.children[0],t,"header"))},e.prototype.isSlideShow=function(e){return _(e.flags).includes("slideShowPreset")},e.prototype.getWantedArgsSignature=function(e){if(e.isList()){var t=this.modelTree.getListHeader(e),i=this.modelTree.getListFooter(e),n=_.first(this.modelTree.getListItems(e));return _.map([t,n,i],function(e){return e&&e.contentElement.getWantedArgs(!1)||""}).join("#")}return e.contentElement.getWantedArgs(!1)},e.prototype.changePreset=function(e,t,i){t.preset=ob.deepClone(t.preset);var n=this.getPresetGroups(e,t.preset,i);this.mediaOverride.changeC2CtoFullWidth(t.preset.data,n),_.each(n,function(e){_.each(e.layouts,function(e){var t=_.get(e.selections,["overrides","strips"]);_.each(t,function(e){_.each(e,function(e){e.strip&&(e.strip.paddingTop=40,e.strip.paddingBottom=40)})})})});var o=this.getMediaFieldName(e);e.argsMatchingPolicy[o]&&("ListHeader"===e.contentElementType?t.preset.convertedHeaderPreset=!0:t.preset.convertedPreset=!0)},e.prototype.turnMediaOffForConvertedPreset=function(e,t){var i=this.getMediaFieldName(e);"ListHeader"===e.contentElementType?t.preset.convertedHeaderPreset&&(e.argsMatchingPolicy[i]=!1):t.preset.convertedPreset&&(e.argsMatchingPolicy[i]=!1)},e.prototype.convertAllOnMediaCoast2CoastPreset=function(e,t,i,n){if(void 0===n&&(n=!1),e.isListItem)return!0;var o=_.get(this.getPresetGroups(e,t.preset,i),[0,"layouts",0]);if(!o)return!0;if(1===o.cluster)return o.mediaType===AdiCoreSanta.PresetMediaType.COAST2COAST&&this.changePreset(e,t,i),this.turnMediaOffForConvertedPreset(e,t),!0;if(!_.some(e.argsMatchingPolicy))return!0;var r=this.LayoutUtils.transformStructureToStringArray(o,o.structure),a=this.LayoutUtils.transformStructureToStringArray(o,o.onMediaStructure),s=o.argsSignature.split("#"),l=e.contentElement.calculateUnwantedArgs(),c=s.filter(function(e){return l.find(function(t){return t===e})});if(1===this.clusters.calculateFallBackClusterAndStructure(r,a,c,[],!e.isListItem).cluster&&o.mediaType===AdiCoreSanta.PresetMediaType.COAST2COAST){if(n){var d=_.intersection(_.flatten(r),c);if(d.length>0){var u=_.find(_.keys(e.contentElement.values),function(t){return e.contentElement.values[t].signature===d[0]});u&&(e.argsMatchingPolicy[u]=!0)}}return!1}return!0},e.prototype.getMediaFieldName=function(e){return e.isList()?{item:this.getItemMediaFieldName(_.first(this.modelTree.getListItems(e))),header:this.getItemMediaFieldName(this.modelTree.getListHeader(e))}:this.getItemMediaFieldName(e)},e.prototype.getItemMediaFieldName=function(e){var t;return _.each(e.contentElement.values,function(e,i){"media"===e.type&&(t=i)}),t},e.prototype.convertPreset=function(e,t,i,n){n&&!e.isListHeader()||this.convertAllOnMediaCoast2CoastPreset(e,t,n,i),n||this.convertPartialPreset(e,t)},e.prototype.convertPartialPreset=function(e,t){return t.preset.data.isList||0!==t.preset.data.groups[0].id.indexOf("Partial lg ")||(t.preset.convertedPreset=!0,this.turnMediaOffForConvertedPreset(e,t)),!0},e.prototype.calculateSolution=function(e,t){var i,n=this;if(e.dummyPageIdSuffix?i=e.dummyPageIdSuffix:(i="|"+e.node.id+"|"+this.getWantedArgsSignature(e.node),"header"===t&&(i+="|"+_.map(e.flags).join())),this.flags.debugShowAllFields){var o=void 0;o=e.node.isList()?e.node.children:[e.node],_.each(o,function(e){_.each(e.contentElement.values,function(t,i){"text"!==t.type&&"button"!==t.type||-1!==["ContactFormTitle","country","gate","state","street","zipCode","city"].indexOf(t.subType)||(e.argsMatchingPolicy[i]=!0)})})}return this.layoutSolver.createLayoutPresetPreviewSolution(e.preset,e.node,e.isClone,i,{preferredMedia:e.node.preferredMedia,bg:this.convertToBgObj(e.bg),headerBg:this.convertToBgObj(e.headerBg),resetOpacity:!_.get(e,["preset","data","isMobile"]),desktopSolution:e.desktopSolution}).then(function(t){return t?(t.sourcePageName=e.sourcePageName,t.sourceName=e.sourceName,e.flags&&(t.flags=e.flags),n.slideShowService.setIsSlideShow(t.dummyPageId,t.node.id,n.isSlideShow(t)),n.$p.when(t)):n.$p.reject("Could not find any solution to this preset")})},e.prototype.getBgOptions=function(e){var t=[this.getBgColorOption()],i=e.image||[];return i.splice(0,0,this.getBgColorOption()),{bgOptions:e,bgForPresetWithContent:t,bgForPresetWithContentLength:t.length,bgForPresetWithoutContent:i,bgForPresetWithoutContentLength:i.length}},e.prototype.getSectionBgOptions=function(e){return e.isList()?{headerBg:this.getBgOptions(this.sectionBackgroundService.getBackgroundOptions(e)),bg:this.getBgOptions(this.sectionBackgroundService.getBackgroundOptions(e))}:this.getBgOptions(this.sectionBackgroundService.getBackgroundOptions(e))},e.prototype.getLgStripColorByNode=function(e){var t=this.simpleSolutionManager.getSectionSolution(e.containerPageId,e.id);return t&&t[0]&&t[0].getLgData().strip.color},e.prototype.isDarkTpaBackground=function(e){var t=this.getLgStripColorByNode(e);return e.containerPageId&&t?t===this.designKit.darkColorsSantaFormat[0]:this.themeChooser.coloration.isActiveKitColorationModeIsDark()},e.prototype.generateFlattenedListOfPreviewsForTpa=function(e,t){_.first(t)||(t=[{}]);var i=[],n=this.modelTree.canInvertTpa(e)&&this.isDarkTpaBackground(e);return _.each(t,function(t){i.push({node:e,preset:t,isInverted:n,isTpa:!0})}),this.flags.debug&&0===i.length&&i.push({node:e,preset:null,isInverted:n,isTpa:!0}),i},e.prototype.getTpaPreset=function(e){var t=this.tpaService.getTpaPreset(e).id;return this.defaultsService.getPresetsForNode(e).then(function(e){return e.find(function(e){return e.id===t})})},e.prototype.generateColorOptions=function(e,t){void 0===t&&(t=!1);var i=e.isList()&&!this.modelTree.getListHeader(e).isUserHidden(),n=!1,o=!1;if(!this.flags.newListLayouts||!this.solutionManager.isSectionPartial(e)||!this.sectionBackgroundService.isPartialMedia(e)){var r=this.sectionBackgroundService.getBackground(e);n=r&&r.mediaType!==AdiCoreSanta.BgMediaTypes.COLOR&&r.mediaType!==AdiCoreSanta.BgMediaTypes.PATTERN;var a=this.sectionBackgroundService.getBackground(e,"header")||r;o=i&&a&&a.mediaType!==AdiCoreSanta.BgMediaTypes.COLOR&&a.mediaType!==AdiCoreSanta.BgMediaTypes.PATTERN}var s=this.simpleSolutionManager.getSectionSolution(e.containerPageId,e.id),l=this.designKit.getConfigurationOfLg(s[0]),c=_.sortBy(this.sectionBackgroundService.getUniqueConfigurationsOfActiveKit(),function(e){return e.id!==l.id});return e.isTpa||e.isTpaWidget?this.getTpaPreset(e).then(function(t){return _(c).filter(function(e){return"D1"===e.display||"L1"===e.display}).map(function(i){return{node:e,confId:i.id,isTpa:!0,isInverted:"D1"===i.display,preset:t}}).flatten().value()}):_(c).map(function(n){return!i||t&&!o?{node:e,confId:n.id}:_.map(c,function(t){return{node:e,headerConfId:n.id,confId:t.id}})}).flatten().filter(function(e){return!(n&&3!==e.confId||o&&3!==e.headerConfId)}).value()},e.prototype.createColorOptionSolution=function(e,t){var i=this,n=e.confId,o=e.headerConfId;return t=t||"layoutPresetPreview_switchColor_"+n+"_"+(o||0),this.simpleSolutionManager.duplicateSectionForPreview(e.node,t).then(function(t){return i.designKit.setSpecificConfigurationForSectionByConfId(t.solution,n,o),i.solutionManager.preparePresetPreviewForRender(i.sitePartTypes.BODY,t),t.preset=e,t})},e}();e.PresetService=t,angular.module("adiCoreAppInternal").service("presetService",t)}(S||(S={}));var r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};!function(e){var t=function(){function e(e,t,i,n,o){this.flags=e,this.modelTree=t,this.presetService=i,this.lssModifier=n,this.storyServices=o}return e.$inject=["flags","modelTree","presetService","lssModifier","storyServices"],e.prototype.applyFieldMask=function(e,t,i,n,o){e.contentElement.calculateWantedArgs(),_.each(e.contentElement.values,function(t,n){e.argsMatchingPolicy[n]=i.indexOf(t.signature)>-1});var r=e.contentElement.getReferenceFields();_.each(r,function(e,t){e&&-1===i.indexOf(t)&&(r[t]=!1)}),e.contentElement.setReferenceFields(r),o&&this.presetService.convertPreset(e,t,!0,n),e.contentElement.getNonBlankFields(),_.some(e.argsMatchingPolicy)||(e.userHidden=e.isListHeader()||e.isListFooter())},e.prototype.getPartKey=function(e,t){var i=e.preset.data.isList?AdiCoreSanta.SettingsPart.items:AdiCoreSanta.SettingsPart.single;return"ListHeader"===t?i=AdiCoreSanta.SettingsPart.header:"ListFooter"===t&&(i=AdiCoreSanta.SettingsPart.footer),i},e.prototype.getSettingPerPart=function(e,t,i){var n=this.getAllSettingsPerPart(e,i);if(i!==AdiCoreSanta.SettingsPart.header&&i!==AdiCoreSanta.SettingsPart.footer||(t%=n.length),n.length-1>=t)return n[t]},e.prototype.getAllSettingsPerPart=function(e,t){var i=e[t],n=this.storyServices.story.selectedPage===this.modelTree.homePageId;return _.filter(i,function(e){return e.usage===AdiCoreSanta.SettingsUsage.all||(n?e.usage===AdiCoreSanta.SettingsUsage.homePage:e.usage===AdiCoreSanta.SettingsUsage.innerPage)})},e.prototype.filterPresetsBySettings=function(e,t,i){var n=this;return e=_.map(e,function(e){return e.settings=n.getSetting(e,t[0].contentElementType,i,t[0].isList()),e}),_.filter(e,function(e){return!!e.settings})},e.prototype.splitPresetsBySettings=function(e,t){var i=this;if(e[0]&&e[0].preset.data.isList){var n=[],o=t[0],a=_.filter(o.children,function(e){return!e.isListHeader()&&!e.isListFooter()&&!e.userHidden}).length,s=o.getContentElementType();return _.each(e,function(e){var t=e.preset.data.properties.settings;if(t){var o=t[s]||t.all,l=i.getAllSettingsPerPart(o,AdiCoreSanta.SettingsPart.items),c=void 0;if(i.flags.headlessApi){var d=_.find([3,2,1],function(e){return a%e==0});c=_.map(l,function(e){return r({},e,{itemsPerRow:a%e.itemsPerRow==0?e.itemsPerRow:d})})}else c=_.filter(l,function(e){return a%e.itemsPerRow==0});c=(i.flags.lodash4?_.uniqBy:_[String("uniq")])(c,function(e){return e.itemsPerRow}),_.each(c,function(t){var o=ob.deepClone(e);i.lssModifier.adjustPresetNumOfItemsInRow(o.preset,t.itemsPerRow),n.push(o)})}}),n}return e},e.prototype.getSetting=function(e,t,i,n){var o=e.preset.data.properties.settings;if(o){var r=o[t]||o.all,a={};if(n?(a[AdiCoreSanta.SettingsPart.header]=this.getSettingPerPart(r,i,AdiCoreSanta.SettingsPart.header),a[AdiCoreSanta.SettingsPart.items]=this.getSettingPerPart(r,i,AdiCoreSanta.SettingsPart.items),a[AdiCoreSanta.SettingsPart.footer]=this.getSettingPerPart(r,i,AdiCoreSanta.SettingsPart.footer)):a[AdiCoreSanta.SettingsPart.single]=this.getSettingPerPart(r,i,AdiCoreSanta.SettingsPart.single),a[AdiCoreSanta.SettingsPart.single]||a[AdiCoreSanta.SettingsPart.items])return a}},e.prototype.applyPresetSettings=function(e,t,i,n,o){var r=this.getPartKey(t,e.contentElementType),a=t.settings[r];if(this.applyFieldMask(e,t,a.fieldMask,n,i),e.isListHeader()||e.isListFooter()||(this.lssModifier.changePresetTextAlign(e.contentElement,t.preset,a.textAlignment),this.lssModifier.changePresetOnMediaPosition(e.contentElement,t.preset,a.boxPositionOnMedia)),this.lssModifier.changePresetPartialLg(t.preset,a.contentColumnPosition),!o&&a.itemsPerRow&&n){var s=this.modelTree.getListItems(n),l=a.itemsPerRow*a.numberOfRows,c=s.length-l;c>0&&n.children.splice(n.children.indexOf(s[l]),c),this.lssModifier.adjustPresetNumOfItemsInRow(t.preset,a.itemsPerRow)}},e}();e.PresetSettingsService=t,angular.module("adiCoreAppInternal").service("presetSettingsService",t)}(S||(S={})),function(e){var t=function(){function e(e,t,i,n,o,r,a){this.presetService=e,this.modelTree=t,this.mediaOverride=i,this.presetSettingsService=n,this.sectionBackgroundService=o,this.flags=r,this.slideShowService=a}return e.$inject=["presetService","modelTree","mediaOverride","presetSettingsService","sectionBackgroundService","flags","slideShowService"],e.prototype.createPreviewsFromExistingNodes=function(e,t,i,n){var o=this;if(i)return e.sort(function(e){return e.containerPageName?0:1}).map(function(e){return{node:o.modelTree.duplicateNodeAndContentElementForPresetPreview(e),sourcePageName:e.containerPageName,sourceName:e.containerSourceName,isClone:!0,staticRoundRobin:!0}});var r=_.first(e);return t.map(function(e){var t=o.modelTree.duplicateNodeAndContentElementForPresetPreview(r);return n||o.presetSettingsService.applyPresetSettings(t,e,!1,void 0,!0),{node:t,preset:e.preset,sourcePageName:null,sourceName:null,isClone:!0}})},e.prototype.createPreviewsFromDrafts=function(e,t,i,n){var o=this;return t.map(function(t,r){var a=(r+i)%e.length,s=o.modelTree.duplicateNodeAndContentElementForPresetPreview(e[a]);if(n)if(s.isList()){var l=s.children[0],c=_.last(s.children);l.userHidden=!_.some(l.argsMatchingPolicy),c.userHidden=!_.some(c.argsMatchingPolicy),s.children.forEach(function(e){return o.presetService.convertPreset(e,t,!1,s)})}else o.presetService.convertPreset(s,t,!1);else s.isList()?s.children.forEach(function(e){o.presetSettingsService.applyPresetSettings(e,t,!0,s)}):o.presetSettingsService.applyPresetSettings(s,t,!0);var d={node:s,preset:t.preset,sourcePageName:null,sourceName:null,isClone:!0};return o.presetService.setConvertedPresetBg(d,Math.floor(r/e.length)),d})},e.prototype.hasBgAndColumn=function(e){var t=this.mediaOverride.getAllowedMediaOverride(e);return this.sectionBackgroundService.getBackground(e).mediaType!==AdiCoreSanta.BgMediaTypes.COLOR&&t===AdiCoreSanta.PresetMediaType.COLUMNBG},e.prototype.createPreviewCombination=function(e,t,i,n,o,r,a){var s=this;void 0===a&&(a=!0);var l,c=this.modelTree.duplicateNodeAndContentElementForPresetPreview(e);if(c.isList()){var d=this.modelTree.getListItems(c)[0],u=o.item;r&&(d.argsMatchingPolicy[u]=!d.argsMatchingPolicy[u],this.avoidEmptyPreview(d,u));var p=_.filter(t.preset.data.groups,function(e){return!e.isHeader&&!e.isFooter});if(l="image"===_.get(p&&p[0],["columns","backgroundMode"]),!d.argsMatchingPolicy[u]&&l){if(!r)return!1;d.argsMatchingPolicy[u]=!0}}else r&&(c.argsMatchingPolicy[o]=!c.argsMatchingPolicy[o]);var h={node:c,preset:t.preset,fitMode:t.fitMode,sourcePageName:null,sourceName:null,isClone:!0};if(h.node.isList()?_.every(h.node.children,function(e){return s.presetService.convertAllOnMediaCoast2CoastPreset(e,h,h.node)}):this.presetService.convertAllOnMediaCoast2CoastPreset(h.node,h)&&this.presetService.convertPartialPreset(h.node,h)){if((a||this.presetService.isMediaOnMedia(c,t.preset,o))&&this.presetService.setSectionBackground(h,o,Math.floor(i/n),this.presetService.getSectionBgOptions(c)),this.presetService.setConvertedPresetBg(h,Math.floor(i/n)),h.node.isList())!h.node.children[0].userHidden&&(l||this.slideShowService.isSlideShow(h.node))&&h.headerBg&&"color"!==h.headerBg.mediaType&&(h.headerBg=this.presetService.getBgColorOption());return h.dummyPageIdSuffix="|"+c.id+"|"+this.presetService.getWantedArgsSignature(c)+"|"+r,h}return null},e.prototype.avoidEmptyPreview=function(e,t){_.every(e.argsMatchingPolicy,function(e){return!e})&&(e.argsMatchingPolicy[t]=!0)},e.prototype.createPreviewBgPermutations=function(e,t,i){var n=this,o=[],r=e.length;return _.each(e,function(e){var a=n.presetService.getMediaFieldName(e);_.each(t,function(t,s){if(!n.hasBgAndColumn(e)){var l=void 0;l=!!i.isChangeBgSupported&&!(s<4);var c=n.createPreviewCombination(e,t,s,r,a,!1,l);c&&o.push(c)}}),_.each(t,function(t,s){if(!n.flags.newListLayouts||!t.preset.data.sectionSolution||!t.preset.data.sectionSolution.partial){var l=void 0;l=!!i.isChangeBgSupported&&!(s<4);var c=n.createPreviewCombination(e,t,s,r,a,!0,l);c&&o.push(c)}})}),o},e.prototype.generateNewPreviews=function(e,t,i,n){var o=e.filter(function(e){return e.isDraft}),r=o.length,a=[];if(t=ob.deepClone(t),0===i){var s=e.filter(function(e){return!e.isDraft});a=a.concat(this.createPreviewsFromExistingNodes(s,t,r>0,n))}r>0?a=a.concat(this.createPreviewsFromDrafts(o,t,i,n)):(s=e.filter(function(e){return!e.isDraft}))&&i>0&&"Contact"===s[0].contentElementType&&(a=a.concat(this.createPreviewsFromExistingNodes(s,t,!1,n)));return a},e.prototype.generateAlternativePreviews=function(e,t){return t.map(function(t){return e.map(function(e){return{node:e,preset:t.preset,sourcePageName:null,sourceName:null,isClone:!1,fitMode:t.fitMode}})}).reduce(function(e,t){return e.concat(t)},[])},e.prototype.generateAlternativePreviewsWithBg=function(e,t,i){return this.createPreviewBgPermutations(e,t,i)},e}();e.PresetPreviewGenerator=t,angular.module("adiCoreAppInternal").service("presetPreviewGenerator",t)}(S||(S={}));var a=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){e.done?o(e.value):new i(function(t){t(e.value)}).then(a,s)}l((n=n.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var i,n,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};!function(e){var t=function(){function t(e,t,i,n,o,r,a,s,l,c,d,u,p,h,g){this.flags=e,this.wizardService=t,this.defaultsService=i,this.presetService=n,this.presetPreviewGenerator=o,this.mobileSectionValidator=r,this.presetSettingsService=a,this.Story=s,this.ContentElement=l,this.modelTree=c,this.modelSerialize=d,this.menuService=u,this.layoutSelectionStoreProvider=p,this.storyServices=h,this.visualValidationContainer=g}return t.$inject=["flags","wizardService","defaultsService","presetService","presetPreviewGenerator","mobileSectionValidator","presetSettingsService","Story","ContentElement","modelTree","modelSerialize","menuService","layoutSelectionStoreProvider","storyServices","visualValidationContainer"],t.prototype.init=function(){this.flags.separateVisualValidationFromSanta=!0,this.flags.coreHeaderFooterDesignKitConfig=!0,this.flags.dontUseDSForCompDef=!0,this.flags.coreUseKitlerCatalog=!0,this.flags.loadLayoutsLater=!0,this.flags.consumerMode=!0,this.flags.lodash4=!0,this.visualValidationDiv=document.createElement("visual-validation"),document.body.appendChild(this.visualValidationDiv),this.visualValidationContainer.init(angular.element(this.visualValidationDiv)),angular.element(this.visualValidationDiv).html("");var e=this.createFakeStory();return this.wizardService.paasInit(e)},t.prototype.destroy=function(){document.body.removeChild(this.visualValidationDiv)},t.prototype.suggestSectionPresets=function(e){return a(this,void 0,void 0,function(){var t,i,n,o=this;return s(this,function(r){switch(r.label){case 0:return t=this.prepareDraft(e),this.strategy=this.createGenericStrategy(),[4,this.strategy.generateListOfPreviews([t],!1)];case 1:return i=r.sent(),[4,Promise.all(i.map(function(e){return o.strategy.calculatePresetPreview(e)}))];case 2:return n=r.sent(),[2,_.filter(n,function(e){return null!==e})]}})})},t.prototype.selectSection=function(e,t){return a(this,void 0,void 0,function(){return s(this,function(i){return[2,this.storyServices.generateSolutionRenderInstructions(e.solution,t)]})})},t.prototype.prepareDraft=function(e){var t=this.creteFakeDraft(e),i=this.modelTree.createNodeFromCE(t,"999."+t.type+"_0");return i.alias=e,_.forEach(i.children,function(e){return e.alias=i.alias}),t.items||(i.hiddenMedia=_.clone(t.getHiddenMedia())),i.isDraft=!0,i},t.prototype.creteFakeDraft=function(e){var t=new this.ContentElement(e);return t.values={AboutTitle:{type:"text",subType:"title",value:"This is Your About Teaser Title",id:"746154d0d93f492eef4ef671"},AboutBody:{type:"text",subType:"longText",value:"This is your Homepage About Section. It\u2019s a great space to write a  short snippet of text summarizing what you do and what your site is about. Consider adding an eye catching image and a button that leads the visitor to a full About Section.",id:"746154d0d93f492eef4ef671"},AboutMedia:{type:"media",subType:"image",value:[{Title:"Mountains in Fog",fileInput:{face:[]},fileUrl:"media/2978daa662a4416aa051f49aa2d13422.jpg",uri:"2978daa662a4416aa051f49aa2d13422.jpg",height:2592,width:3872,mediaType:"image",relativeUri:"2978daa662a4416aa051f49aa2d13422.jpg",usage:"all"},{Title:"Forest Home",fileInput:{face:[]},fileUrl:"media/48a3aaf93d81484fac1477fd65ed5c32.jpg",uri:"48a3aaf93d81484fac1477fd65ed5c32.jpg",height:3269,width:4904,mediaType:"image",relativeUri:"48a3aaf93d81484fac1477fd65ed5c32.jpg",usage:"all"},{Title:"Palm Trees",fileInput:{face:[]},fileUrl:"media/f102399b227b4cb9a99a0bd552240528.jpg",uri:"f102399b227b4cb9a99a0bd552240528.jpg",height:1673,width:2509,mediaType:"image",relativeUri:"f102399b227b4cb9a99a0bd552240528.jpg",usage:"all"},{Title:"Desert",fileInput:{face:[]},fileUrl:"media/5cce5e6b3c4e466bada76c875f9e1563.jpg",uri:"5cce5e6b3c4e466bada76c875f9e1563.jpg",height:2592,width:3872,mediaType:"image",relativeUri:"5cce5e6b3c4e466bada76c875f9e1563.jpg",usage:"all"},{Title:"Mountains in Clouds",fileInput:{face:[]},fileUrl:"media/61449d37e2c84f6ca369b41542d785a3.jpg",uri:"61449d37e2c84f6ca369b41542d785a3.jpg",height:4016,width:6016,mediaType:"image",relativeUri:"61449d37e2c84f6ca369b41542d785a3.jpg",usage:"all"},{Title:"Grassy Mountains",fileInput:{face:[]},fileUrl:"media/bfed04b421d5458cbb1947766ebc9ca4.jpg",uri:"bfed04b421d5458cbb1947766ebc9ca4.jpg",height:3648,width:5472,mediaType:"image",relativeUri:"bfed04b421d5458cbb1947766ebc9ca4.jpg",usage:"all"},{Title:"White Structure",fileInput:{face:[]},fileUrl:"media/ad7b01298cb542c1bfcf925581b4755a.jpg",uri:"ad7b01298cb542c1bfcf925581b4755a.jpg",height:3376,width:5064,mediaType:"image",relativeUri:"ad7b01298cb542c1bfcf925581b4755a.jpg",usage:"all"},{Title:"Wood Structure",fileInput:{face:[]},fileUrl:"media/fd0de853c8734ed0b01b110d79d8d166.jpg",uri:"fd0de853c8734ed0b01b110d79d8d166.jpg",height:4e3,width:6e3,mediaType:"image",relativeUri:"fd0de853c8734ed0b01b110d79d8d166.jpg",usage:"all"},{Title:"Surfer",fileInput:{face:[]},fileUrl:"media/842e8b5e3918486fb2757103bed7eb03.jpg",uri:"842e8b5e3918486fb2757103bed7eb03.jpg",height:1250,width:2001,mediaType:"image",relativeUri:"842e8b5e3918486fb2757103bed7eb03.jpg",usage:"all"},{Title:"Coastline",fileInput:{face:[]},fileUrl:"media/50b0017c607d448aa184338fe05563bb.jpg",uri:"50b0017c607d448aa184338fe05563bb.jpg",height:2990,width:5207,mediaType:"image",relativeUri:"50b0017c607d448aa184338fe05563bb.jpg",usage:"all"},{Title:"White Wall with Stairs",fileInput:{face:[]},fileUrl:"media/86a4251d5bc84575b0ca107557e839ed.jpg",uri:"86a4251d5bc84575b0ca107557e839ed.jpg",height:2990,width:4485,mediaType:"image",relativeUri:"86a4251d5bc84575b0ca107557e839ed.jpg",usage:"all"},{Title:"Red Mountain",fileInput:{face:[]},fileUrl:"media/81a5667bff124709a7c30dcaf4fc0e35.jpg",uri:"81a5667bff124709a7c30dcaf4fc0e35.jpg",height:2732,width:4096,mediaType:"image",relativeUri:"81a5667bff124709a7c30dcaf4fc0e35.jpg",usage:"all"},{Title:"Pink Building",fileInput:{face:[]},fileUrl:"media/aee905421679410f91ab187679fb02d4.jpg",uri:"aee905421679410f91ab187679fb02d4.jpg",height:3456,width:4853,mediaType:"image",relativeUri:"aee905421679410f91ab187679fb02d4.jpg",usage:"all"},{Title:"Shore",fileInput:{face:[]},fileUrl:"media/9206a62cfc3a401db31ca6829fe7008e.jpg",uri:"9206a62cfc3a401db31ca6829fe7008e.jpg",height:3264,width:4896,mediaType:"image",relativeUri:"9206a62cfc3a401db31ca6829fe7008e.jpg",usage:"all"},{Title:"Fern Plant",fileInput:{face:[]},fileUrl:"media/03f22a3cb4d543b9b7ffcaae2f53a15f.jpg",uri:"03f22a3cb4d543b9b7ffcaae2f53a15f.jpg",height:4016,width:6016,mediaType:"image",relativeUri:"03f22a3cb4d543b9b7ffcaae2f53a15f.jpg",usage:"all"},{fileName:"79c181a84f5a4f3e9a64a2fd3446f7f2.svg",fileUrl:"shapes/79c181a84f5a4f3e9a64a2fd3446f7f2.svg",uri:"05b483649121487f8c74988bd75d001b.svg",title:"About",mediaType:"shape",relativeUri:"shapes/79c181a84f5a4f3e9a64a2fd3446f7f2.svg",usage:"content"},{Title:"Black and White Star in Circle",mediaType:"clipart",relativeUri:"7784bb4d6d5e448aacbf908cbe3a95e0.png",uri:"7784bb4d6d5e448aacbf908cbe3a95e0.png",fileUrl:"media/7784bb4d6d5e448aacbf908cbe3a95e0.png",width:378,height:349,usage:"content"},{Title:"Serving Coffee",fileBaseUrl:"video/11062b_482865fdd2424d17828b72e1e1db16f7",fileInput:{duration:11760},fileOutput:{image:[{url:"media/11062b_482865fdd2424d17828b72e1e1db16f7f000.jpg",width:1920,height:1080},{url:"media/11062b_482865fdd2424d17828b72e1e1db16f7f001.jpg",width:1920,height:1080},{url:"media/11062b_482865fdd2424d17828b72e1e1db16f7f002.jpg",width:1920,height:1080},{url:"media/11062b_482865fdd2424d17828b72e1e1db16f7f003.jpg",width:1920,height:1080}],video:[{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/480p/mp4/file.mp4",quality:"480p",width:853,height:480,format:"mp4"},{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/480p/webm/file.webm",quality:"480p",width:853,height:480,format:"webm"},{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/720p/mp4/file.mp4",quality:"720p",width:1280,height:720,format:"mp4"},{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/720p/webm/file.webm",quality:"720p",width:1280,height:720,format:"webm"},{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/1080p/mp4/file.mp4",quality:"1080p",width:1920,height:1080,format:"mp4"},{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/1080p/webm/file.webm",quality:"1080p",width:1920,height:1080,format:"webm"}]},mediaType:"video",relativeUri:"11062b_482865fdd2424d17828b72e1e1db16f7",thumbnailUrl:"https://static.wixstatic.com/media/11062b_0002142444534490b950a8797535371df000.jpg_srz_p_100_70_75_22_0.50_1.20_0.00_jpg_srz",usage:"all"},{Title:"Urban View",fileBaseUrl:"video/11062b_482865fdd2424d17828b72e1e1db16f7",fileInput:{duration:19600},fileOutput:{image:[{url:"media/11062b_482865fdd2424d17828b72e1e1db16f7f000.jpg",width:1920,height:1080},{url:"media/11062b_482865fdd2424d17828b72e1e1db16f7f001.jpg",width:1920,height:1080},{url:"media/11062b_482865fdd2424d17828b72e1e1db16f7f002.jpg",width:1920,height:1080},{url:"media/11062b_482865fdd2424d17828b72e1e1db16f7f003.jpg",width:1920,height:1080}],video:[{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/480p/mp4/file.mp4",quality:"480p",width:853,height:480,format:"mp4"},{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/480p/webm/file.webm",quality:"480p",width:853,height:480,format:"webm"},{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/720p/mp4/file.mp4",quality:"720p",width:1280,height:720,format:"mp4"},{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/720p/webm/file.webm",quality:"720p",width:1280,height:720,format:"webm"},{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/1080p/mp4/file.mp4",quality:"1080p",width:1920,height:1080,format:"mp4"},{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/1080p/webm/file.webm",quality:"1080p",width:1920,height:1080,format:"webm"}]},mediaType:"video",relativeUri:"11062b_482865fdd2424d17828b72e1e1db16f7",thumbnailUrl:"https://static.wixstatic.com/media/11062b_3e2f37c297534f9ead156265242fbca8f000.jpg_srz_p_100_70_75_22_0.50_1.20_0.00_jpg_srz",usage:"all"},{mediaType:"extVideo",videoUrl:"https://vimeo.com/134734962",usage:"content"},{mediaType:"extVideo",videoUrl:"https://vimeo.com/135171563",usage:"content"},{mediaType:"extVideo",videoUrl:"https://vimeo.com/200660389",usage:"content"}]},AboutSubtitle:{type:"text",subType:"subTitle",value:"This is Your About Teaser Subtitle",id:"746154d0d93f492eef4ef671"},button:{type:"button",subType:"button",value:{callToAction:"Read More"},id:"746154d0d93f492eef4ef671"}},t},t.prototype.createGenericStrategy=function(){var t={strategyMode:e.PresetsStrategyMode.Add,sitePart:AdiCoreSanta.sitePartTypes.BODY};return new e.GenericPresetsStrategy(t,this.defaultsService,this.presetService,this.presetPreviewGenerator,this.mobileSectionValidator,this.flags,this.presetSettingsService)},t.prototype.createFakeStory=function(){var e=this.createInitialBlob(),t=new this.Story({dbStory:e,bft:"{}",owner:{},selectedPage:"",selectedStyle:{}});return this.setState(t,e.blob,!0),t},t.prototype.setState=function(e,t,i){if(_.assign(e,t),t.locale){var n=_.isString(t.locale)?JSON.parse(t.locale):ob.deepClone(t.locale);e.storyLocales[e.activeLocale]=n,e.selectedStyle=_.isString(t.selectedStyle)?JSON.parse(t.selectedStyle):ob.deepClone(t.selectedStyle),t.contentElements=t.contentElements||{},t.flags=t.flags||{},e.contentElements=_.isString(t.contentElements)?JSON.parse(t.contentElements):ob.deepClone(t.contentElements),i||(this.menuService.deserialize(t.mainMenu),e.bft=this.modelTree.deserialize(t.bft),this.layoutSelectionStoreProvider.getLayoutSelectionStore().deserialize(n.layoutSelections)),i&&t.locale.renderedModel&&this.modelSerialize.deserialize(t.locale.renderedModel)}},t.prototype.createInitialBlob=function(){return{storyId:"",revision:2,blob:{description:null,selectedPage:"page1001",name:null,selectedStyle:{mainKit:"40a3031c8ac942328a4f4a0f4db3c9cc",coloration:{mainColor:"#E6D8D7",secondaryColor:"#705959",thirdColor:"#191919",fourthColor:"#F7F7F7",black:"#000000",white:"#FFFFFF",currentState:2,colorationLevel:0,colorationVersion:1,kitId:"40a3031c8ac942328a4f4a0f4db3c9cc"},colorationConfigs:{confPattern:[{display:"D1",id:3},{display:"L1",id:0}],headerAndFooter:{footerTextColoring:0,headerTextColoring:0,stripFooter:"{color_15}",stripHeader:"{color_15}",selectedMenuOnStrip:"{color_27}",selectedMenuOnHeader:"{color_25}",headerBgColor:"{color_11}"},configurations:[[{colorIndex:0,stripColor:"{color_11}",cutsomColor:{buttonbg:"{color_15}",buttontext:"{color_11}"},longTextColor:"{color_15}",subTitleColor:"{color_15}",titleColor:"{color_15}"},{colorIndex:0,stripColor:"{color_11}",cutsomColor:{container2:"{color_15}",buttonbg:"{color_11}",buttontext:"{color_15}"},longTextColor:"{color_11}",subTitleColor:"{color_11}",titleColor:"{color_11}"},{colorIndex:0,stripColor:"{color_11}",cutsomColor:{container2:"{color_15}",buttonbg:"{color_11}",buttontext:"{color_15}",container0:"{color_15}",linetitlebeneath:"{color_11}"},longTextColor:"{color_11}",subTitleColor:"{color_11}",titleColor:"{color_11}"}],[{colorIndex:0,stripColor:"{color_27}",cutsomColor:{buttonbg:"{color_15}",buttontext:"{color_11}"},longTextColor:"{color_15}",subTitleColor:"{color_15}",titleColor:"{color_15}"},{colorIndex:0,stripColor:"{color_27}",cutsomColor:{container2:"{color_11}",buttonbg:"{color_15}",buttontext:"{color_11}"},longTextColor:"{color_15}",subTitleColor:"{color_15}",titleColor:"{color_15}"},{colorIndex:0,stripColor:"{color_27}",cutsomColor:{container2:"{color_11}",buttonbg:"{color_15}",buttontext:"{color_11}",container0:"{color_11}",linetitlebeneath:"{color_15}"},longTextColor:"{color_15}",subTitleColor:"{color_15}",titleColor:"{color_15}"}],[{colorIndex:0,stripColor:"{color_32}",cutsomColor:{buttonbg:"{color_15}",buttontext:"{color_11}"},longTextColor:"{color_15}",subTitleColor:"{color_15}",titleColor:"{color_15}"},{colorIndex:0,stripColor:"{color_32}",cutsomColor:{container2:"{color_11}",buttonbg:"{color_15}",buttontext:"{color_11}"},longTextColor:"{color_15}",subTitleColor:"{color_15}",titleColor:"{color_15}"},{colorIndex:0,stripColor:"{color_32}",cutsomColor:{container2:"{color_11}",buttonbg:"{color_15}",buttontext:"{color_11}",container0:"{color_11}",linetitlebeneath:"{color_15}"},longTextColor:"{color_15}",subTitleColor:"{color_15}",titleColor:"{color_15}"}],[{colorIndex:0,stripColor:"{color_15}",cutsomColor:{buttonbg:"{color_11}",buttontext:"{color_15}"},longTextColor:"{color_11}",subTitleColor:"{color_11}",titleColor:"{color_11}"},{colorIndex:0,stripColor:"{color_15}",cutsomColor:{container2:"{color_11}",buttonbg:"{color_15}",buttontext:"{color_11}"},longTextColor:"{color_15}",subTitleColor:"{color_15}",titleColor:"{color_15}"},{colorIndex:0,stripColor:"{color_15}",cutsomColor:{container2:"{color_11}",buttonbg:"{color_15}",buttontext:"{color_11}",container0:"{color_11}",linetitlebeneath:"{color_15}"},longTextColor:"{color_15}",subTitleColor:"{color_15}",titleColor:"{color_15}"}],[{colorIndex:0,stripColor:"{color_25}",cutsomColor:{buttonbg:"{color_11}",buttontext:"{color_15}"},longTextColor:"{color_11}",subTitleColor:"{color_11}",titleColor:"{color_11}"},{colorIndex:0,stripColor:"{color_25}",cutsomColor:{container2:"{color_11}",buttonbg:"{color_15}",buttontext:"{color_11}"},longTextColor:"{color_15}",subTitleColor:"{color_15}",titleColor:"{color_15}"},{colorIndex:0,stripColor:"{color_25}",cutsomColor:{container2:"{color_11}",buttonbg:"{color_15}",buttontext:"{color_11}",container0:"{color_11}",linetitlebeneath:"{color_15}"},longTextColor:"{color_15}",subTitleColor:"{color_15}",titleColor:"{color_15}"}],[{colorIndex:0,stripColor:"{color_18}",cutsomColor:{buttonbg:"{color_11}",buttontext:"{color_15}"},longTextColor:"{color_11}",subTitleColor:"{color_11}",titleColor:"{color_11}"},{colorIndex:0,stripColor:"{color_18}",cutsomColor:{container2:"{color_11}",buttonbg:"{color_15}",buttontext:"{color_11}"},longTextColor:"{color_15}",subTitleColor:"{color_15}",titleColor:"{color_15}"},{colorIndex:0,stripColor:"{color_18}",cutsomColor:{container2:"{color_11}",buttonbg:"{color_15}",buttontext:"{color_11}",container0:"{color_11}",linetitlebeneath:"{color_15}"},longTextColor:"{color_15}",subTitleColor:"{color_15}",titleColor:"{color_15}"}]],styles:{hc1:{bg:"color_11",bgctr:"color_11",brd:"color_11"},fc1:{bg:"color_11",bgctr:"color_11",brd:"color_11"}}}},contentElements:{},activeLocale:"en",archived:null,industryId:"e79e5765052b89b579c9a4c2",structureId:"40dc538a8a6c3e2dae342922",selectedOffers:[{type:"Stores",checked:!1},{type:"Bookings",checked:!1},{type:"GetSubscribers",checked:!1},{type:"Chat",checked:!0},{type:"Blog2",checked:!1}],contentVersion:"1.293.0",staticsVersion:"DEV",privateMediaFolderId:"",coloration:null,smartAssist:null,headlessSiteBuildDone:!1,createdFromTemplate:!1,flags:{},locale:{savedSites:{undefined:{pagesMap:{},nodesRefMap:{}}},contentElements:{"1_11":{CompanySize:{type:"text",subType:"companySize"},Founder:{type:"text",subType:"founder"},YearFounded:{type:"text",subType:"yearFounded"},BusinessType:{type:"text",subType:"businessType"},MainEmail:{type:"text",subType:"email",value:"info@mysite.com"},BusinessName:{type:"text",subType:"title",value:'\uffff\ufffe<p class="font_7"><span style="text-decoration:none;"><a adilinkid="adi_link_c8e01dbe">quickStory</a></span></p>'},BusinessTagline:{type:"text",subType:"subTitle",value:"Business tagline"},CopyrightMessage:{type:"text",subType:"copyrightMSG",value:"\xa92018 by quickStory. Proudly created with Wix.com"},Logo:{type:"media",subType:"image",value:[{Title:"Black and White Star in Circle",mediaType:"clipart",relativeUri:"7784bb4d6d5e448aacbf908cbe3a95e0.png",uri:"7784bb4d6d5e448aacbf908cbe3a95e0.png",fileUrl:"media/7784bb4d6d5e448aacbf908cbe3a95e0.png",width:378,height:349},{Description:"",Title:"Graphic Shape 4",mediaType:"shape",relativeUri:"shapes/2e796bc57637468ba28a8ca2e254810f.svg"}]},button:{type:"button",subType:"button",value:{callToAction:"Get In Touch"}},Login:{type:"widget",subType:"login",value:{loginBarShow:"avatarOnly",loginBarText:"",isAutoApproved:!0,hasMembersArea:!1,membersAreaWasInstalled:!1,enableGoogleLogin:!0,enableFacebookLogin:!0}},Menu:{signature:"menu",subType:"menu",type:"menu",value:!0}},page1001:{displayName:{type:"text",subType:"longText",value:"ADI Page"},pageTitleSEO:{type:"text",subType:"pageTitleSEO",value:""},descriptionSEO:{type:"text",subType:"descriptionSEO",value:""},metaKeywordsSEO:{type:"text",subType:"metaKeywordsSEO",value:""},pageUriSEO:{type:"text",subType:"pageUriSEO",value:"ADI Page"},indexable:{type:"bool",subType:"indexable",value:!0}},page1001_header:{Button:{type:"button",subType:"button",value:{callToAction:"BUTTON TEXT",isPageRef:!1,media:[],targetUrl:""}},PageTitle:{type:"text",subType:"title",value:"Page Header Title"},PageSubTitle:{type:"text",subType:"subTitle",value:"Page Header Subtitle"},PageMedia:{type:"media",subType:"image",value:[{Description:"",Link:{isPageRef:!1,targetPage:"page179"},Title:"",fileName:"Concrete Skate and Bike Park",height:1285,mediaType:"image",relativeUri:"7b9cc6dc9f4d43838a59d50767fd0b49.jpg",width:1920}]},PageDescription:{type:"text",subType:"longText",value:"Page Description"}},"1_101":{SocialButtons:{type:"media",subType:"social",value:[{fileName:"facebook",relativeUri:"0fdef751204647a3bbd7eaa2827ed4f9.png",width:200,height:200,Title:"",Description:"",Link:{targetUrl:"https://www.facebook.com/wix"},mediaType:"icon",platform:"facebook"},{fileName:"twitter",relativeUri:"c7d035ba85f6486680c2facedecdcf4d.png",width:200,height:200,Title:"",Description:"",Link:{targetUrl:"https://twitter.com/Wix"},mediaType:"icon",platform:"twitter"},{fileName:"Linkedin",relativeUri:"6ea5b4a88f0b4f91945b40499aa0af00.png",width:200,height:200,Title:"",Description:"",Link:{targetUrl:"https://www.linkedin.com/company/wix-com"},mediaType:"icon",platform:"linkedin"}]},SocialTitle:{type:"text",subType:"title",value:"quickStory"}},"1_102":{Country:{type:"text",subType:"country"},State:{type:"text",subType:"state"},City:{type:"text",subType:"city"},Street:{type:"text",subType:"street"},ZipCode:{type:"text",subType:"zipCode"},"Contact Title":{type:"text",subType:"title",value:"Contact"},"Contact Media":{type:"media",subType:"image",value:[{Title:"Mountains in Fog",fileInput:{face:[]},fileUrl:"media/2978daa662a4416aa051f49aa2d13422.jpg",uri:"2978daa662a4416aa051f49aa2d13422.jpg",height:2592,width:3872,mediaType:"image",relativeUri:"2978daa662a4416aa051f49aa2d13422.jpg",usage:"all"},{Title:"Forest Home",fileInput:{face:[]},fileUrl:"media/48a3aaf93d81484fac1477fd65ed5c32.jpg",uri:"48a3aaf93d81484fac1477fd65ed5c32.jpg",height:3269,width:4904,mediaType:"image",relativeUri:"48a3aaf93d81484fac1477fd65ed5c32.jpg",usage:"all"},{Title:"Palm Trees",fileInput:{face:[]},fileUrl:"media/f102399b227b4cb9a99a0bd552240528.jpg",uri:"f102399b227b4cb9a99a0bd552240528.jpg",height:1673,width:2509,mediaType:"image",relativeUri:"f102399b227b4cb9a99a0bd552240528.jpg",usage:"all"},{Title:"Desert",fileInput:{face:[]},fileUrl:"media/5cce5e6b3c4e466bada76c875f9e1563.jpg",uri:"5cce5e6b3c4e466bada76c875f9e1563.jpg",height:2592,width:3872,mediaType:"image",relativeUri:"5cce5e6b3c4e466bada76c875f9e1563.jpg",usage:"all"},{Title:"Mountains in Clouds",fileInput:{face:[]},fileUrl:"media/61449d37e2c84f6ca369b41542d785a3.jpg",uri:"61449d37e2c84f6ca369b41542d785a3.jpg",height:4016,width:6016,mediaType:"image",relativeUri:"61449d37e2c84f6ca369b41542d785a3.jpg",usage:"all"},{Title:"Grassy Mountains",fileInput:{face:[]},fileUrl:"media/bfed04b421d5458cbb1947766ebc9ca4.jpg",uri:"bfed04b421d5458cbb1947766ebc9ca4.jpg",height:3648,width:5472,mediaType:"image",relativeUri:"bfed04b421d5458cbb1947766ebc9ca4.jpg",usage:"all"},{Title:"White Structure",fileInput:{face:[]},fileUrl:"media/ad7b01298cb542c1bfcf925581b4755a.jpg",uri:"ad7b01298cb542c1bfcf925581b4755a.jpg",height:3376,width:5064,mediaType:"image",relativeUri:"ad7b01298cb542c1bfcf925581b4755a.jpg",usage:"all"},{Title:"Wood Structure",fileInput:{face:[]},fileUrl:"media/fd0de853c8734ed0b01b110d79d8d166.jpg",uri:"fd0de853c8734ed0b01b110d79d8d166.jpg",height:4e3,width:6e3,mediaType:"image",relativeUri:"fd0de853c8734ed0b01b110d79d8d166.jpg",usage:"all"},{Title:"Surfer",fileInput:{face:[]},fileUrl:"media/842e8b5e3918486fb2757103bed7eb03.jpg",uri:"842e8b5e3918486fb2757103bed7eb03.jpg",height:1250,width:2001,mediaType:"image",relativeUri:"842e8b5e3918486fb2757103bed7eb03.jpg",usage:"all"},{Title:"Coastline",fileInput:{face:[]},fileUrl:"media/50b0017c607d448aa184338fe05563bb.jpg",uri:"50b0017c607d448aa184338fe05563bb.jpg",height:2990,width:5207,mediaType:"image",relativeUri:"50b0017c607d448aa184338fe05563bb.jpg",usage:"all"},{Title:"White Wall with Stairs",fileInput:{face:[]},fileUrl:"media/86a4251d5bc84575b0ca107557e839ed.jpg",uri:"86a4251d5bc84575b0ca107557e839ed.jpg",height:2990,width:4485,mediaType:"image",relativeUri:"86a4251d5bc84575b0ca107557e839ed.jpg",usage:"all"},{Title:"Red Mountain",fileInput:{face:[]},fileUrl:"media/81a5667bff124709a7c30dcaf4fc0e35.jpg",uri:"81a5667bff124709a7c30dcaf4fc0e35.jpg",height:2732,width:4096,mediaType:"image",relativeUri:"81a5667bff124709a7c30dcaf4fc0e35.jpg",usage:"all"},{Title:"Pink Building",fileInput:{face:[]},fileUrl:"media/aee905421679410f91ab187679fb02d4.jpg",uri:"aee905421679410f91ab187679fb02d4.jpg",height:3456,width:4853,mediaType:"image",relativeUri:"aee905421679410f91ab187679fb02d4.jpg",usage:"all"},{Title:"Shore",fileInput:{face:[]},fileUrl:"media/9206a62cfc3a401db31ca6829fe7008e.jpg",uri:"9206a62cfc3a401db31ca6829fe7008e.jpg",height:3264,width:4896,mediaType:"image",relativeUri:"9206a62cfc3a401db31ca6829fe7008e.jpg",usage:"all"},{Title:"Fern Plant",fileInput:{face:[]},fileUrl:"media/03f22a3cb4d543b9b7ffcaae2f53a15f.jpg",uri:"03f22a3cb4d543b9b7ffcaae2f53a15f.jpg",height:4016,width:6016,mediaType:"image",relativeUri:"03f22a3cb4d543b9b7ffcaae2f53a15f.jpg",usage:"all"},{fileName:"5d88a227a1194aa6a0fc1cc483f55caf.svg",fileUrl:"shapes/5d88a227a1194aa6a0fc1cc483f55caf.svg",uri:"05b483649121487f8c74988bd75d001b.svg",title:"Services",mediaType:"shape",relativeUri:"shapes/5d88a227a1194aa6a0fc1cc483f55caf.svg",usage:"content"},{Title:"Black and White Star in Circle",mediaType:"clipart",relativeUri:"7784bb4d6d5e448aacbf908cbe3a95e0.png",uri:"7784bb4d6d5e448aacbf908cbe3a95e0.png",fileUrl:"media/7784bb4d6d5e448aacbf908cbe3a95e0.png",width:378,height:349,usage:"content"},{Title:"Urban View",fileBaseUrl:"video/11062b_482865fdd2424d17828b72e1e1db16f7",fileInput:{duration:19600},fileOutput:{image:[{url:"media/11062b_482865fdd2424d17828b72e1e1db16f7f000.jpg",width:1920,height:1080},{url:"media/11062b_482865fdd2424d17828b72e1e1db16f7f001.jpg",width:1920,height:1080},{url:"media/11062b_482865fdd2424d17828b72e1e1db16f7f002.jpg",width:1920,height:1080},{url:"media/11062b_482865fdd2424d17828b72e1e1db16f7f003.jpg",width:1920,height:1080}],video:[{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/480p/mp4/file.mp4",quality:"480p",width:853,height:480,format:"mp4"},{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/480p/webm/file.webm",quality:"480p",width:853,height:480,format:"webm"},{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/720p/mp4/file.mp4",quality:"720p",width:1280,height:720,format:"mp4"},{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/720p/webm/file.webm",quality:"720p",width:1280,height:720,format:"webm"},{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/1080p/mp4/file.mp4",quality:"1080p",width:1920,height:1080,format:"mp4"},{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/1080p/webm/file.webm",quality:"1080p",width:1920,height:1080,format:"webm"}]},mediaType:"video",relativeUri:"11062b_482865fdd2424d17828b72e1e1db16f7",thumbnailUrl:"https://static.wixstatic.com/media/11062b_3e2f37c297534f9ead156265242fbca8f000.jpg_srz_p_100_70_75_22_0.50_1.20_0.00_jpg_srz",usage:"all"},{Title:"Serving Coffee",fileBaseUrl:"video/11062b_482865fdd2424d17828b72e1e1db16f7",fileInput:{duration:11760},fileOutput:{image:[{url:"media/11062b_482865fdd2424d17828b72e1e1db16f7f000.jpg",width:1920,height:1080},{url:"media/11062b_482865fdd2424d17828b72e1e1db16f7f001.jpg",width:1920,height:1080},{url:"media/11062b_482865fdd2424d17828b72e1e1db16f7f002.jpg",width:1920,height:1080},{url:"media/11062b_482865fdd2424d17828b72e1e1db16f7f003.jpg",width:1920,height:1080}],video:[{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/480p/mp4/file.mp4",quality:"480p",width:853,height:480,format:"mp4"},{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/480p/webm/file.webm",quality:"480p",width:853,height:480,format:"webm"},{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/720p/mp4/file.mp4",quality:"720p",width:1280,height:720,format:"mp4"},{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/720p/webm/file.webm",quality:"720p",width:1280,height:720,format:"webm"},{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/1080p/mp4/file.mp4",quality:"1080p",width:1920,height:1080,format:"mp4"},{url:"video/11062b_482865fdd2424d17828b72e1e1db16f7/1080p/webm/file.webm",quality:"1080p",width:1920,height:1080,format:"webm"}]},mediaType:"video",relativeUri:"11062b_482865fdd2424d17828b72e1e1db16f7",thumbnailUrl:"https://static.wixstatic.com/media/11062b_0002142444534490b950a8797535371df000.jpg_srz_p_100_70_75_22_0.50_1.20_0.00_jpg_srz",usage:"all"},{mediaType:"extVideo",videoUrl:"https://vimeo.com/134734962",usage:"content"},{mediaType:"extVideo",videoUrl:"https://vimeo.com/135171563",usage:"content"},{mediaType:"extVideo",videoUrl:"https://vimeo.com/200660389",usage:"content"}]},"address for google map":{type:"text",subType:"map",value:"500 Terry Francois Street San Francisco, CA 94158",dependent:"Show google map"},"address for display":{type:"text",subType:"address",value:"500 Terry Francois Street San Francisco, CA 94158"},"Contact form title":{type:"text",subType:"ContactFormTitle",value:"Contact quickStory",dependent:"Show contact form"},fax:{type:"text",subType:"fax",value:"456-789-1234"},"Contact description":{type:"text",subType:"longText",value:"This is your Contact Section. Go on, be outgoing and friendly! Let the world know the best way to reach you.  Keep it amiable and light to encourage visitors to get in touch.",name:"Contact description"},email:{type:"text",subType:"email",value:"info@mysite.com"},"phone number":{type:"text",subType:"phoneNumber",value:"123-456-7890"},"Show contact form":{type:"gate",subType:"gate",dependencies:["Contact form title","Contact form email"]},"Show google map":{type:"gate",subType:"gate",dependencies:["address for google map"]},"Contact form email":{type:"text",subType:"form",value:"Contact form email",dependent:"Show contact form"}}},layoutSelections:{pages:{general:{},page1001:{node_page1001:{}}},overrides:{style:{},media:{}},fontOverrides:{},menuOverrides:{alignment:"center",stretchButtons:!0},textFormatting:{},variations:{},fixedHeader:!1,tpaService:{},designPolicy:{id:"linear",factor:1,lineHeight:1,formula:"dp1"},siteOverrides:{siteScrollType:"scroll",sitePagesTransition:"outIn"},lgData:{},imageShadows:{},imageStretches:{},decorations:{}},styles:{},renderedModel:{model:{pages:[]}}},userRoles:[],ownerId:null,importedSite:null,popupConfigurations:{},tipMessages:{},visitedTasks:{},mobileEditorActive:!0,tourState:{},nodeIdToSlideshowTransition:{},revisionsUpdated:0,adiFeatures:{htmlRevision:!0},htmlRevision:1,mainMenu:'[{"id":"page1001","children":[],"name":"ADI Page","isHiddenFromMenu":false,"page":true}]',bft:{data:{id:"1",displayName:"1",userHidden:!1,argsMatchingPolicy:{PageDescription:!0,PageMedia:!0,PageTitle:!0},mobileArgsPolicy:{},referenceFields:{},mobileReferenceFields:{},crossPageConnected:!1,nextFirstLevelNodeId:112,nextPageNodeId:1001,layoutFilter:"f",children:[{id:"1.11",displayName:"1.11",userHidden:!1,contentElementType:"GeneralDescription",type:"contentElement",argsMatchingPolicy:{BusinessName:!0,Logo:!1,BusinessTagline:!1,Menu:!0,MainEmail:!1},mobileArgsPolicy:{},referenceFields:{"Contact.phone number":!1,"Social.SocialButtons":!1},mobileReferenceFields:{},hiddenMedia:{image:{},video:{},audio:{},shape:{"shapes/2e796bc57637468ba28a8ca2e254810f.svg":!0}},crossPageConnected:!1,layoutFilter:"f",children:[]},{id:"page1001",alias:"ADI Page",displayName:"ADI Page",userHidden:!1,contentElementType:"Page",type:"page",argsMatchingPolicy:{displayName:!0,pageTitleSEO:!1,descriptionSEO:!1,metaKeywordsSEO:!1,pageUriSEO:!1,indexable:!1},mobileArgsPolicy:{},referenceFields:{},mobileReferenceFields:{},crossPageConnected:!1,layoutFilter:"f",children:[{id:"page1001.header",displayName:"page1001.header",userHidden:!0,contentElementType:"PageHeader",type:"contentElement",containerPageId:"page1001",argsMatchingPolicy:{PageDescription:!0,PageMedia:!0,PageTitle:!0},mobileArgsPolicy:{},referenceFields:{},mobileReferenceFields:{},crossPageConnected:!0,layoutFilter:"f",children:[]}]},{id:"footer",displayName:"footer",userHidden:!1,contentElementType:"Footer",type:"footer",argsMatchingPolicy:{},mobileArgsPolicy:{},referenceFields:{},mobileReferenceFields:{},crossPageConnected:!1,layoutFilter:"f",children:[{id:"1.11",displayName:"1.11",userHidden:!1,contentElementType:"GeneralDescription",type:"contentElement",containerPageId:"footer",argsMatchingPolicy:{BusinessName:!1,Logo:!1,BusinessTagline:!1,Menu:!1,CompanySize:!1,Founder:!1,YearFounded:!1,BusinessType:!1,MainEmail:!1,CopyrightMessage:!0,button:!1,Login:!1},mobileArgsPolicy:{},referenceFields:{"Contact.fax":!1,"Contact.phone number":!1,"Social.SocialButtons":!0,"Contact.address for display":!1},mobileReferenceFields:{},crossPageConnected:!1,layoutFilter:"f",children:[]}]},{id:"masterPage",displayName:"masterPage",userHidden:!1,contentElementType:"MasterPage",type:"masterPage",argsMatchingPolicy:{},mobileArgsPolicy:{},referenceFields:{},mobileReferenceFields:{},crossPageConnected:!1,layoutFilter:"f",children:[]},{id:"1.101",displayName:"1.101",userHidden:!1,contentElementType:"Social",type:"contentElement",argsMatchingPolicy:{SocialButtons:!0,SocialTitle:!0},mobileArgsPolicy:{},referenceFields:{},mobileReferenceFields:{},crossPageConnected:!1,layoutFilter:"f",children:[]},{id:"1.102",displayName:"1.102",userHidden:!1,contentElementType:"Contact",type:"contentElement",argsMatchingPolicy:{"Contact Title":!0,"Contact Media":!0,"Contact description":!0,fax:!0,email:!0,"address for display":!0,"Show contact form":!0,"Contact form title":!0,"Contact form email":!0,"Show google map":!0,"Contact map title":!0,"address for google map":!0,"phone number":!0},mobileArgsPolicy:{},referenceFields:{"Social.SocialButtons":!0},mobileReferenceFields:{},crossPageConnected:!1,layoutFilter:"f",children:[]}]},homePageId:""},richTextLinks:{adi_link_c8e01dbe:{isPageRef:!0,targetPage:"page1001"}}},archived:!1,template:!1,isStoryOwner:!0,ownerId:"c2faeb3a-cdfc-499c-9d1b-d239f534fc27",userRoles:"owner",isDraft:!1}},t}();e.AdiPaas=t,angular.module("adiCoreAppInternal").service("adiPaas",t)}(S||(S={})),function(e){var t=function(){function t(t,i,n,o,r,a,s){this.strategyOptions=t,this.defaultsService=i,this.presetService=n,this.presetPreviewGenerator=o,this.mobileSectionValidator=r,this.flags=a,this.presetSettingsService=s,this.chunkIndex=0,this.maxChunks=0,this.staticIndex=0,this.hashMap={},this.sitePart=this.strategyOptions.sitePart,this.existingNode=this.strategyOptions.node,this.ceType=this.strategyOptions.strategyMode===e.PresetsStrategyMode.Change&&this.sitePart===AdiCoreSanta.sitePartTypes.HEADER?"SiteHeader":null}return t.prototype.generateListOfPreviews=function(e,t,i){var n=this;return void 0===i&&(i=!1),this.getPresets(e,t).then(function(o){var r=n.filterPresets(o,e),a=n.orderPresets(r,e),s=n.generatePreviewsFromPresets(e,a,t,i);return n.flags.coreNewMobileColumns&&t&&s.forEach(function(e){e.desktopSolution=n.strategyOptions.desktopSolution}),s})},t.prototype.generateNextChunkOfPreviews=function(t,i){return void 0===i&&(i=!1),this.strategyOptions.strategyMode===e.PresetsStrategyMode.Add&&this.chunkIndex<this.maxChunks?(this.presets=this.presetSettingsService.filterPresetsBySettings(this.presets,t,this.chunkIndex),this.presetPreviewGenerator.generateNewPreviews(t,this.presets,this.chunkIndex++,i)):[]},t.prototype.calculatePresetPreview=function(e,t){var i=this;return this.tryOverrideNextPreset(e),e=this.preCalculate(e,t),Promise.resolve().then(function(){if(!i.validateMobilePreset(e))return Promise.reject("Mobile preset does not fit desktop solution")}).then(function(){return i.presetService.calculateSolution(e,i.sitePart)}).then(function(t){return i.validatePresetPreview(e,t)?i.validateMobileSolution(e,t)?(i.tryUpdateNextOverridePreset(e),i.postCalculate(t,i.presets,i.existingNode,i.strategyOptions.strategyMode,i.sitePart),t):Promise.reject("Mobile solution does not fit desktop solution"):Promise.reject("Preset preview validation failed")}).catch(function(n){return i.flags.debugMode&&console.log("%cCannot create solution for preset/node\nPreset ID: "+e.preset.id+"\nReason: "+n,"color:red"),i.tryNextPreset(e,t)})},t.prototype.isUnique=function(t){if(this.strategyOptions.strategyMode===e.PresetsStrategyMode.Add)return!0;var i=this.getPresetVisualSignature(t);return this.hashMap[i]||(this.hashMap[i]=t),this.hashMap[i]===t},t.prototype.shouldLoadPreviousOnScroll=function(){return!0},t.prototype.getPresetVisualSignature=function(e){var t=this;return[_.map(e.solution,function(e){return[e.id,e.selectedHeightMutation,t.getColumnsVisualSignature(e),!(e.isMobile()&&e.isSiteHeader())&&_.get(e.getLgData(),["menuStrip","enable"])||!1,"["+_.map(e.segments,function(e){var i=e.getLENoError();return i&&[i.id,t.getLEVisualSignature(i)].join("$")}).join(",")+"]"].join("$")}).join("\n"),this.flags.mergedHeader&&e.flags?e.flags.join("$"):null].filter(function(e){return!!e}).join("$")},t.prototype.getPresets=function(t,i){var n=this.strategyOptions.strategyMode===e.PresetsStrategyMode.Add,o=t[0].isList();return this.flags.allPresets?this.defaultsService.getAllLayoutPresets(!1,this.flags.consumerMode?this.ceType:void 0).then(function(e){return e.filter(function(e){return o===e.data.isList&&i===Boolean(e.data.isMobile)&&-1===e.data.forContent.indexOf("SiteHeader")&&-1===e.data.forContent.indexOf("GeneralDescription")})}):this.defaultsService.getPresetsForNode(t[0],this.ceType,n,i,!i)},t.prototype.filterPresets=function(e,t){return this.strategyOptions&&this.strategyOptions.filterPresets?this.strategyOptions.filterPresets(e,t):e},t.prototype.orderPresets=function(e,t){return!this.flags.allPresets&&this.strategyOptions&&this.strategyOptions.orderPresets?this.strategyOptions.orderPresets(e,t):e.map(function(e){return{preset:e,maskIndex:0}})},t.prototype.generatePreviewsFromPresets=function(t,i,n,o){var r=this;if(void 0===o&&(o=!1),this.presets=i,this.tryJust1Preset(),this.strategyOptions.strategyMode===e.PresetsStrategyMode.Add)return this.maxChunks=AdiCoreSanta.maxPresetsIterations,this.presets=this.presetSettingsService.filterPresetsBySettings(this.presets,t,this.chunkIndex),this.presetPreviewGenerator.generateNewPreviews(t,this.presets,this.chunkIndex++,o);if(n||(this.presets=this.presetSettingsService.splitPresetsBySettings(this.presets,t)),this.strategyOptions.isBackgroundSupported&&!n&&this.sitePart===AdiCoreSanta.sitePartTypes.BODY){var a={isChangeBgSupported:this.strategyOptions.isChangeBgPermutationSupported},s=this.presetPreviewGenerator.generateAlternativePreviewsWithBg(t,this.presets,a);return this.flags.fpdOverStage&&this.strategyOptions.preferredMedia&&s.forEach(function(e){return e.node.preferredMedia=r.strategyOptions.preferredMedia}),s}return this.presetPreviewGenerator.generateAlternativePreviews(t,this.presets)},t.prototype.postCalculate=function(e,t,i,n,o){this.strategyOptions&&this.strategyOptions.postCalculate&&this.strategyOptions.postCalculate(e,t,i,n,o)},t.prototype.preCalculate=function(e,t){return this.strategyOptions&&this.strategyOptions.preCalculate?this.strategyOptions.preCalculate(e,t):e},t.prototype.validatePresetPreview=function(e,t){return!this.strategyOptions||!this.strategyOptions.validatePresetPreview||this.strategyOptions.validatePresetPreview(e,t)},t.prototype.validateMobilePreset=function(e){return!(e.preset.data.isMobile&&!this.mobileSectionValidator.validateMobilePreset(e.preset,this.sitePart,e.node.containerPageId,e.node.id))},t.prototype.validateMobileSolution=function(e,t){return!(t.preset.data.isMobile&&!this.mobileSectionValidator.validateMobileSolution(t.solution,this.sitePart,e.node.containerPageId,e.node.id))},t.prototype.tryOverrideNextPreset=function(e){e.staticRoundRobin&&(void 0===e.staticStartIndex&&(e.staticStartIndex=this.staticIndex),e.preset=this.presets[this.staticIndex].preset)},t.prototype.tryUpdateNextOverridePreset=function(e){e.staticRoundRobin&&(this.staticIndex=(this.staticIndex+1)%this.presets.length)},t.prototype.tryNextPreset=function(e,t){return e.staticRoundRobin&&(this.staticIndex=(this.staticIndex+1)%this.presets.length,e.staticStartIndex!==this.staticIndex)?this.calculatePresetPreview(e,t):null},t.prototype.getColumnsVisualSignature=function(e){var t=e.getColumnsData();return!(!t||!t.enable||e.isMobile())&&[t.colSplit,t.rowSplit,t.fullWidth,t.spacing,t.margin,t.columnVOffset||0,t.split].join(",")},t.prototype.getLEVisualSignature=function(e){var t=[],i=e.getLayoutSelectionStore();return e.recurseLayouts(function(n){var o;if(e.isMediaType(n)){var r=e.overrides&&e.overrides.media&&e.overrides.media[n.argIndex];o=r&&r.name||n.type}else switch(n.type){case"menu":o=[!i||i.menuOverridesManager.stretchButtons(),i?i.menuOverridesManager.alignment():"center"].join("|");case"text":o=e.getAlignment(n,"align")}o&&t.push(o)}),t.join("$")},t.prototype.tryJust1Preset=function(){var e=this;if(this.flags.debugMode&&this.flags.justThisPresetId){var t=_.find(this.presets,function(t){return t.preset.id===e.flags.justThisPresetId});t&&(this.presets=[t])}},t.prototype.preparePreset=function(e,t,i,n,o){var r=this;void 0===o&&(o=!1);var a=_.find(e,function(e){return e.id===t&&!(n&&!e.data.isMobile)}),s=this.generatePreviewsFromPresets([i],[{preset:a}],n,o);return 0===s.length?Promise.resolve(!1):(this.flags.coreNewMobileColumns&&n&&s.forEach(function(e){e.desktopSolution=r.strategyOptions.desktopSolution}),this.calculatePresetPreview(s[0],1))},t}();e.GenericPresetsStrategy=t}(S||(S={})),function(e){!function(e){e[e.Generic=0]="Generic",e[e.Tpa=1]="Tpa",e[e.Color=2]="Color",e[e.FitMode=3]="FitMode",e[e.UnFitMode=4]="UnFitMode",e[e.InterleaveFitMode=5]="InterleaveFitMode",e[e.MED=6]="MED"}(e.PresetsStrategyType||(e.PresetsStrategyType={})),function(e){e[e.Add=0]="Add",e[e.Change=1]="Change"}(e.PresetsStrategyMode||(e.PresetsStrategyMode={}))}(S||(S={})),function(e){n.$inject=["previewColors","designKit","flags","layoutSelectionStoreProvider","modelStyles","$clone","$innerChild","styleId","le","applicationParameters","marginLeftRight","kit","layout"];var t=function(e,t){return void 0===t&&(t="alpha-bg"),!e[t]||"0"===e[t]},i=function(e){return!e.brd||"0"===e.brd};function n(e,n,o,r,a,s,l,c,d,u,p,h,g){void 0===p&&(p=0);var m=function(){var e=d.containingSegment.getRealNodeFromPreviewNode();return r.getLayoutSelectionStore(e.containerPageId)},f=function(e){var t=g.subType||g.type,i=a.getButtonColoredStyleDefinition(d,c,t,e);return _.get(i,["style","properties"])||{}};if(l.css({width:"auto",height:"auto",marginLeft:p+"px",marginRight:p+"px"}),s.css({display:"flex"}),o.twoButtonSection||s.css({width:"auto",height:"auto"}),o.designKit){var v=o.twoButtonSection?a.getButtonColoredStyleDefinition(d,c,g.subType||g.type):n.getButtonColoredStyleDefinition(c,d),y=function(){var e=u.isInMobileEditMode()&&m();return o.twoButtonSection?f(e):n.getButtonColorsOverride(d,g,c,e)||{}}(),b=y.bg||_.get(v,["style","properties","bg"]),S=y.txt||_.get(v,["style","properties","txt"]),C=y.brd||_.get(v,["style","properties","brd"]);!i(v.style.properties)&&C&&(C=e.getRGBColor(C,{kit:h}),s[0].style.setProperty("border-color",C,"important")),!t(v.style.properties)&&b&&(b=e.getRGBColor(b,{kit:h}),s[0].style.setProperty("background-color",b,"important")),S&&(S=e.getRGBColor(S,{kit:h}),l.css("color",S),l.css("-webkit-text-fill-color",S))}}angular.module("adiCoreAppInternal").factory("applyButtonStyle",["$injector",function(e){return function(t,i,o,r,a,s,l){return void 0===a&&(a=0),e.invoke(n,null,{$clone:t,$innerChild:i,styleId:o,le:r,marginLeftRight:a,kit:s,layout:l})}}])}(S||(S={})),function(e){o.$inject=["$p","modelStyles","flags","componentStyles","componentElementCreator","previewColors","layout","le","applicationParameters","userOverrides","designKit","kit"];var t=function(e,t){return!e[t]||"0"===e[t]},i=function(e){return t(e,"alpha-bg")},n=function(e){return t(e,"alpha-brd")};function o(e,t,o,r,a,s,l,c,d,u,p,h){var g=l.style,m=angular.element("<div />");if("c100"==g)return e.when(m);var f=a.getCatalogStyleDefinition(g);return a.applyBorder(f,m),a.setAbsolutePosition(m),m.css({width:"auto",height:"auto"}),function(e,a){if("decorative"===l.containerRole&&o.designKit){var s=(l.subType||l.type)+r.getDecorationUniqueID(l),h=t.getDecorativeBoxStyleDefinition(c,a,s),g=c.containingSegment.hasColumnWithColorBackground()&&!c.isOnMediaContainer(l),m=h.style.properties,f=d.isInMobileEditMode()&&u.getColumnBgColorOverride(c.containingSegment);f&&(m.bg=p.getSantaFormatColor(f)),i(m)||v("background-color","bg",g,h,e),n(m)||v("border-color","brd",g,h,e)}}(m,g),e.when(m);function v(e,t,i,n,o){var r;if(i)r="transparent";else{var a=_.get(n,["style","properties",t]);a&&(r=s.getRGBColor(a,{kit:h}))}r&&o[0].style.setProperty(e,r,"important")}}angular.module("adiCoreAppInternal").factory("getContainerPreview",["$injector",function(e){return function(t,i,n){return e.invoke(o,null,{layout:t,le:i,kit:n})}}])}(S||(S={})),function(e){function t(e,t,i,n,o,r,a,s,l){var c=a.style,d=angular.element("<div />"),u=o.getCatalogStyleDefinition(c);return o.applyBorderBottom(u,d),d.css({top:0,left:0,width:"100%",display:"block"}),function(e,o){if(i.designKit){var c=(a.subType||a.type)+n.getDecorationUniqueID(a),d=t.getLineColoredStyleDefinition(o,s,c,a),u=_.get(d,["style","properties","brd"]);u&&(u=r.getRGBColor(u,{kit:l}),e[0].style.setProperty("border-color",u,"important"))}}(d,c),e.when(d)}t.$inject=["$p","designKit","flags","componentStyles","componentElementCreator","previewColors","layout","le","kit"],angular.module("adiCoreAppInternal").factory("getLinePreview",["$injector",function(e){return function(i,n,o){return e.invoke(t,null,{layout:i,le:n,kit:o})}}])}(S||(S={}));r=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};!function(e){function t(e,t,i,n,o,a,s,l,c,d,u,p){var h=angular.element("<div />"),g=i.getCatalogStyleDefinition(u);i.applyBorder(g,h),i.applyRadius(g,h),i.applyBoxShadow(g,h);var m="center";if(t.twoButtonSection){switch(s.align){case"left":m="flex-start";break;case"right":m="flex-end";break;default:m="center"}var f=s.margin||0;h.css(r({},p,{position:"absolute",paddingLeft:f,paddingRight:f}))}else i.setAbsolutePosition(h);h.css({display:"flex",alignItems:"center",justifyContent:m,whiteSpace:"nowrap"});var v=angular.element("<span></span>").appendTo(h),y="font_"+s.font,b=n.getFontStyle(y).replace(/\+/g," ");v.css("font",b);var S=s.isMobile?o.getFontSize(y):n.getFontSize(y);v.css("fontSize",S+"px");var C=n.getLineHeight(y);return v.css("lineHeight",C),a(h,v,u,l,0,d,s),v.html(_.htmlEncode(c)),e.when(h)}t.$inject=["$p","flags","componentElementCreator","themeChooser","mobileFonts","applyButtonStyle","layout","le","value","kit","styleId","boundary"],angular.module("adiCoreAppInternal").factory("getButtonPreview",["$injector",function(e){return function(i,n,o,r,a,s){return e.invoke(t,null,{layout:i,le:n,value:o,kit:r,styleId:a,boundary:s})}}])}(S||(S={})),function(e){t.$inject=["$p","getMediaLayoutPreview","getContactFormPreview","getMenuPreview","getSocialPreview","getIconLayoutPreview","getContainerPreview","getLinePreview","getButtonPreview","richTextService","visualValidation","previewColors","flags","layoutElementButtons","buttonStyleResolver","layout","le","applicationParameters","$rootEl","boundary","layoutSelectionStoreProvider","userOverrides","nodeManipulationService","designKit","columnService","kit"];function t(e,t,i,n,o,r,a,s,l,c,d,u,p,h,g,m,f,v,y,b,S,C,w,T,I,x){var P=f.getArgValue(m.argIndex),M=f.getLayoutValue(m,P);if(f.isMediaType(m))return t(m,M,f,y,b,x);if(m.type===AdiCoreSanta.ElementTypes.Form)return i(b);if(m.type===AdiCoreSanta.ElementTypes.Menu)return n(m,f,b,x);if(m.type===AdiCoreSanta.ElementTypes.Social)return o(m,f,b,M,x);if(m.type===AdiCoreSanta.ElementTypes.ShoppingCart||m.type===AdiCoreSanta.ElementTypes.Social)return r(b);if(m.type===AdiCoreSanta.ElementTypes.Container)return a(m,f,x);if(m.type===AdiCoreSanta.ElementTypes.Line)return s(m,f,x);if(m.type===AdiCoreSanta.ElementTypes.Button){if(p.twoButtonSection){var L=[P||{}].concat(h.getExtraButtons(P));return e.all(L.map(function(t,i){var n=f.buttonDimensions[i];if(!n)return e.when();var o=m.style;if(i>0){var r=g.toCatalogId(m.style);o=(r=r&&g.getExtraButtonStyle(r))?g.toStyleId(r):m.style}var a={left:n.offset.x,top:n.offset.y,width:n.width,height:n.height},s=f.getLayoutValue(m,t),c=n.width-2*m.margin,d=n.textDimensions.width;if(d>c){var u=Math.floor(c*(M.length/d)*.95);s=s.substr(0,u)+"..."}return l(m,f,s,x,o,a)})).then(function(e){return e.filter(function(e){return!!e})})}if(m.clientRectWidth){var k=(m.clientRectWidth-m.validationWidth)/m.clientRectWidth,_=Math.floor(.8*(1-k)*M.length);M=M.substr(0,_)+"..."}return l(m,f,M,x,m.style,void 0)}var $=function(e){void 0===e&&(e=!0);var t=v.isInMobileEditMode()&&A(f.containingSegment);return f.getFormatting(m,null,t,e)},A=function(e){var t=e.getRealNodeFromPreviewNode();return S.getLayoutSelectionStore(t.containerPageId)},E=function(){var e=B(!0);return v.isInMobileEditMode()&&!p.coreNewMobileColumns?D(e):e},D=function(e){if(!p.coreNewMobileColumns){if(H()){var t=R();if(t)return T.getTextContrastingToBg(f,m,e,t)}return O()?e:f.getFieldColorOverride(m)?T.getTextContrastingToBg(f,m,e,N()):B(!1)}},F=function(){var e=f.containingSegment.getRealNodeFromPreviewNode();return w.getSegmentByNode(e,e.containerPageId)},B=function(e){var t=$(e);return t&&"color_"+t.getColor()||15},O=function(){if(!p.coreNewMobileColumns){var e=F();return T.isMobileBgSameAsDesktop(f,m,m.subType,e)}},H=function(){var e=F();return f&&f.hasMedia()&&!f.onMediaStructure&&e&&e.allowedMobileMediaBackgroundPadding()},R=function(){var e=F(),t=I.getSegmentMediaColumnBackground(e);if(t&&t.mediaColor)return t.mediaColor;var i=e.containingLG.getLgData().strip;return i.enable&&i.color},N=function(){return p.overrideContainerBgColor&&m.boxParentOverrideKey&&C.getColumnBgColorOverride(f.containingSegment)};return d.getOrBuildValidator(m,f).then(function(e){if(e.div){var t=angular.element(e.div).clone(),i=d.innerChild(t[0]);return function(e,t){var i=f.getAlignment(m,"align"),n=$(),o=n&&n.getBGColor();o&&(o=u.getRGBColor(o,{kit:x})),o&&t[0].style.setProperty("background-color",o,"important");var r=u.getRGBColor(E(),{kit:x});e.css("color",r),e.css("-webkit-text-fill-color",r),e.css({width:"auto",maxWidth:"none",textAlign:i}),e.css({display:"block",whiteSpace:"normal",wordWrap:"break-word"}),e.addClass("text-align-"+i),t.html(c.isRichText(M)?c.unMarkRichText(M):c.transformForEditor(M,n))}(t,angular.element(i).empty()),t}})}angular.module("adiCoreAppInternal").factory("getLayoutPreview",["$injector",function(e){return function(i,n,o,r,a){return e.invoke(t,null,{layout:i,le:n,$rootEl:o,boundary:r,kit:a})}}])}(S||(S={})),function(e){function t(e,t){var i=angular.element('<div style="display: flex; flex-direction: column;">  <div class="form-layout-preveiw-input">Name</div>  <div class="form-layout-preveiw-input">Email</div>  <div class="form-layout-preveiw-input">Subject</div>  <div class="form-layout-preveiw-input" style="flex: 1;">Message</div>  <div style="display: flex; flex-direction: row;"><div style="flex: 1;"></div><div class="form-layout-preveiw-button">Send</div></div></div>').css({height:t.height,width:t.width});return e.when(i)}t.$inject=["$p","boundary"],angular.module("adiCoreAppInternal").factory("getContactFormPreview",["$injector",function(e){return function(i){return e.invoke(t,null,{boundary:i})}}])}(S||(S={})),function(e){function t(e,t){var i=angular.element("<div></div>").css({height:t.height,width:t.width});return e.when(i)}t.$inject=["$p","boundary"],angular.module("adiCoreAppInternal").factory("getIconLayoutPreview",["$injector",function(e){return function(i){return e.invoke(t,null,{boundary:i})}}])}(S||(S={})),function(e){function t(e,t,i,n,o,r,a,s,l,c,d,u,p){var h=l.overrides&&l.overrides.media&&l.overrides.media[a.argIndex],g=l.isMobile()?320:c.width();if(h&&h.name&&"Accordion"===h.name){s=_.filter(s,{mediaType:AdiCoreSanta.MediaItemTypes.Image});var m=angular.element('<div class="accordion-media-layout-preview" style="display: flex; flex-direction: row;"></div>').css({height:u.height,width:u.width});return _.each(_.range(6),function(e){var t=s[e];t&&angular.element("<div></div>").css({flex:1===e?"2 0 0":"1 0 0",backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundClip:"content-box",backgroundImage:"url("+o.itemToThumbnailUrl(t,u.width,u.height)+")"}).appendTo(m)}),e.when(m)}if(h&&h.name&&"Masonry"===h.name){s=_.filter(s,{mediaType:AdiCoreSanta.MediaItemTypes.Image});var f=angular.element('<div class="masonry-media-layout-preview" style="display: flex; flex-direction: row;">  <div style="flex: 1; display: flex; flex-direction: column">    <div class="img" style="flex: 1;"></div>    <div class="img" style="flex: 1;"></div>  </div>  <div style="flex: 1; display: flex; flex-direction: column">    <div class="img" style="flex: 1;"></div>    <div class="img" style="flex: 2;"></div>    <div class="img" style="flex: 1;"></div>  </div></div>').css({height:u.height,width:u.width});return _.each(f.find(".img"),function(e,t){var i=angular.element(e),n=s[t]||s[t-s.length]||s[t-2*s.length];i.css({backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundClip:"content-box",padding:"5px",backgroundImage:"url("+o.itemToThumbnailUrl(n,u.width,u.height)+")"})}),e.when(f)}if(h&&h.name&&"Slideshow"===h.name){var v=s[0],y=angular.element('<div class="impress-media-layout-preview" style="display:flex; flex-direction: row; align-items: center;">  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="12.8px" height="25.5px" viewBox="29.5 13.9 12.8 25.5" style="enable-background:new 29.5 13.9 12.8 25.5;margin: 0 30px 0 20px;" xml:space="preserve"> <path d="M41,39.5l1.2-1.3L30.5,25.4l-1.2,1.3L41,39.5z"/> <path d="M42.2,15.2L41,13.9L29.4,26.7l1.2,1.3L42.2,15.2z"/> </svg>  <div class="img" style="flex: 1; height: 100%"></div>  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="12.8px" height="25.5px" viewBox="29.5 13.9 12.8 25.5" style="enable-background:new 29.5 13.9 12.8 25.5;margin: 0 20px 0 30px;"xml:space="preserve"> <path d="M30.5,39.5l-1.2-1.3L41,25.4l1.2,1.3L30.5,39.5z"/> <path d="M29.4,15.2l1.2-1.3l11.6,12.8L41,28L29.4,15.2z"/> </svg></div>').css({height:u.height,width:u.width});return y.find(".img").css({backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundClip:"content-box",backgroundImage:"url("+o.itemToThumbnailUrl(v,u.width,u.height)+")"}),e.when(y)}if(h&&h.name&&"Impress"===h.name){v=s[0];var b=angular.element('<div class="impress-media-layout-preview" style="display:flex; flex-direction: row; align-items: center;">  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="12.8px" height="25.5px" viewBox="29.5 13.9 12.8 25.5" style="enable-background:new 29.5 13.9 12.8 25.5;margin: 0 30px 0 20px;" xml:space="preserve"> <path d="M41,39.5l1.2-1.3L30.5,25.4l-1.2,1.3L41,39.5z"/> <path d="M42.2,15.2L41,13.9L29.4,26.7l1.2,1.3L42.2,15.2z"/> </svg>  <div style="width: 40%; display: flex; flex-direction: column; justify-content: center;">    <div class="title" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; text-align: left; line-height: 27px; font-size: 24px;font-family: proxima-nova, sans-serif; font-weight: 300; padding: 0 10px;"></div>    <div class="desc" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; text-align: left; line-height: 27px; font-size: 14px;font-family: proxima-nova, sans-serif; font-weight: 300; padding: 0 10px;"></div>  </div>  <div class="img" style="flex: 1; height: 280px"></div>  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="12.8px" height="25.5px" viewBox="29.5 13.9 12.8 25.5" style="enable-background:new 29.5 13.9 12.8 25.5;margin: 0 20px 0 30px;"xml:space="preserve"> <path d="M30.5,39.5l-1.2-1.3L41,25.4l1.2,1.3L30.5,39.5z"/> <path d="M29.4,15.2l1.2-1.3l11.6,12.8L41,28L29.4,15.2z"/> </svg></div>').css({backgroundColor:i.getRGBColor(18,{kit:p}),height:u.height,width:u.width});return b.find(".title").text(v.Title).css({color:i.getRGBColor(16,{kit:p})}),b.find(".desc").text(v.Description).css({color:i.getRGBColor(1,{kit:p})}),b.find(".img").css({backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundClip:"content-box",padding:"10px",backgroundImage:"url("+o.itemToThumbnailUrl(v,u.width,u.height)+")"}),e.when(b)}if(h&&h.name&&"Thumbnails"===h.name){s=_.filter(s,{mediaType:AdiCoreSanta.MediaItemTypes.Image});var S=h.properties&&h.properties.thumbnailsGravity||"bottom",C=angular.element('<div class="thumbnails-media-layout-preview" style="display:flex;"></div>').css({flexDirection:"bottom"===S?"column":"right"===S?"row":"row-reverse",height:u.height,width:u.width});return angular.element('<div style="flex: 1;"></div>').css({backgroundImage:"url("+o.itemToThumbnailUrl(s[0],u.width,u.height)+")"}).appendTo(C),angular.element('<div style="display:flex; justify-content: center"><div class="img"></div><div class="img"></div><div class="img"></div></div>').css({flexDirection:"bottom"===S?"row":"column"}).appendTo(C),_.each(C.find(".img"),function(e,t){var i=angular.element(e),n=s[t]||s[s.length-1];i.css({backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundClip:"content-box",padding:"5px",width:80,height:60,backgroundImage:"url("+o.itemToThumbnailUrl(n,80,60)+")"})}),e.when(C)}if(h&&h.name&&h.name.indexOf("Collage")>=0){s=_.filter(s,{mediaType:AdiCoreSanta.MediaItemTypes.Image});var w="Fullwidth Collage"===h.name,T=angular.element('<div class="collage-media-layout-preview" style="display:flex; flex-direction: column;"></div>').css({height:u.height});return w?T.addClass("strip-media-layout-preview"):T.width(u.width),T.append(angular.element('<div style="flex: 3; display:flex; flex-direction: row;"><div class="img" style="flex: 3;"></div><div style="flex: 1; display:flex; flex-direction: column;"><div class="img" style="flex: 1;"></div><div class="img" style="flex: 2;"></div></div></div>')),s.length>3&&T.append(angular.element('<div style="flex: 2; display:flex; flex-direction: row;"><div class="img" style="flex: 1;"></div><div class="img" style="flex: 1;"></div></div>')),_.each(T.find(".img"),function(e,t){var i=angular.element(e);s[t]&&i.css({backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundClip:"content-box",padding:w?0:10,backgroundImage:"url("+o.itemToThumbnailUrl(s[t],u.width,u.height)+")"})}),e.when(T)}if(h&&h.name&&("Slider"===h.name||"Strip Showcase"===h.name)){s=_.filter(s,{mediaType:AdiCoreSanta.MediaItemTypes.Image});var I="Strip Showcase"===h.name,x=angular.element('<div class="slider-media-layout-preview" style="display:flex; flex-direction: row;"></div>').css({height:a.height});return I?x.addClass("strip-media-layout-preview"):x.width(u.width),x.append(angular.element('<div class="img" style="flex: 1;"></div><div class="img" style="flex: 2;"></div><div class="img" style="flex: 1;"></div>')),_.each(x.find(".img"),function(e,t){var i=angular.element(e),n=s[t-1]||s[s.length-1];i.css({backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundClip:"content-box",padding:"0 5px",opacity:I&&1!==t?.6:1,backgroundImage:"url("+o.itemToThumbnailUrl(n,u.width,u.height)+")"})}),e.when(x)}if(h&&h.name&&"Strip Video"===h.name){var P=_.find(s,{mediaType:AdiCoreSanta.MediaItemTypes.Video}),M=angular.element('<div class="strip-media-layout-preview"></div>').css({height:a.height}).append(r(P,g,a.height));return e.when(M)}if(n.isStripType(l)){var L=s[0],k=void 0;if(h.properties.alignType&&(k={alignment:h.properties.alignType}),t.stripFocalPoint&&t.focalPointFocusOnFaces){var $=l.containingSegment&&l.containingSegment.node&&l.containingSegment.node.getFocalPoint(L.relativeUri);$&&(k={focalPoint:$})}var A=o.itemToThumbnailUrl(L,g,a.height,k),E=angular.element('<div class="strip-media-layout-preview"></div>').css({height:a.height,backgroundImage:"url("+A+")"});if("Strip Slideshow"===h.name){var D=angular.element('<div class="strip-slideshow-navbar"></div>');_.each(_.range(5),function(){D.append(angular.element('<div class="strip-slideshow-navbar-item"></div>'))}),E.append(D)}return e.when(E)}if(h&&h.name&&h.name.indexOf("Grid")>=0){var F="Animated Grid"===h.name?"PaginatedGridGallery":"MatrixGallery",B=l.isMobile()&&AdiCoreSanta.MobileComponentOrganizer.createProperties("gallery",F)||h.properties||{},O=B.numCols||3,H=B.maxRows||2,R=B.margin||0,N=Math.floor(u.width/O-(O>1?R:0)),U=Math.floor(u.height/H-(H>1?R:0)),V="Grid (with margins and text below)"===h.name,z="grid-media-layout-preview",j={height:u.height};"coast2coast"===B.stretch?z+=" strip-media-layout-preview":j.width=u.width;var W=angular.element('<div class="'+z+'" style="display:flex; flex-wrap:wrap;flex-direction: row; justify-content: space-between;"></div>').css(j);return _.each(_.range(O*H),function(e){var t=angular.element('<div style="flex:0 0 auto; width:'+N+"px; height:"+U+'px;"></div>').appendTo(W);s[e]&&s[e].mediaType===AdiCoreSanta.MediaItemTypes.Image&&(t.css({position:"relative",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundImage:"url("+o.itemToThumbnailUrl(s[e],N,U)+")"}),V&&angular.element('<div class="title" style="position: absolute; bottom: 0; left: 0; right: 0; color: #000000; background: #ffffff; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; text-align: left; line-height: 27px; font-size: 24px;font-family: proxima-nova, sans-serif; font-weight: 300; padding: 10px; height: 47px;"></div>').text(s[e].Title||" ").appendTo(t))}),e.when(W)}if(a.subType===AdiCoreSanta.ElementTypes.Subscribe){var G=i.getRGBColor(d.getLayoutColorContrastToBackground(l,a),{kit:p}),K=i.getRGBColor(d.getColorOfFirstBackground(l,a),{kit:p}),q=angular.element('<div style="display: flex; flex-direction: column; align-items: center; align-content: space-around; height: 100%; justify-content: center">  <div style="align-self:center; margin-bottom: 30px; font-size: 14px;font-family: \'Avenir - Medium\', sans-serif;" class="subscribe-in-footer-preview-title">Subscribe</div>  <div style="width:100%; margin-bottom: 5px; font-size: 14px;font-family: \'Avenir - Medium\', sans-serif; padding: 2px" class="subscribe-in-footer-preview-email">Email Address</div>  <div style="display: flex; flex-direction: column; width:100%; align-items: center; margin-bottom: 5px;"  class="subscribe-in-footer-preview-button"><div style="font-size: 14px;font-family: \'Avenir - Medium\', sans-serif; padding: 2px" class="subscribe-in-footer-preview-button-text">Sign Up</div></div></div>').css({height:u.height,width:u.width});return q.find(".subscribe-in-footer-preview-title").css({color:G}),q.find(".subscribe-in-footer-preview-email").css({color:G,border:"1px solid "+G}),q.find(".subscribe-in-footer-preview-button").css({background:G}),q.find(".subscribe-in-footer-preview-button-text").css({background:G,color:K}),e.when(q)}if(h&&h.name&&h.name.indexOf("Freestyle")>=0){var Y=angular.element('<div class="freestyle-media-layout-preview" style="position: relative;overflow: hidden;"></div>').css({height:u.height,width:u.width});return _.each([{top:"30%",left:"5%",transform:"rotate(370deg)",transformOrigin:"bottom right"},{top:"22%",left:"46%",transform:"rotate(347deg)",transformOrigin:"bottom right"},{top:"44%",left:"24%",transform:"rotate(364deg)",transformOrigin:"top right"},{top:"20%",left:"13%",transform:"rotate(345deg)"},{top:"5%",left:"30%",transform:"rotate(354deg)",transformOrigin:"bottom right"}],function(e,t){s[t]&&s[t].mediaType===AdiCoreSanta.MediaItemTypes.Image&&angular.element('<div style="border:2px solid #ffffff;box-shadow: -2px 3px 10px 0 rgba(0,0,0,0.2) ;position: absolute; width:250px; height:350px;"></div>').css(e).css({backgroundSize:"cover",backgroundPosition:"center",backgroundImage:"url("+o.itemToThumbnailUrl(s[t],250,350)+")"}).appendTo(Y)}),e.when(Y)}var X=angular.element('<div class="media-layout-preview" style="position: relative;"></div>').css({backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",height:u.height,width:u.width});if(a.type!==AdiCoreSanta.ElementTypes.Map){var Z=void 0;if(h&&"video"===h.name){var J="video"===h.type?AdiCoreSanta.MediaItemTypes.Video:AdiCoreSanta.MediaItemTypes.ExtVideo;Z=_.find(s,function(e){return e.mediaType===J}),X.append(angular.element('<div class="circle" style="width:100px;height:100px;border: 5px solid #ffffff;border-radius:50%;top: 50%;left: 50%;transform: translate(-50%, -50%);position: absolute;background-color: rgba(0,0,0,.5);"></div><div class="triangle" style="width:0%;height:0%;border-top: 20px solid transparent;border-left: 30px solid #ffffff;border-bottom: 20px solid transparent;top: 50%;left:50%;transform: translate(-35%, -50%);position: absolute;"></div>'))}else{Z=s[0];var Q=_.get(l.overrides,["style","media"])||a.style;Q&&X.addClass("media-layout-preview-"+Q)}var ee={fit:"full"===_.get(h,["properties","displayMode"])},te=l&&l.getLayoutBySubType(AdiCoreSanta.ElementSubTypes.Image);ee.crop=l.containingSegment&&l.containingSegment.node&&l.containingSegment.node.getCropOfImage(te.argIndex,Z.relativeUri,te);var ie=o.itemToThumbnailUrl(Z,u.width,u.height,ee);ie.then?ie.then(function(e){X.css({backgroundImage:"url("+e+")"})}):X.css({backgroundImage:"url("+ie+")"}),X.css({backgroundSize:ee.fit?"contain":"cover"});var ne=l.getLayoutSelectionStore().getImageShadow(l.containingSegment,l);if(ne&&(ne.left||ne.top)&&!l.imageFitFullMode()){var oe=angular.element('<div class="media-layout-shadow-preview" style="position: relative"></div>'),re=i.getRGBColor(d.getLayoutColorContrastToBackground(l,a),{kit:p});oe.append(angular.element('<div style="position:absolute;height:'+u.height+"px;width:"+u.width+"px;\n            left:"+(ne.left||0)+"px;top:"+(ne.top||0)+"px; background:"+re+'"></div>')),oe.append(X),X=oe}}return e.when(X)}t.$inject=["$p","flags","previewColors","mediaOverride","mediaGallery","getVideoBgPreview","layout","value","le","$rootEl","designKit","boundary","kit"],angular.module("adiCoreAppInternal").factory("getMediaLayoutPreview",["$injector",function(e){return function(i,n,o,r,a,s){return e.invoke(t,null,{layout:i,value:n,le:o,$rootEl:r,boundary:a,kit:s})}}])}(S||(S={})),function(e){function t(e,t,i,n,o,r,a,s,l){var c,d,u=a.getLayoutSelectionStore(),p=!u||u.menuOverridesManager.stretchButtons(),h=u?u.menuOverridesManager.alignment():"center";if(i.designKit){var g=a.getLayoutBySubType(r.subType),m=a.isLayoutInMenuStripArea(g)?a.containingLG.getLgData().menuStrip.color:"{"+t.getHeaderBg([a.containingLG])+"}";c=o.getRGBColor(t.invertToBrightestColor(m),{kit:l})}return s.height===s.width?(d=angular.element('<div class="tiny-menu-layout-preview">  <div class="tiny-menu-stroke"></div>  <div class="tiny-menu-stroke"></div>  <div class="tiny-menu-stroke"></div></div>').css({height:s.height,width:s.width}),c&&d.find(".tiny-menu-stroke").css({"background-color":c})):((d=angular.element('<div style="display: flex; flex-direction: row;">  <div class="menu-layout-preview">Home</div>  <div class="menu-layout-preview">About</div>  <div class="menu-layout-preview">Services</div>  <div class="menu-layout-preview">Contact</div></div>').css({height:s.height,width:s.width,justifyContent:"left"===h?"flex-start":"right"===h?"flex-end":"center"})).find(".menu-layout-preview").css({padding:"4px 10px",fontSize:"14px",textAlign:h,flex:p?"1 0 0":"0 0 auto"}),c&&d.css("color",c)),e.when(d)}t.$inject=["$p","designKit","flags","componentStyles","previewColors","layout","le","boundary","kit"],angular.module("adiCoreAppInternal").factory("getMenuPreview",["$injector",function(e){return function(i,n,o,r){return e.invoke(t,null,{layout:i,le:n,boundary:o,kit:r})}}])}(S||(S={})),function(e){function t(e,t,i,n,o,r,a,s,l,c,d){var u,p=s.getLayoutSelectionStore(),h=(!p||p.menuOverridesManager.stretchButtons(),p?p.menuOverridesManager.alignment():"center");if(i.designKit){var g=void 0;if(s.containingLG.isHeader()){var m=s.getLayoutBySubType(a.subType);g=s.isLayoutInMenuStripArea(m)?s.containingLG.getLgData().menuStrip.color:s.containingLG.isSiteHeader()?"{"+t.getHeaderBg([s.containingLG])+"}":"{"+t.getFooterBg([s.containingLG])+"}"}else g=t.getBgColor(s.containingLG);g&&(u=r.getRGBColor(t.invertToBrightestColor(g),{kit:d}))}var f='<div style="display: flex">'+function(e,t,i){var n="",o="";return _.each(_.initial(e),function(e,r){o=i.getPlatformByName(e.platform).svg(t,"25px","25px"),n+='<div  style="height: 25px; margin-right: 10px;">'+o+"</div>"}),o=i.getPlatformByName(_.last(e).platform).svg(t,"25px","25px"),n+='<div  style="height: 25px;">'+o+"</div>"}(c,u,n)+"</div>",v=angular.element(f).css({height:l.height,width:l.width,justifyContent:"left"===h?"flex-start":"right"===h?"flex-end":"center"});return e.when(v)}t.$inject=["$p","designKit","flags","socialLinkManager","componentStyles","previewColors","layout","le","boundary","value","kit"],angular.module("adiCoreAppInternal").factory("getSocialPreview",["$injector",function(e){return function(i,n,o,r,a){return e.invoke(t,null,{layout:i,le:n,boundary:o,value:r,kit:a})}}])}(S||(S={})),function(e){function t(e,t,i,n){return angular.element('<video loop class="media-bg video-bg"></video>').css({width:i,height:n,"-ms-transform":"scale("+e.getScaleToFill(t,i,n)+")","-ms-transform-origin":"center center"}).append(angular.element('<source type="video/mp4"></<source/>').attr("src",e.getVideoUrl(t)))}t.$inject=["mediaGallery","mediaItem","width","height"],angular.module("adiCoreAppInternal").factory("getVideoBgPreview",["$injector",function(e){return function(i,n,o){return e.invoke(t,null,{mediaItem:i,width:n,height:o})}}])}(S||(S={}));a=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){e.done?o(e.value):new i(function(t){t(e.value)}).then(a,s)}l((n=n.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var i,n,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};angular.module("adiCoreAppInternal").factory("bookingService",["$http","applicationParameters","flags","richTextUtils",function(e,t,i,n){var o=this,r=function(e,t,i,n,o){void 0===o&&(o=!0);var r={method:e,url:t};return o&&(r.headers=l(i)),n&&(r.data=n),r},l=function(e){return{"Content-Type":"application/json","x-wix-scheduler-instance":e}},c={templateBookingServiceData:{order:null,categoryId:"19e463e2-e978-41df-8ea0-8a9c0fefdd7d",info:{name:"Personal Training",description:"Personal Training Description (Optional)",images:[{fileName:"08a2ae_a3e0741112b74fb783ffd5429b8aa234~mv2.png",width:824,height:824,relativeUri:"08a2ae_a3e0741112b74fb783ffd5429b8aa234~mv2.png"}],tagLine:""},location:{type:"BUSINESS",locationText:null},payment:{currency:"USD",price:19.99,isFree:!1,priceText:null,minCharge:null,paymentType:"ONLINE"},schedulePolicy:{maxParticipantsPerOrder:1,isBookable:!0,uouHidden:!1},schedule:{}},missingFieldsServiceData:{type:"INDIVIDUAL",schedulePolicy:{capacity:1,minutesBetweenAppointments:10,staffMembersIds:[]},schedule:{durationInMinutes:60,startDate:null,endDate:null,noEndDate:!0}},missingFieldsGroupData:{type:"GROUP",schedulePolicy:{capacity:11},schedule:{durationInMinutes:60,repeatEveryXWeeks:1,startDate:"2018-04-10",endDate:"2019-04-10",noEndDate:!1,classHours:{mon:{workingHours:[{workingHour:{startTime:"10:00:00.000"},staffId:null}]},tue:null,wed:{workingHours:[{workingHour:{startTime:"10:00:00.000"},staffId:null}]},thu:null,fri:{workingHours:[{workingHour:{startTime:"10:00:00.000"},staffId:null}]},sat:null,sun:null}}},missingFieldsCourseData:{order:null,type:"COURSE",schedulePolicy:{maxParticipantsPerOrder:5,capacity:40},schedule:{startDate:"2018-06-02",endDate:"2018-07-02",actualStartDate:null,actualEndDate:null,noEndDate:!1,repeatEveryXWeeks:1,classHours:{mon:{workingHours:[{workingHour:{startTime:"9:00",endTime:"18:00"},staffId:null}]},tue:null,wed:null,thu:{workingHours:[{workingHour:{startTime:"9:00",endTime:"18:00"},staffId:null}]},fri:null,sat:null,sun:null}}}},d=t.clientTopology.schedulerBaseUrl,u={url:function(){return d+"/api/owner/services"},method:"GET"},p={url:function(e){return d+"/index?instance="+e},method:"GET"},h={url:function(){return d+"/api/onboarding/status"},method:"GET"},g={url:function(){return d+"/api/owner/categories"},method:"POST"},m={url:function(e){return d+"/api/owner/categories/"+e},method:"DELETE"},f={url:function(){return d+"/api/owner/offerings/bulk"},method:"POST"},v={url:function(){return d+"/api/owner/appStatus"},method:"PUT"},y={url:function(){return d+"/_api/scheduler-server/owner/business/setup"},method:"GET"},b={url:function(){return d+"/_api/scheduler-server/owner/staff"},method:"GET"},S=function(e){return a(o,void 0,void 0,function(){var t,i;return s(this,function(n){switch(n.label){case 0:return[4,C.getStaffMemebers(e)];case 1:return t=n.sent(),(i=_.get(t,"data.staff[0].id"))&&(function(e){c.missingFieldsServiceData.schedulePolicy.staffMembersIds=[e]}(i),function(e){var t=function(t){_.forEach(t,function(t){null!==t&&t.workingHours.map(function(t){return t.staffId=e})})};t(c.missingFieldsGroupData.schedule.classHours),t(c.missingFieldsCourseData.schedule.classHours)}(i)),[2]}})})},C={getBusiness:function(t){return e(r(u.method,u.url(),t))},deleteCategory:function(t,i){return e(r(m.method,m.url(i),t))},wakeAppHack:function(t){return e(r(p.method,p.url(t),t,null,!1))},isAppReady:function(t){return e(r(h.method,h.url(),t))},createCategory:function(t,i){return e(r(g.method,g.url(),t,{name:n.toPlainText(i)}))},getStaffMemebers:function(t){return e(r(b.method,b.url(),t))},getFirstCategoryId:function(e){return o.getBusiness(e).then(function(e){return e.data.categories[0]&&e.data.categories[0].id})},addServices:function(t,i,l,d){return a(o,void 0,void 0,function(){var o,a;return s(this,function(s){switch(s.label){case 0:return function(e){c.templateBookingServiceData.categoryId=e||c.templateBookingServiceData.categoryId}(i),[4,S(t)];case 1:return s.sent(),o={requests:l.map(function(e){return function(e,t,i){var o=i.missingFieldsGroupData,r=i.missingFieldsServiceData,a=i.missingFieldsCourseData,s=i.templateBookingServiceData,l={info:{images:e.images&&e.images.length?e.images.slice(0,1):[],description:e.description&&n.toPlainText(e.description)||"",name:e.name&&n.toPlainText(e.name)||""}};switch(t){case"single":return _.defaultsDeep(l,r,s);case"group":return _.defaultsDeep(l,o,s);case"course":return _.defaultsDeep(l,a,s);default:return _.defaultsDeep(l,r,s)}}(e,d,c)})},a=r(f.method,f.url(),t,o),[2,e(a)]}})})},updateAppStatus:function(t){return e(r(v.method,v.url(),t,{services:!0,calendar:!0,businessInfo:!0,payments:!1}))},getSetup:function(t){return e(r(y.method,y.url(),t))}};return C}]),angular.module("adiCoreAppInternal").service("defaultsService",["toasterService","modelTree","VerticalDefaultValues","contentElements","BackendLayoutPreset","$injector","storyServices","flags","dataFlags","PresetMediaType",function(e,t,i,n,o,r,a,s,l,c){AdiCoreSanta.setDefaultsService(this);var d={},u={};function p(e,t){d=i.getDefaultSelectionValuesByVertical(e,t,!1,!1),u=i.getDefaultSelectionValuesByVertical(e,t,!1,!0)}function h(e){return function(e){return e&&e.contentElement&&e.contentElement.isSpecialListItem()?e.parentContentElementType:""}(e)+e.contentElementType+(e.isListItem?"List":"")}function g(e,t,i,n){if(i)return!0;var o=e.partitions?e.partitions[0].argList:e.layouts[0].argList,r=function(e,t){var i=e.getContentElement().getWantedArgs(t);return""===i?[]:i.split("#")}(t,n);return!_.difference(r,o).length}this.getLeSelection=function(e,t){var i=t.getTypeForLSSWithoutNodeId();return e[i]&&e[i].LE[0]},this.getLgHeightSelection=function(e,t){var i=t.id,n=t.getTypeForLSSWithoutNodeId();return e[n]&&e[n].LG[i]},this.getLgPartitionHeightSelection=function(e,t){var i=t.id,n=t.getTypeForLSSWithoutNodeId();return e[n]&&e[n].LG[i+"_partition"]},this.setDefaults=function(e,t){p(e,t)},this.getDefaultsDB=function(e){return"footer"===e?u:d},this.init=function(e,t){i.init(e,t),p(e,t)};var m={},f="GENERIC";function v(e){n.utilIsTpa(e)||(m[f]?m[e]=m[f]:m[f]=m[e])}function y(e,i){var n=e.data.priority;if(n){if(_.isNumber(n))return n;var o=n[function(e){return t.getGeneralInformation()===e?"SiteHeader":h(e)}(i)];return _.isNumber(o)?o:99}return 99}this.getAllLayoutPresets=function(e,t,i){var n=t||"undefined";t&&v(t);var a=s.consumerMode?r.get("BackendLayoutPresetNew"):o;if(!m[n]||e){var l={limit:1e6};i&&(l.where=[["archived","==",!1]]),t&&(l.forContent=t),m[n]=a.search(l).then(function(e){return _.map(e,function(e){if(e.data.isList&&(e.data.zigZag=e.data.zigZag||{cols:!!e.data.zigZagState,rows:!!e.data.zigZagState&&e.data.itemsInRow%2>0}),e.data.zigZagState&&e.data.itemsInRow%2>0||e.data.zigZag&&e.data.zigZag.rows){var t,i,n,o=_.filter(e.data.groups,function(e){return!(e.isFooter||e.isHeader)});if(1===o.length&&o[0].layouts&&3===o[0].layouts.length)t=o[0],(i=_.clone(t)).zigZag=!t.zigZag,i.layouts=[_.clone(t.layouts[1]),_.clone(t.layouts[0]),_.clone(t.layouts[1])],n=_.findIndex(e.data.groups,t),e.data.groups.splice(n+1,0,i);else if(1===o.length&&o[0].layouts&&(2===o[0].layouts.length||4===o[0].layouts.length)){t=o[0],(i=_.cloneDeep(t)).zigZag=!i.zigZag;var r=i.layouts.shift();i.layouts.push(r),n=_.findIndex(e.data.groups,t),e.data.groups.splice(n+1,0,i)}}return e})}),t&&v(t)}return m[n]},this.getPresetsForNode=function(e,i,o,r,a){var d,u,p,h,m=this;i=i||e.getContentElementType();var f=e.isList();return f&&(d=t.getListHeader(e),u=t.getListFooter(e),p=_.filter(t.getListItems(e),function(e){return!e.isUserHidden()})),this.getAllLayoutPresets(!1,s.consumerMode?i:void 0).then(function(m){return _.filter(m,function(m){if(Boolean(r)!==Boolean(m.data.isMobile))return!1;if(s.consumerMode&&!l.areFulfilled(m))return!1;if(f!==m.data.isList)return!1;if((!_.includes(m.data.forContent,"Any")||n.uniqueElements[i])&&!_.includes(m.data.forContent,i))return!1;if(f){if(p.length){if(!(h=_.find(m.data.groups,function(e){return!e.isHeader&&!e.isFooter})))return!1;if(!h.isAggregator&&!g(h,p[0],o,r))return!1;if(h.isAggregator&&!t.isAggregatorAllowed(e))return!1}if(d&&!d.isUserHidden()&&(h=_.first(m.data.groups),!("f"!==m.data.listHeaderLayoutFilter||h.isHeader&&g(h,d,o,r))))return!1;if(u&&!u.isUserHidden()&&(h=_.last(m.data.groups),!("f"!==m.data.listFooterLayoutFilter||h.isFooter&&g(h,u,o,r))))return!1;if(!a&&p.length%m.data.itemsInRow)return!1}else if(!m.data.isTpa&&!g(h=m.data.groups[0],e,o,r))return!1;return m.fixedSize||(_.each(m.data.groups,function(e){var t=e.layouts.length,i=(940-20*(t-1))/t;_.each(e.layouts,function(e){_.each(e.selections.overrides.variations,function(e){_.each(e,function(e){_.each(e,function(e){e.size&&e.size>1&&(e.size=e.size/i)})})})})}),m.fixedSize=!0),_.each(m.data.groups,function(e){_.each(e.layouts,function(t){var i=_.get(t,["selections","overrides","strips"]);i=_.values(i)[0],i=_.values(i)[0];var n=_.get(i,"columns");if(i&&n&&(e.columns=n,delete i.columns),e.columns&&e.columns.enable&&_.some(e.columns.singleColumnProps,function(e){return"image"===e.backgroundMode})&&t.mediaType!==c.COLUMNBG&&(t.mediaType=c.COLUMNBG),e.isHeader){var o=_.get(t,["selections","overrides","variations"]);o=_.values(o)[0],(o=_.values(o)[0])&&(_.each(["title","subTitle","longText"],function(e){_.get(o,[e,"align"])||_.set(o,[e,"align"],"center")}),_.get(o,["button","hPosition"])||_.set(o,["button","hPosition"],"center"))}})}),!0})}).then(function(t){return e.isTpaNode()?t:(s.consumerMode&&!r&&"GeneralDescription"!==e.contentElementType&&(t=_.filter(t,function(e){return _.get(e.data,"properties.settings")})),m.sortByPriority(e,t))})},this.sortByPriority=function(e,i){var n=a.story.selectedPage===t.homePageId;return(s.lodash4?_.sortBy:_.sortByAll)(i,function(t){return y(t,e)},function(e){var t=e.data.groups.length;return n?t:-t})},_.assign(this,{getCeType:h,getPriority:y})}]),function(e){!function(e){var t=function(){function e(e,t,i,n,o,r,a,s,l,c,d,u,p,h,g,m,f,v,y,b,S,C,w,T,I,x,P){this.designKitParameters=e,this.fontSizeCalculationUtils=t,this.fontsNotAllowedCapsStyle=i,this.fontsNotAllowedItalicStyle=n,this.themeChooser=o,this.LayoutElementFormatting=r,this.$log=a,this.$injector=s,this.componentStyles=l,this.sitePartTypes=c,this.mediaOpacity=d,this.storyServices=u,this.colorThiefService=p,this.themeChooserUtils=h,this.toasterService=g,this.socialLinkManager=m,this.obMonitoring=f,this.documentServicesMediator=v,this.PresetMediaType=y,this.flags=b,this.tpaService=S,this.modelTree=C,this.previewColors=w,this.designKitStrips=T,this.catalogStyleFetcher=I,this.selections=x,this.userOverrides=P,this.trimSantaColor=function(e){return e&&e.substring(e.indexOf("_")+1).substring(0,2)},this.textIsOnStrip="textIsOnStrip",this.lightColors=[this.designKitParameters.L1,this.designKitParameters.L2,this.designKitParameters.L3],this.lightColorsSantaFormat=this.lightColors.map(this._santaFormatNumber),this.darkColors=[this.designKitParameters.D1,this.designKitParameters.D2,this.designKitParameters.D3],this.darkColorsSantaFormat=this.darkColors.map(this._santaFormatNumber),this.allColorsSantaFormat=this.lightColorsSantaFormat.concat(this.darkColorsSantaFormat),this.fieldSubTypeToIndexMap=this.designKitParameters.fieldSubTypeToIndexMap,this.coloringOptions=this.designKitParameters.coloringOptions,this.kitStatesOptions=this.designKitParameters.kitStatesOptions,this.textColoringOptionsOnL=this._createColoringOptions(this.darkColors),this.textColoringOptionsOnD=this._createColoringOptions(this.lightColors),this.defaultCustomColor=this.darkColors[2],this.containerDefaultStyle=this.componentStyles.styles.container[0],this.typesThatShouldGetFullListConf=["Client"],this.getStyleDefinition=this._getStyleDefinition,this.coloringOptions=_.map(this.coloringOptions,function(e,t){return{id:t,value:e}}),this.kitStatesOptions=_.map(this.kitStatesOptions,function(e,t){return{id:t,value:e}}),this.tpaService.invertColor=this.invertColor.bind(this),AdiCoreSanta.setDesignKit(this)}return e.$inject=["designKitParameters","fontSizeCalculationUtils","fontsNotAllowedCapsStyle","fontsNotAllowedItalicStyle","themeChooser","LayoutElementFormatting","$log","$injector","componentStyles","sitePartTypes","mediaOpacity","storyServices","colorThiefService","themeChooserUtils","toasterService","socialLinkManager","obMonitoring","documentServicesMediator","PresetMediaType","flags","tpaService","modelTree","previewColors","designKitStrips","catalogStyleFetcher","selections","userOverrides"],e.prototype.getSantaFormatColor=function(e){return this._santaFormatNumber(this.designKitParameters[e])},e.prototype.getKitFormatColor=function(e){var t=this.allColorsSantaFormat.indexOf(e);return this.indexToKitColor(t)},e.prototype._santaFormatNumber=function(e){return"{color_"+e+"}"},e.prototype._createColoringOptions=function(e){return _.map(this.coloringOptions,function(t){return t=t.split(","),[e[t[0]-1],e[t[1]-1],e[t[2]-1]]})},e.prototype.santaToKitFormat=function(e){return this.indexToKitColor(this.allColorsSantaFormat.indexOf(e))},e.prototype.getStyleOfHeaderMobile=function(e){var t=this.documentServicesMediator.getTinyMenuComp(),i=this.documentServicesMediator.getStyleDefinitionByComp(t);i.skin="wysiwyg.viewer.skins.mobile.TinyMenuFullScreenSkin";var n=e?this.getColorOfStripMenu():this._getHeaderBgWithCurlyBraces(),o=this._isDarkColor(n),r=o?this.darkColorsSantaFormat:this.lightColorsSantaFormat,a=o?this.lightColorsSantaFormat:this.darkColorsSantaFormat;return i.style.properties.iconcolor=a[0],i.style.properties["alpha-borderColorSelected"]="0",i.style.properties["alpha-bordercolor"]="0",i.style.properties["alpha-bg"]="0",i.style.properties["alpha-bgOpen"]="0",i.style.properties.font="font_8",i.style.properties.rd="0px",i.style.properties.textAlignment="center",i.style.properties.bg=n,i.style.properties.separatorHeight="0",i.style.properties.iconcolorSelected=a[0],i.style.properties.bgDrop=r[0],i.style.properties.txt=a[0],i.style.properties.txts=a[2],i},e.prototype._setStyleOfHeaderMobile=function(e){var t=this.documentServicesMediator.getTinyMenuComp(),i=this.getStyleOfHeaderMobile(e);this.documentServicesMediator.setComponentStyleId(t,i),this.documentServicesMediator.updateLayout(t,{y:15})},e.prototype._isDarkColor=function(e){return-1!==this.darkColorsSantaFormat.indexOf(e)},e.prototype._getActiveKit=function(){return this.themeChooser.getActiveTheme("color")},e.prototype._getCompBgStyle=function(e){return this.flags.coreHeaderFooterDesignKitConfig,this.documentServicesMediator.getStyleDefinitionByComp(e).style.properties.bg},e.prototype._getHeaderComp=function(){return this.flags.coreHeaderFooterDesignKitConfig,this.documentServicesMediator.getHeader()},e.prototype._getFooterComp=function(){return this.flags.coreHeaderFooterDesignKitConfig,this.documentServicesMediator.getFooter()},e.prototype._getHeaderBg=function(){return this.flags.coreHeaderFooterDesignKitConfig,this._getCompBgStyle(this._getHeaderComp())},e.prototype._getHeaderBgWithCurlyBraces=function(){return this.flags.coreHeaderFooterDesignKitConfig?"{"+this.getHeaderBg()+"}":"{"+this._getHeaderBg()+"}"},e.prototype.getConfigurationOfSiteHeader=function(e,t){var i;t=t||this._getActiveKit();var n=_.get(e&&e.getLayoutSelectionStore().siteOverrides,"headerBackground");i=this.flags.coreHeaderFooterDesignKitConfig?n?this.getSantaFormatColor(n):t.kitFonts.headerAndFooter.headerBgColor?t.kitFonts.headerAndFooter.headerBgColor:"{"+(_.get(t,"definition.styles.hc1.properties.bg")||"color_"+this.designKitParameters.L1)+"}":n?this.getSantaFormatColor(n):t.kitFonts.headerAndFooter.headerBgColor||this._getHeaderBgWithCurlyBraces();var o=this.allColorsSantaFormat.indexOf(i);return{id:o,display:this.indexToKitColor(o)}},e.prototype.getConfigurationOfSiteFooter=function(e,t){var i;if(t=t||this._getActiveKit(),this.flags.coreHeaderFooterDesignKitConfig){var n=_.get(e&&e.getLayoutSelectionStore().siteOverrides,"footerBackground");i=n?this.getSantaFormatColor(n):t.kitFonts.headerAndFooter.headerBgColor?t.kitFonts.headerAndFooter.headerBgColor:"{"+(_.get(t,"definition.styles.fc1.properties.bg")||"color_"+this.designKitParameters.L1)+"}"}else i="{"+(_.get(t,"definition.styles.fc1.properties.bg")||this._getCompBgStyle(this._getFooterComp()))+"}";var o=this.allColorsSantaFormat.indexOf(i);return{id:o,display:this.indexToKitColor(o)}},e.prototype.isSitePartDark=function(e){return this._isDarkColor(e===this.sitePartTypes.HEADER?this._getHeaderBgWithCurlyBraces():this._getFooterBgWithCurlyBraces())},e.prototype._getFooterBgWithCurlyBraces=function(){return this.flags.coreHeaderFooterDesignKitConfig?"{"+this.getFooterBg()+"}":"{"+this._getCompBgStyle(this._getFooterComp())+"}"},e.prototype._getContrastedColor=function(e,t,i){var n,o,r,a,s,l=this._getSelectionsOfSegment(e),c=this._getColorOfFirstBackground(e,t,l);if(c===this.textIsOnStrip)return this.lightColors[0];var d=(i+1)%3,u=(i+2)%3;if(this._isDarkColor(c)?(n=this.textColoringOptionsOnD,r=this.lightColors,a=this.darkColorsSantaFormat):(n=this.textColoringOptionsOnL,r=this.darkColors,a=this.lightColorsSantaFormat),o=(s=n[l.colorIndex||0])[i],c===a[2]&&o===r[2]){var p=_.findIndex(n,function(e){return(e[i]===r[0]||e[i]===r[1])&&e[d]===s[d]&&e[u]===s[u]});l.colorIndex=p,o=n[l.colorIndex][i]}return o},e.prototype._hasLeStripImageOrVideo=function(e){if(e&&e.overrides&&e.overrides.media)return _.some(e.overrides.media,function(t,i){return e.argList[i]&&e.argList[i].type===AdiCoreSanta.ElementTypes.Media&&("Strip Image"===t.name||"Strip Video"===t.name||e.containingSegment.hasColumnWithMediaBackground())})},e.prototype._getParentElement=function(e,t,i){void 0===i&&(i=!1);var n=e.containingLG.getLgData();if(t){if(t.boxParentOverrideKey&&(void 0!==t.onMediaIndex||!e.hasColumnWithColorBackground()))return"box";if(!i&&!t.boxParentOverrideKey&&!e.hasColumnWithColorBackground()){var o=e.node&&this.selections.getForNodeByType(e.node).background;if(o&&("image"===o.mediaType||"video"===o.mediaType)&&(!this.flags.newListLayouts||!n.strip||!n.strip.partialMediaPosition))return"media"}var r=e.getLENoError();if(void 0!==t.onMediaIndex&&r){if(this._hasLeStripImageOrVideo(r))return"media";var a=r.getArgValue(t.onMediaIndex),s=a&&a[0]&&this.colorThiefService.getColorOfImageBehindText(a[0],r,t);if(s)return this.colorThiefService.isColorDark(s)?this.darkColorsSantaFormat[0]:this.lightColorsSantaFormat[0]}if(e.containingLG.isHeader())return"header"}return e.hasColumnWithColorBackground()?"column":n.strip&&n.strip.enable&&n.strip.color?"strip":"page"},e.prototype._getColorOfFirstBackground=function(e,t,i,n){var o=e.containingLG.getLgData();if(t){var r=e.getLayoutSelectionStore();if(t.boxParentOverrideKey&&(void 0!==t.onMediaIndex||!e.hasColumnWithColorBackground())){var a=r.getOverride("style",e,t.boxParentOverrideKey)||this.containerDefaultStyle;if(a)if("0"!==this._getStyleDefinition(a).style.properties["alpha-bg"])return n?this.getComponentCustomColorWithOverride(e,t.boxParentOverrideKey):this.getComponentCustomColor(e,t.boxParentOverrideKey)}var s=e.getLENoError();if(void 0!==t.onMediaIndex&&s){if(this._hasLeStripImageOrVideo(s)){if(n)if(h=this.mediaOpacity.getColor(e.getSegmentNode()))return h;return this.textIsOnStrip}var l=s.getArgValue(t.onMediaIndex),c=l&&l[0]&&this.colorThiefService.getColorOfImageBehindText(l[0],s,t);if(c)return this.colorThiefService.isColorDark(c)?this.darkColorsSantaFormat[0]:this.lightColorsSantaFormat[0]}if(e.containingLG.isHeader()){var d=s&&s.getLayoutBySubType(t.subType);if(o.menuStrip&&o.menuStrip.enable&&(d&&d.inMenuStrip||s&&s.isLayoutInMenuStripArea(d)))return o.menuStrip.color;if((i=i||this._getSelectionsOfSegment(e)).bgColor)return i.bgColor}}if(e.hasColumnWithColorBackground())return n?this.getComponentCustomColorWithOverride(e,"columnBg"):this.getComponentCustomColor(this.desktopSegment(e),"columnBg");if(e.isMobile){var u=e.containingLG.getColumnsData();if(u&&u.enable){var p=this.getComponentCustomColor(e,"columnBg",void 0,!0);if(p)return p}}if(o.strip&&o.strip.enable&&o.strip.color){var h;if(n&&"image"===o.strip.mediaType&&(!this.flags.newListLayouts||!o.strip.partialMediaPosition))if(h=this.mediaOpacity.getColor(e.getSegmentNode()))return h;return o.strip.color}return this.documentServicesMediator.getPageBackground(this.documentServicesMediator.getCurrentPageId()).ref.color},e.prototype.isSegmentHeaderOrFooter=function(e){return"header"===e.sitePart||"footer"===e.sitePart},e.prototype.calculateFieldColor=function(e,t,i,n){var o;if(this.themeChooser.isActiveMainKitWithNewColorationPalette()&&this._isNewColorationAlgo(this._getSelectionsOfSegment(t))&&!this.isSegmentHeaderOrFooter(t))o=this._getColorOfNewColoration(e,t,i,n);else{var r=this.fieldSubTypeToIndexMap[e];void 0!==r&&(o=this._getContrastedColor(t,i,r))}return o},e.prototype.getTextContrastingToBg=function(e,t,i,n){return(n=n||this._getColorOfFirstBackground(e.containingSegment,t))===this.textIsOnStrip&&(n=this.darkColorsSantaFormat[0]),n&&!this.themeChooser.coloration.isValidTextContrast(i,n)?"color_"+(this.isDarkColor(n)?this.designKitParameters.L1:this.designKitParameters.D1):i},e.prototype._getTextColorFromActiveKitConfigurations=function(e,t,i){var n=this._getActiveKit().configurations;return n[e][t][i]||(i="longTextColor"),n[e][t][i]},e.prototype._getColorOfNewColoration=function(e,t,i,n){var o,r,a=this.lightColors[0],s=this._getColorIndexOfLGStrip(t.containingLG),l=e+"Color";switch(this._getParentElement(t,i)){case"strip":r=0;var c=n||this._getTextColorFromActiveKitConfigurations(s,r,l);o=c?this.trimSantaColor(c):a;break;case"box":r=1;var d=n||this._getTextColorFromActiveKitConfigurations(s,r,l);o=d?this.trimSantaColor(d):a;break;case"media":o=a;break;case"column":r=1;var u=n||this._getTextColorFromActiveKitConfigurations(s,r,l);o=u?this.trimSantaColor(u):a;break;default:console.log("No match for parent element, fieldType: ",e),o=a}return o},e.prototype.shouldHeaderBeTransparent=function(){if(!this.mergedHeaderService){if(!this.$injector.has("mergedHeaderService"))return!1;this.mergedHeaderService=this.$injector.get("mergedHeaderService")}return this.mergedHeaderService.shouldHeaderBeTransparent()},e.prototype._getHeaderTextColoringIndex=function(e){return this.flags.mergedHeader&&this.shouldHeaderBeTransparent()?0:(e=e||this._getActiveKit()).kitFonts.headerAndFooter&&e.kitFonts.headerAndFooter.headerTextColoring||0},e.prototype._getFooterTextColoringIndex=function(e){return(e=e||this._getActiveKit()).kitFonts.headerAndFooter&&e.kitFonts.headerAndFooter.footerTextColoring||0},e.prototype._getSelectionsOfSegment=function(e){return e.getLayoutSelectionStore().getDesignKitConfiguration(e)},e.prototype.getKitConfigurationCustomColor=function(e,t,i){var n=(i=i||this._getActiveKit()).configurations[e]||this.getFirstValidConfigurationForColor(i.configurations,e);if(n&&n[t])return n[t].cutsomColor;this.$log.error(i.displayName+" kit: No configurations for: "+t+" containers. color: "+this.indexToKitColor(e))},e.prototype.getFirstValidConfigurationForColor=function(e,t){for(var i=t<3?0:3,n=i;n<i+3;n++)if(e[n])return e[n]},e.prototype._reseSelectionsOfSegment=function(e){return e.getLayoutSelectionStore().resetDesignKitConfiguration(e)},e.prototype.getComponentCustomColorWithOverride=function(e,t){var i=this.userOverrides.getFieldColorOverride(e.getSegmentNode(),t);return i?this.getSantaFormatColor(i):this.getComponentCustomColor(e,t)},e.prototype.getComponentCustomColor=function(e,t,i,n){var o=i||this._getSelectionsOfSegment(e),r=o.cutsomColor&&o.cutsomColor[t];if(!r&&-1!==t.indexOf("container")){var a=this._getContainersKeysFromConf(o);a.length&&(r=o.cutsomColor[a[0]])}return r||(n?void 0:this._santaFormatNumber(this.defaultCustomColor))},e.prototype._getTitleColor=function(e,t){return this.getColorByField("title",e,t)},e.prototype.getColorByField=function(e,t,i){var n=this._getSelectionsOfSegment(t),o=this.getColorFromSelections(n,e);i&&i.getLayoutBySubType(e);return this._santaFormatNumber(this.trimSantaColor(o))},e.prototype._getLongtextColor=function(e,t){return this.getColorByField("longText",e,t)},e.prototype._changeColoringIndex=function(e,t){this._getSelectionsOfSegment(e).colorIndex=t,this._render()},e.prototype._checkIfAllTextInTheSameColor=function(e){var t=this._getSelectionsOfSegment(e),i=this.textColoringOptionsOnD[t.colorIndex];return i[0]===i[1]&&i[1]===i[2]},e.prototype._getStyleDefinition=function(e){if(this.flags.separateVisualValidationFromSanta){var t=this.themeChooser.getActiveTheme("mainKit");return this.catalogStyleFetcher.getStyleDefinition2(t,e)}return this.catalogStyleFetcher.getStyleDefinition(e)},e.prototype._render=function(){this.storyServices.emitLayoutSolutionChanged()},e.prototype._noBg=function(e,t){return!e[t=t||"alpha-bg"]||"0"===e[t]},e.prototype._noBgForm=function(e){return this._noBg(e,"alpha-bg1")},e.prototype._noBorder=function(e){return!e.brd||"0"===e.brd},e.prototype._getContainersKeysFromConf=function(e){return _.keys((this.flags.lodash4?_.pickBy:_[String("pick")])(e.cutsomColor,function(e,t){return-1!==t.indexOf("container")}))},e.prototype._getContainersKeyOfLayouts=function(e,t){var i=e.hasColumnWithColorBackground(),n=_.map(t,function(t){return i&&!e.getLE().isOnMediaContainer(t)?"columnBg":e.getOverrideKey(t)});return i&&n.unshift("columnBg"),_.uniq(n)},e.prototype._adjustConfKeysToSegment=function(e,t){if(t.length>0){var i=this._getContainersKeysFromConf(e);_.forEach(i,function(i,n){t[n]!==i&&(e.cutsomColor[t[n]]=e.cutsomColor[i],delete e.cutsomColor[i])})}},e.prototype._clearUnusedCustomContainers=function(e,t){var i=this._getContainersKeysFromConf(e),n=this._getContainersKeyOfLayouts(t,t.getLE().getAllDecorativeContainersLayout());_.forEach(i,function(t){-1===n.indexOf(t)&&delete e.cutsomColor[t]})},e.prototype.setStripColor=function(e,t){var i=e.getLgData();i.strip=i.strip||{},i.strip.color=t,i.strip.enable||("space"===i.bottomLine.line&&(i.bottomLine.line="line",i.bottomLine.enable=!1),"space"===i.topLine.line&&(i.topLine.line="line",i.topLine.enable=!1),i.strip.enable=!0,i.strip.paddingBottom=80,i.strip.paddingTop=80,i.strip.scrollType="scroll",i.strip.bgPosition="center",i.strip.fittingType="fill",i.strip.enable=!0,i.strip.style="strc1",i.strip.url="none"),e.isMobile()||_.each(e.getMobileSiblingLGs(),function(e){if(e){var t=e.getLgData();t.strip=t.strip||{},t.strip.color=i.strip.color}})},e.prototype.desktopSegment=function(e){return this.flags.coreNewMobileColumns?this.flags.consumerMode?e.getDesktopSegment():e:e.isPresetPreview()||!this.flags.consumerMode?e:e.getDesktopSegment()},e.prototype.applyColoration=function(e,t,i){var n=this;i=i||this._getActiveKit();var o=t.getLENoError();if(o){var r;if(e===this.sitePartTypes.BODY){var a=void 0,s=this._getContainersKeyOfLayouts(t,o.getAllDecorativeContainersLayout());if(t.isMobile)a=this._getColorIndexOfLGStrip(this.desktopSegment(t).containingLG)||0;else{a=this._getColorIndexOfLGStrip(t.containingLG)||0;var l=o.getMediaLayout();l&&l.shadowData&&(l.shadowData.left||l.shadowData.right)&&s.push("shadowBox")}var c=s.length;if(c<0||c>2)return void this.toasterService.error("number of containers is not valid: "+c,!0);if(!i.configurations[a])return void(t.node.isTpaNode()||this.$log.error("no configuration for regular segment - "+t.node.contentElementType));var d=i.configurations[a][c];if(!d)return void this.toasterService.error(i.displayName+" kit: No configurations for : "+c+" containers. color: "+this.indexToKitColor(a),!0);delete(d=ob.deepClone(d)).stripColor,this._adjustConfKeysToSegment(d,s),r=this._reseSelectionsOfSegment(t),Object.assign(r,d),r.colorIndex=r.colorIndex||0}else r=this.applyColorationForHeaderFooter(e,t,i);o.layoutArray.forEach(function(e){if(e.type===AdiCoreSanta.ElementTypes.Text||e.type===AdiCoreSanta.ElementTypes.Form||"widget"===e.type&&"login"===e.subType){var i=n.getColorFromSelections(r,e.subType);r[e.subType+"Color"]=n._santaFormatNumber(n.calculateFieldColor(e.subType,t,e,i))}})}},e.prototype.applyMediaOpacityAndBgColorForSolution=function(e){var t=this,i={};_.each(e,function(e){_.each(e.segments,function(n){var o=n.node.identifyingNode;o.isList()&&(i[o.id]||(i[o.id]={listNode:o,segments:[]}),i[o.id].segments=i[o.id].segments.concat(e.segments)),n.node.isListHeader()||t.applyMediaOpacityAndBgColorForNode(n.node,[n])})}),_.each(i,function(e){var i=t.applyMediaOpacityAndBgColorForNode(e.listNode,e.segments),n=e.listNode.children[0],o=t.selections.getForNode(n);o.designKit||(o.designKit={});var r=o.designKit;r.mediaOpacity=i.mediaOpacity,r.mediaColor=i.mediaColor})},e.prototype.applyMediaOpacityAndBgColorForNode=function(e,t){var i=this;t=t[0].isMobile?t.map(function(e){return i.desktopSegment(e)}):t;var n=this.selections.getForNode(e);n.designKit||(n.designKit={});var o=n.designKit;return t[0].isMobile?o:(o.mediaOpacity=n.mediaOpacity,o.mediaColor=n.mediaColor?this.getSantaFormatColor(n.mediaColor):void 0,(e.isList()?this.hasTextDirectlyOnListBackground(e,t):this.hasTextDirectlyOnMedia(e,t[0]))&&(void 0===o.mediaOpacity&&(o.mediaOpacity=AdiCoreSanta.DEFAULT_OPACITY),void 0===o.mediaColor&&(o.mediaColor=this.getD1Color())),o)},e.prototype.hasTextDirectlyOnListBackground=function(e,t){var i=this;if(this.flags.newListLayouts){var n=t[0].containingLG.getLgData().strip;if(n&&n.partialMediaPosition)return!1}var o=_.filter(e.children,function(e){var t=i.selections.getForNodeByType(e).background;return t&&("image"===t.mediaType||"video"===t.mediaType)});return _.find(o,function(e){var i=_.find(t,function(t){return t.node===e});if(i){var n=i.getLENoError();return _.find(n.layoutArray,function(e){return!e.boxParentOverrideKey&&void 0===e.onMediaIndex&&!i.hasColumnWithColorBackground()})}})},e.prototype.hasTextDirectlyOnMedia=function(e,t){var i=this,n=t.getLENoError();if(n)return _.find(n.layoutArray,function(n){return"media"===i._getParentElement(t,n,!e.isListItem)})},e.prototype._setConfigurationForAllSegmentsOfLG=function(e,t){this.setStripColor(e,this.allColorsSantaFormat[t])},e.prototype._getFirstNodeOfLg=function(e){return e.segments[0].node},e.prototype._kitHasPattern=function(e){return e.kitFonts&&e.kitFonts.confPattern&&e.kitFonts.confPattern.length},e.prototype._getIdentifyingNodeOfLg=function(e){return this._getFirstNodeOfLg(e).identifyingNodeId},e.prototype.setTpaBg=function(e,t){e.getLgData().strip.color=t?this.darkColorsSantaFormat[0]:this.lightColorsSantaFormat[0]},e.prototype.lgHasMediaBg=function(e){var t=_.get(e.getLgData(),"strip.mediaType",AdiCoreSanta.BgMediaTypes.COLOR);return t!==AdiCoreSanta.BgMediaTypes.COLOR&&t!==AdiCoreSanta.BgMediaTypes.PATTERN},e.prototype._segConfigurationsForPage=function(e,t,i){var n=e.kitFonts.confPattern.length,o=0,r=e.kitFonts.listConfiguration?e.kitFonts.listConfiguration.id:void 0;if(this.themeChooser.coloration.isKitWithNewColorationMethod(e)||void 0!==r||this.toasterService.error("list configuration is not defined",!0),t)for(var a,s,l,c=0;c<t.length;c++)if(a=t[c],s=e.kitFonts.confPattern[o%n].id,(l=this._getFirstNodeOfLg(a)).isTpaNode())this.modelTree.canInvertTpa(l)&&this.setTpaColoration(a,l,this.isKitDark(e));else{var d=l&&-1!==this.typesThatShouldGetFullListConf.indexOf(l.contentElementType),u=l&&l.isListItem&&"ListHeader"!==l.contentElementType;if((e.kitFonts.listConfiguration||this.themeChooser.isNewKitVersion(e))&&(u||d)){r=e.kitFonts.listConfiguration?e.kitFonts.listConfiguration.id:void 0,this.themeChooser.coloration.isKitWithNewColorationMethod(e)&&1===a.segments.length||d?(r=s,o++):1===a.segments.length||d?r===s&&o++:(r=s,o++);for(var p=l.identifyingNodeId;a&&this._getIdentifyingNodeOfLg(a)===p;)this._setConfigurationForAllSegmentsOfLG(a,this.lgHasMediaBg(a)?3:r),a=t[++c];c--}else{this._setConfigurationForAllSegmentsOfLG(a,this.lgHasMediaBg(a)?3:s);var h=t[c+1];"ListHeader"===a.contentType&&h&&this._getIdentifyingNodeOfLg(a)===this._getIdentifyingNodeOfLg(h)&&h.segments.length>1||o++}}},e.prototype.isKitDark=function(e){return 1===e.kitFonts.colors.currentState},e.prototype.setTpaColoration=function(e,t,i){this.setTpaBg(e,i),this.setTpaForeground(t,i)},e.prototype.setTpaForeground=function(e,t){this.tpaService.updateStyle(e,this.tpaService.getTpaPreset(e),t)},e.prototype.setConfigurationsOfKit=function(e){var t=this;if(this._kitHasPattern(e)){var i=this.layoutSolver.siteSolutions.body;_.each(i,function(i){t._segConfigurationsForPage(e,i.getSelectedSolution(),!1)}),[this.sitePartTypes.HEADER,this.sitePartTypes.FOOTER].forEach(function(i){var n=t.layoutSolver.getSelectedSolution(i);n&&t.setConfigurationForHeaderFooter(i,n,e)}),Object.keys(i).length&&this.modelTree.setColorDirtyForPages(this.getUnrenderedPages(i))}},e.prototype._getConfigurationToDisplayOfKit=function(e){var t=this;if(e.configurations){var i=[];return _.forEach(e.configurations,function(e,n){e&&i.push({id:n,display:t.indexToKitColor(n)})}),i}},e.prototype._indexToKitColor=function(e){return(Math.floor(e/3)?"D":"L")+(e%3+1)},e.prototype._setSpace=function(e,t){e.enable=!0,e.line="space",e.space=t},e.prototype._getColorIndexOfLGStrip=function(e){if(e){var t=e.getLgData();if(t.strip&&t.strip.enable)return this.allColorsSantaFormat.indexOf(t.strip.color)}},e.prototype._getButtonColors=function(e,t){var i,n=e.containingSegment,o=e.getLayoutBySubType("button");if(e.getAllDecorativeContainersLayout().length>0&&void 0===o.boxParentOverrideKey){var r=this.allColorsSantaFormat.indexOf(e.containingLG.getLgData().strip.color),a=this._getActiveKit();a.configurations[r]||(this.obMonitoring.error("no configuration",{currentKitName:a.displayName,confIndex:r}),r=_.findIndex(a.configurations)),i=a.configurations[r][0]}var s=this.getComponentCustomColor(n,"buttontext",i),l=this.getComponentCustomColor(n,"buttonbg",i),c=this._getColorOfFirstBackground(n,o),d=parseInt(_.get(t,["style","properties","alpha-bg"]));return c===this.textIsOnStrip&&1!==d&&(c=this.darkColorsSantaFormat[0],l=this.lightColorsSantaFormat[0],s=this.darkColorsSantaFormat[0]),{firstBgColor:c,bgColor:l,textColor:s}},e.prototype.getFontOverride=function(e,t,i,n){var o=this.fontSizeCalculationUtils.fontOfFieldType(e,t),r=o&&o.aFont;if(r){if(i)i=this.fontSizeCalculationUtils.adjustFontExtraSize(i,o.category),r=this.fontSizeCalculationUtils.addAndNormalizeFont(r,i,o.category,n).newFont;return r}},e.prototype._isNewColorationAlgo=function(e){var t=e.titleColor,i=e.subTitleColor,n=e.longTextColor;return!!(t&&i&&n)},e.prototype.getColorFromSelections=function(e,t){return e[t+"Color"]||e.longTextColor},e.prototype.getFontFormatting=function(e,t,i,n,o){var r=e.node,a=this._getSelectionsOfSegment(e),s=this.fontSizeCalculationUtils.getCategoryOfCE(r,t);if(s){var l=this.themeChooser.getActiveFontTheme();if(l.kitFonts&&l.kitFonts[s]){var c=l.kitFonts[s],d=new this.LayoutElementFormatting;if(!n){var u=this.getColorFromSelections(a,t),p=o?this.designKitParameters[o]:this.trimSantaColor(u);p&&d.setColor(p)}d.setBold(!!c.Bold);var h=!1;c.Italic&&i&&i.fontFamily&&(h=_.some(this.fontsNotAllowedItalicStyle.names,function(e){return i.fontFamily.includes(e)})),d.setItalic(!!c.Italic&&!h);var g=!1;return c.Caps&&i&&i.fontFamily&&(g=_.some(this.fontsNotAllowedCapsStyle.names,function(e){return i.fontFamily.includes(e)})),d.setCapsLock(!!c.Caps&&!g),d.setUnderline(!1),d.setBGColor(""),d}}},e.prototype.getFormattingForRichTextEditor=function(e,t){var i=new this.LayoutElementFormatting,n=this.fontSizeCalculationUtils.getCategoryOfCE(e,t);if(n){var o=this.themeChooser.getActiveFontTheme();if(o.kitFonts&&o.kitFonts[n]){var r=o.kitFonts[n];i.setBold(!!r.Bold),i.setItalic(!!r.Italic),i.setUnderline(!1)}}return i},e.prototype.getDefaultBackgroundColor=function(){return this._santaFormatNumber(this.lightColors[0])},e.prototype.getD1Color=function(){return this._santaFormatNumber(this.darkColors[0])},e.prototype.getTextColoringOptions=function(){return this.coloringOptions},e.prototype.getKitStatesOptions=function(){return this.kitStatesOptions},e.prototype.changeColoringIndex=function(e,t){this._changeColoringIndex(e,t)},e.prototype.getColoringIndex=function(e){return this._getSelectionsOfSegment(e).colorIndex},e.prototype.checkIfAllTextInTheSameColor=function(e){return this._checkIfAllTextInTheSameColor(e)},e.prototype.setComponentCustomColor=function(e,t,i){var n=this._getSelectionsOfSegment(e);n.cutsomColor=n.cutsomColor||{},n.cutsomColor[t]=i.pointer,this._render()},e.prototype.getBoxColoredStyleDefinition=function(e,t,i,n){var o=t.containingSegment,r=this._getStyleDefinition(e),a=r.style.properties;return"header"!==o.sitePart&&(this._noBg(a)?a.brd=n?this.getSantaFormatColor(n):this._checkIfAllTextInTheSameColor(o)?this.getComponentCustomColor(o,i):this._getTitleColor(o,t):a.bg=n?this.getSantaFormatColor(n):this.getComponentCustomColor(o,i)),r},e.prototype.getTextButtonHoverColor=function(e){if(this.flags.twoButtonSection){var t=this.previewColors.getRGBColor(e),i=this.previewColors.getRGBColor(this.lightColorsSantaFormat[1]),n=this.previewColors.getRGBColor(this.darkColorsSantaFormat[1]);return this.themeChooserUtils.isDarkColor(t,{black:n,white:i},!0)?this.lightColorsSantaFormat[1]:this.darkColorsSantaFormat[1]}return this.lightColorsSantaFormat[1]===e?this.lightColorsSantaFormat[0]:this.lightColorsSantaFormat[1]},e.prototype.getButtonColoredStyleDefinition=function(e,t,i){var n=this._getStyleDefinition(e),o=this._getButtonColors(t,n),r=o.firstBgColor,a=o.bgColor,s=o.textColor;i=i&&this.getSantaFormatColor(i);var l=n.style.properties;return this._noBg(l)?this._noBorder(l)?(l.txt=i||a,l.txth=this.getTextButtonHoverColor(r)):(l.txt=i||a,l.brd=i||a,l.bgh=i||a,l["alpha-bgh"]="1",l.txth=r,l["alpha-brdh"]="0"):(l.txt=l.txth=this.flags.twoButtonSection?this.isDarkColorWithNewColoration(i||a)?this.lightColorsSantaFormat[0]:this.darkColorsSantaFormat[0]:s,l.bg=l.bgh=i||a,l["alpha-bgh"]="0.6"),n},e.prototype.getColorOfFirstBackground=function(e,t,i){var n=this._getColorOfFirstBackground(e.containingSegment,t,void 0,i);return n===this.textIsOnStrip?this.darkColorsSantaFormat[0]:n},e.prototype.getLayoutColorContrastToBackground=function(e,t){var i=this._getColorOfFirstBackground(e.containingSegment,t);return this._isDarkColor(i)?this.lightColorsSantaFormat[0]:this.darkColorsSantaFormat[0]},e.prototype.getBorderBoxStyle=function(e,t){return{style:{properties:{"alpha-bg":"0","alpha-brd":"1","boxShadowToggleOn-shd":"false",brd:this.getLayoutColorContrastToBackground(e,t),brw:"3",rd:"0px",shd:"0px 1px 4px 0px rgba(0,0,0,0.6)"}},styleType:"custom",skin:"wysiwyg.viewer.skins.area.DefaultAreaSkin"}},e.prototype.getShadowBoxStyle=function(e,t){return{style:{properties:{"alpha-bg":"1",bg:this.getLayoutColorContrastToBackground(e,t)}},styleType:"custom",skin:"wysiwyg.viewer.skins.area.RectangleArea",type:"TopLevelStyle"}},e.prototype.getLineColoredStyleDefinition=function(e,t,i,n){var o=t.containingSegment,r=this._getStyleDefinition(e),a=r.style.properties;if(t.isHeader){t.containingLG.getColumnsData();if(n.docked){var s=this._getHeaderBgWithCurlyBraces();this._isDarkColor(s)?a.brd=this.lightColorsSantaFormat[0]:a.brd=this.darkColorsSantaFormat[0]}else a.brd=this._getTitleColor(o,t);a["alpha-brd"]=.85,a.lnw="1px"}else a.brd=this.getComponentCustomColor(o,i);return r},e.prototype.getCustomMenuDefinitions=function(e,t){var i=e.kitFonts.headerAndFooter,n=t?i.stripHeader:i.headerBgColor,o=this._isDarkColor(n)?this.lightColorsSantaFormat[0]:this.darkColorsSantaFormat[0],r=t?i.selectedMenuOnStrip:i.selectedMenuOnHeader;return{txt:o,txth:r,txts:r}},e.prototype.getMenuColoredStyleDefinition=function(e,t){var i,n=this._getActiveKit(),o=!t.isMobile()&&t.containingSegment.containingLG.getLgData().menuStrip&&t.containingSegment.containingLG.getLgData().menuStrip.enable;if(this.flags.menuColor&&this.themeChooser.coloration.isActiveKitWithNewColoration())i=this.getCustomMenuDefinitions(n,o);else{var r=this._getHeaderBgWithCurlyBraces(),a=!o&&this._isDarkColor(r),s=o&&this._isDarkColor(n.kitFonts.headerAndFooter.stripHeader);i=a||s?{txt:this.lightColorsSantaFormat[0],txth:this.lightColorsSantaFormat[1],txts:this.lightColorsSantaFormat[1]}:{txt:this.darkColorsSantaFormat[0],txth:this.darkColorsSantaFormat[1],txts:this.darkColorsSantaFormat[1]}}var l=this._getStyleDefinition(e),c=l.style.properties;return _.forEach(i,function(e,t){c[t]=e}),c.bgDrop=o?this.getColorOfStripMenu(n):this.flags.coreHeaderFooterDesignKitConfig?this.getHeaderBg():this._getHeaderBg(),l},e.prototype.getCartColoredStyle=function(e){var t=this._getActiveKit(),i=e.containingSegment.containingLG.getLgData().menuStrip&&e.containingSegment.containingLG.getLgData().menuStrip.enable?this.getColorOfStripMenu(t):this._getHeaderBgWithCurlyBraces(),n=this._isDarkColor(i);return this.designKitParameters.defaultCartStyle.style.properties.param_color_cartWidget_cartIcon="color_"+(n?this.lightColors[0]:this.darkColors[0]),this.designKitParameters.defaultCartStyle.style.properties.param_color_cartWidget_cartIconNumber=this.designKitParameters.defaultCartStyle.style.properties.param_color_cartWidget_cartIcon,this.designKitParameters.defaultCartStyle},e.prototype.getShapeColor=function(e){var t=e.containingSegment;return this._getTitleColor(t,e)},e.prototype.getImageColoredStyleDefinition=function(e,t,i,n){if(-1===e.indexOf("tpa")&&-1===e.indexOf("tpm")&&-1===e.indexOf("thm")){var o,r=this._getStyleDefinition(e),a=r.style.properties;if(a.brd){var s=t.containingSegment,l=t.getAllDecorativeContainersLayout();if(l.length){var c=l[0],d=s.getOverrideKey(c);if(i.boxParentOverrideKey!==d){var u=this._getStyleDefinition(n.style&&n.style[d]||c.style).style.properties;o=this._noBg(u)?this._checkIfAllTextInTheSameColor(s)?this.getComponentCustomColor(s,d):this._getTitleColor(s,t):this.getComponentCustomColor(s,d)}}return o=o||this._getTitleColor(s,t),a.brd=o,r}}},e.prototype.getFormColoredStyleDefinition=function(e,t){var i=this._getStyleDefinition(e),n=i.style.properties,o=t.containingSegment,r=this.getColorByField("form",o,t),a=this._isDarkColor(r)?this.lightColorsSantaFormat[0]:this.darkColorsSantaFormat[0];return this._noBgForm(n)?(n.brd=r,n.labelTxt=r,n.txt1=r,n.txt3=r,n.txt4=r,n.bg2=r,n.txt2=a):(n.bg1=r,n.labelTxt=a,n.bg2=r,n.txt2=a,n.txt1=a,n.txt3=a),i},e.prototype.saveDesignKitConfiguration=function(e){var t=this,i=this._getActiveKit();if(i.Custom)this.toasterService.error("Can't save configuration for custom theme",!0);else if(this.themeChooser.isKit(i)){var n=e.segments[0],o=this._getSelectionsOfSegment(n);o=ob.deepClone(o),this._clearUnusedCustomContainers(o,n);var r=(this.flags.lodash4?_.pickBy:_[String("pick")])(o,function(e){return!(e instanceof t.LayoutElementFormatting)}),a=e.getLgData().strip.color;r.stripColor=a;var s=this.allColorsSantaFormat.indexOf(a);if(-1!==s){var l=n.getLE();i.configurations=i.configurations||[],i.configurations[s]=i.configurations[s]||[];var c=l.getAllDecorativeContainersLayout().length;c<0||c>2?this.toasterService.error("number of containers is not valid: "+c,!0):(i.configurations[s][c]=ob.deepClone(r),this.themeChooser.saveTheme(i),this.toasterService.info("configuration saved for color "+s+" and "+c+" containers",!0))}else this.toasterService.error("Strip color isn't defined",!0)}else this.toasterService.error("Theme is not kit",!0)},e.prototype.getArrayColors=function(){return this.allColorsSantaFormat},e.prototype.getArrayColorsHex=function(e){var t=this.lightColors.concat(this.darkColors),i=(e=e||this._getActiveKit()).definition.properties;return _.map(t,function(e){var t=_.clone(i["color_"+e]);return t.pointer="{color_"+e+"}",t})},e.prototype.getGsu=function(e){var t=e&&e.designPolicy&&e.designPolicy.formula||"dp0";return this.designKitParameters.dpToGsu[t]},e.prototype.manageStripsPadding=function(e,t,i){var n=_.map(e,"segments[0]");if(n&&0!==n.length){var o=this.getGsu(n[0].getLayoutSelectionStore());if("body"===i){var r=this.designKitStrips.getLgStripDescriptors(e),a=this.designKitStrips.getHeaderStripDescriptor(!n[0].isMobile&&this.layoutSolver?this.layoutSolver.getSelectedSolution(this.sitePartTypes.HEADER):void 0,this.flags.coreHeaderFooterDesignKitConfig?this.getHeaderBg():void 0),s=this.designKitStrips.getFooterStripDescriptor(this.flags.coreHeaderFooterDesignKitConfig?this.getFooterBg():void 0);this.designKitStrips.manageBodyStripsPadding(r,t,o,a,s)}else{var l=n[0].isMobile?0:o*this.designKitParameters.smallHeaderFooterPaddingBottomFactor,c=n[0].getLENoError(),d=c&&t[0].menuStrip,u=d&&d.enable;if("header"===i){var p=c&&c.getLayoutBySubType("menu"),h=p&&p.top;u?0===h?(this._setSpace(t[0].topLine,d.paddingTop),this._setSpace(t[0].bottomLine,l)):(this._setSpace(t[0].topLine,l),this._setSpace(t[0].bottomLine,d.paddingBottom)):(this._setSpace(t[0].bottomLine,l),this._setSpace(t[0].topLine,l))}"footer"===i&&t[0]&&(this._setSpace(t[0].topLine,l),this._setSpace(t[0].bottomLine,u?d.paddingBottom:l))}}},e.prototype.getConfigurationsOfActiveKit=function(){return this._getConfigurationToDisplayOfKit(this._getActiveKit())},e.prototype.getConfigurationsOfKit=function(e){return this._getConfigurationToDisplayOfKit(e)},e.prototype.getConfigurationOfLg=function(e){var t=this._getColorIndexOfLGStrip(e);return{id:t,display:this.indexToKitColor(t)}},e.prototype.indexToKitColor=function(e){return this._indexToKitColor(e)},e.prototype.setConfiguration=function(e,t){this.setStripColor(e.containingLG,this.allColorsSantaFormat[t]),this._render()},e.prototype.setConfigurationForSectionByConfId=function(e,t,i,n){var o,r,a=this._getActiveKit();o=this._getFirstNodeOfLg(e[0]);var s=this.getBgDefaultColorConfIdForSection(e,n),l=s.confIdForFirstLG,c=s.confIdForSecondLG,d=o&&o.isListItem&&!o.isListHeader()&&1===e[0].segments.length;r=o&&(d||-1!==this.typesThatShouldGetFullListConf.indexOf(o.contentElementType)),l=this.themeChooser.coloration.isActiveKitWithNewColoration()?l||t:l||(r?a.kitFonts.listConfiguration.id:t),this._setConfigurationForAllSegmentsOfLG(e[0],l);var u=e[1];if(u){o=this._getFirstNodeOfLg(u),r=1===u.segments.length||o&&-1!==this.typesThatShouldGetFullListConf.indexOf(o.contentElementType),t=this.themeChooser.coloration.isActiveKitWithNewColoration()?l||t:r?a.kitFonts.listConfiguration.id:t,c=c||t;for(var p=1;p<e.length;p++)this._setConfigurationForAllSegmentsOfLG(e[p],c)}},e.prototype.setConfigurationForHeaderFooter=function(e,t,i){void 0===t&&(t=this.layoutSolver.getSelectedSolution(e))},e.prototype.applyColorationForHeaderFooter=function(e,t,i){var n=t.containingLG.getLgData();n.menuStrip&&n.menuStrip.enable&&(n.menuStrip.color="footer"===e?this.getColorOfCopyStrip(i):this.getColorOfStripMenu(i));var o=this._reseSelectionsOfSegment(t);i=i||this._getActiveKit();var r=(e===this.sitePartTypes.HEADER?this.getConfigurationOfSiteHeader(t.containingLG,i):this.getConfigurationOfSiteFooter(t.containingLG,i)).id;return o.cutsomColor=this.getKitConfigurationCustomColor(r,0,i),o.bgColor=this.allColorsSantaFormat[r],o.colorIndex=this.sitePartTypes.HEADER?this._getHeaderTextColoringIndex(i):this._getFooterTextColoringIndex(i),o},e.prototype.setSpecificConfigurationForSection=function(e,t,i,n){var o,r,a=this.getBgDefaultColorConfIdForSection(e,n),s=a.confIdForFirstLG,l=a.confIdForSecondLG;t.length>1?(o=l||this._getColorIndexOfLGStrip(t[1]),r=s||this._getColorIndexOfLGStrip(t[0])):o=s||l||this._getColorIndexOfLGStrip(t[0]),this.setSpecificConfigurationForSectionByConfId(e,o,r,i)},e.prototype.setSpecificConfigurationForSectionByConfId=function(e,t,i,n){var o=this;this._getActiveKit();_.forEach(e,function(e,n){o._setConfigurationForAllSegmentsOfLG(e,0===n&&void 0!==i?i:t)})},e.prototype.setConfigurationForSection=function(e,t,i,n,o){var r,a=this._getActiveKit(),s=this._getColorIndexOfLGStrip(t),l=this._getColorIndexOfLGStrip(i),c=void 0!==s,d=void 0!==l,u=a.kitFonts.confPattern;if(e){var p=e[0],h=p.segments[0].node;if(h&&h.isTpaNode())return this.modelTree.canInvertTpa(h)&&this.setTpaBg(p,1===this.themeChooser.coloration.getActiveKitColorationMode()),!0}if(c||d)if(c&&!d){r=(_.findIndex(u,{id:s})+1)%u.length}else if(!c&&d){r=(_.findIndex(u,{id:l})-1+u.length)%u.length}else{var g=_.filter(u,function(e){return e.id!==s&&e.id!==l});r=g.length?u.indexOf(g[0]):_.findIndex(u,{id:l})}else r=0;if(void 0!==r){var m=u[r]||u[0];this.setConfigurationForSectionByConfId(e,m.id,n,o)}return!0},e.prototype.getColorOfStripMenu=function(e){return(e=e||this._getActiveKit()).kitFonts.headerAndFooter&&e.kitFonts.headerAndFooter.stripHeader},e.prototype.getColorOfCopyStrip=function(e){return(e=e||this._getActiveKit()).kitFonts.headerAndFooter&&e.kitFonts.headerAndFooter.stripFooter},e.prototype.isDarkColorWithNewColoration=function(e){if(this.themeChooser.coloration.isActiveKitWithNewColoration()){var t=this.themeChooser.coloration.getActiveKitColors(),i=t.black,n=t.white,o=this.previewColors.getRGBColor(e);return this.themeChooserUtils.isDarkColor(o,{black:i,white:n},!0)}return this._isDarkColor(e)},e.prototype.getDefaultMapStyle=function(e,t){var i=this._getColorOfFirstBackground(e.containingSegment,t);return this.isDarkColorWithNewColoration(i)?"black":"white"},e.prototype.modifySocialImages=function(e,t,i){var n=this,o=this._getColorOfFirstBackground(t.containingSegment,i),r=this.isDarkColorWithNewColoration(o);_.forEach(e,function(e){if(e.platform){var t=n.socialLinkManager.getPlatformByName(e.platform);t&&(e.relativeUri=r?t.lightRelativeUri:t.darkRelativeUri)}})},e.prototype.getSitePartBg=function(e){return e===this.sitePartTypes.HEADER?this.getHeaderBg():this.getFooterBg()},e.prototype.getHeaderBg=function(e){void 0===e&&(e=this.layoutSolver.getSelectedSolution(this.sitePartTypes.HEADER));var t=e&&e[0]&&this._getSelectionsOfSegment(e[0].segments[0]);return this.flags.coreHeaderFooterDesignKitConfig?t&&t.bgColor?t.bgColor.substring(1,t.bgColor.length-1):"color_"+this.designKitParameters.L1:t.bgColor?t.bgColor.substring(1,t.bgColor.length-1):this._getHeaderBg()},e.prototype.getFooterBg=function(e){void 0===e&&(e=this.layoutSolver.getSelectedSolution(this.sitePartTypes.FOOTER));var t=e&&e[0]&&this._getSelectionsOfSegment(e[0].segments[0]);return this.flags.coreHeaderFooterDesignKitConfig?t&&t.bgColor?t.bgColor.substring(1,t.bgColor.length-1):"color_"+this.designKitParameters.L1:t.bgColor?t.bgColor.substring(1,t.bgColor.length-1):this._getCompBgStyle(this._getFooterComp())},e.prototype.adjustStyleOfGallery=function(e){var t=ob.deepClone(e);return _.forEach(t,function(e,i){-1!==i.indexOf("fnt")&&delete t[i]}),t},e.prototype.registerWithLayoutSolver=function(e){this.layoutSolver=e},e.prototype.isDarkColor=function(e){return this.designKitParameters[e]&&(e=this._santaFormatNumber(this.designKitParameters[e])),"{"!==e[0]?(this.$log.error('Color should be in Santa format, for example "{color_11}"'),!1):this._isDarkColor(e)},e.prototype.invertToBrightestColor=function(e,t,i){if(this.lightColorsSantaFormat.indexOf(e)>=0)return this.darkColorsSantaFormat[0];if(this.darkColorsSantaFormat.indexOf(e)>=0)return this.lightColorsSantaFormat[0];if(t&&i)throw new Error(e+" is not from the palette - it is neither dark nor light.\n    link to preset story: "+i.story+"\n    presetId: "+i.id+"\n    nodeId: "+i.nodeId+"\n    key: "+t);return e},e.prototype.invertColor=function(e,t,i){var n=this.lightColorsSantaFormat.indexOf(e);if(n>=0)return this.darkColorsSantaFormat[n];var o=this.darkColorsSantaFormat.indexOf(e);return o>=0?this.lightColorsSantaFormat[o]:(t&&i&&console.error(e+" is not from the palette - it is neither dark nor light.\n        link to preset story: "+i.story+"\n        presetId: "+i.id+"\n        nodeId: "+i.nodeId+"\n        key: "+t),e)},e.prototype.getColorSignature=function(e,t){var i=this;return _.map(e,function(e){var t=e.segments[0].getLE();if(1===e.segments.length&&1===t.cluster&&t.getMediaLayout()&&t.getMediaType()===i.PresetMediaType.COAST2COAST||e.hasNonTransparentBackground){var n=[];return t.recurseLayouts(function(e){switch(e.type){case AdiCoreSanta.ElementTypes.Text:var o=t.getFormatting(e);n.push(o&&o.getColorRGB()||"");break;case AdiCoreSanta.ElementTypes.Container:if("decorative"===e.containerRole){var r=(e.subType||e.type)+i.componentStyles.getDecorationUniqueID(e);n.push(i.previewColors.getRGBColor(i.getComponentCustomColor(t.containingSegment,r))),n.push(i.previewColors.getRGBColor(i._getTitleColor(t.containingSegment,t)))}break;case AdiCoreSanta.ElementTypes.Button:var a=i._getButtonColors(t);n.push(i.previewColors.getRGBColor(a.firstBgColor)),n.push(i.previewColors.getRGBColor(a.bgColor)),n.push(i.previewColors.getRGBColor(a.textColor))}}),n.join(",")}return i.getConfigurationOfLg(e).display}).join("$")},e.prototype.getBoxColorOfSegment=function(e){var t=e.segments[0].getLENoError();if(!_.some(t.layout,function(e){return e.type===AdiCoreSanta.ElementTypes.Text})){var i=_.find(t.layout,function(e){return e.type===AdiCoreSanta.ElementTypes.Container&&"decorative"===e.containerRole&&!(e.onMediaIndex>=0)});if(i){var n=(i.subType||i.type)+this.componentStyles.getDecorationUniqueID(i);return this.previewColors.getRGBColor(this.getComponentCustomColor(t.containingSegment,n))}}},e.prototype.getBgDefaultColorConfIdForSection=function(e,t){return{confIdForFirstLG:void 0,confIdForSecondLG:void 0}},e.prototype.isButtonWithBg=function(e){var t=this._getStyleDefinition(e).style.properties;return!this._noBg(t)},e.prototype.getTextColorsOfSegment=function(e){var t=this,i=e.segments[0],n=i.getLENoError(),o=[],r=this._getSelectionsOfSegment(i);return _.each(n.argList,function(e){if(e.type===AdiCoreSanta.ElementTypes.Text){var i=t.getColorFromSelections(r,e.subType),n=t.trimSantaColor(i);o.push(n)}}),_.filter((this.flags.lodash4?_.uniqBy:_[String("uniq")])(o,_.isUndefined))},e.prototype.getBgColor=function(e){var t=e.getLgData();if(t.strip&&t.strip.enable&&t.strip.color)return t.strip.color},e.prototype.doesPreviewBackgroundMatchSelected=function(e,t){return this.getBgColor(t)===(e.isInverted?this.getD1Color():this.lightColorsSantaFormat[0])},e.prototype.setDefaultKitConfigurationForPage=function(e,t){var i=this.layoutSolver.siteSolutions.body[e];this.setKitConfigurationForSolution(this._getActiveKit(),i.getSelectedSolution(),t)},e.prototype.setKitConfigurationForSolution=function(e,t,i){void 0===i&&(i=!1),this._segConfigurationsForPage(e,t,i)},e.prototype.isContrastValid=function(e,t){return this.themeChooser.coloration.isValidTextContrast(t,e)},e.prototype.getUnrenderedPages=function(e){return this.modelTree.getPagesNodes().filter(function(t){return!e[t.id]})},e.prototype.getButtonColorsOverride=function(e,t,i,n){if(!this.flags.twoButtonSection){var o=e&&e.getFieldColorOverride(t,null,n)||!1,r={};if(o){var a=this.getSantaFormatColor(o);return r={txt:a,txth:a,bg:a,bgh:a,brd:a,brdh:a},this.isButtonWithBg(i)?r.txt=r.txth=this.invertToBrightestColor(a):this.isStrokeButton(e)&&(r.txth=this.invertColor(a)),r}}},e.prototype.isStrokeButton=function(e){if(!this.flags.twoButtonSection)return this.getButtonStyleCatalogOverride(e).includes("stroke")},e.prototype.getButtonStyleCatalogOverride=function(e){var t=this.selections.getForNode(_.get(e,["containingSegment","node"]));return _.get(t,["styleCatalogOverrides","buttons"],"").toLowerCase()},e.prototype.isMobileBgSameAsDesktop=function(e,t,i,n){var o=this._getColorOfFirstBackground(e.containingSegment,t,null,!0),r=(n=n||e.getDesktopSegment())&&n.getLENoError(),a=r&&r.getLayoutBySubType(i);return o===(a&&this._getColorOfFirstBackground(r.containingSegment,a,null,!0))},e}();e.DesignKit=t,angular.module("adiCoreAppInternal").service("designKit",t)}(e.design||(e.design={}))}(S||(S={})),angular.module("adiCoreAppInternal").provider("flags",function(){this.$get=function(){return this}}),angular.module("adiCoreAppInternal").service("fontLoader",["$p","$log","santaFontMetadata",function(e,t,i){var n=[],o=[];function r(e){return e&&e.replace&&(e=(e=(e=e.trim()).replace(/\'/g,"")).replace(/\"/g,"")),e}function a(i){var n=e.defer(),o=_.assign({active:function(){n.resolve(!0)},inactive:function(){t.error("Error loading font: ",i),n.resolve(!1)}},i);return WebFont.load(o),n.promise}function s(e,t){var i=e.declarations.find(function(e){return e.property===t});return i&&i.value}this.sanitizeFontFamily=r,this.loadFont=function(o,s){if(o=o.toLowerCase(),n[o])return n[o];var l=i[o];if(l){var c;if("google"===l.provider?c={google:{families:[(l.cdnName||l.displayName)+":n,b,i,bi"]}}:"system"!==l.provider&&"monotype"!==l.provider&&"open source"!==l.provider&&"google-self-hosted"!==l.provider||(c={custom:{families:[l.fontFamily+":n4,n7,i4,i7"]}}),c)return n[o]=a(c),n[o]}else{if(function(e,t){var n=i[t],o=n&&n.fallbacks&&n.fallbacks.split(",").map(r);return o&&o.includes(e)}(o,s))return n[o]=a({custom:{families:[o+":n4,n7,i4,i7"]}}),n[o];(function(e,t){var n=i[t],o=n&&n.genericFamily&&r(n.genericFamily);return o&&o===e})(o,s)||t.error("Tried to load unknown font: ",o)}return n[o]=e.when(!1),n[o]},this.makeCustomFont=function(e){(function(e){var t=e.family;return o[t]&&o[t].some(function(t){return t.fontStyle===s(e,"font-style")&&t.fontWeight===s(e,"font-weight")})})(e)||(function(e){var t=e.family,i={fontStyle:s(e,"font-style"),fontWeight:s(e,"font-weight")};o[t]?o[t].push(i):o[t]=[i]}(e),function(e){var t=document.createElement("style");t.type="text/css",t.appendChild(document.createTextNode(e)),(document.head||document.getElementsByTagName("head")[0]).appendChild(t)}(function(e){return"@font-face {"+e.declarations.reduce(function(e,t){return e+t.property+": "+t.value+"; "},"")+"}"}(e)))}}]),angular.module("adiCoreAppInternal").service("headerDesignPolicy",["applicationParameters","mediaGallery",function(e,t){function i(e,t){return{0:{title:e,Square:{50:{title:t}},Horizontal:{50:{title:t}},Vertical:{50:{title:t}}}}}function n(e,t,i,n){return{0:{title:e,Square:{10:{title:t},60:{title:i},70:{title:n}},Horizontal:{10:{title:t},80:{title:i},90:{title:n}},Vertical:{10:{title:t},80:{title:i},90:{title:n}}}}}var o={"leftLogo-subTitle":{0:{0:{subTitle:25}},24:{0:{subTitle:25},20:{subTitle:30}},32:{0:{subTitle:30,Square:{70:{subTitle:35}},Horizontal:{70:{subTitle:35}},Vertical:{80:{subTitle:35}}},20:{subTitle:35},24:{subTitle:40}},40:{0:{subTitle:30,Square:{70:{subTitle:35}},Horizontal:{50:{subTitle:35}},Vertical:{40:{subTitle:35}}},20:{subTitle:35},24:{subTitle:40}},48:{0:{subTitle:30,Square:{70:{subTitle:35}},Horizontal:{70:{subTitle:35}},Vertical:{70:{subTitle:35}}},20:{subTitle:35},24:{subTitle:35,Square:{50:{subTitle:40}},Horizontal:{50:{subTitle:40}},Vertical:{40:{subTitle:40}}},32:{subTitle:45}},56:{0:{subTitle:30,Square:{60:{subTitle:35}},Horizontal:{50:{subTitle:35}},Vertical:{40:{subTitle:35}}},20:{subTitle:35},24:{subTitle:40},32:{subTitle:45}},72:{0:{subTitle:35,Square:{60:{subTitle:40}},Horizontal:{60:{subTitle:40}},Vertical:{40:{subTitle:40}}},20:{subTitle:40},24:{subTitle:45},32:{subTitle:45}},88:{0:{subTitle:40,Square:{70:{subTitle:45}},Horizontal:{70:{subTitle:45}},Vertical:{40:{subTitle:45}}},20:{subTitle:45},24:{subTitle:50},32:{subTitle:55}}},"leftLogo-title":{0:i(60,80),24:i(60,80),32:i(70,80),40:i(80,85),48:i(85,90),56:i(85,90),72:i(95,100),88:i(105,110)},"leftLogo-menu":{0:{0:{menu:40}}},"default-menu":{0:{0:{menu:0,Square:{10:{menu:30}},Horizontal:{10:{menu:30}},Vertical:{10:{menu:30}}},14:{menu:30},20:{menu:40},40:{menu:50},72:{menu:60}}},"default-logo":{0:{0:{logo:40,Square:{70:{logo:50}},Horizontal:{90:{logo:50}},Vertical:{90:{logo:50}}}}},"default-title":{0:n(65,25,30,35),20:n(65,30,35,40),24:n(65,35,40,45),32:n(85,40,45,50),40:n(85,50,55,60),56:n(115,70,70,70),72:n(115,80,80,80),88:n(115,90,90,90)},"default-subTitle":{0:{0:{subTitle:25},20:{subTitle:30}},32:{0:{subTitle:30},20:{subTitle:35},24:{subTitle:40},32:{subTitle:45}},72:{0:{subTitle:35},20:{subTitle:40},24:{subTitle:45}},88:{0:{subTitle:40},20:{subTitle:45},24:{subTitle:50}}}};this.snapToGrid=function(e,t,i){var n=e/t;return t*(n=i?Math.floor(n):Math.ceil(n))},this.getRatioName=function(e,t){var i=t&&e&&e/t||1;return i<.8?"Vertical":i>1.2?"Horizontal":"Square"},this.applyPolicy=function(t,i,n){var r,a,s,l=_.find(i,function(e){return"menu"===e.subType}),c=_.find(i,function(e){return"menubar"===e.subType}),d=_.find(i,function(e){return"box"===e.subType}),u=_.find(i,function(e){return"logo"===e.subType}),p=_.find(i,function(e){return"title"===e.subType}),h=_.find(i,function(e){return"subTitle"===e.subType}),g=_.find(i,function(e){return"contacts"===e.subType}),m=u&&u.$layout.width()||0,f=u&&u.$layout.height()||0,v=p&&p.font.fontSize||0,y=this.getRatioName(m,f),b=function(e,t,i,n,r){var a=_.filter([t,i]),s=_.last(a),l=[];return l.push({key:"menu",rule:"menu",firstLineFontSize:0,seconLineFontSize:s&&s.font.fontSize||0}),l.push({key:"logo",rule:"logo",firstLineFontSize:0,seconLineFontSize:0}),_.each(a,function(e,t){t?l.push({key:e.subType,rule:"subTitle",firstLineFontSize:a[t-1].font.fontSize,seconLineFontSize:e.font.fontSize}):l.push({key:e.subType,rule:"title",firstLineFontSize:e.font.fontSize,seconLineFontSize:0})}),_.reduce(l,function(t,i){var a=o[e+"-"+i.rule],s=_.findLast(a&&_.findLast(a,function(e,t){return i.firstLineFontSize>=t})||{},function(e,t){return i.seconLineFontSize>=t})||{};t[i.key]=s[i.rule];var l=_.filter(s[n],function(e,t){return r>=t});return _.reduce(l,function(e,n){return t[i.key]=n[i.rule],t},t)},{})}(t,p,h,y,f),S=c&&c.$layout.is(".menu-on-top"),C=u&&u.$layout.is(".big-logo");(S||C)&&(b.menu=0),S||(b["default"===t?i[0].subType:"title"]=0),p&&!b.title&&(b.title=this.snapToGrid(p.font.lineMargin,e.quarterBaseLine)),p&&h&&!b.subTitle&&(b.subTitle=this.snapToGrid(h.font.lineMargin,e.quarterBaseLine)+2*e.quarterBaseLine);var w,T=p&&p.$layout.height();w=p?h?p.font.lineMargin+b.subTitle-h.font.lineMargin+h.$layout.height():T:0;var I=v<72&&f>=40||"Vertical"===y&&f>=50?w:T,x=Math.ceil(u&&(f-I)/2||0),P=u&&f-x-w||0;if(u&&"leftLogo"===t)if((h||p)&&u.$layout.css(u.$layout.parents(".flip-content").length?"margin-left":"margin-right","15px"),p&&!C){if(b.logo=b.title-p.font.lineMargin-x,b.logo<0){var M=this.snapToGrid(-b.logo,e.quarterBaseLine)+(S&&e.quarterBaseLine||0);b.title+=M,b.logo+=M}S||(b.menu&&(b.menu=b.menu-Math.max(P-(h||p).font.marginBottom,0)),b.menu<40&&(b.menu+=this.snapToGrid(40-b.menu,e.quarterBaseLine)))}else b.logo=S?30:0;if(c){if(c.$layout.is(".menu-align-base-line")||c.$layout.is(".menu-align-center")){var L,k=h||p,$=k&&Math.max(P,k.font.marginBottom)||0;if(c.$layout.is(".menu-align-base-line")){var A=0;l?A="ddm1"===l.styleId?10:0:(r=c.$layout.find('.layout[header-layouts-value="MainEmail"]:visible, .layout[header-layouts-value="Contact.phone number"]:visible')[0])&&(s=n["font_"+((a=angular.element(r)).attr("font")||"0")],A=5+a.height()-s.lineMargin+(parseInt(a.css("margin-bottom"))||0)),L=k&&$+k.$layout.height()-k.font.lineMargin-A||0}else L=((k?w:f)-c.$layout.height())/2+$;if(d&&(L+=20),c.$layout.css("margin-bottom",L),(u||p)&&c.$layout.css((u||p).$layout.parents(".flip-h").length?"padding-right":"padding-left",100),b.menu=0,g)if(u||p){var E=30+g.$layout.height(),D=-L-c.$layout.height();if(D+=k?b.title-p.font.lineMargin+w+$:b.logo+f,d&&(D+=40),D<E){var F=this.snapToGrid(E-D,e.quarterBaseLine);d?d.$layout.css("margin-top",F):(b.title+=F,b.logo+=F)}}else g.$layout.css("margin-bottom",30)}b.menubar=b.menu,b.menu=0}g&&g.$layout.is(".align-to-left-logo")&&(a=g.$layout.find('.layout[header-layouts-value="MainEmail"]:visible, .layout[header-layouts-value="Contact.phone number"]:visible'),p&&1===a.length?(s=n["font_"+(a.attr("font")||"0")],g.$layout.css("margin-top",b.title-s.lineMargin-s.marginTop)):g.$layout.css("margin-top",b.logo+(f-g.$layout.height())/2));var B=_.map(i,function(e){return b[e.subType]||0});this.applySpaces(i,B)},this.applySpaces=function(e,t){_.each(e,function(i,n){var o=t[n];if(o){var r=n&&e[n-1].font,a=i.font,s=o;r&&(s=s-r.marginBottom-r.lineHeight+r.lineMargin),a&&(s-=a.lineMargin),i.$layout.css("margin-top",s+"px")}})},this.addImage=function(i,n,o){var r,a,s,l,c,d=this;function u(){var t,n;t=+i.attr("max-width"),n=+i.attr("max-height"),o&&(t*=o,n*=o),a/s>=t/n?(l=Math.min(t,a),c=Math.ceil(s*l/a)):c=Math.min(n,s),c=d.snapToGrid(c,e.quarterBaseLine,!0),l=Math.floor(a*c/s)}return"shape"===n.mediaType&&n.svg?(r=i.html(n.svg.html),a=n.svg.width,s=n.svg.height,u(),r.find("svg").width(l).height(c).attr("viewBox","0 0 "+a+" "+s)):(a=n.width,s=n.height,a&&s||(a=s=80),u(),r=angular.element("<img />").attr("src",t.itemToThumbnailUrl(n,l,c)).css("width",l+"px").css("height",c+"px").appendTo(i.attr("media-type","image").data("media",n))),i.css("width",l+"px"),i.css("height",c+"px"),r}}]),angular.module("adiCoreAppInternal").factory("HeaderLayoutElement",["$p","solutionStatusCodes","LayoutElement","headerLayoutSolver",function(e,t,i,n){function o(e,i,n,o,r,a){var s=n.join("#").replace(/\s/g,"_");this.templateId=e,this.structureSuffix=i,this.id=e+"_"+i+"_"+s,this.html=o,this.mode=r,this.isHeader=!0,this.cluster=0,this.argsComponents=[],this.solutionStatus=t.unknown,this.overrides={},this.width=a||940,this.height=60,this.maxHeight=600,this.widgetSizes={},this.argsSignature=n}return o.prototype=Object.create(i.prototype),o.prototype.isMobile=function(){return 300===this.width},o.prototype.clone=function(){throw"clone is not supported"},o.prototype.smartClone=function(){throw"smartClone is not supported"},o.prototype.applyDesignPolicy=function(){},o.prototype.calculateLayoutElementStatus=function(){return n.calculateLayoutElementStatus(this)},o.prototype.matchWantedArgs=function(e){return n.matchWantedArgs(this,e)},o.prototype.getArgValue=function(e){return this.extractedArgs[e]},o.prototype.shouldApplyUserAdditionalHeight=function(){return!1},o.prototype.getLayoutData=function(){return{templateId:this.templateId,structureSuffix:this.structureSuffix}},o.prototype.getSerializedData=function(){return{templateId:this.templateId,structureSuffix:this.structureSuffix,argsSignature:this.argsSignature,html:this.html,mode:this.mode,width:this.width,version:3}},o}]);var l=function(){function e(e,t,i,n){this.flags=e,this.selections=t,this.designKit=i,this.localizedComponentAttributes=n,this.defaultWidgetSize={940:{subscribe:{width:450,height:180}},300:{subscribe:{width:300,height:180}}}}return e.$inject=["flags","selections","designKit","localizedComponentAttributes"],e.prototype.getFontOverride=function(e,t,i){var n=e.containingLG.getLayoutSelectionStore(),o=this.getLeField(e,t,i);if(o&&("text"===o.type||"button"===o.type)){if(this.flags.designKit){var r=e.isMobile()?void 0:this.selections.getForSegment(e.containingSegment).fontOverrides;return _.get(r,[o.subType],this.designKit.getFontOverride(e.containingSegment.node,o.subType))}return n.fontOverridesManager.getOverride(e.containingSegment.node,o.subType)}},e.prototype.getLeField=function(e,t,i){if("label"===i){var n=this.localizedComponentAttributes.getAttributesByType("defaults");return{type:"text",subType:"label",value:_.get(n,"footer."+t.toLowerCase(),t)}}var o=e.containingSegment.contentElement,r=t.indexOf(".")>-1,a=t.split(".");if(r?o.getReferenceFields()[t]:o.getArgsMatchingPolicy()[t]){var s=void 0;s=r?o.extractReferences(a[1],a[0])[0]:o.getFieldValue(t);var l=_.clone(s);if("media"===l.type){var c=r?o.getReferenceValuesByMediaType(a[0])[0]:o.getValuesByMediaType();l.value=c.shape||c.clipart||c.icon||c.image}return l}},e.prototype.getUsedFonts=function(e){var t=this,i=angular.element(e.html);return _.map(i.find(".layout[font]"),function(i){var n=t.getFontOverride(e,i.getAttribute("header-layouts-value"),i.getAttribute("type"));return n?n.replace("font_",""):i.getAttribute("font")})},e.prototype.getWidgetSize=function(e,t){var i=this.getLeField(e,t);return e.widgetSizes[i.subType]||this.defaultWidgetSize[e.width][i.subType]},e}();angular.module("adiCoreAppInternal").service("headerLayoutSolverCommon",l);var c=function(){function e(e,t,i,n,o,r){this.$compile=e,this.modelTree=t,this.$rootScope=i,this.tpaService=n,this.componentStyleOverrideSolver=o,this.headerLayoutSolverCommon=r}return e.$inject=["$compile","modelTree","$rootScope","tpaService","componentStyleOverrideSolver","headerLayoutSolverCommon"],e.prototype.createPreviewScope=function(e,t){var i=this;return _.assign(this.$rootScope.$new(!0),{fonts:e,isMobile:t.isMobile(),getFieldValue:function(e,n){if("shoppingCart"===e)return i.tpaService.hasShoppingCart()?"x":void 0;var o=i.headerLayoutSolverCommon.getLeField(t,e,n);return o&&o.value},getTextFormatting:function(e,n){var o=i.headerLayoutSolverCommon.getLeField(t,e,n);return o&&t.getFormattingBySubType(o.subType,void 0,!0)},getFontOverride:function(e,n){return i.headerLayoutSolverCommon.getFontOverride(t,e,n)},getMediaSize:function(){return t.containingLG.getLayoutSelectionStore().getMediaSize(t)},getWidgetSize:function(e){return i.headerLayoutSolverCommon.getWidgetSize(t,e)},getStyleOverride:function(e,n){if(n===AdiCoreSanta.ElementTypes.Button){var o=t.containingSegment.node||i.modelTree.getGeneralInformation(),r=i.componentStyleOverrideSolver.getCatalogId(o,"buttons");if(r)return"catalog-buttons-"+r}var a=t.containingLG.getLayoutSelectionStore().getOverride("style",t.containingSegment);return a&&a[n]}})},e.prototype.buildPreview=function(e,t,i){var n=this.createPreviewScope(t,e);i.append(this.$compile(e.html)(n)),i.scope=n},e.prototype.cleanup=function(e){e.scope.$destroy()},e}();angular.module("adiCoreAppInternal").service("headerLayoutPreviewOld",c);var d,u=function(){function e(e,t,i,n,o,r,a,s,l,c){this.tpaService=e,this.modelTree=t,this.componentStyleOverrideSolver=i,this.headerLayoutSolverCommon=n,this.componentStyles=o,this.headerDesignPolicy=r,this.richTextService=a,this.LayoutElementFormatting=s,this.platformService=l,this.flags=c}return e.$inject=["tpaService","modelTree","componentStyleOverrideSolver","headerLayoutSolverCommon","componentStyles","headerDesignPolicy","richTextService","LayoutElementFormatting","platformService","flags"],e.prototype.getStyleOverride=function(e){var t=e.layoutElement,i=e.type;if(i===AdiCoreSanta.ElementTypes.Button){var n=t.containingSegment.node||this.modelTree.getGeneralInformation(),o=this.componentStyleOverrideSolver.getCatalogId(n,"buttons");if(o)return"catalog-buttons-"+o}var r=t.containingLG.getLayoutSelectionStore().getOverride("style",t.containingSegment);return r&&r[i]},e.prototype.getFieldValue=function(e){var t=e.layoutElement,i=e.fieldName,n=e.type;switch(i){case"Menu":case"Subscribe":return!0;case"shoppingCart":return this.tpaService.hasShoppingCart()?"x":void 0;case"Login":return this.flags.membersArea&&this.platformService.hasMembersArea()?"Log in":void 0}var o=this.headerLayoutSolverCommon.getLeField(t,i,n);return o&&o.value},e.prototype.getFontOverride=function(e){var t=e.layoutElement,i=e.fieldName,n=e.type;return this.headerLayoutSolverCommon.getFontOverride(t,i,n)},e.prototype.getMediaSize=function(e){var t=e.layoutElement;return t.containingLG.getLayoutSelectionStore().getMediaSize(t)},e.prototype.getWidgetSize=function(e){var t=e.layoutElement,i=e.fieldName;return this.headerLayoutSolverCommon.getWidgetSize(t,i)},e.prototype.getTextFormatting=function(e){var t=e.layoutElement,i=e.fieldName,n=e.type,o=this.headerLayoutSolverCommon.getLeField(t,i,n);return o&&t.getFormattingBySubType(o.subType,void 0,!0)},e.prototype.buildMenuElement=function(e){e.innerText="M"},e.prototype.buildButtonElement=function(e){var t=e.element,i=(e.layoutElement,e.fieldName,e.type,e.value);t.setAttribute("style-id",e.getStyleOverride(e)||this.componentStyles.styles.button[0]),t.innerHTML="<div><span>"+_.htmlEncode(i.callToAction)+"</span></div>"},e.prototype.buildLogoElement=function(e){var t=e.element,i=(e.layoutElement,e.attrs),n=e.value;t.innerText="";var o,r=+e.getMediaSize(e),a=+i["media-size"];r?(o=r,a&&(o=o/=a),t.setAttribute("media-size",r)):o=1,this.headerDesignPolicy.addImage(angular.element(t),n[0],o)},e.prototype.buildSocialButtonsElement=function(e){var t=this,i=e.element,n=e.value,o=+e.attrs.spacing;i.innerText="";var r=angular.element(i);_.each(n,function(e,i){t.headerDesignPolicy.addImage(r,e).css("margin-left",i?(o||8)+"px":"0")}),r.css("width","auto")},e.prototype.buildSubscribeElement=function(e){var t=e.element,i=e.getWidgetSize(e);t.style.width=i.width+"px",t.style.height=i.height+"px",t.innerText="Widget"},e.prototype.buildLoginElement=function(e){var t=e.element,i=e.layoutElement,n=(e.fieldName,e.type,e.getTextFormatting(e));t.innerText=this.LayoutElementFormatting.format(_.htmlEncode("Log in"),n);var o=220,r=i.isMobile()?"avatarOnly":this.platformService.getLoginComponentDisplayMode();switch(r){case"avatarOnly":o=90;break;case"avatarAndIcon":o=110;break;case"memberName":o=220}t.setAttribute("selected-login-type",r),t.style.minWidth=o+"px"},e.prototype.buildOtherElement=function(e){var t=e.element,i=(e.layoutElement,e.fieldName,e.type,e.value),n=e.attrs,o=n.align,r=n.wordwrap,a=e.getTextFormatting(e);this.richTextService.isRichText(i)?t.innerHTML=this.richTextService.transformForViewer(i,+n.font,void 0,o,!1,a,{}):t.innerHTML=this.LayoutElementFormatting.format(_.htmlEncode(i),a),o&&(t.style.textAlign=o),r&&(t.style.maxWidth="100%",t.style.whiteSpace="normal",t.style.wordWrap="break-word")},e.prototype.setFontStyle=function(e){var t=e.element,i=e.attrs,n=e.fonts,o=(e.layoutElement,e.fieldName,e.type,e.getFontOverride(e)),r=i.font;o?(r=o.replace("font_",""),t.setAttribute("font",r),i.font=r):r&&(o="font_"+r);var a="";o&&(a+=";"+_.get(n,[o,"css"],""),t.setAttribute("fontSize",_.get(n,[o,"fontSize"],""))),i.style&&(a+=";"+i.style),t.setAttribute("style",a)},e.prototype.buildElement=function(e,t){for(var i={},n=0,o=e.attributes;n<o.length;n++){var r=o[n];i[r.name]=r.value}var a=i["header-layouts-value"];if(a){var s=i.type;if(t.fieldName=a,t.type=s,t.attrs=i,t.element=e,t.value=t.getFieldValue(t),t.value&&(!0===t.value||t.value[0]||t.value.callToAction))switch(e.style.display="block",this.setFontStyle(t),a){case"Menu":this.buildMenuElement(t);break;case"button":this.buildButtonElement(t);break;case"Logo":this.buildLogoElement(t);break;case"Social.SocialButtons":this.buildSocialButtonsElement(t);break;case"Subscribe":this.buildSubscribeElement(t);break;case"Login":this.buildLoginElement(t);break;default:this.buildOtherElement(t)}else e.style.display="none"}},e.prototype.getLocalScope=function(){return{getFieldValue:this.getFieldValue.bind(this),getTextFormatting:this.getTextFormatting.bind(this),getMediaSize:this.getMediaSize.bind(this),getWidgetSize:this.getWidgetSize.bind(this),getFontOverride:this.getFontOverride.bind(this),getStyleOverride:this.getStyleOverride.bind(this)}},e.prototype.buildPreview=function(e,t,i,n){void 0===n&&(n={});var o=Object.assign({fonts:t,layoutElement:e},this.getLocalScope(),n),r=i[0];r.innerHTML=e.html;for(var a=0,s=r.getElementsByClassName("layout");a<s.length;a++){var l=s[a];this.buildElement(l,o)}},e.prototype.cleanup=function(){},e}();angular.module("adiCoreAppInternal").service("headerLayoutPreviewNew",u),angular.module("adiCoreAppInternal").factory("headerLayoutPreview",["flags","$injector",function(e,t){return t.get(e.headerLayoutPreview?"headerLayoutPreviewNew":"headerLayoutPreviewOld")}]),angular.module("adiCoreAppInternal").service("headerLayoutSolver",["flags","$p","mediaGallery","solutionStatusCodes","visualValidation","visualValidationContainer","applicationParameters","heightMutations","componentStyles","headerDesignPolicy","tpaService","richTextService","themeChooser","designPolicyButton","columnService","headerLayoutSolverCommon","headerLayoutPreview",function(e,t,i,n,o,r,a,s,l,c,d,u,p,h,g,m,f){return new(function(){function i(){}return i.prototype.updateShapeProperties=function(e){if(!e||"shape"!==e.mediaType||e.svg)return t.when();return o.getShapeSVG({componentClass:"wysiwyg.viewer.components.WPhoto",componentProperties:{displayMode:"fit",onClickBehavior:"goToLink",type:"WPhotoProperties"},mediaMinHeight:60,ruleNodeIndex:4,skinClass:"wysiwyg.viewer.skins.photo.NoSkinPhoto",style:"wp2",type:"media",top:0,left:0,height:600,width:600},e).then(function(t){e.svg=t})},i.prototype.initMasterFonts=function(e,t){return o.getThemeFonts(e,t).then(function(e){return _.each(e,function(e){e.marginTop=c.snapToGrid(e.lineMargin,a.quarterBaseLine)-e.lineMargin,e.marginBottom=c.snapToGrid(e.lineHeight-e.lineMargin,a.quarterBaseLine)-(e.lineHeight-e.lineMargin),e.css+=";display:inline-block;max-width:none;margin-top:"+e.marginTop+"px;margin-bottom:"+e.marginBottom+"px;white-space:nowrap;align-self: auto;"}),e})},i.prototype.makeEqualColumnWidth=function(e){var t=e.find(".equal-width"),i=_.reduce(t,function(e,t){return Math.max(e,angular.element(t).width())},0);t.css("min-width",i)},i.applySquashLayouts=function(e){for(var t=e.find(".squash:visible"),i=0;i<t.length;i++){var n=angular.element(t[i]);i>0&&(n.is(".layout")?n:n.find(".layout")).css("margin-top",0),i<t.length-1&&(n.is(".layout")?n:n.find(".layout")).css("margin-bottom",0)}},i.prototype.applyFooterDesignPolicy=function(t,n){var o=_.map(t.find(".layout.first-line:visible"),function(e){var t=angular.element(e),i="font_"+(t.attr("font")||"0");return{$layout:t,font:n[i]}});if(o.length){var r=(e.lodash4?_.strictMaxBy:_.max)(o,function(e){return e.font.lineMargin}).font.lineMargin;r=c.snapToGrid(r,a.quarterBaseLine);for(var s=0,l=o;s<l.length;s++){var d=l[s];c.applySpaces([d],[r])}}i.applySquashLayouts(t)},i.prototype.setButtonMargins=function(e,t){_.each(e.find(".layout.button:visible"),function(e){var i=angular.element(e),n="font_"+(i.attr("font")||"0"),o=t[n],r=i.attr("style-id"),s=p.isButtonStyleTransparent(r);if(!s){var l=h(o.fontSize,s);i.attr("margin",l.side);var c=2*l.top+o.fontSize-o.topMargin;c=Math.ceil(c/a.quarterBaseLine)*a.quarterBaseLine,i.css({marginTop:0,marginBottom:0,height:c,paddingLeft:l.side,paddingRight:l.side,display:"flex",flexDirection:"column",justifyContent:"center",backgroundColor:"#d3d3d3"})}})},i.prototype.applyMobileDesignPolicy=function(e,t){this.setButtonMargins(e,t)},i.prototype.applyDesignPolicy=function(e,t,n,o){this.makeEqualColumnWidth(e),i.applySquashLayouts(e),this.setButtonMargins(e,t);var r,a=!o||o.menuOverridesManager.stretchButtons(),s=o?o.menuOverridesManager.alignment():"center",d=_.map(e.find(".layout[design-policy]:visible"),function(e){var i=angular.element(e),a=i.attr("design-policy"),s={subType:a,$layout:i};if("logo"!==a&&"menu"!==a&&"menubar"!==a&&"contacts"!==a&&"box"!==a){var c="font_"+(i.attr("font")||"0");s.font=t[c]}if("menu"===a){var d=n&&o&&o.getOverride("style",n);s.styleId=d&&d.menu||l.styles.menu[0],r=s}return s});if(d.length){var u=e.find("[header-design-policy]").attr("header-design-policy")||"default";"menu"===d[0].subType&&e.is(".flip-v")&&d.push(d.shift());for(var p=0,h=e.find(".layout.layout-align-center");p<h.length;p++){var g=h[p],m=angular.element(g),f=(20-m.height())/2;m.css("margin-top",f),m.css("margin-bottom",f)}if(c.applyPolicy(u,d,t),r)if(a||"center"!==s){if("left"===s){if("ddm1"===r.styleId){var v=+r.$layout.css("margin-left").replace("px","")||0;r.$layout.css("margin-left",v-10)}}else if("right"===s&&"ddm1"===r.styleId){var y=+r.$layout.css("margin-right").replace("px","")||0;r.$layout.css("margin-right",y-10)}}else if("center"===r.$layout.attr("align")){var b=e.offset(),S=r.$layout.offset(),C=r.$layout[0].getBoundingClientRect(),w=Math.ceil(C.width),T=S.left-b.left,I=e.width()-w-2*T;I>0?r.$layout.css("margin-left",I):I<0&&r.$layout.css("margin-right",-I)}}},i.prototype.createPreviewElement=function(e,t,i){var n=angular.element('<div class="preview"></div>').width(e.width).addClass(e.mode).appendTo(r.$headerLayoutSolver);return f.buildPreview(e,t,n),e.isMobile()?this.applyMobileDesignPolicy(n,t):e.containingLG.isSiteHeader()?this.applyDesignPolicy(n,t,e.containingSegment,i):this.applyFooterDesignPolicy(n,t),n},i.createLayout=function(t,i,n,r){var a,s=i.offset(),c=n.offset(),d=r+c.top-s.top,u=c.left-s.left,p=n[0].getBoundingClientRect(),h="true"===n.attr("widebox"),g=0,f=Math.ceil(p.width),v=Math.ceil(p.height),y=n.attr("header-layouts-value"),b=n.attr("type"),S=y&&m.getLeField(t,y,b),C=null;switch(b=b||S&&S.type){case"shoppingCart":a={type:"shoppingCart",subType:"shoppingCart"};break;case"login":a={type:"widget",subType:"login"};break;case"subscribe":a={type:"widget",subType:"subscribe",styleId:n.attr("style-id"),headerAlignment:n.attr("header-alignment")};break;case"box":C=a={type:"container",containerRole:"decorative",style:"c1",layout:[]};break;case"line":a={style:"hl1",type:"line"},"true"===n.attr("full-screen")&&(a.docked={left:{vw:0,px:0},right:{vw:0,px:0}});break;case"button":var w=n.find("div").width(),T=n.find("span").width();a=_.defaults({margin:+(n.attr("margin")||"0"),font:n.attr("font")||"0",style:n.attr("style-id"),align:"center",validationWidth:w,clientRectWidth:T>w?T:0},o.masterButtonLayouts),e.twoButtonSection&&(t.buttonDimensions=[{offset:{x:0,y:0},width:f,height:v,textDimensions:{width:T,height:v}}]);break;case"menu":a={componentClass:"wysiwyg.viewer.components.menus.DropDownMenu",componentProperties:{alignButtons:"center",alignText:"center",moreButtonLabel:"More",moreItemHeight:15,sameWidthButtons:!1,stretchButtonsToMenuWidth:!0},ruleNodeIndex:0,skinClass:"wysiwyg.common.components.dropdownmenu.viewer.skins.SolidColorMenuButtonSkin",style:l.styles.menu[0],type:"menu"},t.isMobile()&&(f+=10,v+=10,d-=5,u-=5);break;case"media":a="Social.SocialButtons"===y?{componentClass:"wysiwyg.viewer.components.LinkBar",componentProperties:{bgScale:1,gallery:"social_icons",iconSize:+n.attr("max-width"),orientation:"HORIZ",spacing:+(n.attr("spacing")||8)},ruleNodeIndex:2,skinClass:"wysiwyg.viewer.skins.LinkBarNoBGSkin",style:"lb1",type:"social"}:{componentClass:"wysiwyg.viewer.components.WPhoto",componentProperties:{displayMode:"fit",onClickBehavior:"goToLink",type:"WPhotoProperties"},mediaMinHeight:60,ruleNodeIndex:4,skinClass:"wysiwyg.viewer.skins.photo.NoSkinPhoto",style:l.styles.media[0],type:"media",mediaSize:+n.attr("media-size")||1};break;case"label":case"text":if(!h){var I=t.isMobile()?.09:.02;g=Math.max(1,Math.ceil(p.width*I))}a=_.defaults({font:n.attr("font")||"0",fontSize:+n.attr("fontSize"),align:n.attr("align")},o.masterTextLayouts);break;case"menustrip":return t.menuStripTop=d,void(t.menuStripBottom=d+v);default:return}var x=(n.attr("header-column")||"").split(","),P=!!n.attr("header-menustrip");return _.assign(a,{top:d,left:u,height:v,width:f+g,subType:S&&S.subType||a.subType,row:x[0]?Number(x[0]):0,rowAlign:x[2]?Number(x[2]):void 0,inMenuStrip:P}),t.layout.push(a),S&&(a.argIndex=t.argList.length,t.argList.push({type:S.type,subType:S.subType}),t.extractedArgs.push(S.value)),C},i.prototype.createLayouts=function(e,t){var o=null;e.height=c.snapToGrid(t.height(),a.gridStep);var r=t.find(".layout.menu-on-top:visible").length?0:e.height-t.height();e.layout=[],e.argList=[],e.extractedArgs=[];for(var s=0,l=t.find(".layout:visible");s<l.length;s++){var d=l[s],u=angular.element(d),p=i.createLayout(e,t,u,r);p&&(o=p)}if(!e.isMobile()&&_.every(e.layout,function(e){return e.top>=a.gridStep})&&(_.each(e.layout,function(e){return e.top-=a.gridStep}),e.height-=a.gridStep),o){var h=_.filter(e.layout,function(e){return"media"===e.type||"title"===e.subType||"subTitle"===e.subType});o.layout=_.map(h,function(t){return t.top-=o.top,t.left-=o.left,t.boxParentOverrideKey=e.containingSegment.getOverrideKey(o),t}),e.layout=_.difference(e.layout,h)}e.solutionStatus=n.pass,e.createLayoutArray()},i.prototype.createColumns=function(e,t){if(e.containingLG.isSiteHeader()){for(var n=[],o=0,r=e.layout;o<r.length;o++){var a=r[o];n[d=a.row]||(n[d]=[]);var s=0;a.rowAlign===g.alignment.center?s=1:a.rowAlign===g.alignment.right&&(s=2);var l=n[d][s];l||(l=i.createCell(a.rowAlign),n[d][s]=l),"line"===(a=_.assign({originLayout:a},a)).type&&t.fullWidth&&!a.docked&&(a.left=0,a.width=980,a.docked={left:{vw:0,px:80},right:{vw:0,px:80}}),l.layout.push(a),"media"===a.type&&"social"!==a.subType&&(l.hasMedia=!0)}for(var c=0;c<n.length;){var d;if(d=n[c]){for(var u=0;u<d.length;)d[u]?u++:d.splice(u,1);c++}else n.splice(c,1)}return this.setRenderedProperties(this.alignColumns(n,e))}},i.prototype.setRenderedProperties=function(e){for(var t=0;t<e.length;t++)for(var i=e[t],n=0,o=0;o<i.length;o++){var r=i[o];r.renderedLayoutLeftOffset=AdiCoreSanta.renderConfig.segmentPadding,r.renderedMinWidth=r.width,r.offset=n;for(var a=0,s=r.layout;a<s.length;a++){var l=s[a];l.originLayout.columnsRowIndex=t,l.originLayout.columnsColIndex=o}n+=r.width}return e},i.createCell=function(e,t){return void 0===t&&(t=0),{isVirtual:!0,isHeader:!0,hasMedia:!1,hasText:!1,doesMediaFill:!1,height:t,width:0,layout:[],allSettings:{},extraProps:{alignment:e}}},i.prototype.getCellsByAlign=function(e){for(var t,i,n,o=-1,r=0,a=e;r<a.length;r++){var s=a[r],l=s.extraProps.alignment;if(l<=o)return console.log("header alignment error: bad order"),{};switch(o=l,l){case g.alignment.left:t=s;break;case g.alignment.center:i=s;break;case g.alignment.right:n=s;break;default:return console.log("header alignment error: unknown alignment type"),{}}}return{leftCell:t,centerCell:i,rightCell:n}},i.prototype.updateCellWidth=function(t,i,n){if(n)t.width=i-AdiCoreSanta.renderConfig.segmentPadding;else if(t.width=0,t.layout.length){var o=(e.lodash4?_.strictMaxBy:_.max)(t.layout,function(e){return e.left+e.width});t.width=o.left+o.width}},i.prototype.removeSpaceOnLeftSideInCell=function(t){if(0===t.layout.length)return 0;var i=(e.lodash4?_.strictMinBy:_[String("min")])(t.layout,function(e){return e.left}).left;return 0!==i&&(this.shiftCellContents(t,-i),t.width-=i),i},i.prototype.shiftCellContents=function(e,t){for(var i=0,n=e.layout;i<n.length;i++){n[i].left+=t}},i.prototype.alignCells=function(e,t,n){if(e.length){var o=this.getCellsByAlign(e),r=o.leftCell,a=o.centerCell,s=o.rightCell;if(r||a||s){for(var l=0,c=e;l<c.length;l++){var d=c[l];this.updateCellWidth(d,t,d===s)}if(1===e.length&&1===e[0].layout.length&&"line"===e[0].layout[0].type)this.shiftCellContents(e[0],AdiCoreSanta.renderConfig.segmentPadding);else{if(!r){var u=i.createCell(g.alignment.left,n);e.unshift(u),r=u}if(!s){var p=i.createCell(g.alignment.right,n);e.push(p),s=p}for(var h=0,m=0,f=e;m<f.length;m++){if((d=f[m])===r)h+=d.width,this.shiftCellContents(d,AdiCoreSanta.renderConfig.segmentPadding),d.width+=AdiCoreSanta.renderConfig.segmentPadding;else if(d===a){var v=this.removeSpaceOnLeftSideInCell(d);r.width+=v-h,h=d.width+v}else h=r.width+(a?a.width:0),d.width=t-h,this.shiftCellContents(d,AdiCoreSanta.renderConfig.segmentPadding-h)}}}}},i.prototype.setCellAlignment=function(e,t,i){void 0===t.extraProps.alignment&&(1===e.length?t.extraProps.alignment=g.alignment.center:2===e.length?t.extraProps.alignment=0===i?g.alignment.left:g.alignment.right:t.extraProps.alignment=0===i?g.alignment.left:i===e.length-1?g.alignment.center:g.alignment.right)},i.prototype.updateCellHeight=function(e,t){for(var i=0,n=e.layout;i<n.length;i++){var o=n[i];t>0&&(o.top-=t);var r=o.top+o.height;r>e.height&&(e.height=r)}},i.prototype.alignColumns=function(e,t){for(var i=0,n=t.containingLG.isMobile()?a.mobilePageWidth:a.desktopPageWidth,o=0,r=e;o<r.length;o++){for(var s=r[o],l=0,c=0;c<s.length;c++){var d=s[c];d.offset=0,d.height=0,d.width=0,this.setCellAlignment(s,d,c),this.updateCellHeight(d,i),l<d.height&&(l=d.height)}i+=l,this.alignCells(s,n,l)}return e},i.prototype.calculateLayoutElementStatus=function(e){var i=this,n=m.getLeField(e,"Logo"),o=e.containingLG.getLayoutSelectionStore();return this.updateShapeProperties(n&&n.value&&n.value[0]).then(function(){return u.initForRender()}).then(function(){var t=m.getUsedFonts(e);return i.initMasterFonts(t,e.isMobile())}).then(function(t){return i.createPreviewElement(e,t,o)}).then(function(n){if("headerLayoutJoker"===e.templateId||i.validate(n)){i.createLayouts(e,n),e.columns=void 0;var o=e.containingLG.getColumnsData();o&&o.enable&&(e.columns=i.createColumns(e,o))}else e.failWithReason("content does not fit layout");return f.cleanup(n),n.remove(),t.when()})},i.prototype.matchWantedArgsWithHtml=function(e,t,i){var n=_.map(i.find('.layout[header-layouts-value]:not([type="label"])'),function(e){var t=angular.element(e);return{$layout:t,fieldNames:t.attr("header-layouts-value").split("|"),required:!!t.attr("required")}});function o(e){return _.find(n,function(t){return!t.assigned&&t.fieldNames.indexOf(e)>-1})}for(;t.length;){var r=t.pop(),a=o(r);if(!a)return!1;a.assigned=!0;var s=r.indexOf("#");s>0&&(r=r.substring(0,s)),a.$layout.attr("header-layouts-value",r)}if(n.some(function(e){return!e.assigned&&e.required}))return!1;for(var l=0,c=n;l<c.length;l++){var d=c[l];d.assigned||d.$layout.remove()}var u=i.find('.remove-if-empty:not(:has(.layout:not([type="label"]):not([type="line"])))').hide();return i.find(".trim-end > div").not(u).last().css({marginRight:"0"}),e.html=i[0].outerHTML,!0},i.prototype.matchWantedArgs=function(e,t){t=_.clone(t);var i=angular.element(e.html),n=this.matchWantedArgsWithHtml(e,t,i);return i.remove(),n},i.prototype.validateLayout=function(e,t){var i=t.getBoundingClientRect();switch(t.getAttribute("type")){case"menu":return 300===e.width()||i.width>=140;case"menustrip":case"subscribe":return!0;case"login":var n=t.getAttribute("login-types").split("|"),o=t.getAttribute("selected-login-type");if(!n.includes(o))return!1}var r=t.offsetParent.getBoundingClientRect();return i.left>=r.left&&i.right<=r.right},i.prototype.validate=function(e){var t=this;return _.every(e.find(".layout:visible"),function(i){return t.validateLayout(e,i)})},i}())}]),angular.module("adiCoreAppInternal").directive("headerLayoutsValue",["headerDesignPolicy","LayoutElementFormatting","richTextService","componentStyles","platformService",function(e,t,i,n,o){return{restrict:"A",scope:!0,link:function(r,a,s){var l,c,d=s.headerLayoutsValue,u=+s.spacing,p=s.align,h=s.wordwrap,g=s.type,m="Menu"===d||"Subscribe"===d||"Login"===d||r.getFieldValue(d,g);if(m&&(!0===m||m[0]||m.callToAction)){a.show();var f="",v=r.getFontOverride(d,g),y=s.font;if(v?(y=v.replace("font_",""),a.attr("font",y)):s.font&&(v="font_"+s.font),v&&(f+=";"+_.get(r.fonts,[v,"css"],""),a.attr("fontSize",_.get(r.fonts,[v,"fontSize"],""))),s.style&&(f+=";"+s.style),a.attr("style",f),"Menu"===d)a.html("M");else if("button"===d)a.attr("style-id",r.getStyleOverride(d,g)||n.styles.button[0]),a.append(angular.element("<div />").append(angular.element("<span />").text(m.callToAction)));else if("Logo"===d){a.empty();var b,S=+r.getMediaSize(),C=+a.attr("media-size");S?(b=S,C&&(b=b/=C),a.attr("media-size",S)):b=1,e.addImage(a,m[0],b)}else if("Social.SocialButtons"===d)a.empty(),_.each(m,function(t,i){e.addImage(a,t).css("margin-left",i?(u||8)+"px":"0")}),a.css("width","auto");else if("Subscribe"===d){var w=r.getWidgetSize(d);a.empty(),a.text("Widget"),a.css(w)}else if("Login"===d){l=r.getTextFormatting(d,g),c=t.format(_.htmlEncode("Log in"),l),a.html(c);var T=220,I=r.isMobile?"avatarOnly":o.getLoginComponentDisplayMode();switch(I){case"avatarOnly":T=90;break;case"avatarAndIcon":T=110;break;case"memberName":T=220}a.attr("selected-login-type",I),a.css("min-width",T+"px")}else l=r.getTextFormatting(d,g),c=i.isRichText(m)?i.transformForViewer(m,+y,void 0,p,!1,l,{}):t.format(_.htmlEncode(m),l),a.html(c),p&&a.css("text-align",p),h&&(a.css("max-width","100%"),a.css("white-space","normal"),a.css("word-wrap","break-word"))}else a.hide()}}}]),angular.module("adiCoreAppInternal").constant("callInLayout",function(e){return function(){return e.apply(this.getMaster(),arguments)}}).factory("LayoutElement",["SmartLayoutElement","layoutElementButtons","solutionStatusCodes","applicationParameters","$p","fieldSignature","LayoutElementFormatting","layoutDecoration","LayoutDecorationUtils","SmartLayoutRuleUtils","$log","callInLayout","BoxDecorationTypes","themeChooser","prettyLayoutService","designPolicyService","visualValidation","validationCache","designPolicyButton","flags","PresetMediaType","mediaOverride","fontCustomizationService","segmentLayoutElements","designKit","componentStyleOverrideSolver","selections","userOverrides","lssModifier",function(e,t,i,n,o,r,a,s,l,c,d,u,p,h,g,m,f,v,y,b,S,C,w,T,I,x,P,M,L){function k(e,t,o,r){this.id=e.id,this.name=e.name,this.argList=e.argList,this.layout=e.layout,this.forContent=e.forContent,this.forContent||(this.forContent=n.defaultForContent),this.width=e.width,this.height=e.height,this.family=e.family,this.argsSignature=e.argsSignature,this.aggregationStrategy=e.aggregationStrategy,this.aggregationParams=e.aggregationParams,this.isAllowedFooter=e.isAllowedFooter,this.isAllowedHeader=e.isAllowedHeader,this.padding=e.padding,this.maxHeight=n.maxHeight,this.snapShot=e.snapShot,this.scenarioId=e.scenarioId,this.hasAlign=e.hasAlign,this.tempSnapShot=e.tempSnapShot,this.getSnapShot=e.getSnapShot,this.solutionStatus=e.solutionStatus,this.solutionFailReason=e.solutionFailReason,this.rootNode=e.rootNode,this.smartLayoutRulesNodes=e.smartLayoutRulesNodes||[],this.smartLayoutRulesNodesMap=e.smartLayoutRulesNodesMap,this.alignRules=e.alignRules||[],this.layoutArray=e.layoutArray||[],this.isOriginalSmartHeight=e.isOriginalSmartHeight,this.originalHeight=e.originalHeight,this.stretched=e.stretched,this.source=e.source,this.containingLG=e.containingLG,this.cluster=e.cluster,this.templateId=e.templateId,this.mediaFullWidth=e.mediaFullWidth,this.selections=P,this.storageId=e.storageId,this.oldFamily=e.oldFamily,this.oldId=e.oldId,this.storageId||(this.storageId=this.id,this.scenarioId&&(this.id=this.scenarioId+"_"+this.family,this.oldFamily&&(this.oldId=this.scenarioId+"_"+this.oldFamily))),e.spanHints&&(this.spanHints=e.spanHints),e.solution&&(this.LEGindex=e.LEGindex,this.solution=e.solution,this.originalSolution=e.originalSolution,this.originalSpanHints=e.originalSpanHints,this.containerIndex=e.containerIndex),this.structure=e.structure,this.onMediaStructure=e.onMediaStructure,this.boxesStructure=e.boxesStructure||[[],[],[],[]],this.boxesStructure[p.ON_MEDIA]=this.onMediaStructure||[],this.boxesStructure[p.FULL]=this.structure||[],this.boxTypes=[],this.priority=e.priority,this.editMode=r,this.errorList=[],this.extractedFontOverrides=[],this.argsComponents=[],this.alignVariations=[],this.generator=e.generator,this.contactRules=e.contactRules||[],o||(this.solutionStatus=t||i.unknown,this.solutionFailReason=""),this.overrides=_.clone(e.overrides)||{},this.variationsMap={},this.decorationTypes="",this.splitParagraphValidation={},b.twoButtonSection&&(this.buttonDimensions=[])}function $(e,t,i){var n=!1;_.each(e,function(e){n||!(n=t(e,i))&&e.layout&&$(e.layout,t,e)})}k.prototype.getStorageId=function(){return this.storageId},k.globalOverrides={},k.getLayoutData=function(e){var t=new k({id:e.id||e.objectId,name:e.name,argList:e.arguments,layout:e.layout,forContent:e.forContent,width:e.width,height:e.height,family:e.family,oldFamily:e.oldFamily,argsSignature:e.argsSignature,aggregationStrategy:e.aggregationStrategy,aggregationParams:e.aggregationParams,isAllowedFooter:e.isAllowedFooter||!1,isAllowedHeader:e.isAllowedHeader||!1,padding:e.padding,snapShot:e.snapShot,scenarioId:e.scenarioId,hasAlign:e.hasAlign,cluster:e.cluster,mediaFullWidth:e.mediaFullWidth,structure:e.structure,onMediaStructure:e.onMediaStructure,boxesStructure:e.boxesStructure,priority:e.priority,generator:e.generator,contactRules:e.contactRules,tempSnapShot:{data:""},getSnapShot:function(){return this.tempSnapShot.data&&this.tempSnapShot.data.length>0?this.tempSnapShot.data:this.snapShot?this.snapShot.url:void 0}});return t.initSmartLayoutRules(),t.deserializeTree(e.ruleTree),t},k.prototype.setLayoutData=function(e){e.name=this.name,e.arguments=this.argList,e.layout=this.layout,e.forContent=this.forContent,e.width=this.width,e.height=this.height,e.family=this.family,e.oldFamily=this.oldFamily,e.ruleTree=this.serializeTree(),e.aggregationStrategy=this.aggregationStrategy,e.aggregationParams=this.aggregationParams,e.argsSignature=this.argsSignature,e.padding=this.padding,e.isAllowedFooter=this.isAllowedFooter,e.isAllowedHeader=this.isAllowedHeader,e.scenarioId=this.scenarioId,e.hasAlign=this.hasAlign,e.cluster=this.cluster,e.mediaFullWidth=this.mediaFullWidth,e.structure=this.structure,e.onMediaStructure=this.onMediaStructure,e.boxesStructure=this.boxesStructure,e.priority=this.priority,e.generator=this.generator,e.contactRules=this.contactRules},k.prototype.getSerializedData=function(){var e={id:this.id,name:this.name,arguments:this.argList,layout:this.layout,forContent:this.forContent,width:this.width,height:this.height,family:this.family,oldFamily:this.oldFamily,ruleTree:this.serializeTree(),aggregationStrategy:this.aggregationStrategy,aggregationParams:this.aggregationParams,argsSignature:this.argsSignature,padding:this.padding,isAllowedFooter:this.isAllowedFooter,isAllowedHeader:this.isAllowedHeader,scenarioId:this.scenarioId,hasAlign:this.hasAlign,cluster:this.cluster,mediaFullWidth:this.mediaFullWidth,structure:this.structure,onMediaStructure:this.onMediaStructure,boxesStructure:this.boxesStructure,priority:this.priority,version:3};return(b.lodash4?_.omitBy:_.omit)(e,function(e){return void 0===e})},k.prototype.clone=function(){return new k(this,this.solutionStatus,!0)},k.prototype.smartClone=function(){var e=new k(this,this.solutionStatus,!0,this.editMode);return e.layout=b.lodash4?_.cloneDeep(this.layout):_.clone(this.layout,!0),this.originalArgList&&(e.argList=b.lodash4?_.cloneDeep(this.originalArgList):_.clone(this.originalArgList,!0),e.handleOverrides()),e.smartLayoutRulesNodes.length=0,e.initSmartLayoutRules(),e.copyTree(this.rootNode),e},k.prototype.shallowClone=function(){var e=Object.create(this);return e.argsComponents=[],e.setLGContainer(this.containingLG),e.setSegContainer(this.containingSegment),e.active=null,e.elementReference=null,b.twoButtonSection&&(e.buttonDimensions=[]),e.reference=this,e},k.prototype.getLayoutBySubType=function(e){return this.smartLayoutRulesNodesMap?this.smartLayoutRulesNodesMap[e]&&this.smartLayoutRulesNodesMap[e][0].bottom.component:_.find(this.layoutArray,function(t){return t.subType===e})},k.prototype.getAllDecorativeContainersLayout=function(){return _.filter(this.getAllContainersLayout(),{containerRole:"decorative"})},k.prototype.getAllStructureContainersLayout=function(){return _.filter(this.getAllContainersLayout(),{containerRole:"structure"})},k.prototype.isStructureContainerLayout=function(e){return"structure"===e.containerRole},k.prototype.isDecorativeContainerLayout=function(e){return"decorative"===e.containerRole},k.prototype.isTextOrButtonField=function(e){return e.type===AdiCoreSanta.ElementTypes.Text||e.type===AdiCoreSanta.ElementTypes.Button},k.prototype.getAllContainersLayout=function(){return this.smartLayoutRulesNodesMap&&this.smartLayoutRulesNodesMap.container&&_(this.smartLayoutRulesNodesMap.container).map("bottom.component").value()||[]},k.prototype.getArgIndexByType=function(e){return _.findIndex(this.argList,{type:e})},k.prototype.getArgIndexBySubType=function(e){return _.findIndex(this.argList,{subType:e})},function(){function e(e,t,i){for(var n=0;n<t.length;n++)i[n].push(t[n][e])}function t(e){for(var t=[],i=0;i<e;i++)t.push([]);return t}function i(e,t,i,n){for(var o=0;o<t.length;o++)if(t[o][e]===n[o][i])return!0;return!1}function n(e,t){var i;if(e.some(function(e){$([e],function(n){if(n===t)return i=e,!0})}),void 0===i)throw new Error("could not find root container");return i}k.prototype.calcColumns=function(o,r){if(this.structure){var a=[],s=_.findIndex(this.argList,function(e){return"media"===e.type&&"social"!==e.subType});s>=0&&a.push(s);var l=this.getArgIndexBySubType("map");if(l>=0&&a.push(l),0===a.length){var c=this.getArgIndexBySubType("form");c>=0&&a.push(c)}if(a.length||1===this.cluster){var d=this,u=[this.structure],p=[this.height];if(a.length&&r&&this.structure.length>1){var h=function(e,t){var i,n,o=[],r=[];return e.forEach(function(e){var a=_.find(e,function(e){return _.indexOf(t,e)>=0});!isNaN(a)&&_.every(e,function(e){return e===a})||(a=-1),a!==n&&(n=a,i=[],o.push(i),r.push(a)),i.push(e)}),{columnRowsStructure:o,columnRowsMediaIndexes:r}}(this.structure,a);if((u=h.columnRowsStructure).length>1){var g=h.columnRowsMediaIndexes;p=u.map(function(e,t){var i;if(g[t+1]>=0){if(i=d.getLayoutWithArgIndex(g[t+1]),g[t-1]>=0){var n=d.getLayoutWithArgIndex(g[t-1]);return i.absoluteTop-n.absoluteTop-n.height}return g[t]>=0?(i=d.getLayoutWithArgIndex(g[t])).height:i.absoluteTop}return g[t]>=0?(i=d.getLayoutWithArgIndex(g[t])).height:(i=d.getLayoutWithArgIndex(g[t-1]),d.height-i.absoluteTop-i.height)})}}this.columns=u.map(function(r,a){var l=o?function(n){if(_.isEmpty(n))return[[-1]];for(var o=n[0].length,r=[],a=0;a<o;a++){var s=r[r.length-1];s&&i(a,n,s[0].length-1,s)||(s=t(n.length),r.push(s)),e(a,n,s)}return r}(r):[r],c=function(e){return e.map(function(e){return _.uniq(_.flattenDeep(e))})}(l),u=function(e,t){for(var i=-1,n=0,o=[],r=0;r<t.length;r++)0===n&&(o[++i]=0,n=e[i]),n--,o[i]+=t[r];return o}(function(e){return e.map(function(e){return e[0].length})}(l),d.getCleanColumnWidths()[a]),h=-1,g=d.layout;s>=0?h=function(e,t){if(t<0)return-1;for(var i=0;i<e.length;i++)if(e[i].indexOf(t)>=0)return i;return-1}(c,s):1===d.cluster&&(h=0,g=g.slice(1));var m=function(e,t){return t.map(function(t){return t.map(function(t){if(e[t]&&("media"!==e[t].type||"social"===e[t].subType))return e[t].subType}).filter(_.identity)})}(d.argList,c),f=function(e,t,i){return t.map(function(t,o){var r,a=t.map(function(t){if(!(t<0)){var i;if($(e,function(e){if(e.argIndex===t)return i=e,!0}),void 0===i)throw new Error("could not find layout for argIndex="+t+" in column #"+o);if("media"!==i.type||"social"===i.subType)return n(e,i)}}).filter(_.identity);if(o===i)$(e,function(e){if("media"===e.type&&"social"!==e.subType)return r=e,!0}),r&&a.push(n(e,r)),a.push.apply(a,e.filter(function(e){return void 0!==e.onMediaIndex}));else if(0===a.length)throw new Error("could not find any layouts for column #"+o);return _.uniq(a)})}(g,c,h),v=0,y=d.getMediaLayout();return _.zip(u,f).map(function(e,t){var i=e[0],n=e[1];return $(n,function(e){e.columnsRowIndex=a,e.columnsColIndex=t}),{isVirtual:!0,offset:(v+=i)-i,hasMedia:s>=0&&h===t,hasText:m[t].length>0||y&&d.textDirectlyOnMedia(d.getMediaLayout())||1===d.cluster&&!y||!1,doesMediaFill:s>=0&&h===t&&function(e,t){return 1===e[t].length}(c,h),width:i,height:p[a],layout:n}})})}}}}(),k.prototype.getColumns=function(){return this.columns},k.prototype.setArgComponent=function(e,t){isNaN(e)||(this.argsComponents[e]=t)},k.prototype.failWithReason=function(e){this.solutionStatus=i.fail,this.solutionFailReason=e,b.debug&&d.debug(e)},k.prototype.setLGContainer=function(e){this.containingLG=e},k.prototype.getSolutionStatus=function(){return this.solutionStatus},k.prototype.getScreenShot=function(){return this.screenShot||"field_screenShot_of_LE_is_undefined"},k.prototype.recurseLayouts=function(e){$(this.layout,e.bind(this))},k.prototype.getMediaIndex=function(e){if(void 0===e.mediaIndex){var t=0;this.recurseLayouts(function(e){this.isMediaLayout(e)?e.mediaIndex=t++:e.mediaIndex=-1})}return e.mediaIndex},k.prototype.getMediaLayout=function(){var e=null;return this.recurseLayouts(function(t){if(this.isMediaLayout(t))return e=t,!0}),e},k.prototype.isMediaLayout=function(e){return"media"===e.type||"gallery"===e.type},k.prototype.isOnMediaContainer=function(e){return this.onMediaStructure&&"container"===e.type&&(e.onMediaIndex>-1||-1===e.onMediaIndex&&1===this.cluster)},k.prototype.getOnMediaContainer=function(){var e=this;return _.find(this.layoutArray,function(t){return e.isOnMediaContainer(t)})},k.prototype.getBgLayout=function(e){return e>-1?this.getLayoutWithArgIndex(e):-1===e&&1===this.cluster?this.layout[0]:void 0},k.prototype.getLayoutWithArgIndex=function(e){var t=null,i=this.getRuleNodeByArgIndex(e);return i?i.top.component:($(this.layout,function(i){if(i.argIndex===e)return t=i,!0}),t)},k.prototype.getRuleNodeByArgIndex=function(e){if(this.smartLayoutRulesNodesMap){var t=this.argList[e],i=this.smartLayoutRulesNodesMap[t.subType];return _.find(i,function(t){return t.top.component.argIndex===e})}},k.prototype.isTextLayout=_.memoize(function(e){return["text","button","textButton"].indexOf(e.type)>-1},_.property("type")),k.prototype.getLayoutMargins=function(e){var t={left:0,right:this.width};return this.recurseLayouts(function(i){if(e!==i&&!(i.top>e.top+e.height||e.top>i.top+i.height)){var o=i.left,r=i.left+i.width;o>n.gridStep?t.right=Math.min(t.right,o):t.left=Math.max(t.left,r)}}),t.left>0&&(t.left+=n.gridStep),t.right<this.width&&(t.right-=n.gridStep),t},k.prototype.centerSocialImageList=function(e,t){var i,n,o=e.width,r=this.getArgValue(t).length;if(e.width=e.componentProperties.iconSize*r+e.componentProperties.spacing*(r-1),this.variationsMap&&(i=this.variationsMap.social||this.variationsMap[AdiCoreSanta.ElementSubTypes.Title]||this.variationsMap[AdiCoreSanta.ElementSubTypes.Subtitle]||this.variationsMap[AdiCoreSanta.ElementSubTypes.LongText]||this.variationsMap[AdiCoreSanta.ElementSubTypes.Phone]||this.variationsMap[AdiCoreSanta.ElementSubTypes.Fax]||this.variationsMap[AdiCoreSanta.ElementSubTypes.Email]||this.variationsMap[AdiCoreSanta.ElementSubTypes.Address]),i?n=i.hPosition||i.align:this.isMobile()&&(n="center"),0!==e.left||n){var a=this.getLayoutMargins(e);if(a.right-a.left<e.width)return e.width=0,!0;switch(n){case"right":e.left=a.right-e.width;break;case"center":e.left=(a.right+a.left)/2-e.width/2;break;default:e.left=a.left}}return o!==e.width&&this.containingLG.handleSmartLayoutMutation(this),e.left>=0&&e.left+e.width<=this.width},k.prototype.visualMeasureSplit=function(e,t){var i=this,n=F(t);return this.measureComponent(e,n[0],this).then(function(t){return i.splitParagraphValidation.firstPart=t,i.measureComponent(e,n[1],i)}).then(function(e){i.splitParagraphValidation.secondPart=e})},k.prototype.shouldSplitParagraph=function(){return b.sectionTextSplitParagraph&&this.containingSegment&&!!this.getLayoutSelectionStore().getParagraphColumns(this.containingSegment.node,null)},k.prototype.visualMeasure=function(e,i){b.twoButtonSection?this.getMaster().updateHeightFromNode():this.updateHeightFromNode();var n=this,r=this.getLayoutWithArgIndex(e);return r?r.width<0||r.height<0?(this.errorList.push("negative height / width"),o.when()):o.when().then(function(){if(n.shouldSplitParagraph()&&"longText"===r.subType)return n.visualMeasureSplit(r,i)}).then(function(){return b.twoButtonSection&&r.type===AdiCoreSanta.ElementTypes.Button?t.measureComponentButton(n,r,i):n.measureComponent(r,i,n)}).then(function(e){return r.numLines=e.lines,e}):o.when()};function A(e){e.passingHeight=e.height,e.recurseLayouts(function(e){e.passingHeight=e.height})}function E(e,t,i,n,o){var r=t.slice(),a={index:i};n&&(a.vAlign=n),o&&(a.hAlign=o),r.push(a),e.push(r)}function D(e,t){return void 0!==t.argIndex?e.argList[t.argIndex]&&e.argList[t.argIndex].subType:t.subType||t.type}function F(e){var t=function(e){var t=e.length,i=e.indexOf(" ",Math.floor(.55*t)),n=e.indexOf(".",Math.floor(.55*t)),o=Math.floor(.55*t);return n<=Math.floor(.6*t)?n:i<=Math.floor(.6*t)?i:o}(e);return[e.substr(0,t),e.substr(t+1)]}return k.prototype.visualValidate=function(e,t){this.clientRectList=this.clientRectList||[],this.clientRectList[e]=t;var i=this.getLayoutWithArgIndex(e);if("social"===i.type)return this.centerSocialImageList(i,e);i.breakingText&&(i.breakingText=!1);var o,r=!1,a=!1,s=!1,l=i.height,c=this.isTextLayout(i);if("button"===i.type){var d=this.getLayoutOriginalSizes(i).width-2*i.margin;d<t.width&&!b.twoButtonSection?(i.validationWidth=d,i.clientRectWidth=t.width,i.hasToBeFull=!0):i.validationWidth=t.width,a=!0,b.twoButtonSection||(t.height=Math.max(t.height,2*i.heightMargin+i.fontSize-i.topMargin),t.height=Math.ceil(t.height/n.quarterBaseLine)*n.quarterBaseLine)}else t.width>i.width&&(c?i.breakingText=!0:r=!0);if(r||"text"!==i.type||(i.textWidth=t.width,i.textHeight=t.height-(t.lineHeight-t.lineMargin),i.clientRect=t),null===this.needsReset&&(i.fixedBottom||this.isTextOnlyCluster())&&i.height!==t.height)return this.needsReset=!0,!1;if(!r){var u=this.getNeededLineOffset(i);i.height-=u,i.top+=u,i.missingHeight=(i.missingHeight||0)+u;var p=t.height;if(p>i.height&&!(this.isMediaType(i)&&i.height>=i.mediaMinHeight)&&(o=this.mutate(i.argIndex,p)),"media"===i.type){var h=this.getArgValue(i.argIndex),g=_.uniq(_.map(h,"mediaType"));1===g.length&&"video"===g[0]&&(i.width<200&&(r=!0),i.height<200&&(o=this.mutateByStretching(this.height+200-i.height))),i.squareImage&&i.height<i.width&&(o=this.mutateByStretching(this.height+i.width-i.height))}o&&(i=this.getLayoutWithArgIndex(i.argIndex),"success"===o.result?(a=a||!0,o.containerMutation&&(s=this.getSegmentHeight()<this.height)):"failure"===o.result&&(r=!0)),!a&&"media"!==i.type&&"map"!==i.type&&t.height>l&&(r=!0)}return null===this.needsReset&&c&&i.height>t.height&&this.getCleanLELayoutByArgIndex(e).height<i.height?(this.needsReset=!0,!1):(this.layout.hadHeightMutation=!1,a?(s&&(this.layout.hadHeightMutation=!0),this.containingLG.handleSmartLayoutMutation(this,s)):r&&this.failWithReason("Visual validation failed - argument #"+e+" argType: "+this.argList[e].subType),this.isNotFailing())},k.prototype.hasComponentsOnMedia=function(e){var t=this;return e&&void 0!==e.hasOnMedia?e.hasOnMedia:(this.recurseLayouts(function(i,n){if(i===e){var o=n||t.layout;return e.hasOnMedia=_(o).filter({type:"container"}).some(function(t){return t.top>=e.top&&t.top<=e.top+e.height&&t.left>e.left&&e.left<=e.left+e.width}),!0}}),e.hasOnMedia)},k.prototype.setFontOverriderForAllArgs=function(){if(!this.isMobile()){var e=w.getSectionOverride(this.containingSegment.node),t=this;_.each(this.argList,function(i,n){"text"===i.type&&t.setFontOverriderForArg(i,n,e)})}},k.prototype.setFontOverriderForArg=function(e,t,i){this.extractedFontOverrides[t]=b.designKit?I.getFontOverride(this.containingSegment.node,e.subType,i,this):this.getLayoutSelectionStore().fontOverridesManager.getOverride(this.containingSegment.node,e.subType,i,this)},k.prototype.findArgInLayout=function(e,t){var i,n=this;return e.layout&&e.layout.length?((t?_.findLast:_.find)(e.layout,function(e){return-1!==(i=n.findArgInLayout(e,t))}),i):void 0===e.argIndex?-1:e.argIndex},k.prototype.checkExtractedArgs=function(){return!this.errorList.length||(this.failWithReason(this.errorList.join(", ")),!1)},k.prototype.getCleanLE=function(){return this.cleanLayouts[this.id]},k.prototype.initColumnWidth=function(e){var t=-1,i=-1,o=n.getGridUnits(e.width);if(e.structure&&0!==e.structure.length){if(1===e.structure[0].length)e.columnWidths=e.structure.map(function(){return[o]});else if(e.columnWidths=_(e.structure).map(function(o,r){return o=_.uniq(o),_.map(o,function(o,a){var s=e.getLayoutWithArgIndex(o);return"social"===s.type&&(t=r,i=a),n.getGridUnits(s.width)})}).value(),t>-1&&i>-1){var r=e.columnWidths[t];r[i]+=o-(b.lodash4?_.strictSumBy:_.sum)(r)}}else e.columnWidths=[[o]]},k.prototype.getCleanColumnWidths=function(){var e=this.getCleanLE();return e.columnWidths||this.initColumnWidth(e),e.columnWidths},k.prototype.getCleanLELayoutByArgIndex=function(e){return this.cleanLayouts[this.id].getLayoutWithArgIndex(e)},k.prototype.setSegContainer=function(e){this.containingSegment=e},k.prototype.setDecorationChanged=u(function(e){this.decorationChanged=e}),k.prototype.updateVariationsDecorationsIfNeeded=u(function(){var e=this;return o.resolve().then(function(){var t=e.getLayoutSelectionStore().getVariations(e.containingSegment,e.cluster,e.selections);if(!_.isEqual(t,e.variationsMap)||!s.hasCurrentDecorations(e))return e.variationsMap=ob.deepClone(t),s.applyDecoration(e)})}),k.prototype.needsCalcFromValueChange=function(e,t,i){return!(e&&t&&t.values!==i.values&&!function(e,t,i){return angular.forEach(e,function(e){if(e.field&&e.field===i&&e.element&&e.element===t.type)return!0}),!1}(this.argList,t,e)&&!(i.aggregator&&i.ceArray.indexOf(t)>=0))},k.prototype.calculateLayoutElementStatus=u(function(e,t,i,n){var r=this;return this.needsFirstTimeInit&&(this.needsFirstTimeInit=!1,this.reset()),this.needsCalcFromValueChange(i,t,e)?this.updateVariationsDecorationsIfNeeded().then(function(){return r.checkSolutionStatus(e,n)}).then(function(){return r.checkUglyRules()}).then(function(){var e=r.prevFontOverrides&&!_.isEqual(r.extractedFontOverrides,r.prevFontOverrides);return r.passingHeight||A(r),r.finishCalculateSolutionStatus(r.needsReset||e)}).then(function(){if(r.isPassing())return r.calculateColumns(),r.checkColumnsUglyRules()}):o.resolve()}),k.prototype.calculateColumns=function(){if(this.isPassing()&&!this.isMobile()){this.columns=void 0;var e=this.containingLG.getColumnsData();e&&e.enable&&(e.colSplit||e.rowSplit)&&this.calcColumns(e.colSplit,e.rowSplit)}},k.prototype.getLayoutOriginalSizes=function(e){if(e.argIndex>-1){var t=this.getCleanLE().getLayoutWithArgIndex(e.argIndex);return{width:e.originalWidth||t.width,left:e.originalLeft||t.left,hPosition:t.hPosition}}return{width:e.width,left:e.left}},k.prototype.createElementLayoutHPosition=function(e,t,i){var o=this.getLayoutOriginalSizes(e);t>=o.width?o.hPosition?e.hPosition=ob.deepClone(o.hPosition):delete e.hPosition:(t<=1&&(t=o.width*t)%n.horizontalGridStep&&(t=(Math.floor(t/n.horizontalGridStep)+1)*n.horizontalGridStep),e.hPosition={left:{left:_.get(o.hPosition,["left","left"],o.left),width:t},center:{left:_.get(o.hPosition,["center","left"],o.left)+(o.width-t)/2,width:t},right:{left:_.get(o.hPosition,["right","left"],o.left)+o.width-t,width:t}},b.freeSection&&i&&["left","center","right"].forEach(function(t){var n=e.hPosition[t];i.left&&(n.left+=i.left),i.width&&(n.width+=i.width),n.left<o.left&&(n.left=o.left),n.left+n.width>o.left+o.width&&(n.width=o.left+o.width-n.left)}))},k.prototype.lockImage=function(e){e.mediaMinHeight=e.width,e.squareImage=!0},k.prototype.getButtonLeftAndWidth=function(e){var t,i=this.getLayoutOriginalSizes(e),n=i.width,o=i.left;if(b.twoButtonSection||!0!==this.getAlignment(e,"fullWidth"))switch(t=b.twoButtonSection?e.validationWidth:e.validationWidth+2*e.margin,this.getAlignment(e,"hPosition")){case"center":o+=(n-t)/2;break;case"right":o=o+n-t}else t=n;return{width:t,left:o}},k.prototype.squizLayouts=function(){var e=this;angular.forEach(this.layoutArray,function(t){if("button"===t.type){var i=e.getButtonLeftAndWidth(t);t.width=i.width,e.fakeOriginalToSpecificLayoutForSpecificAttribute(t,"width"),t.left=i.left}}),s.updateLinesPosition(this)},k.prototype.finishCalculateSolutionStatus=function(e){var t=this;return o.when().then(function(){if(t.prevFontOverrides=ob.deepClone(t.extractedFontOverrides),t.errorList.length>0&&t.failWithReason(t.errorList.join(",")),t.isNotFailing()){if(t.solutionStatus=i.pass,t.solutionFailReason=null,e)return t.needsReset=!1,t===t.containingSegment.getLENoError()&&(t.containingSegment.mutation=null),t.shrink().then(function(){return t.finishCalculateSolutionStatus(t.needsReset)});if(t.wantedHeight=t.getWantedHeight(),t.containingLG.forcePretty&&t.wantedHeight<t.height)return t.finishCalculateSolutionStatus(!0);if(t.wantedHeight>t.height&&"success"!==t.mutateByStretching(t.wantedHeight).result)return void t.failWithReason("Cannot strecth");t.squizLayouts()}})},k.prototype.isTextOnlyCluster=function(){return 49===this.cluster||50===this.cluster||51===this.cluster},k.prototype.getWantedHeight=function(){if(this.containingLG.forcePretty){var e,t=g.getLayoutPrettyHeight(this);e=Math.max(this.passingHeight,g.getLayoutAdditionalHeight(this,t,this.passingHeight)),this.isMobile()&&b.mobileNoGrid||(e=n.getValidHeight(e));var i=n.maxHeight;return Math.min(e,i)}return this.getSegmentHeight()},k.prototype.shouldApplyUserAdditionalHeight=function(){if(this.isTextOnlyCluster())return!1;if(this.containingLG.isListHeader()||this.containingLG.isListFooter())return!1;if(this.getMediaType()===S.COAST2COAST)return!0;var e=this.containingLG.getColumnsData();return!!(e&&e.enable&&e.fullWidth&&e.backgroundMode)},k.prototype.shrink=function(){var e=this;return s.applyDecoration(e).then(function(){return e.checkArgsAndVisualValidate([])}).then(function(){A(e)})},k.prototype.isShapeLayout=function(e){return e.height<=n.shapeMediaSize&&e.width<=n.shapeMediaSize},k.prototype.numOfImagesForLe=function(){var e=this;return _.reduce(this.argList,function(t,i,n){if("image"===i.subType){var o=e.getLayoutWithArgIndex(n);e.isShapeLayout(o)?t.smallMedias+=1:t.bigMedias+=1,940===o.width&&(t.coast2coastMedias+=1)}return t},{smallMedias:0,bigMedias:0,coast2coastMedias:0})},k.prototype.userProvidedEnoughImages=function(e){var t=function(e){return{images:e.getValuesByMediaType().image?e.getValuesByMediaType().image.length:0,shapes:e.getValuesByMediaType().shape?e.getValuesByMediaType().shape.length:0,extVideos:e.getValuesByMediaType().extVideo?e.getValuesByMediaType().extVideo.length:0,videos:e.getValuesByMediaType().video?e.getValuesByMediaType().video.length:0}}(e),i=this.numOfImagesForLe();return t.images>=i.bigMedias&&t.shapes+t.images-i.bigMedias>=i.smallMedias||i.bigMedias>0&&t.extVideos>=i.bigMedias||i.coast2coastMedias>0&&t.videos>=i.coast2coastMedias},k.prototype.uglyFail=function(e,t){var i=this;if(e&&void 0!==e.onMediaIndex){var n=_.find(this.layoutArray,function(e){return i.isOnMediaContainer(e)}),r=this.getBgLayout(e.onMediaIndex),a=this.getAlignment(n,"hPosition");if(a<l.getMediaContainerWidth(r.width,this).length-1)return this.needsReset=!0,this.updateSelectedVariationsMap(n,a+1,"hPosition"),this.containingLG.getLayoutSelectionStore().setVariations(this.containingSegment,this.cluster,this.variationsMap),o.when()}return this.errorList.push(t),o.when()},k.prototype.isFullWidth=function(){return this.isMobile()?300===this.width:940===this.width},k.prototype.ignoreUglyRules=function(){return this.isMobile()||(2===this.cluster||49===this.cluster)&&this.isFullWidth()||!_.isUndefined(this.splitArg)},k.prototype.checkUglyRules=function(){if(this.ignoreUglyRules())return o.when(!0);if(940===this.width&&this.onMediaStructure){var e=this,t=_.find(this.layoutArray,function(t){return e.isOnMediaContainer(t)}),i=this.getBgLayout(t.onMediaIndex);if(this.getAlignment(t,"hPosition")<l.getMediaContainerWidth(i.width,this).length-1){var n=0,r=0;_.each(t.layout,function(e){"text"===e.type&&(n=Math.max(n,e.width),r+=e.height)}),r/n>.75&&this.uglyFail(t.layout[0],"texts on media have an aspect ratio above 0.75")}}for(var a=0;a<this.argList.length;a++){var s,c=this.argList[a];if("text"===c.type&&"form"!==c.subType&&"map"!==c.subType){if((s=this.getLayoutWithArgIndex(a)).breakingText)return this.uglyFail(s,c.subType+" needs ellipsis");var d=s.height/s.width,u=1.4;if("longText"===c.subType&&(u=1.6),d>u)return this.uglyFail(s,c.subType+" has an aspect ratio above "+u)}else if("media"===c.type&&this.onMediaStructure&&!this.isMobile()){s=this.getLayoutWithArgIndex(a);var p=C.validate(this,s,this.containingSegment,!1);if("has_layouts_above"===_.get(p,["response","type"]))return this.uglyFail(s,c.subType+"with content on "+p.currentGallery.name)}}return o.when(!0)},k.prototype.checkUglyFitMode=function(){if(!this.imageFitFullMode())return o.when(!0);var e=19===this.cluster||21===this.cluster,t=this.layout.find(function(e){return"container"===e.type&&"decorative"===e.containerRole});if(!this.containingSegment.node.isListItem&&e&&t&&this.layout.length>1)return this.uglyFail(t,"side by side singles cant have decorative box with sibilings in fit mode");if(this.containingSegment.node.isListItem&&t&&this.layout.length>1)return this.uglyFail(t,"list items cant have decorative box with sibilings in fit mode");if(0===this.getMediaType())return this.uglyFail(null,"prevent shape in fit mode");if(1===this.getMediaType())return this.uglyFail(null,"prevent coast2coast in fit mode");if(this.onMediaStructure&&this.onMediaStructure.length>0)return this.uglyFail(null,"prevent text on media in fit mode");var i=C.getStyleOverrrides(this.containingSegment);return i&&"wp3"===i.media?this.uglyFail(null,"has media skin in fit mode"):this.containingSegment.node.isListItem&&this.containingSegment.node.identifyingNode.zigZagState?this.uglyFail(null,"no zigzag layouts in fit mode"):o.when(!0)},k.prototype.checkColumnsUglyRules=function(){if(this.containingLG.columns&&this.containingSegment.isContact()&&!this.isMobile()){var e=this.getCleanColumnWidths(),t=n.getGridUnits(this.width);_.some(e,function(e){return e<t})&&this.failWithReason("contact has partial columns")}return o.when(!0)},k.prototype.imageFitFullMode=function(){var e=this.getMediaLayout();if(!e)return!1;var t=C.getGallery(this,e,this.containingSegment);return!!t&&(t&&"full"===t.properties.displayMode)},k.prototype.checkSolutionStatus=function(e,t){return this.extractedFontOverrides.length=0,this.setFontOverriderForAllArgs(),t||this.getSolutionStatus()===i.unknown||!_.isEqual(this.extractedFontOverrides,this.prevFontOverrides)||this.decorationChanged?(this.resetSolutionStatus(),this.userProvidedEnoughImages(e)?(this.decorationChanged=null,this.checkExtractedArgs()?this.visualValidateAll():o.when()):(this.errorList.push("Not enough images"),o.when(!0))):o.when()},k.prototype.sitePartFit=function(e){return!e||"footer"===e&&this.isAllowedFooter||"body"===e||"header"===e&&this.isAllowedHeader},k.prototype.possibleAligns=function(){if(!this.possibleAlignsCache){this.possibleAlignsCache=[[]];var e=this;angular.forEach(this.layout,function(t){var i=[];_.each(e.possibleAlignsCache,function(n){!function e(t,i,n,o){var r,a,s=t.indexOf(i);i.vPosition?_.each(i.vPosition,function(e,l){if(i.hPosition)_.each(i.hPosition,function(e,t){E(o,n,s,l,t)});else if(e.layout){E(o,n,s,l),r=[angular.copy(o[o.length-1])];var c=!1;_.each(e.layout,function(e,n){e.hPosition&&(c=!0,a=[],_.each(r,function(o){var r=t.indexOf(i.layout[n]);_.each(e.hPosition,function(e,t){E(a,o,r,void 0,t)})}),r=a)}),c&&(o.splice(-1,1),Array.prototype.push.apply(o,r))}else E(o,n,s,l)}):i.hPosition?_.each(i.hPosition,function(e,t){E(o,n,s,void 0,t)}):i.layout&&(r=[[]],_.each(i.layout,function(i){a=[],_.each(r,function(n){e(t,i,n,a)}),r=a}),Array.prototype.push.apply(o,r))}(e.layoutArray,t,n,i)}),i.length>0&&(e.possibleAlignsCache=i)})}return this.possibleAlignsCache},k.prototype.updateOriginalComponent=function(e){angular.forEach(e,function(e){angular.forEach(e.component,function(t,i){e.originalComponent[i]=t})})},k.prototype.changeAlignFromLayout=function(e,t,i,n){var o=this.layoutArray.indexOf(e);o>-1&&(this.changeAlign(o,t,i),n||this.updateSelectedVariationsMap(e,t,i))},k.prototype.updateFromVariationsMap=function(){var e=this;e.variationsMap&&(e.recurseLayouts(function(t){var i=e.getVariatiableKey(t),n=e.variationsMap[i];n&&((n.size||b.freeSection&&n.layoutChange)&&e.createElementLayoutHPosition(t,n.size||1,n.layoutChange),e.variationsMap[i].vPosition&&e.changeAlignFromLayout(t,n.vPosition,"vPosition",!0),(e.variationsMap[i].hPosition||b.freeSection&&n.layoutChange)&&e.changeAlignFromLayout(t,n.hPosition||"left","hPosition",!0),e.variationsMap[i].squareImage&&e.lockImage(t))}),this.initAlignRules())},k.prototype.getVariatiableKey=function(e){return"media"===e.type?"media":"container"===e.type?"container"+(void 0!==e.onMediaIndex?"OnMedia":""):this.getLayoutSubType(e)},k.prototype.getLayoutSubType=function(e){if(void 0===e.argIndex)return e.type;var t=this.argList[e.argIndex];return"media"!==t.type||t.subType?t.subType||t.type:"image"},k.prototype.updateSelectedVariationsMap=function(e,t,i){var n=this.getVariatiableKey(e);this.variationsMap[n]=this.variationsMap[n]||{},void 0!==t?this.variationsMap[n][i]=t:delete this.variationsMap[n][i]},k.prototype.getAlignment=function(e,t,i){var n={vPosition:"activeV",hPosition:"activeH",fullWidth:"fullWidth",align:"align"},o=this.getVariatiableKey(e);return this.variationsMap&&this.variationsMap[o]&&void 0!==this.variationsMap[o][t]?this.variationsMap[o][t]:i?void 0:void 0!==e[n[t]]?e[n[t]]:e.componentProperties&&e.componentProperties[n[t]]||{vPosition:"top",hPosition:"left",fullWidth:!1,align:"left"}[t]},k.prototype.getLineWidthAndLeftPosition=function(e){return e.widthAndLeftPosition||s.getLineWidthAndLeftPosition(this,e)},k.prototype.changeAlign=function(e,t,i){if(i&&t){var n=this,o=n.layoutArray[e];o[i]&&(angular.forEach(o[i][t],function(r,a){"layout"===a?_.each(r,function(t,i){_.each(t,function(e,t){o.layout[i][t]=e}),n.updateOriginalComponent(n.smartLayoutRulesNodes[e+i+1])}):o[a]=o[i][t][a]}),n.updateOriginalComponent(this.smartLayoutRulesNodes[e])),"vPosition"===i&&o.vPositionRules&&_.each(o.vPositionRules[t],function(e){var t=n.nodesForComponent(e.childIndex,e.childFacet);void 0!==e.parentIndex?t.parentCandidate=n.nodesForComponent(e.parentIndex,e.parentFacet):t.parentCandidate=null,n.trySetRule(t)})}},k.prototype.setVAlignByIndex=function(e){var t=this;_.each(this.possibleAligns()[e],function(e){t.changeAlign(e.index,e.vAlign,"vPosition"),t.changeAlign(e.index,e.hAlign,"hPosition")}),this.initAlignRules()},k.prototype.getAlignVariations=u(function(){if(!this.alignVariations.length){var e=this.possibleAligns(),t=this;this.alignVariations=_.map(e,function(e){var i=t.smartClone();return _.each(e,function(e){i.changeAlign(e.index,e.vAlign,"vPosition"),i.changeAlign(e.index,e.hAlign,"hPosition")}),i})}return this.alignVariations}),k.prototype.getArgsSignature=function(){return this.argsSignature||this.calcArgsSignature(),this.argsSignature},k.prototype.calcArgsSignature=function(){var e=this,t=_.map(this.argList,function(t){return e.getArgSignature(t)});this.argsSignature=this.sortAndCleanArgsSignature(t)},k.prototype.sortAndCleanArgsSignature=function(e){return _.uniq(_.remove(e,void 0)).sort().join("#")},k.prototype.getArgSignature=function(e){if("label"!==e.subType&&!e.hidden)return e.isReference?e.element+"."+e.field:r[e.subType]||e.subType||r[e.type]||e.type},k.prototype.getStripImageArgIndex=function(){return _.findKey(this.overrides.media,function(e){return"stripContainer"===e.type})},k.prototype.handleOverrides=function(){this.originalArgList=this.argList,Object.defineProperty(this,"argList",{get:function(){var e=[],t=this;return angular.forEach(this.originalArgList,function(i,n){if(t.overrides&&t.overrides.media&&t.overrides.media[n]&&"media"===i.type){var o=b.lodash4?_.cloneDeep(i):_.clone(i,!0);o.subType="gallery"===t.overrides.media[n].type?"gallery":"image",e.push(o)}else e.push(i)}),!_.isUndefined(this.splitArg)&&e[this.splitArg]&&(e[t.originalArgList.length]=b.lodash4?_.cloneDeep(e[this.splitArg]):_.clone(e[this.splitArg],!0),e[t.originalArgList.length+1]=b.lodash4?_.cloneDeep(e[this.splitArg]):_.clone(e[this.splitArg],!0)),e},set:function(e){this.originalArgList=e}})},k.prototype.toggleFormatting=function(e,t,i){var n=D(this,e);if(n){var o=this.getFormattingBySubType(n,e);o.toggle(t,i),this.containingLG.setAsDirty(),this.containingLG.handleSmartLayoutMutation(this),this.decorationChanged=!0,d.debug("Change text formatting: "+o.serialize())}},k.prototype.getFormatting=function(e,t,i,n){if("text"===e.type||"widget"===e.type&&"login"===e.subType){var o=D(this,e);return this.getFormattingBySubType(o,e,t,i,n)}},k.prototype.getFieldColorOverride=function(e,t,i){return i=i||this.getLayoutSelectionStore(),t=t||e&&D(this,e),M.getFieldColorOverride(this.containingSegment.getSegmentNode(),t,i)},k.prototype.getFormattingBySubType=function(e,t,i,n,o){if(o=o||!0,b.designKit){var r;if(b.coreNewMobileColumns&&this.isMobile()&&t&&t.type===AdiCoreSanta.ElementTypes.Text){var a=P.getForNode(this.containingSegment.getSegmentNode());(r=o&&_.get(a,["designKit","mobile",t.subType+"Color"]))&&(r=I.getKitFormatColor(r))}else r=o&&this.getFieldColorOverride(t,e,n);return I.getFontFormatting(this.containingSegment,e,t,i,r)}return this.getLayoutSelectionStore().getTextFormattingBySubType(this.containingSegment,e,t,i)},k.prototype.resetFormatting=function(e){var t=D(this,e);this.getLayoutSelectionStore().resetTextFormatting(this.containingSegment,t),this.containingLG.setAsDirty()},k.prototype.getMapStyleOverride=function(e){var t=D(this,e);return this.getLayoutSelectionStore().getMapStyleOverride(this.containingSegment,t)},k.prototype.getDesignPolicyParams=function(){return b.sectionDesignPolicy||b.condensedPresets?L.getSectionDesignPolicy(this.containingSegment.node):this.getLayoutSelectionStore().designPolicy},k.prototype.createLayoutArray=function(){var e=this;e.layoutArray=[],e.recurseLayouts(function(t){return e.layoutArray.push(t),!1})},k.prototype.badLEs={},k.prototype.setAllLayoutsFontAndLineMargin=function(){var e=this;return function e(t,i){return _.sequencePromises(t,function(t){return i(t).then(function(){if(t.layout)return e(t.layout,i)})})}(this.layout,function(t){return e.setLayoutFontAndLineMargin(t,e)})},k.prototype.setLayoutFontAndLineMargin=function(e){var t=this;if(e.designMargin={},void 0!==e.argIndex&&(e.subType=t.argList[e.argIndex].subType),t.needsVisualValidation(e)){var i,n=t.getLayoutSelectionStore(),r=t.argList[e.argIndex];if(r&&("text"===r.type||"button"===r.type)){void 0===e.initialFont&&(e.initialFont=e.font);var a=t.containingSegment.node,s=w.getSectionOverride(a);if(i=(i=t.extractedFontOverrides&&t.extractedFontOverrides[e.argIndex])||(b.designKit?I.getFontOverride(a,r.subType,s,t):n.fontOverridesManager.getOverride(a,r.subType,s,t)),e.font=i?i.replace("font_",""):e.initialFont,b.textEditOnStage2&&!this.isMobile()&&(e.fontSizeOverride=w.getOverrideFontSize(a,r.subType)),"button"===r.type){var l=n.getOverrideMap(),c=t.containingSegment&&t.containingSegment.getTypeForLSSWithoutPartition(),d=c&&l.style&&l.style[c]&&l.style[c].button;d&&(e.style=d);var u=x.getCatalogId(t.containingSegment.node,"buttons");u&&(e.style="catalog-buttons-"+u)}}return f.getOrBuildValidator(e,t).then(function(i){if(e.baseLineMargin=i.lineMargin,e.lineHeight=i.lineHeight,e.fontSize=i.fontSize,e.fontFamily=i.fontFamily,e.topMargin=i.topMargin,"button"===e.type){e.isTextButton=h.isButtonStyleTransparent(e.style),e.isTextButton||(e.baseLineMargin=0);var n=y(e.fontSize,e.isTextButton);e.margin=n.side,e.heightMargin=n.top,b.twoButtonSection&&(e.align=e.isTextButton?t.getAlignment(e,"hPosition"):"center",e.fullWidth=!!t.getAlignment(e,"fullWidth"))}})}return o.when({status:1})},k.prototype.measureComponent=function(e,t){var i=this,n=i.getLayoutValue(e,t);if(!f.shouldUseValidator(e,i))return o.when({width:e.width,height:e.height,lineHeight:0,lineMargin:0});var r=v.get(n,e,i);return r||(r=f.validate(e,t,i),v.set(n,e,i,r)),r},k.prototype.isContact=function(){return this.generator},k.prototype.applyDesignPolicy=function(e){var t=m.designPolicy;if(t&&this.structure&&!this.isContact()){var i=this;this.calculateAbsoluteLocations();var n=this.getDesignStructure();_.each(n,function(n){if(n.length){var o=t.exec(n,e,i);_.each(o,function(e,t){_.each(e,function(e,i){var o;if(e)if(t<n.length){o=n[t][i];var r=t>0?n[t-1][i].argIndex:-1;r!==o.argIndex&&(o.designMargin[r]=Math.max(e,o.designMargin[r]||0))}else(o=n[t-1][i])&&(o.padding=Math.max(e,o.padding||0),o.missingBottom=o.padding)})})}})}},k.prototype.isOptionForMirror=function(){return this.scenarioId},k.prototype.isMirror=function(e){var t=this;if(this.id!==e.id&&this.isOptionForMirror()&&e.isOptionForMirror()&&_.every(this.argList,function(i,n){var o=t.getLayoutWithArgIndex(n),r=e.getLayoutWithArgIndex(n);return o.width===r.width}))return _.every(this.structure,function(t,i){var n=e.structure[i];if(!n||t.length!==n.length)return!1;var o=t.length;return!(t[0]!==n[o-1]||n[0]!==t[o-1])});return!1},k.prototype.textDirectlyOnMedia=function(e){return this.onMediaStructure&&_.some(this.layoutArray,function(t){return!t.boxParentOverrideKey&&"text"===t.type&&t.onMediaIndex===e.argIndex})},k.prototype.textDirectlyOnBackgroundMedia=function(){return this.onMediaStructure&&!this.getMediaLayout()&&_.some(this.layoutArray,function(e){return!e.boxParentOverrideKey&&"text"===e.type})},k.prototype.hasText=function(){return _.some(this.layoutArray,function(e){return"text"===e.type})},k.prototype.getExtractedArgs=function(){var e=this;return _.map(this.argList,function(t,i){return e.getArgValue(i)})},k.prototype.getSortedArgOrder=function(e){if(this.structure){if(!e&&!this.structure.length&&this.onMediaStructure)return this.getSortedArgOrder(this.onMediaStructure);var t=[],i=this,n=e||this.structure;return _.each(n,function(n){_.each(n,function(n){t.push(n),!e&&["media","image"].indexOf(i.argList[n].type)>-1&&i.onMediaStructure&&t.push.apply(t,i.getSortedArgOrder(i.onMediaStructure))})}),_.uniq(t)}return _.map(this.argList,function(e,t){return t})},k.prototype.visualValidateAll=function(){var e=this,i=this.getSortedArgOrder();return this.setAllLayoutsFontAndLineMargin().then(function(){var n=[e],o=e.containingSegment.getSegBrothers();return o&&o.length>1&&(n=_(o).map(function(t){return _.find(t.optionalLayoutElements,function(t){return t.layout===e.layout})}).filter().value()),_.sequencePromises(i,function(i){return _.sequencePromises(n,function(t){var n=t.getExtractedArgs();return b.twoButtonSection?t.visualMeasure(i,n[i]):e.visualMeasure(i,n[i])}).then(function(o){var r=_.keys(o[0]),a={};(_.each(r,function(e){a[e]=(b.lodash4?_.strictMaxBy:_.max)(_.map(o,e))}),b.twoButtonSection&&n.length>1)&&(e.getLayoutWithArgIndex(i).type===AdiCoreSanta.ElementTypes.Button&&t.syncButtonsDimensions(n));return a})})}).then(function(t){return e.applyDesignPolicy(e.getDesignPolicyParams().factor),_.allPromises(i,function(i,n){return e.visualValidate(i,t[n])})})},k.prototype.needsVisualValidation=function(e){return e.argIndex>=0},k.prototype.checkArgsAndVisualValidate=function(){var e=this;return this.checkExtractedArgs()?this.visualValidateAll().then(function(){return e.checkUglyRules()}):o.when(!1)},k.prototype.isSelectedLE=function(){return this.containingSegment&&this.containingSegment.isSelectedLE(this)},k.prototype.getLayoutParent=function(e){var t,i=this;return this.recurseLayouts(function(n,o){if(e===n)return t=o||i,!0}),t},k.prototype.getLayoutValue=function(e,t){return"button"===e.type?t&&t.callToAction:t},k.prototype.getArgValue=function(e){return this.containingSegment.contentElement.getArgumentValue(this,e)},k.prototype.isValidForHeight=function(){return this.isPassing()&&(!this.containingSegment||this.getSegmentHeight()===this.height||this.containingLG&&(this.containingLG.isHeader()||this.containingLG.forcePretty))},k.prototype.isPassing=function(){return this.getSolutionStatus()===i.pass},k.prototype.isNotFailing=function(){return this.getSolutionStatus()!==i.fail},k.prototype.isCloned=function(){return!!this.reference},k.prototype.getMaster=function(){return this.reference||this},k.prototype.getSegmentHeight=function(){return this.containingSegment.height},k.prototype.resetSolutionStatus=u(function(){this.errorList.length=0,this.needsReset=null,this.solutionFailReason=null,this.solutionStatus=i.unknown}),k.prototype.getLayoutFontSize=function(e){if("text"===e.type||"button"===e.type){var t;if(this.extractedFontOverrides&&this.extractedFontOverrides[e.argIndex])t=this.extractedFontOverrides[e.argIndex];else if("button"!==e.type||b.coreUseKitlerCatalog)t="font_"+e.font;else{var i=this.getLayoutSelectionStore().getOverrideMap(),n=this.containingSegment&&this.containingSegment.getTypeForLSSWithoutPartition(),o=n&&i.style&&i.style[n]&&i.style[n].button,r=o||e.style;t=h.getActiveTheme("color").definition.styles[r].properties.fnt}return h.getFontSize(t)}},k.prototype.maxFontInBox=function(e){var t=0,i=this;return $(e.layout,function(e){var n=i.getLayoutFontSize(e);n>-1&&(t=Math.max(t,n))}),t},k.prototype.lineDefaultPositionArea=function(e){return m.designPolicy.execFirstLastLine(e,this.getDesignPolicyParams().factor)},k.prototype.getLayoutSelectionStore=function(){return this.containingLG.getLayoutSelectionStore()},k.prototype.getMasterLe=function(){var e=this.containingSegment;if(this.containingLG.segments.length>1&&e.node.isListItem&&!Object.isExtensible(this)){var t=T.getSegLayoutElements(e);if(t&&t.length>1)return t[0].seg.getLE()}return this},k.prototype.isElementWithDynamicWidth=function(e){return this.structure&&this.structure.length&&("text"===e.type||this.isMediaType(e)||"form"===e.type)&&_.flatten(this.structure).indexOf(e.argIndex)>-1},k.prototype.getMediaType=function(){return this.getLayoutSelectionStore().getOverride("media",this.containingSegment,"allowedMediaOverrides")},k.prototype.isMobile=function(){return this.containingSegment&&this.containingSegment.isMobile},k.prototype.getDesktopSegment=function(){return this.containingSegment.getDesktopSegment()},k.prototype.getDesktopLE=function(){return this.getDesktopSegment().getLE()},k.prototype.isLayoutInMenuStripArea=function(e){var t=this.containingLG.getLgData(),i=this.getLayoutBySubType("menu")||this.getLayoutBySubType("copyrightMSG"),n=t.menuStrip;if(i&&n&&n.enable&&e){var o,r;if(this.containingLG.isMobile()&&this.containingLG.isSiteHeader()?(o=this.menuStripTop,r=this.menuStripBottom):(o=i.top-n.paddingTop,r=i.top+i.height+n.paddingBottom),isNaN(o)||isNaN(r))return!1;var a=e.top+e.height/2;return a>=o&&a<=r}return!1},k.prototype.getLayoutByArg=function(e){var t=this;return _.find(this.layoutArray,function(i){if(void 0!==i.argIndex){var n=t.argList[i.argIndex];return n.type===e.type&&n.subType===e.subType&&n.value===e.value}return!1})},k.prototype.isMediaByHorizontalEdge=function(){var e=this.getArgIndexByType("media");return!(void 0===e||!this.structure)&&_.some([_.first(this.structure),_.last(this.structure)],function(t){return _.includes(t,e)})},k.prototype.hasMedia=function(){var e=this.getArgIndexByType("media");return e>=0&&"social"!==this.argList[e].subType},k.prototype.isMapStripType=function(e){var t=this.variationsMap&&this.variationsMap.map&&this.variationsMap.map.fullWidth;if(t){var i=_.find(e?[e]:this.layout,function(e){return"map"===e.type});t=i&&940===i.width}return t},k.prototype.getShadowData=function(e){if("media"===e.type&&"image"===e.subType){var t=this.getLayoutSelectionStore().getImageShadow(this.containingSegment,this);if(t&&t.left&&t.top&&!this.imageFitFullMode()){var i=this.containingSegment.getMediaOverrides();if(!i||"video"!==i.name)return t}}},k.prototype.setParagraphColumns=function(e){var t=this.getLayoutBySubType("longText");if(t){var i=t&&this.getLayoutParent(t),n=i&&i.layout,o=this.splitArg||t.argIndex,r=this.getExtractedArgs();this.originalArgList||this.handleOverrides();var a=this.originalArgList.length,s=a+1;if(e){if(n){var l=_.find(n,{argIndex:a}),c=_.find(n,{argIndex:s});l||(this.mutate(o,t.height+_.get(t,"clientRect.lineHeight")),l=_.cloneDeep(t),n.push(l),c=_.cloneDeep(t),n.push(c));var d=F(r[o]);this.splitArgs={},this.splitArgs[a]=d[0],this.splitArgs[s]=d[1],l.argIndex=a,c.argIndex=s,this.isMobile()?(l.height=this.splitParagraphValidation.firstPart.height||0,c.top=l.top+l.height,c.height=this.splitParagraphValidation.secondPart.height||0):(l.width=(t.width-15)/2,c.width=(t.width-15)/2,c.left=(t.width+15)/2+l.left),l.splitLayout=!0,c.splitLayout=!0,t.skip=!0,this.splitArg=this.splitArg||o}}else if(this.splitArg&&n){delete this.splitArg;var u=_.findIndex(n,{argIndex:a}),p=_.findIndex(n,{argIndex:s});u>-1&&(n[u]=void 0),p>-1&&(n[p]=void 0),delete this.splitArgs,t.skip=!1}}},_.assign(k.prototype,e.prototype),k}]),function(e){var t=function(){function e(e,t,i,n,o){this.visualValidation=e,this.validationCache=t,this.applicationParameters=i,this.flags=n,this.$p=o,this.generateCacheKey=function(e,t,i){return i.map(function(i){return e.getLayoutValue(t,i)}).join("|")},this.generateCacheKeyButtons=function(e,t,i,n){return i.map(function(i){return e.getLayoutValue(t,i)}).concat([n,"Button"]).join("|")}}return e.$inject=["visualValidation","validationCache","applicationParameters","flags","$p"],e.prototype.getExtraButtons=function(e){return e&&e.extraButtons?e.extraButtons.filter(function(e){return e.enable}):[]},e.prototype.measureComponentButton=function(e,t,i){var n=this;void 0===i&&(i={});var o=function(e,t){return e.forEach(function(i,n){var o=0===n?void 0:e[n-1],r=o?o.offset.y+t+o.height:0;i.offset={x:0,y:r}}),e},r=function(e,t){var i=e.map(function(e){return e.offset.x+e.width}),n=e.map(function(e){return e.offset.y+e.height});return t.width=Math.max.apply(Math,i),t.height=Math.max.apply(Math,n),t},a=function(e,t){return e.width<=t},s=t.fullWidth,l=t.isTextButton,c=e.getAlignment(t,"hPosition"),d=[i].concat(this.getExtraButtons(i));if(""===t.font){var u={offset:{x:0,y:0},width:44,height:45,textDimensions:{width:4,height:28}},p=d.length||1,h=Array.apply(null,Array(p)).map(function(e){return u});return this.setButtonDimensions(e,h),this.$p.when({width:44,height:45,lines:1,lineHeight:28,lineMargin:15})}var g=this.generateCacheKey(e,t,d),m=this.generateCacheKeyButtons(e,t,d,c),f=this.validationCache.get(m,t,e),v=this.validationCache.get(g,t,e);if(v&&f)this.setButtonDimensions(e,f);else{var y=d.map(function(i){return n.visualValidation.validate(t,i,e)});v=this.$p.all(y).then(function(i){var d=_.cloneDeep(i[0]),u=e.getLayoutOriginalSizes(t).width;return i=function(e,t){return e.forEach(function(e,i,n){var o=0===i?void 0:n[i-1],r=o?o.offset.x+t+o.width:0;e.offset={x:r,y:0}}),e}(i=function(e,t){return e.forEach(function(e){e.textDimensions={width:e.width,height:e.height},e.width+=2*t.margin,e.height=Math.max(e.height,2*t.heightMargin+(t.fontSize||0)-(t.topMargin||0)),e.height=Math.ceil(e.height/n.applicationParameters.quarterBaseLine)*n.applicationParameters.quarterBaseLine}),e}(i,t),20),d=r(i,d),s?(i=function(e,t){return e.forEach(function(e){return e.width=t}),e}(i,u),i=o(i,20),d=r(i,d)):a(d,u)||(l||(i=function(e){var t=Math.max.apply(Math,e.map(function(e){return e.width}));return e.forEach(function(e){return e.width=t}),e}(i)),i=o(i,20),d=r(i,d),a(d,u)||(i=function(e,t){return e.forEach(function(e){return e.width=e.width>t?t:e.width}),e}(i,u),d=r(i,d)),c&&l&&(i=function(e,t,i){var n=i.width;return t.forEach(function(t,i){var o,r=t.width;switch(e){case"center":o=(n-r)/2;break;case"right":o=n-r;break;default:o=0}t.offset.x+=o}),t}(c,i,d))),f=i.map(function(e){return function(e,t,i,n){return{offset:i,width:e,height:t,textDimensions:n}}(e.width,e.height,e.offset,e.textDimensions)}),n.setButtonDimensions(e,f),n.validationCache.set(m,t,e,f),d}),this.validationCache.set(g,t,e,v)}return v},e.prototype.setButtonDimensions=function(e,t){var i;(i=e.buttonDimensions).splice.apply(i,[0,e.buttonDimensions.length].concat(ob.deepClone(t)))},e.prototype.syncButtonsDimensions=function(e){var t=(this.flags.lodash4?_.strictMaxBy:_.max)(e.map(function(e){return e.buttonDimensions[0].width}));e.forEach(function(e){return e.buttonDimensions[0].width=t})},e}();e.LayoutElementButtons=t,angular.module("adiCoreAppInternal").service("layoutElementButtons",t)}(S||(S={})),S||(S={}),angular.module("adiCoreAppInternal").factory("LayoutGroup",["$log","$browser","solutionStatusCodes","applicationParameters","heightMutations","$p","SmartLayoutRuleNode","layoutSelectionStoreProvider","modelTree","tpaService","platformService","layoutSelectionStoreSelectionsAdapter","prettyLayoutService","sitePartTypes","flags","segmentFactory","documentServicesMediator","columnsCompatibilityService","columnService","segmentLayoutElements","selections","presetLogs",function(e,t,i,n,o,r,a,s,l,c,d,u,p,h,m,f,v,y,b,S,C,w){var T=o.heightMutations,I=o.heightMutations.slice(0);function x(e,t,i){return t?e+=i:e-=i,e}var P=[{split:"1/2",segments:[460],segmentSignature:"10",leftOffset:0},{split:"1/3",segments:[300],segmentSignature:"100",leftOffset:0},{split:"1/3",segments:[300,300],segmentSignature:"110",leftOffset:0},{split:"1/4",segments:[220],segmentSignature:"1000",leftOffset:0},{split:"1/4",segments:[220,220],segmentSignature:"1100",leftOffset:0},{split:"1/4",segments:[220,220,220],segmentSignature:"1110",leftOffset:0},{split:"1/2 R",segments:[460],segmentSignature:"01",leftOffset:480},{split:"1/3 M",segments:[300],segmentSignature:"010",leftOffset:320},{split:"1/3 R",segments:[300],segmentSignature:"001",leftOffset:640},{split:"1/4 ML",segments:[220],segmentSignature:"0100",leftOffset:240},{split:"1/4 MR",segments:[220],segmentSignature:"0010",leftOffset:480},{split:"1/4 R",segments:[220],segmentSignature:"0001",leftOffset:720},m.newListLayouts&&{split:"(1/4)*2 R",segments:[220,220],segmentSignature:"0011",leftOffset:480},m.newListLayouts&&{split:"(1/3)*2 R",segments:[300,300],segmentSignature:"011",leftOffset:320},m.newListLayouts&&{split:"2/3",segments:[620],segmentSignature:"20",leftOffset:0},m.newListLayouts&&{split:"2/3 R",segments:[620],segmentSignature:"02",leftOffset:320}].filter(Boolean),M=function(){function e(e){if(this.data=e,e&&(this.id=e.id,this.name=e.name,this.targetWidth=e.targetWidth,this.targetHeight=e.targetHeight,this.sitePart=e.sitePart,this.page=e.page,this.segments=e.segments,this.segmentSignature=e.segmentSignature,this.columnPartition=e.columnPartition,this.isGenerator=e.isGenerator,this.asymmetric=e.asymmetric),this.columnPartition)for(var t=0;t<this.segments.length;t++)this.segments[t].partitionIndex=t}return e.setSiteLayoutLoader=function(t){e.siteLayoutLoader=t},e.getLayoutData=function(e){return{id:e.id||e.objectId,isGenerator:!!e.isGenerator,name:e.name,targetWidth:e.targetWidth,targetHeight:e.targetHeight,sitePart:e.sitePart,segments:e.segments,columnPartition:e.columnPartition}},e.createMobileLg=function(){var e=n.defaultForContent.slice();return e.unshift("GeneralDescription"),e.unshift("Contact"),{isGenerator:!1,id:"5680125272e7a231006e2620",name:"single object mobile width",targetWidth:940,targetHeight:80,sitePart:"body",segments:[{forContent:e,isMobile:!0,left:m.consumerMode?0:320,top:0,width:300,height:60}]}},e.createAsymmetricSplitLG=function(t){var i=ob.deepClone(t);i.id=i.name=i.segmentSignature+" Asymmetric Split",i.asymmetric=!0;for(var n=2===i.segmentSignature.length?300:220,o=0,r=i.segments;o<r.length;o++)r[o].width=n;return new e(i)},e.findPartialSegmentsLgId=function(e){return"Partial lg "+_.findIndex(P,function(t){return t.segmentSignature===e})},e.getItemsLgs=function(e){return _.filter(e,function(e){var t=e.segments[0];return t.node&&t.node.isListItem&&["ListHeader","ListFooter"].indexOf(t.contentElement.type)<0})},e.createPartialSegmentsLG=function(){return P.map(function(t,i){for(var o={id:"Partial lg "+i,name:t.split+" split with "+t.segments.length,targetWidth:940,targetHeight:20,sitePart:"body",segments:[],segmentSignature:t.segmentSignature},r=0,a=0;a<t.segments.length;a++){var s=t.segments[a];r=t.leftOffset+a*n.segmentsGap+a*s,o.segments.push({forContent:n.defaultForContent,left:r,top:0,width:s})}return new e(o)})},e.prototype.containingPage=function(){return{sitePart:"header"===this.sitePart&&this.page?this.page:this.sitePart,page:this.page}},e.prototype.autoCrop=function(e,t){for(var i=0,n=this.segments;i<n.length;i++)n[i].autoCrop(e,t)},e.prototype.getSegmentSignature=function(){return this.segmentSignature||(this.segmentSignature=_.fill(new Array(this.segments.length),"1").join("")),this.segmentSignature},e.prototype.getSortedNodeIds=function(){var e=_.map(this.segments,"node.id");return e.sort(function(e,t){if(!e)return-1;if(!t)return 1;for(var i=e.split("."),n=t.split("."),o=0;o<Math.min(i.length,n.length);o++)if(i[o]!==n[o])return i[o].localeCompare(n[o]);return 0}),e},e.prototype.checkIfHeightValidForAllSegments=function(e,t){return this.segments.every(function(i,n){return t?i.isHeightValid(t[n]):i.isHeightValid(e)})},e.prototype.setSegmentsLocationInLG=function(e){for(var t=0;t<e.length;t++){var i=e[t];if(!(i<=1))for(var n=0,o=0;o<i;o++)this.segments[t].top=n,n+=this.segments[t].height+20,t++}},e.prototype.setPage=function(e){this.page=e;for(var t=0,i=this.segments;t<i.length;t++)i[t].page=e},e.prototype.isLGrepeater=function(){return this.id.indexOf("Auto")>-1},e.prototype.isHeader=function(){return"headerLayoutGroup"===this.id},e.prototype.isSiteHeader=function(){return this.isHeader()&&!this.segments[0].node},e.prototype.hasAggregator=function(){return this.segments[0].contentElement.aggregator},e.prototype.setLgData=function(e){var t=this,i="";this.segments.forEach(function(e,n){e instanceof g||(t.segments[n]=f(e),e=t.segments[n]),e.containingLG=t,i+=e.contentElement.type,e.setSitePart(t.sitePart),e.resetOptionalLayoutElements()}),this.contentType=i,this.allContentElements=e,this.forcePretty=this.segments&&!this.columnPartition&&(1===this.segments.length||this.isOnlyListItem())},e.prototype.getCleanLayoutElementById=function(t){return e.siteLayoutLoader.getCleanLayoutElementById(t)},e.prototype.getWantedArgs=function(e){var t;return this.isHeader()?(t=e.calculateWantedArgs(!0,this.isMobile()),this.isSiteHeader()&&(c.hasShoppingCart()&&t.push("shoppingCart"),this.isMobile()&&!_.includes(t,"Menu")&&t.push("Menu"))):t=e.getWantedArgs(this.isMobile()),t},e.prototype.setOptionalLayoutElements=function(t){var i=this;return _.sequencePromises(this.segments,function(n,o){n instanceof g||(i.segments[o]=f(n),n=i.segments[o]);var a,s=i.getWantedArgs(n.contentElement),l=(m.lodash4?_.isEqual:_.eq)(n.wantedArgs,s);if(m.consumerMode&&(!i.isHeader()||m.predefinedHeaderLayout)&&t){if(n.hasPredefinedLayout(s))return n.wantedArgs=s,n.setPredefinedOptionalLayoutElement(),r.when();n.setPredefinedLayout(null)}if(!m.consumerMode||i.isHeader()||n.node.isTpaNode()||(a=n.getLayoutSelectionStore().calculateRequestedClusters(n)),l&&(m.lodash4?_.isEqual:_.eq)(n.requiredClusters,a))return r.when();n.wantedArgs=s,n.requiredClusters=a,-1!==n.forContent.indexOf("ListFooter")||-1!==n.forContent.indexOf("GeneralDescription")?n.heightMutationsArr=I:n.heightMutationsArr=T;var c={};if(n.containingLG=i,i.isHeader()){n.optionalLayoutElements=e.siteLayoutLoader.layoutsForHeader(s,n.width,i.isSiteHeader()?h.HEADER:h.FOOTER);for(var d=0,u=n.optionalLayoutElements;d<u.length;d++){var p=u[d];p.setLGContainer(i),p.setSegContainer(n)}return r.when()}var v=n.contentElement.type;return e.siteLayoutLoader.layoutsForContentElementTypeAndSize(v,s,n.width,a,"footer"===i.page?i.page:i.sitePart).then(function(e){n.cloneOptionalLayoutElements(e);for(var t=0,i=n.optionalLayoutElements;t<i.length;t++){var o=i[t];o.cluster?c[o.cluster]?o.active=!1:(c[o.cluster]=!0,o.active=!0):o.active=!0}})})},e.prototype.changeHeightMutationIndex=function(e){this.selectedHeightMutation=e,this.targetHeight=parseInt(T[this.selectedHeightMutation],10)},e.prototype.getPartitionKey=function(){return this.columnPartition.join("_")},e.prototype.resetLayoutPaddings=function(){var e=this.getLgData().strip;e.presetBottomIs0=void 0,e.presetTopIs0=void 0,e.paddingBottom=40,e.paddingTop=40},e.prototype.tryToSetHeightHandler=function(e,t,n){var o,a=this,s={segmentsHeightChanged:!1,succeed:!1};void 0!==t&&void 0!==n&&(o=t[n]||t[0]);var l=this.checkIfHeightValidForAllSegments(e,o);return this.changeHeightMutationIndex(e),r.when().then(function(){if(l){if(s.segmentsHeightChanged=_.some(a.changeHeightOfSegments(e,o)),a.indexOfChosenColumnPartition=n,s.segmentsHeightChanged||!a.status||a.status===i.unknown)return a.status=i.unknown,a.calculateLayoutGroupStatus(void 0,void 0,!0).then(function(e){e&&(s.succeed=!0)});s.succeed=a.status!==i.fail}}).then(function(){return s.succeed&&a.getLayoutSelectionStore().setLGHeightSelection(a),s})},e.prototype.changeHeightToSpecificIndex=function(e,t){var i=this,n=this.selectedHeightMutation;if(this.columnPartition){if(void 0===t)return r.when(!1);var a=o.getPartitions(this,this.getPartitionKey(),e);return this.tryToSetHeightHandler(e,a,t).then(function(e){return e.succeed?(i.indexOfChosenColumnPartition=t,i.setSegmentsLocationInLG(i.columnPartition),!0):(e.segmentsHeightChanged&&i.changeHeightOfSegments(n),!1)})}return this.tryToSetHeightHandler(e).then(function(e){return!!e.succeed||(e.segmentsHeightChanged&&i.changeHeightOfSegments(n),!1)})},e.prototype.changeHeightToSpecificIndexIgnoringPartitions=function(e){var t=this;if(this.forcePretty){var i=(m.lodash4?_.strictMaxBy:_.max)(_.map(this.segments,function(e){var t=e.getLENoError();return t&&p.getLayoutPrettyHeight(t)||0})),n=o.heightMutations.indexOf(i),a=e-n;return this.getLayoutSelectionStore().setLGAdditionalHeight(this,a),this.isDirty=!0,this.calculateLayoutGroupStatus(void 0,void 0,!0)}if(!this.columnPartition)return this.changeHeightToSpecificIndex(e);var s=!1,l=0,c=o.getPartitions(this,this.getPartitionKey(),e);return function e(t,i,n){return n=n||r.defer(),i()?t().then(function(){return e(t,i,n)}):n.resolve(),n.promise}(function(){return t.changeHeightToSpecificIndex(e,l).then(function(e){s=e,l++})},function(){return!s&&c&&l<c.length}).then(function(){return s})},e.prototype.tryToChangeSegHeight=function(e,t){var i=this;return r.when().then(function(){if(!i.columnPartition)return i.changeHeightToSpecificIndexIgnoringPartitions(T.indexOf(t));var n,r=o.getPartitionsValues(i,i.getPartitionKey(),i.selectedHeightMutation)[i.indexOfChosenColumnPartition],a=_.findIndex(T.slice(i.selectedHeightMutation),function(a,s){var l=o.getPartitionsValues(i,i.getPartitionKey(),s);if(l){var c=_.findIndex(l,function(i){return _.every(i,function(i,n){return n===e?i>=t:i>=r[n]})});if(-1!==c)return n=c,!0}});return!(!n||!a)&&i.changeHeightToSpecificIndex(a,n)})},e.prototype.aggregatorUniqueId=function(e){for(var t="",i=0,n=e;i<n.length;i++){var o=n[i];o.isSpecialListItem()&&(t+=o.type)}return t},e.prototype.clearCache=function(){this.uniqueId=void 0;for(var e=0,t=this.segments;e<t.length;e++)t[e].clearCache()},e.prototype.resetForRecalc=function(){var e=this.getLayoutSelectionStore(),t=this.getUniqueIdForSolution();this.isDirty=!0,this.clearCache();for(var i=0,n=this.segments;i<n.length;i++)n[i].wantedArgs=void 0;S.deleteSegmentsByLg(this);var o=this.getUniqueIdForSolution();e.copyLgRelatedData(this.page,t,o,!0)},e.prototype.getUniqueIdForSolution=function(e,t){if(void 0===e&&(e=!1),void 0===t&&(t=!1),!this.uniqueId||t){var i=this.getSortedNodeIds(),n=this.id+_.reduce(i,function(e,t){return t?e+t+"#":e},"");if(n.indexOf("#")>-1){if(this.hasAggregator()&&(n+=this.aggregatorUniqueId(this.segments[0].contentElement.ceArray)),e||t)return n;this.uniqueId=n}else this.uniqueId="header";this.sitePart!==h.BODY&&this.isMobile()&&(this.uniqueId=this.uniqueId+"-mobile")}return this.uniqueId},e.prototype.findIdentifyingNodeId=function(){return this.segments[0].findIdentifyingNodeId()},e.prototype.findIdentifyingNode=function(){return this.segments[0].findIdentifyingNode()},e.prototype.getBoundingTop=function(){var e=this.getLgData(),t=this.top||0;return e.strip.enable&&this.contentType!==n.tpaTypes.Blog.type?t-=e.strip.paddingTop:e.topLine.enable&&"space"===e.topLine.line&&(t-=e.topLine.space),t},e.prototype.getBoundingHeight=function(){var e=this.getLgData(),t=this.targetHeight;if(e.strip.enable&&this.contentType!==n.tpaTypes.Blog.type){if(this.columns){var i=b.getRowsHeight(this,!1,!0);t=(m.lodash4?_.strictSumBy:_.sum)(i)}this.isMobile()&&this.getDesktopLG()?(this.isMobileFirstLG()&&(t+=e.strip.paddingTop),this.isMobileLastLG()&&(t+=e.strip.paddingBottom)):t+=e.strip.paddingTop+e.strip.paddingBottom}else e.topLine.enable&&"space"===e.topLine.line&&(t+=e.topLine.space),e.bottomLine.enable&&"space"===e.bottomLine.line&&(t+=e.bottomLine.space);return t},e.prototype.getLgData=function(){return this.getLayoutSelectionStore().getLgData(this.getUniqueIdForSolution(),this.page)},e.prototype.getColumnsData=function(){var e=this.getLayoutSelectionStore().getColumnsData(this.segments[0]);return y.ensureColumnsDataFormat(this,e),e},e.prototype.setColumnsData=function(e){if(!this.isMobile()){y.ensureColumnsDataFormat(this,e);var t=this.getLayoutSelectionStore();t.setColumnsData(this.segments[0],e),this.segments.length>1&&t.setColumnsData(this.segments[1],e)}},e.prototype.getTypeForLSSWithoutNodeId=function(){return this.typeForLSSWithoutNodeId?this.typeForLSSWithoutNodeId:(this.typeForLSSWithoutNodeId=this.contentType+"|"+this.segments[0].getTypeForLSSWithoutNodeId(),this.typeForLSSWithoutNodeId)},e.prototype.getTypeForLSS=function(){return this.typeForLSS?this.typeForLSS:(this.typeForLSS=this.contentType+"|"+this.segments[0].getTypeForLSS(),this.typeForLSS)},e.prototype.hasLEsEverySeg=function(){return _.every(this.segments,function(e){return e.getOptionalLayoutElements().length>0})},e.prototype.hasValidSegsForPartition=function(e){var t=_.map(e,function(e){return T[e]});return _.every(this.segments,function(e,n){return _.every(e.getOptionalLayoutElements(),{solutionStatus:i.unknown})||e.minPassingHeight()<=t[n]})},e.prototype.getAdditionalHeight=function(){return this.getLayoutSelectionStore().getLGAdditionalHeight(this)*n.gridStep},e.prototype.changeLgHeight=function(e,i){var n,a,s=this;if(i=i||1,this.forcePretty){var l=this.getLayoutSelectionStore().getLGAdditionalHeight(this);return l=x(l,e,i),this.getLayoutSelectionStore().setLGAdditionalHeight(this,l),this.isDirty=!0,this.calculateLayoutGroupStatus(void 0,void 0,!0)}var c=this.indexOfChosenColumnPartition,d=!0,u=this.selectedHeightMutation||0,p=this.selectedHeightMutation;-1===p&&(p=o.defaultHeight);var h=r.defer(),g=this.columnPartition?function(){if(!(n=o.getPartitions(s,s.getPartitionKey(),u)))return d=!1,r.when();d&&void 0!==s.indexOfChosenColumnPartition||(a=e?0:n.length-1),d=!1;var t=!1;return _.whilePromises(function(){return!t&&(e?a<n.length:a>=0)},function(){if(s.hasValidSegsForPartition(n[a]))return s.tryToSetHeightHandler(u,n,a).then(function(n){n.succeed?(s.indexOfChosenColumnPartition=a,s.setSegmentsLocationInLG(s.columnPartition),t=!0):a=x(a,e,i)});a=x(a,e,i)}).then(function(){return t})}:function(){return s.tryToSetHeightHandler(u).then(function(e){return e.succeed})},f=function(){var r=_.map(s.segments,function(e){return e.minPassingHeight()});if(s.columnPartition&&d&&void 0!==s.selectedHeightMutation&&void 0!==s.indexOfChosenColumnPartition&&-1!==s.selectedHeightMutation)u=s.selectedHeightMutation,a=x(s.indexOfChosenColumnPartition,e,i);else{var l=(m.lodash4?_.strictMaxBy:_.max)(r),v=T.indexOf(l);u=_.isFinite(l)?e&&v>u?v:!e&&v>=u?-1:x(u,e,i):-1}u>=0&&u<T.length&&s.hasLEsEverySeg()?g().then(function(e){e?(t.$$completeOutstandingRequest(_.noop),h.resolve(!0)):f()}):(s.indexOfChosenColumnPartition=c,s.columnPartition&&(n=o.getPartitions(s,s.getPartitionKey(),p)),s.tryToSetHeightHandler(p,n,c)).then(function(){t.$$completeOutstandingRequest(_.noop),h.resolve(!1)})};return f(),t.$$incOutstandingRequestCount(),h.promise},e.prototype.handleSmartLayoutMutationWithHeight=function(e,t){var i=10*Math.floor(t.height/10);if(this.columnPartition){var n=1,r=this.getPartitionKey(),a=this.segments.indexOf(e),s=o.getPartitionLength(this,r);do{var l=o.getPartitionsValues(this,r,this.selectedHeightMutation+1);if(l){for(var c=[],d=0,u=l.length;d<u.length;d++){for(var p=u[d],h=!0,g=0;g<this.segments.length;g++)if(parseInt(p[g],10)<this.segments[g].height||g===a&&parseInt(p[a],10)<i){h=!1;break}h&&c.push(p)}if(c.length>0){var m=o.heightMutations[this.selectedHeightMutation+n];e.mutation={id:t.id,height:m,partition:l.indexOf(c[0])};break}n++}else n++}while(this.selectedHeightMutation+n<s)}else e.mutation={id:t.id,height:i}},e.prototype.handleSmartLayoutMutation=function(e,t){var i=e.containingSegment;i&&i.isSelectedLE(e)&&t&&this.handleSmartLayoutMutationWithHeight(i,e)},e.prototype.chooseLayoutElementOption=function(e,t){var i=this,n=this.getPageDescriptor();return(t?this.getLayoutSelectionStore().tryToSetLESelectionForSegmentWithFallBack(n,e,t):r.when(this.getLayoutSelectionStore().tryToSetLESelectionForSegment(n,e,!1))).then(function(t){if(!t)return!(m.consumerMode&&!i.isSpecialContentElement()||(e.chooseNextlayoutElementOption(1),0));if(i.getLayoutSelectionStore().setLESelection(n,e,e.getLE().id),_.get(e,"node.contentElement.allValuesByMediaType.image[0]"))if(e.shouldAlignImage())m.stripFocalPoint&&m.focalPointFocusOnFaces?e.faceDetectionAutoFocalPoint():e.alignStripImage();else{var o=e.getMediaOverrides();o&&o.name.includes("Image")&&e.faceDetectionAutoCrop()}return!0})},e.prototype.isSpecialContentElement=function(){var e=this.segments[0];return e.node&&e.node.isTpaNode()||e.isContact()},e.prototype.setHeightFromLSS=function(){if(!this.forcePretty){var e=this.getLayoutSelectionStore().getLGHeightSelection(this)||0;if(void 0===this.userSelectedHeight&&(this.userSelectedHeight=e),this.changeHeightMutationIndex(e),this.columnPartition){var t=this.getLayoutSelectionStore().getLGPartitionSelection(this),i=o.getSpecificPartition(this,this.getPartitionKey(),e,t);this.changeHeightOfSegments(e,i),this.indexOfChosenColumnPartition=t,this.setSegmentsLocation()}else this.changeHeightOfSegments(e);this.getLayoutSelectionStore().setLGHeightSelection(this)}},e.prototype.revalidateMediaOverrides=function(){if(!this.isHeader()&&this.containingSolution&&this.containingSolution.isSelectedSolution())for(var e=0,t=this.segments;e<t.length;e++){var i=t[e];i.revalidateMediaOverrides(),i.setOverrides()}},e.prototype.chooseLayoutElementOptionAndChangeHeight=function(e,t){var i=this;return(this.isHeader()||this.forcePretty?r.when(e.chooseLayoutElementOptionById(t,!0)).then(function(){return i.ensureHeightMatchesContent()}):e.chooseLayoutElementOptionAndChangeHeight(t)).then(function(){return i.isDirty=!0,i.calculateLayoutGroupStatus(e.contentElement)})},e.prototype.changeLayoutGroupHeight=function(e){var t=e;m.mobileNoGrid&&this.isMobile()&&(t=n.getValidHeight(e));var i=o.heightMutations.indexOf(t);return this.selectedHeightMutation!==i&&this.changeHeightMutationIndex(i),m.mobileNoGrid&&this.isMobile()&&(this.targetHeight=e),_.sequencePromises(this.segments,function(t){var n=t.getLENoError();if(t.height=e,t.selectedHeightMutation=i,n){var o=n.getMasterLe();return(e<n.height?o.shrink():r.when()).then(function(){e>n.height&&o.mutateByStretching(e)})}})},e.prototype.ensureHeightMatchesContent=function(){if(!this.isHeader()&&!this.forcePretty)return r.when();var e=(m.lodash4?_.strictMaxBy:_.max)(_.map(this.segments,function(e){var t=e.getLENoError();return t&&(t.wantedHeight||t.height)||0}));return this.changeLayoutGroupHeight(e)},e.prototype.calculateColumns=function(){this.columns=b.createColumns(this)},Object.defineProperty(e.prototype,"isDirty",{get:function(){return this._isDirty},set:function(e){this.increasePageLastRenderRevisionIfMobileLg(e),this._isDirty=e},enumerable:!0,configurable:!0}),e.prototype.calculateLayoutGroupStatusForPresetPreview=function(){var e=this;return this.isDirty=!1,this.status=i.pass,this.setHeightFromLSS(),this.ensureHeightMatchesContent().then(function(){return e.revalidateMediaOverrides()}).then(function(){m.coreNewMobileColumns?e.status===i.pass&&e.calculateColumns():e.status!==i.pass||e.isMobile()||e.calculateColumns()})},e.prototype.setSegmentsPredefinedLayout=function(){for(var e=0,t=this.segments;e<t.length;e++){var i=t[e];i.setPredefinedLayout(i.getOptionalLayoutElements()[i.selectedOption])}},e.prototype.clearSegmentsPredefinedLayout=function(){for(var e=!1,t=0,i=this.segments;t<i.length;t++){var n=i[t];n.hasPredefinedLayout()&&(n.wantedArgs=void 0,e=!0,n.setPredefinedLayout(null))}return e},e.prototype.calculateLayoutGroupStatus=function(e,t,n,o){var a=this;return this.status&&this.status!==i.unknown&&!this.isDirty?r.when(this.status===i.pass):this.setOptionalLayoutElements(!0).then(function(){return(n?_.sequencePromisesThenAll:_.allPromises)(a.segments,function(i){return i.calculateSegmentStatus(e,t)})}).then(function(){var t=_.every(a.segments,function(e){return _.some(e.getOptionalLayoutElements(),function(e){return e.isValidForHeight()})}),s=_(a.segments).filter("mutation").map("mutation").value();if(!a.forcePretty&&o&&s.length>0){a.selectedHeightMutation=-1;var l=(m.lodash4?_.strictMaxBy:_.max)(s,function(e){return e.height}),c=T.indexOf(l.height);return a.changeHeightToSpecificIndex(c,l.partition).then(function(){for(var e=0,t=a.segments;e<t.length;e++){var n=t[e];if(n.mutation&&n.mutation.id){var o=n.mutation.id;n.chooseLayoutElementOptionById(o),n.mutation=null}}a.status=i.pass})}return r.when().then(function(){if(!t&&!n){var e=a.selectedHeightMutation;return a.selectedHeightMutation=-1,a.status=i.fail,a.isHeader()||a.forcePretty?(a.segments[0].selectedOption=-1,!1):a.changeLgHeight(!0).then(function(t){return t||a.changeHeightMutationIndex(e),t})}}).then(function(n){if(t||n)return _.sequencePromises(a.segments,function(t){return a.chooseLayoutElementOption(t,(e||a.isDirty)&&a.getLayoutSelectionStore().getPreferredLayoutData(t))}).then(function(e){if(_.every(e))return a.ensureHeightMatchesContent().then(function(){a.status=i.pass});a.status=i.fail});a.status=i.fail})}).then(function(){var r=a.status===i.pass;if(m.consumerMode&&(!a.isHeader()||m.predefinedHeaderLayout))if(r)a.setSegmentsPredefinedLayout();else if(a.clearSegmentsPredefinedLayout())return a.calculateLayoutGroupStatus(e,t,n,o);return a.revalidateMediaOverrides(),a.isDirty=!1,m.coreNewMobileColumns?!r||a.segments[0].node&&a.segments[0].node.isTpaWidget||a.calculateColumns():!r||a.isMobile()||a.segments[0].node&&a.segments[0].node.isTpaWidget||a.calculateColumns(),r})},e.prototype.increasePageLastRenderRevisionIfMobileLg=function(e){this.isMobile()&&e&&l.increasePageLastRenderRevision(this.page)},e.prototype.getPageDescriptor=function(){return this.segments.length&&this.segments[0].node&&this.segments[0].node.crossPageConnected?"general":this.page||this.sitePart},e.prototype.resetSegMutation=function(){for(var e=0,t=this.segments;e<t.length;e++)t[e].mutation=void 0},e.prototype.changeListHeaderAlignToCenter=function(e,t,i){var n=u.getOrCreateVariations(e,t);n&&(n[i]={button:{hPosition:"center"},title:{align:"center"},subTitle:{align:"center"},longText:{align:"center"}})},e.prototype.changeListFooterAlignToCenter=function(e,t,i){var n=u.getOrCreateVariations(e,t);n&&(n[i]={button:{hPosition:"center"},longText:{align:"center"}})},e.prototype.applyLayoutPreset=function(e){var t=this;w.trace("lg.applyLayoutPreset",this,e);var i=o.heightMutations.indexOf(e.height),n=this.getUniqueIdForSolution();this.forcePretty?this.getLayoutSelectionStore().setLGAdditionalHeight(this,e.additionalHeight||0):(this.changeHeightMutationIndex(i),this.getLayoutSelectionStore().setLGHeightSelection(this)),this.setColumnsData(e.columns);var a=this.getPageDescriptor();return this.isDirty=!0,_.sequencePromises(this.segments,function(s,c){var d=e.partitions&&e.partitions[s.partitionIndex],p=d&&o.heightMutations.indexOf(d.height)||i;t.forcePretty||s.changeSegmentHeight(p);var h=d||e.layouts&&e.layouts[c];if(h&&h.leId){w.trace("applyLayoutPreset for segment",c,s,h);var g,f=h.selections,v=s.getLayoutDataFromPreset(h);if(!t.isHeader()){var y=h.cluster;g=t.getLayoutSelectionStore().calculateFallBackClusterAndStructure(s,v),w.trace("fallbackCluster",g);var b=s.node&&s.node.isListHeader(),S=s.node&&s.node.isListFooter(),C=g&&y!==g.cluster;if((C||b||S)&&(f=ob.deepClone(h.selections))){var T="1"===t.segmentSignature;if(m.newListLayouts&&!T||(b?t.changeListHeaderAlignToCenter(f,s.node,y):S&&t.changeListFooterAlignToCenter(f,s.node,y)),C){var I=u.getVariations(f,s.node);I&&I[y]&&(I[g.cluster]=I[y])}}}if(f&&(t.getLayoutSelectionStore().setOverridesForNodeFromDB(s.node||l.getGeneralInformation(),f,a,n,s.isMobile,s.getTypeForLSSWithoutPartition()),s.setOverrides()),m.consumerMode&&!s.isMobile&&t.getLayoutSelectionStore().setOverride("media",s,"allowedMediaOverrides",h.mediaType),h.fontOverrides){var x=(P=t.getLayoutSelectionStore()).fontOverridesManager.getOrInitOverrideObject(s.node);(m.lodash4?_.isEqual:_.eq)(x,h.fontOverrides)||_.assign(x,h.fontOverrides)}if(h.menuOverrides&&t.isSiteHeader()){var P=t.getLayoutSelectionStore();_.assign(P.menuOverridesManager.menuOverrides,h.menuOverrides)}return(t.isHeader()?s.inflateCluster(0,!0).then(function(){var e=s.getOptionalLayoutElements(),i=_.find(e,{id:h.leId})||e[t.getLayoutSelectionStore().calculateFallBackLEIndexForHeader(s,v)];return _.indexOf(e,i)}):g?t.getLayoutSelectionStore().calculateFallBackLEIndexFromCluster(s,v,g,!1):r.when()).then(function(e){var i=s.getOptionalLayoutElements()[e];if(i&&i.isPassing()){t.getLayoutSelectionStore().setPreferredLayoutData(s,v),t.getLayoutSelectionStore().setManualLESelection(a,s,i.id,!0),!m.consumerMode||t.isHeader()&&!m.predefinedHeaderLayout||s.setPredefinedLayout(i);var n=s.getLENoError();n&&i.cluster&&i.cluster===n.cluster&&(n.active=!1),i.active=!0,s.selectedOption=e,i.isValidForHeight()||t.handleSmartLayoutMutationWithHeight(s,i);var o=s.shouldAlignImage(),r=_.get(s,"node.contentElement.allValuesByMediaType.image[0]"),l=s.getMediaOverrides();return r&&(o?m.stripFocalPoint&&m.focalPointFocusOnFaces?s.faceDetectionAutoFocalPoint():s.alignStripImage():l&&l.name.includes("Image")&&s.faceDetectionAutoCrop()),!0}w.trace("failed to solve segment",s,s.getOptionalLayoutElements(),e)})}})},e.prototype.clearLineRefs=function(){this.lineRefs=[]},e.prototype.addLineRef=function(e){this.lineRefs.push(e)},e.prototype.setAnchorRefs=function(e){this.anchorRefs=e},e.prototype.setDecorativeStripRef=function(e){this.decorativeStripRef=e},e.prototype.setComponentRef=function(e){this.componentRef=e},e.prototype.setStripComponentRef=function(e){this.stripComponentRef=e},e.prototype.setColumnsComponentRef=function(e){this.columnsComponentRef=e},e.prototype.setRenderedDecorativeStripRef=function(e){this.renderedDecorativeStripRef=e},e.prototype.isListHeader=function(){return _.every(this.segments,function(e){return e.contentElement&&"ListHeader"===e.contentElement.type})},e.prototype.isListFooter=function(){return _.every(this.segments,function(e){return e.contentElement&&"ListFooter"===e.contentElement.type})},e.prototype.isSpecialListItem=function(){return _.every(this.segments,function(e){return e.contentElement&&e.contentElement.isSpecialListItem()})},e.prototype.isOnlyListItem=function(){return _.every(this.segments,function(e){return e.contentElement&&e.node&&!e.contentElement.isSpecialListItem()&&e.node.isListItem})},e.prototype.getRenderedHeight=function(){return this.rendererHeight||this.targetHeight},e.prototype.changeHeightOfSegments=function(e,t){return _.map(this.segments,function(i,n){return t?i.changeSegmentHeight(t[n]):i.changeSegmentHeight(e)})},e.prototype.setSegmentsLocation=function(){this.setSegmentsLocationInLG(this.columnPartition)},e.prototype.getLayoutSelectionStore=function(){return s.getLayoutSelectionStore(this.page||this.sitePart)},e.prototype.getComponentRefs=function(){var e=[],t=this.getLgData(),i=t&&t.strip&&t.strip.enable;i&&e.push(this.decorativeStripRef);var n=this.segments[0]&&this.segments[0].node;return(!i||n&&n.isTpaNode())&&e.push(this.componentRef),e=(e=e.concat(this.lineRefs)).concat(this.anchorRefs),n&&n.isTpa&&e.push(c.getCompRef(n.contentElementType)),n&&n.isTpaWidget&&e.push(n.widgetRef),_.compact(e)},e.prototype.playAnimations=function(){this.segments[0].node&&this.segments[0].node.isTpaNode()||v.previewAllSetAnimations(this.columnsComponentRef||this.componentRef,"screenIn")},e.prototype.canChangeScrollType=function(){return _.some(this.segments,function(e){return e.canChangeScrollType()})},e.prototype.setDesktopSegment=function(e){this.setPage(e.page);var t=this.segments[0];t.isMobile&&(this.desktopSegment=e,t.node=e.node,t.contentElement=e.contentElement)},e.prototype.isFloatingColumns=function(){if(!m.floatingColumns)return!1;var e=this.getColumnsData();return e&&e.columnVOffset},e.prototype.isMobile=function(){return this.segments[0].isMobile},e.prototype.getDesktopLG=function(){return this.isMobile()?this.desktopSegment&&this.desktopSegment.containingLG:this},e.prototype.getMobileSegmentIndexInDesktop=function(){var e=this;if(m.floatingColumns)return this.getMobileSiblingLGs().indexOf(this);var t=this.getDesktopLG();return _.findIndex(t.segments,function(t){return t===e.desktopSegment})},e.prototype.isMobileFirstLG=function(){return 0===this.getMobileSegmentIndexInDesktop()},e.prototype.isMobileLastLG=function(){var e=this.getMobileSiblingLGs();return e.indexOf(this)===e.length-1},e.prototype.getMobileFirstLG=function(){return m.floatingColumns?this.getMobileSiblingLGs()[0]:this.getDesktopLG().segments[0].mobileLg},e.prototype.getMobileSiblingLGs=function(){var e=this.getDesktopLG();return _.map(e.segments,"mobileLg")},e.prototype.getMobileLGOffset=function(){var e=0,t=this.getMobileSegmentIndexInDesktop();if(t>0){var i=this.getLgData();e+=i.strip&&i.strip.enable&&i.strip.paddingTop||0;var n=this.getMobileSiblingLGs()[t-1],o=n.getLgData();e+=o.strip&&o.strip.enable&&o.strip.paddingBottom||0,e+=n.targetHeight+n.getMobileLGOffset()}return e},e.prototype.getColumnsHeight=function(){return(m.lodash4?_.strictSumBy:_.sum)(b.getRowsHeight(this,!1,!0))},e.prototype.setAsDirty=function(e){if(this.isDirty=!0,e)for(var t=0,i=this.segments;t<i.length;t++){var n=i[t].getMobileLg();n&&n.setAsDirty()}},e.prototype.isZigZagWithColumns=function(){var e=this.getColumnsData(),t=e&&e.enable&&e.colSplit;return this.hasZigZag(AdiCoreSanta.zigZagType.colsOrRows)&&t},e.prototype.hasZigZag=function(e){void 0===e&&(e=AdiCoreSanta.zigZagType.cols);var t=this.segments[0],i=t.node;if(i&&i.isListItem&&!this.isMobile()){var n=C.getForNode(t.findIdentifyingNode());if(n.zigZag)switch(e){case AdiCoreSanta.zigZagType.cols:return n.zigZag.cols;case AdiCoreSanta.zigZagType.rows:return n.zigZag.rows;case AdiCoreSanta.zigZagType.colsOrRows:return n.zigZag.cols||n.zigZag.rows}}return!1},e}();return AdiCoreSanta.setLayoutGroup(M),M}]),angular.module("adiCoreAppInternal").factory("layoutSolver",["$log","obMonitoring","siteLayoutLoader","$p","modelTree","ContentElement","solutionStatusCodes","LayoutGroup","SitePartSolutions","Solution","layoutSelectionStoreProvider","storyServices","spinnerService","themeChooser","sitePartTypes","nodeFilterTypes","applicationParameters","defaultsService","layoutDecoration","flags","designKit","pagesManager","selections","mediaOverride","BoxDecorationTypes","slideShowService","segmentLayoutElements","presetLogs","mediaOpacity","sectionInlineMediaService",function(e,t,i,n,o,r,a,s,l,c,d,u,p,h,g,m,f,v,y,b,S,C,w,T,I,x,P,M,L,k){var $={},A={};function E(e){return e?i.mobileHeaderLayoutGroup:i.headerLayoutGroup}function D(e,t){var i=e.forContent,n=-1!==o.getListNodes().indexOf(t)&&-1!==i.indexOf("AnyList"),r=-1!==o.getAvailableWidgetsTypes().indexOf(t)&&-1!==i.indexOf("AnyWidget"),a=-1!==o.getAvailableTpaTypes().indexOf(t)&&-1!==i.indexOf("AnyTpaSection");return Array.isArray(i)?-1!==i.indexOf(t)||n||r||a:i===t||n||r||a}function F(e,t,i){return!i.aggregator&&1===e&&t.layoutFilter===m.FULL||!i.aggregator&&e>1&&t.layoutFilter===m.PART||i&&i.aggregator&&t.layoutFilter===m.AGGREGATOR}function B(e,t){var n=function(e,t){return _(e).take(t).map(function(e){return Array.isArray(e)?_.map(e,"node.id").join("|"):e.node.id}).join("_")}(e,t);if(!A[n]){var r=!1,a=_.every(_.take(e,t),function(e){return Array.isArray(e)?(r=!0,_.every(e,function(e){return(e.ce.isSpecialListItem()?e.node.layoutFilter:o.findIdentifyingNode(e.node).layoutFilter)===m.REPEATER})):e.node.layoutFilter===m.PART});if(r&&a){var s=e.slice(0,t),l=function(e){var t="";return angular.forEach(e,function(e){Array.isArray(e)?t+="r"+e.length:t+="s"}),t}(s);i.autoGeneratedGroups[l]||function(e,t){i.autoGeneratedGroups[t]=[];var n=[];_.each(e,function(e){if(Array.isArray(e)){var t=-1;_.each(e,function(e){e.ce.isSpecialListItem()?n.push(e):-1===t?(n.push([e]),t=n.length-1):n[t].push(e)})}else n.push(e)}),angular.forEach(N,function(e){!function(e,t,i){var n=_.filter(e,function(e){return!Array.isArray(e)}),o=20*n.length,r=0;if(n.length>0&&(r=(f.fullWidth-t-o)/n.length)<220)return;var a=_.map(e,function(e){return Array.isArray(e)?t:r});if(r*n.length+t+o===f.fullWidth)for(var s=1;s<=R;s++)H(e,a,s,i)}(n,e,t)})}(s,l),A[n]=i.autoGeneratedGroups[l]}else"GeneralDescription"===e[0].type?A[n]=1===t?[E(!b.consumerMode&&b.mobileEditorPresets)]:[]:A[n]=i.layoutGroups.filter(function(i){return i.segments.length===t&&i.segments.every(function(i,n){return D(i,e[n].type)&&F(t,e[n].node,e[n].ce)})})}return A[n]}function O(e){var t=(e-60)/80;return e>=220&&parseInt(t)===t}function H(e,t,n,o){for(var r="Auto",a=[],l=[],c=0;c<e.length;c++){var d=t[c],u=c*f.segmentsGap+(b.lodash4?_.strictSumBy:_.sum)(t.slice(0,c));if(Array.isArray(e[c])){var p=(d-(n-1)*f.segmentsGap)/n;if(!(e[c].length>=n&&O(p)))return;r=r+"|p"+n+e[c].length+d;for(var h=n,g=e[c].slice();h>0;){for(var m=Math.ceil(g.length/h),v=0;v<m;v++)a.push({forContent:f.defaultForContent,left:u,top:0,width:p});g.splice(0,m),u+=p+f.segmentsGap,l.push(m),h--}}else{if("ListFooter"===e[c].type)return;r=r+"|"+c+d,a.push({forContent:f.defaultForContent,left:u,top:0,width:d}),l.push(1)}}var y={id:r,name:r,targetWidth:940,targetHeight:940,sitePart:"body",segments:a,columnPartition:l};i.autoGeneratedGroups[o].push(new s(y))}var R=3,N=[220,300,460,620,700];function U(e){return!!e.columnPartition}function V(e,t,n){var o,r,a;if(0===e.length)n(t);else{if(Array.isArray(e[0])&&1===_.uniq(_.map(e[0],"type")).length)for(r=function(e,t){var n=function(e,t){var i=e.parent.id+"_"+t;return e.parent.asymmetric&&(i+="_asymmetric"),i}(e,t);if(!$[n]){var o=i.layoutGroups.filter(function(i){var n=i.segments.length;return t%n==0&&e.parent.asymmetric===i.asymmetric&&i.segments.every(function(t){return D(t,e.type)&&F(n,e.parent,e.ce)})});$[n]=o.map(function(e){for(var i=[],n=0;n<t/e.segments.length;n++)i.push(e);return i})}return $[n]}(e[0][0],e[0].length),r=_.groupBy(r,function(e){return e.length+(e[0]&&e[0].columnPartition?"p":"")}),r=_.map(r,_.unzip),a=0;a<r.length;a++)o=t.slice().concat(r[a]),V(e.slice(1),o,n);for(var s=1;s<=e.length;s++)(r=B(e,s)).length&&(r=_.groupBy(r,U),_.each(r,function(i){(o=t.slice()).push(i),V(e.slice(s),o,n)}))}}function z(e){if(!i.layoutGroups||0===i.layoutGroups.length)return 0;var t=[];return A={},$={},V(e,[],function(e){t.push(e)}),t}function j(){return u.story.selectedPage}function W(){return ye.createFooterSolutions().then(function(){if(u.story){var e=ye.getAllSolutions(g.FOOTER),t=ye.getSelectedSolutionIndex(g.FOOTER);if(e&&(!e[t]||e[t].status!==a.pass))return ye.moveToNextValidSolution(g.FOOTER,void 0,!0)}})}function G(e,t){var i=j(),r=o.findPageNodeByName(i);return!0!==e&&r&&!1===r.dirty?n.when().then(function(){if(b.consumerMode){if(r.dusty)return u.reRender(g.BODY);var e=ye.getPartSolutions(g.BODY,i);u.emitRenderedPart(g.BODY,e.getSelectedSolution(),e.getSolutionHeight(),i,"desktop")}else u.emitLayoutSolutionChanged()}):(p.waitForMe("calculateCurrentPage",!0),b.twoButtonSection||P.deleteSegments(i),ye.calculateCurrentPage().then(function(){if(u.story){var e=ye.getAllSolutions(g.BODY,i),t=ye.getSelectedSolutionIndex(g.BODY,i);if(e&&(!e[t]||e[t].status!==a.pass))return ye.moveToNextValidSolution(g.BODY,i,!0)}}).then(function(){if(ye.withMissingSolutions)return ye.calculateMissingPageSolutions()}).then(function(){if(!t)return b.consumerMode?u.reRender():u.emitLayoutSolutionChanged()}).then(function(){r&&r.colorDirty&&(S.setDefaultKitConfigurationForPage(i),r.colorDirty=!1),p.imDone("calculateCurrentPage",!0)}))}function K(e){var t=_.uniq(_.map(e,function(e){return e.getId()}));_.each(t,function(e){_.each(oe,function(t){_.each(t,function(i,n){n.indexOf(e+"#")>-1&&t[n].setAsDirty(!0)})})})}function q(i,n,o,r,a){if(t.mark({name:"onNodeChanged"}),e.debug("Node changed - recalculating"),b.perfRenderInPostInit)return Y(r,o).then(function(){return X()}).then(function(){t.measure({name:"onNodeChanged"})});if(_.each(oe,function(e){_.each(e,function(t,i){t&&t.hasAggregator()&&delete e[i]})}),"delete"===r||"userHidden"===r){var s=_.uniq(_.map(o,function(e){return e.getId()}));_.each(s,function(e){_.each(oe,function(t){_.each(t,function(i,n){n.indexOf(e+"#")>-1&&delete t[n]})})})}if("reorderList"===r){var l=o[0].containerPageId,c=ye.getSelectedSolutionIndex(g.BODY,l);ye.keepSolutionIndex={},ye.keepSolutionIndex[l]=c}return G(!0,!0).then(function(){return W()}).then(function(){return b.perfDontWaitForRenderInInit&&a&&a(),b.consumerMode?u.reRender():u.emitLayoutSolutionChanged()}).then(function(){t.measure({name:"onNodeChanged"})})}function Y(e,t){return _.each(oe,function(e){_.each(e,function(t,i){t&&t.hasAggregator()&&delete e[i]})}),"delete"===e||"userHidden"===e?function(e){var t=_.uniq(_.map(e,function(e){return e.getId()}));_.each(t,function(e){_.each(oe,function(t){_.each(t,function(i,n){n.indexOf(e+"#")>-1&&delete t[n]})})})}(t):"reorderList"===e&&function(e){var t=e[0].containerPageId,i=ye.getSelectedSolutionIndex(g.BODY,t);ye.keepSolutionIndex={},ye.keepSolutionIndex[t]=i}(t),function(e){return G(e,!0).then(function(){return W()})}(!0)}function X(){return n.when().then(function(){return b.consumerMode?u.reRender():u.emitLayoutSolutionChanged()})}function Z(e,t,i){return e!==g.BODY?(!ye.siteSolutions[e]&&i&&(ye.siteSolutions[e]=new l(e===g.FOOTER?e:"",e)),b.consumerMode&&ye.siteSolutions[e]&&(!ye.siteSolutions[e].selectedSolution||ye.siteSolutions[e].selectedSolution<0)&&(ye.siteSolutions[e].selectedSolution=0),ye.siteSolutions[e]):(t=t||"",!ye.siteSolutions[e][t]&&i&&(ye.siteSolutions[e][t]=new l(t,e),function(e,t){var i=ye.filters&&ye.filters[t];i&&(e.filters=i.filters,e.lockedLgs=i.lockedLgs),ye.keepSolutionIndex&&void 0!==ye.keepSolutionIndex[t]&&(e.forceSelectedSolution=ye.keepSolutionIndex[t],ye.keepSolutionIndex=void 0)}(ye.siteSolutions[e][t],t)),b.consumerMode&&ye.siteSolutions[e]&&ye.siteSolutions[e][t]&&(!ye.siteSolutions[e][t].selectedSolution||ye.siteSolutions[e][t].selectedSolution<0)&&(ye.siteSolutions[e][t].selectedSolution=0),ye.siteSolutions[e][t])}function J(e,t,i){for(var n=-1,o=[],r=0;r<e.length;r++){var a=e[r];if(-1!==t.indexOf(a.type))return i&&e.splice(r,1),a;if(-1!==t.indexOf(a.type+"List")){if(n>-1&&r-n>1)return o;i&&e.splice(r,1),o.push(a),n=r}}if(o.length>0)return o}function Q(e){for(var t=0;t<e.length;t++){var i=e[t][0];if(i.isLGrepeater()){if("ListHeader"===_.last(i.segments).contentElement.type||"ListFooter"===i.segments[0].contentElement.type)return!1;if(t>0&&"ListHeader"===_.last(e[t-1][0].segments).contentElement.type||t+1<e.length&&"ListFooter"===e[t+1][0].segments[0].contentElement.type)return!1}}return!0}function ee(e){return e.parent&&"ListHeader"!==e.type&&"ListFooter"!==e.type?e.parent.layoutFilter:e.node.layoutFilter}function te(e,t,i,n){for(var o,r=[],a=!1,s=t;!a&&s<e.length;s++)(o=Array.isArray(e[s])?e[s][0]:e[s]).parent===n&&ee(o)===i?r.push(e[s]):a=!0;return r}function ie(e,t){e.setLgData(t)}var ne,oe={};function re(e,t){var i=!0,n=new s;angular.copy(E(t),n);for(var o=0;o<n.segments.length&&i;o++){var r=n.segments[o],a=J(e,r.forContent);if(!a){i=!1;break}var l=!1;if(Array.isArray(a)){l=!0;var c=a[0].type,d=e.indexOf(a[0])-1;"ListHeader"===e[d].type&&a.unshift(e[d]),r.contentElement={ceArray:a,type:"List"+c,aggregator:!0}}else r.contentElement=a;ce(l,r,a)}if(i)return ie(n,e),[[n]]}function ae(e,t,i,n,o,r,a){var l=new s;return a&&(oe[o]=oe[o]||{},oe[o][a]=l),angular.copy(e,l),l.segments.forEach(function(e){e.contentElement=i[t],e.node=n[t],t++}),l.setPage(o),ie(l,r),l}function se(e,t,i,n,o,r){var a=0;return e=e.map(function(e){var s,l=a;return e.map(function(e){s||(s="",e.segments.forEach(function(e,t){s+=i[l+t].getId()+"#"}));var c=e.id+s;t[l].aggregator&&(c+=e.aggregatorUniqueId(t[l].ceArray)),a=l;var d=!r&&oe[n]&&oe[n][c];if(d)return d.copied=!0,a+=d.segments.length,d;var u=ae(e,a,t,i,n,o,c);return a+=u.segments.length,u})})}function le(e,t,i){var n=new r;n.ceArray=[],n.aggregator=!0;var o=0,a=[];return e&&(n.ceArray.push(i[0].ce),o=1,a.push(i[0].ce.type)),angular.forEach(i[o],function(e){n.ceArray.push(e.ce)}),i[o].ce&&a.push(i[o].ce.type),t&&(n.ceArray.push(i[o+1].ce),a.push(i[o+1].ce.type)),n.type="List"+i[o][0].type,n.aggregationKey=a.join("#"),{type:n.type,node:i[o][0].parent,ce:n}}function ce(e,t,i){if("GeneralDescription"!==t.contentElement.type){var n=e?i[0]:i;o.traverse(function(i,o){i.getContentElement()===n&&(t.node=e?o:i)})}}function de(e,t,i,n,o,r){t===o&&""===e.values[r].value&&n&&(e.values[r].value=e.values[t].value.split("<br/>").join(" "),ye.handleValueChange(e,r,i,n))}function ue(e,t){var i=!1;if(t.layoutFilter&&t.layoutFilter!==e.layoutFilter&&(b.mobileEditorPresets&&t.layoutFilter===m.PART?e.layoutFilter=m.FULL:e.layoutFilter=t.layoutFilter,i=!0),e.isList()){var n=o.getListHeader(e);t.listHeaderLayoutFilter&&t.listHeaderLayoutFilter!==n.layoutFilter&&(n.layoutFilter=t.listHeaderLayoutFilter,i=!0);var r=o.getListFooter(e);t.listFooterLayoutFilter&&t.listFooterLayoutFilter!==r.layoutFilter&&(r.layoutFilter=t.listFooterLayoutFilter,i=!0),t.asymmetric!==e.asymmetric&&(e.asymmetric=t.asymmetric,i=!0)}return i}function pe(t,r,a,s){M.trace("createLayoutPresetSolution",t,r,a);var c=[],d=[],u=[],p="SiteHeader"===r.forContent[0]?g.HEADER:g.BODY;if(ue(t,r),t.isList()){var h=o.getListHeader(t),f=o.getListFooter(t),v=_.filter(o.getListItems(t),function(e){return!e.isUserHidden()}),S=w.getForNode(t);b.newListLayouts&&(r.sectionSolution?S.sectionSolution=_.assign({},r.sectionSolution):delete S.sectionSolution);var C=_.assign({},r.zigZag);if(v.length<=1&&(C.cols=!1),v.length<=r.itemsInRow&&!C.cols&&(C.rows=!1),S.zigZag=C,t.layoutFilter===m.AGGREGATOR){h.isUserHidden()||h.layoutFilter!==m.FULL||(c.push([i.layoutGroups.find(function(e){return e.id===_.first(r.groups).id})]),u.push(h),d.push(h.getContentElement()));var T=[],I=!1,x=!1;h.isUserHidden()||h.layoutFilter!==m.AGGREGATOR||(I=!0,T.push({type:h.getContentElementType(),ce:h.getContentElement(),node:h,parent:t})),T.push(_.map(v,function(e){return{type:e.getContentElementType(),ce:e.getContentElement(),node:e,parent:t}})),f.isUserHidden()||f.layoutFilter!==m.AGGREGATOR||(x=!0,T.push({type:f.getContentElementType(),ce:f.getContentElement(),node:f,parent:t}));var P=_.find(r.groups,function(e){return e.isAggregator});c.push([i.layoutGroups.find(function(e){return e.id===P.id})]),u.push(t),d.push(le(I,x,T).ce),f.isUserHidden()||f.layoutFilter!==m.FULL||(c.push([i.layoutGroups.find(function(e){return e.id===_.last(r.groups).id})]),u.push(f),d.push(f.getContentElement()))}else{var L=0;_.each(t.children,function(e){if(!e.isUserHidden()){if("ListHeader"===e.getContentElementType())c.push([i.layoutGroups.find(function(e){return e.id===_.first(r.groups).id})]);else if("ListFooter"===e.getContentElementType())c.push([i.layoutGroups.find(function(e){return e.id===_.last(r.groups).id})]);else if(e.getContentElementType()===t.getContentElementType()){if(L%(r.itemsInRow||1)==0){var n=_.find(r.groups,function(e){return!e.isHeader&&!e.isFooter}).id;c.push([i.layoutGroups.find(function(e){return e.id===n})])}L++}u.push(e),d.push(e.getContentElement())}})}}else{var k=r.groups[0].id;"headerLayoutGroup"===k?c.push([E(r.isMobile)]):c.push([i.layoutGroups.find(function(e){return e.id===k})]),u.push(t),d.push(t.getContentElement())}b.condensedPresets&&ve(r,t);var $,A=o.getAllVisibleContentElements(),D=new l(a,p);return D.isPreview=!0,D.previewForContentElementType=r.contentType,p===g.HEADER?($=re(A,r.isMobile))[0][0].setPage(a):(_.each(d,function(e){e.extractCeFields(A),e.updatePrevCeFields()}),$=se(c,d,u,a,A,!0),delete oe[a]),M.trace("preparedSolution",$),Q($)?(M.trace("preparedSolution validated",$),D.addSolution($),D.sortSolutions(),D.selectedSolution=0,_.sequencePromises(D.getSelectedSolution(),function(e){if(!b.consumerMode||e.isHeader())return e.setOptionalLayoutElements()}).then(function(){return D.applyLayoutPreset(t,r,D.selectedSolution)}).then(function(e){if(!e)return M.trace("failed sitePartSolutions.applyLayoutPreset"),n.when(null);var t=D.getSelectedSolution();if(b.coreNewMobileColumns&&r.isMobile){var i=_.flatten(_.map(s,function(e){return e.segments}));_.each(t,function(e,t){e.desktopSegment=i[t]})}return _.sequencePromises(t,function(e){return e.calculateLayoutGroupStatusForPresetPreview()}).then(function(){return me(D.getSelectedSolution())}).then(function(e){if(!e)return M.trace("failed listPostProcessing"),n.when(null);var t=D.getSelectedSolution();return _.each(t,function(e){_.each(e.segments,function(e){var t=e.getLE();_.each(t.layoutArray,function(e){"line"===e.type&&(e.widthAndLeftPosition=y.getLineWidthAndLeftPosition(t,e))})})}),t})}).catch(function(t){return e.error(t),n.when(null)})):n.when(null)}function he(e){var t=e[0].getLENoError(),i=t.cluster;if(function(e,t){return _.find(e,function(e){return e.getLENoError().id!==t})}(e,t.id)){var n=_.map(e,function(e){return _.map(_.filter(e.optionalLayoutElements,function(e){return e.cluster===i&&e.getSolutionStatus()===a.pass}),"id")}),o=_.intersection.apply(_,n);if(!(o.length>0))return _.each(e,function(e){e.containingLG.status=a.fail}),!1;var r=o[0];_.each(e,function(e){var t=_.findIndex(e.optionalLayoutElements,function(e){return e.id===r});e.containingLG.getLayoutSelectionStore().setLESelectionForSegment(e,t)})}return!0}function ge(e,t){return _.findIndex(e.boxTypes,function(e){return e===t})>=0}function me(e){var t=function(e){return _.filter(e,function(e){return e.isOnlyListItem()})}(e);if(t.length>1){var i=_.groupBy(_.flatten(_.map(t,"segments")),function(e){return e.isZigZag()});return i=_.values(i),function(e,t){for(var i=0;i<t.length;i++){var o=t[i];if(o.length>1&&!he(o))return n.when(!1)}return _.sequencePromises(e,function(e){var t=e.ensureHeightMatchesContent();if(t.then)return t.then(function(){return e.calculateLayoutGroupStatus(void 0)})}).then(function(){return!0})}(t,i).then(function(e){var n=_.get(t[0],["segments",0,"node","identifyingNode"]),o=x.isSlideShow(n);return e&&(o||function(e,t){var i=_.find(e,function(e){return e.segments[0].node.isListItem});if(1===i.segments.length){var n=i.segments[0].getLENoError();if(19===n.cluster||21===n.cluster){var o=ge(n,I.LEFT)||ge(n,I.RIGHT);return t||o}}}(t,i.length>1))?function(e){var t=_.filter(e,function(e){return e.segments[0].node.isListItem}),i=(b.lodash4?_.strictMaxBy:_.max)(_.map(t,function(e){return e.targetHeight}));return _.sequencePromises(t,function(e){return e.changeLayoutGroupHeight(i)})}(t).then(function(){return!0}):e})}return n.when(!0)}function fe(e,t){var i=w.getForNodeByType(e);i.background=t,t.alignment&&(i.backgroundAlignment=t.alignment),"image"===t.mediaType&&(e.backgroundHasFaces=t.hasFaces)}function ve(e,t){if(e.selections&&(e.selections.node&&_.assign(w.getForNode(t),e.selections.node),t.isList())){if(e.selections.header){var i=o.getListHeader(t);_.assign(w.getForNode(i),e.selections.header)}if(e.selections.footer){var n=o.getListFooter(t);_.assign(w.getForNode(n),e.selections.footer)}if(e.selections.items){var r=_.filter(t.children,function(e){return e.isListItemBody()});_.each(r,function(t){_.assign(w.getForNode(t),e.selections.items)})}}}var ye={siteSolutions:{body:{}},initialized:!1,doForCalculatedDesktopLgs:function(e){var t=this;t.doForCalculatedLgs(function(e,i){return t.getSelectedSolution(e,i)||[]},e)},doForCalculatedLgs:function(e,t){function i(i,n){e(i,n).forEach(function(e){t(e)})}o.getPagesList().forEach(function(e){i(g.BODY,e)}),i(g.FOOTER),i(g.HEADER)},getSegmentKeysInLg:function(e){var t=[];return e.segments.forEach(function(e){var i=e.getTypeForLSSWithoutPartition();t=t.concat([i,i+"|-1",i+"zigzag",i+"zigzag|-1","ListFooter"+i,"ListHeader"+i,"ListFooter"+i+"|-1","ListHeader"+i+"|-1"])}),t},bindFunctionForOverlayService:function(e){ne=e},describeAllSolutions:function(e,t){var i=Z(e,t);return i?i.describeAllSolutions():void 0},getLgByNodeId:function(e,t,i){return _.find(ye.getSelectedSolution(e,t),function(e){return _.find(e.segments,function(e){return e.node.id===i})})},getPartSolutions:Z,getHeaderHeight:function(e){return Z("header",e).getSolutionHeight()},getMobileHeaderHeight:function(e){return Z("header",e).getMobileSolutionHeight()},getSelectedSolution:function(e,t){var i=Z(e,t);return i&&e===g.HEADER&&0!==i.selectedSolution&&(i.selectedSolution=0),i?i.getSelectedSolution():void 0},getSelectedSolutionIndex:function(e,t){var i=Z(e,t);return i?i.selectedSolution:void 0},moveToNextValidSolution:function(e,t,i){var o=Z(e,t);return o?o.moveToValidSolution(i):n.when()},toggleLgLock:function(e,t){var i=Z(g.BODY,e);return i?i.toggleLgLock(t):void 0},getLockedLgs:function(e){var t=Z(g.BODY,e);return t?t.getLockedLgs():void 0},getValidSolutions:function(e,t,i){var n=Z(e,t);return n?n.getFilteredSolutions(i,a.pass):[]},getFailedSolutions:function(e,t,i){var n=Z(e,t);return n?n.getFilteredSolutions(i,a.fail):[]},countValidSolutions:function(e,t){return this.getValidSolutions(e,t).length},firstValidSolution:function(e,t){var i=Z(e,t);return i?i.firstValidSolution():void 0},getAllCurrentPageSolutions:function(){return Z(g.BODY,j(),!0)},getAllSolutions:function(e,t){var i=Z(e,t);return i?i.solutions:void 0},moveToSolution:function(e,t,i){var n=Z(e,t);return n?n.changeSolutionTo(i):void 0},createLayoutPresetPreviewSolution:function(e,t,i,n,r){var a,s="layoutPresetPreview"+e.id+(n||""),l=d.cloneLayoutSelectionStoreForPresetPreview(s,t.containerPageId||"GeneralDescription"===t.contentElementType&&"header"),c=e.data;return b.coreNewMobileColumns&&c.isMobile||l.resetFieldColorOverrides(),l.resetAllFontOverrides(),l.resetLayoutOverrides(),i?(o.setContainerPageId(t,s),a=t):a=o.duplicateNodeForLayoutPresetPreview(t,s),r&&r.preferredMedia&&(c=ob.deepClone(c),T.setPreferredMediaInPresetData(c,r.preferredMedia)),r&&r.resetOpacity&&(a.isList()?_.each(a.children,function(e){L.resetOpacity(e),L.resetColor(e)}):(L.resetOpacity(a),L.resetColor(a))),r&&(r.headerBg||r.bg)&&(a.isList()&&fe(o.getListHeader(a),r.headerBg||r.bg),r.bg&&fe(a,r.bg)),w.getForNode(a).additionalHeight=0,function(e,t,i){e.isMobile&&e.groups.forEach(function(n){var r=t,a=e.contentType;e.isList&&(a+="List",n.isHeader?(a+="HeaderList",r=o.getListHeader(t)):n.isFooter&&(a+="FooterList",r=o.getListFooter(t)));var s=i.getOverrideByNode("style",r,"button");s&&n.layouts.forEach(function(e){var t=e.selections.overrides.style;t[a]||(t[a]={}),t[a].button=s})})}(c,a,l),b.videoUploader&&k.setInlineVideoFromPreset(c,a),pe(a,c,s,r&&r.desktopSolution).then(function(i){if(l.readyToDie=!0,i)return t.isList()&&function(e,t,i){var n=o.getListHeader(e);if(n.isUserHidden()){var r=_.find(i.groups,function(e){return e.isHeader});r&&(r=d.patchContentType(r,i.contentType,e.contentElementType),t.updateFromPresetLgData(r,[n],i.isMobile))}var a=o.getListFooter(e);if(a.isUserHidden()){var s=_.find(i.groups,function(e){return e.isFooter});s&&(s=d.patchContentType(s,i.contentType,e.contentElementType),t.updateFromPresetLgData(s,[a],i.isMobile))}}(a,l,c),{node:t,preset:e,solution:i,previewNode:a,lss:l,dummyPageId:s}})},createLayoutPresetPreviewSolutions:function(e,t,i,n,o){var r=this;return _.sequencePromises(e,function(e){return r.createLayoutPresetPreviewSolution(e,t,i,n,o)}).then(function(e){return _(e).filter().value()})},calculateFooter:function(){return W()},createLayoutPresetSolution:function(e,t){return pe(t,e,t.containerPageId)},applyLayoutPreset:function(e,t,i,o,r){var a=ue(i,o),s=!1;i.isList()&&(w.getForNode(i).zigZag=_.assign({},o.zigZag),s=!0),b.condensedPresets&&ve(o,i),s&&u.emitClearIdFromLgsMap(i);var l=n.when();return(a||s||r)&&(l=l.then(function(){return q()})),l.then(function(){K(i.isList()?i.children:[i])}).then(function(){return Z(e,t).applyLayoutPreset(i,o)}).then(function(){return ye.calculateSolverStatus(void 0,void 0,!0)})},filters:{},clearPageSolution:function(e){this.siteSolutions.body&&this.siteSolutions.body[e]&&(this.filters[e]={},this.filters[e].filters=this.siteSolutions.body[e].filters,this.filters[e].lockedLgs=this.siteSolutions.body[e].lockedLgs,this.siteSolutions.body[e]=void 0)},createFooterSolutions:function(){var e=this;p.waitForMe(g.FOOTER,!0);var t=Z(g.FOOTER,null,!0),i=o.getAllVisibleContentElements();return t.clear(),o.traverseFooter(function(e,i){if(e.hasContentElement()&&!e.isUserHidden()&&e.getContentElement().getNumOfNonBlankFields()>0&&t.addNodeData(e,i),e.isUserHidden())return-1}),this.createPageSolutions(t,i).then(function(e){return p.imDone(g.FOOTER,!0),e}).then(function(){if(e.onPageCalculatedCallback)return e.onPageCalculatedCallback("footer")})},createHeaderSolutions:function(e){var t=re(e,!b.consumerMode&&b.mobileEditorPresets);return t[0][0].calculateLayoutGroupStatus().then(function(){var e=Z(g.HEADER,null,!0);e.addSolution(t),e.sortSolutions()})},createSectionByCopy:function(e,t,i,n){n=n||g.BODY;var r,a=o.getAllVisibleContentElements();if(n===g.HEADER)(r=re(a))[0][0].setPage(e);else{var s=_.map(t,function(e){return{id:e.id}});r=this.prepareSectionSolution(e,i,s,a)}return _.map(r,function(e){return e[0]})},allDesktopPagesAreCalculated:function(){return o.getPagesList().every(function(e){return ye.getSelectedSolution("body",e)})},prepareSectionSolution:function(t,n,r,a){var s=[],l=[],c=[];if(n.isList())if(n.layoutFilter===m.AGGREGATOR){var d=o.getListHeader(n),u=o.getListFooter(n),p=_.filter(o.getListItems(n),function(e){return!e.isUserHidden()});d.isUserHidden()||d.layoutFilter!==m.FULL||(c.push(d),l.push(d.getContentElement()));var h=[],g=!1,f=!1;d.isUserHidden()||d.layoutFilter!==m.AGGREGATOR||(g=!0,h.push({type:d.getContentElementType(),ce:d.getContentElement(),node:d,parent:n})),h.push(_.map(p,function(e){return{type:e.getContentElementType(),ce:e.getContentElement(),node:e,parent:n}})),u.isUserHidden()||u.layoutFilter!==m.AGGREGATOR||(f=!0,h.push({type:u.getContentElementType(),ce:u.getContentElement(),node:u,parent:n})),c.push(n),l.push(le(g,f,h).ce),u.isUserHidden()||u.layoutFilter!==m.FULL||(c.push(u),l.push(u.getContentElement()))}else _.each(n.children,function(e){e.isUserHidden()||(c.push(e),l.push(e.getContentElement()))});else c.push(n),l.push(n.getContentElement());var v=0;return _.each(r,function(e){var t;(t="headerLayoutGroup"===e.id?E():_.find(i.layoutGroups,{id:e.id}))&&(v+=t.segments.length,s.push([t]))}),v!==c.length&&(e.debug("cannot create section solution due to segments count mismatch for page/node: "+t+"/"+n.id),s=_.map(c,function(e){return[_.find(i.layoutGroups,function(t){return 1===t.segments.length&&t.segments[0].forContent.indexOf(e.getContentElementType())>=0&&!t.segments[0].isMobile})]})),se(s,l,c,t,a,!0)},createSimplePageSolution:function(e,t){var i=this,n=[],r={},a=e.getPageDescriptor(),s=e.getLayoutSelectionStore().getSolutionLGs(a),l=o.getPageNodeById(a);_.each(l&&l.children,function(o){var a=s[o.id];if(a&&!o.userHidden){var l=i.prepareSectionSolution(e.getPage(),o,a,t);r[o.id]=_.map(l,function(e){return e[0]}),n=_(n).concat(l).value()}}),Q(n)&&(e.addSolution(n),e.sectionMap=r)},createPageSolutions:function(t,i){var n=function(e){for(var t,i,n,o=[],r=0;r<e.length;r++)i=ee(t=Array.isArray(e[r])?e[r][0]:e[r]),!t.parent||i!==m.AGGREGATOR&&i!==m.REPEATER?o.push(e[r]):(n=te(e,r,i,t.parent),"a"===i?o.push(le("ListHeader"===_.first(n).type,"ListFooter"===_.last(n).type,n)):"r"===i&&o.push(_.flatten(n)),r+=n.length-1);return o}(t.getNodesData());return b.consumerMode&&t.getPageDescriptor()!==g.FOOTER?this.createSimplePageSolution(t,i):function(t,i,n){b.consumerMode&&i.getPageDescriptor()!==g.FOOTER&&e.error("ERROR calculating solutions in consumer mode!!!!");for(var o=[],r=[],a=0;a<t.length;a++)if(Array.isArray(t[a]))for(var s=[],l=0;l<t[a].length;l++)r.push(t[a][l].node),o.push(t[a][l].ce),s.push(t[a][l].type);else r.push(t[a].node),o.push(t[a].ce);var c=z(t);_.each(c,function(e){var t=se(e,o,r,i.getPage(),n,b.consumerMode&&i.getPageDescriptor()===g.FOOTER);Q(t)&&i.addSolution(t)})}(n,t,i),t.sortSolutions(),t.calculateSitePartStatus(i)},calculateAllPages:function(){var e=this,t=o.getPagesList();return _.sequencePromises(t,function(t){if(!o.getPageNodeById(t).hidePage)return e.calculatePage(t)})},calculateCurrentPage:function(){var e=j();return this.calculatePage(e)},registerWithOnPageCalculatedCallback:function(e){this.onPageCalculatedCallback=e},calculatePage:function(t,i){b.twoButtonSection&&P.deleteSegments(t),p.waitForMe("calc",!0);var r=this,a=o.getAllVisibleContentElements();e.debug("calculateCurrentPage: "+t),r.clearPageSolution(t);var s=Z(g.BODY,t,!0);return o.traversePage(t,function(e,t){if("page"!==e.getNodeType()&&e.hasContentElement()&&!e.isUserHidden()&&e.getContentElement().getNumOfNonBlankFields()>0&&(e.getContentElement().clearPrevCeFields(),s.addNodeData(e,t)),e.isUserHidden())return-1}),this.duringCalc=n.when().then(function(){if(!i)return o.isSiteHeaderVisible()?r.createHeaderSolutions(a).then(function(){if(r.onPageCalculatedCallback)return r.onPageCalculatedCallback("header")}):void Z(g.HEADER,null,!0).clear()}).then(function(){return r.createPageSolutions(s,a).then(function(){_.each(s.getSelectedSolution(),function(e){var t=e.getLgData(),i=t.columns;_.isEmpty(i)||e.setColumnsData(i),delete t.columns})}).then(function(){if(r.onPageCalculatedCallback)return r.onPageCalculatedCallback(t)})}).then(function(){return p.imDone("calc",!0),r.duringCalc=!1,r.calcDone()}).then(function(){var e=o.findPageNodeByName(t);e&&(e.dirty=!1)}),this.duringCalc},toDoAfterCalc:[],doAfterCalc:function(e){this.toDoAfterCalc.push(e)},doOrDoAfterCalc:function(e){return this.duringCalc?(this.doAfterCalc(e),this.duringCalc):e()},calcDone:function(){var e=this;return _.sequencePromises(this.toDoAfterCalc,function(e){return e()}).then(function(){e.toDoAfterCalc.length=0})},calculateMissingPageSolutions:function(){return this.doOrDoAfterCalc(function(){p.waitForMe("missingPageSolutions");var e=j();return Z(g.BODY,e,!0).cleanCalcMissingSolutions().then(function(){p.imDone("missingPageSolutions")})})},onNodeChanged:q,performAction:Y,reRenderPage:X,handleValueChange:function(e,t,i,o,r){var a=this;return n.resolve().then(function(){if("reference"===t){var s=r&&e.getReferenceContentElements(r)[0];s&&a.setLgsOfContentElementDirty(s),a.setLgsOfContentElementDirty(e)}else{if(a.preHandleValueChange(e,t,i,o),!b.consumerMode&&e.empty&&e.getNumOfNonBlankFields()>0)return u.emitNodeChanged(),n.when();if(t&&(""===e.values[t].value||!b.twoButtonSection&&e.values[t].value&&""===e.values[t].value.callToAction)){if(!o)return n.when()}else if(o&&!i)return n.when()}return i&&(t=null),a.calculateSolverStatus(e,t,void 0,i)})},setLgsOfContentElementDirty:function(e,t){"GeneralDescription"===e.type&&_.each(this.getSelectedSolution(g.HEADER),function(e){e.setAsDirty(!0)});var i=e.getDependencies();t&&(i=_(i).map(function(e){return o.isRegularListItem(e)?o.getListItems(o.findIdentifyingNode(e)):e}).flatten().uniq().value()),_.each(i,function(e){j()!==e.containerPageId&&o.markPageNodeAsDirty(e)}),K(i)},preHandleValueChange:function(e,t,i,n){var r=this;o.isReferenceField(e.type,t)&&_.each(o.getAllVisibleContentElements(),function(e){"GeneralDescription"!==e.type&&"Contact"!==e.type||r.setLgsOfContentElementDirty(e)}),r.setLgsOfContentElementDirty(e,i),_.each(e.getDependencies(),function(e){ne&&("GeneralDescription"===e.contentElementType||e.containerPageId&&e.containerPageId===u.story.selectedPage&&!e.isUserHidden())&&ne(e)}),function(e,t,i,n){de(e,t,i,n,"address for display","address for google map"),de(e,t,i,n,"email","Contact form email")}(e,t,i,n)},handleMaskChange:function(e,t){return this.preHandleValueChange(e,t,!0,!1),this.calculateSolverStatus(e,null,void 0,!0)},calculateSolverStatus:function(e,t,i,r){var a,s=this,c=o.getAllVisibleContentElements();return _.sequencePromises(this.siteSolutions,function(i){return i instanceof l?i.calculateSitePartStatus(c,e,t,!0):_.sequencePromises(i,function(i,n){if(j()===n)return i.calculateSitePartStatus(c,e,t,!0);b.consumerMode||o.markPageAsDirty(n)}).then(b.lodash4?_.some:_.any)}).then(function(e){if(a=e,s.withMissingSolutions)return s.calculateMissingPageSolutions()}).then(function(){return b.consumerMode||(i||_.some(a)||e&&"GeneralDescription"===e.type?u.emitLayoutSolutionChanged():u.emitDataChanged({lockRenderer:r})),n.when()})},removePage:function(e){delete ye.siteSolutions.body[e]},setConsumerMode:function(){this.initializeImplementation()},initializeImplementation:function(){this.initialized||(this.initialized=!0,u.onFooterNodeChanged(function(){e.debug("Node changed in footer - recalculating"),W().then(function(){u.emitLayoutSolutionChanged(g.FOOTER)})}),u.onNodeChanged(q),u.onNodeOverridesChanged(_.debounce(function(e,t){K(t),ye.calculateSolverStatus()},400,{leading:!1,trailing:!0})),u.onNodeChangedClearCache(function(){oe={},q()}),u.onNodeChangedClearCacheSynchronous=function(){return oe={},q()},u.onClearIdFromLgsMap(function(e,t){var i=t.id,n=oe[t.containerPageId];_.each(n,function(e,t){-1!==t.indexOf(i)&&delete n[t]})}),u.onLocaleChanged(function(){G()}),u.onReferenceFieldChanged(function(e,t){ye.handleValueChange(t.getContentElement(),"reference",!0,!1)}),u.onValueChanged(_.debounce(function(t,i,n,o,r){e.debug("Value changed - handleValueChange"),ye.handleValueChange(i,n,o,r)},400,{leading:!1,trailing:!0})),u.onBlurChanged(function(e,t,i,n){ye.handleValueChange(t,i,n,!0)}),u.onFontOverridesChanged(function(){e.debug("Font changed - onFontOverridesChanged"),ye.calculateSolverStatus()}),u.onVerticalChanged(function(){G()}),u.onChangingPage(function(){G()}),u.recalculateCurrentPage=function(e,t){return G(e,t)},u.onPageDeleted(function(e,t){this.removePage(t)}.bind(this)))},initialize:function(){return this.promise?this.promise:(this.initializeImplementation(),this.promise=n.when(),this.promise)},prepareSolution:se,prepareLg:ae,updateLgsMapFromSolution:function(e,t){oe[t]=_.reduce(e,function(e,t){return e[t.getUniqueIdForSolution()]=t,e},{})},listPostProcessing:me,debugStretchAndRecalc:function(){return oe={},G(!0).then(function(){var e=Z(g.BODY,j(),!0);return _.sequencePromises(e.solutions,function(e){return _.sequencePromises(e.solution,function(e){return e.changeHeightToSpecificIndex(80).then(function(){return _.sequencePromises(e.segments,function(e){return _.sequencePromises(e.optionalLayoutElements,function(t){return t.calculateLayoutElementStatus(e.contentElement)})})})})})})},serialize:function(){return this.lastSaved=Date.now(),JSON.stringify({siteSolutions:this.siteSolutions,selectedSolution:this.selectedSolution,initialized:this.initialized,timestamp:this.lastSaved})},deserialize:function(e){var t=JSON.parse(e);this.siteSolutions=t.siteSolutions,this.selectedSolution=t.selectedSolution,this.initialized=t.initialized},recalculateCurrentPage:G};return S.registerWithLayoutSolver(ye),AdiCoreSanta.setLayoutSolver(ye),ye}]),function(e){var t=function(){function e(e,t,i,n,o){this.$window=e,this.$rootScope=t,this.applicationParameters=i,this.flags=n,this.videoProvidersUtils=o,this.assets={framePath:"index.html",protocolPath:"scripts/protocol.js"},AdiCoreSanta.setMediaGallery(this)}return e.$inject=["$window","$rootScope","applicationParameters","flags","videoProvidersUtils"],e.prototype.translateMediaFrameResultItemToSdkMediaResultItem=function(e){var t={};return t.fileName=e.title||"",t.relativeUri=(e.mediaType===AdiCoreSanta.MediaItemTypes.Shape?e.fileUrl:e.uri)||"",t.width=Number(e.width)||0,t.height=Number(e.height)||0,t.Title="",t.Description="",t.Link="",t.fileOutput=e.fileOutput,t.fileInput=e.fileInput,t.labels=e.labels,t.mediaType=e.mediaType,t.fileBaseUrl=e.fileBaseUrl,t},e.prototype.destroy=function(){var e=this;this.$window.MediaFrame.off("close",function(){return e.cancelHandler()}),this.$window.MediaFrame.off("items",function(t){return e.itemsHandler(t)})},e.prototype.open=function(e){var t=this;return new Promise(function(i){t.resolve=i,t.init(e),t.loadMediaGallery()})},e.prototype.init=function(e){this.data=_.assign({multiSelection:"backgrounds"!==e.mediaType,mediaType:"photos"},e)},e.prototype.loadMediaGallery=function(){var e=this,t=this.getOptionsFromData(this.data);_.assign(t,{mediaGalleryBaseHost:this.applicationParameters.clientTopology.mediaGalleryG5SameOriginUrl,baseHost:this.applicationParameters.clientTopology.baseDomain,i18nCode:"en",windowStyle:"fullscreen"}),this.$window.MediaFrame.on("close",function(){return e.cancelHandler()}),this.$window.MediaFrame.on("items",function(t){return e.itemsHandler(t)}),this.flags.passoverCleaning?t.vision=["face"]:t.vision=["face","label","color"],this.$window.MediaFrame.open(t)},e.prototype.cancelHandler=function(){this.destroy(),this.$rootScope.$evalAsync(),this.resolve([])},e.prototype.itemsHandler=function(e){this.$rootScope.$evalAsync(),this.resolve(e.items.map(this.translateMediaFrameResultItemToSdkMediaResultItem)),this.destroy()},e.prototype.getScaleToFill=function(e,t,i){var n=e.fileOutput.video[0],o=t/i,r=n.width/n.height;return o>r?o/r:r/o},e.prototype.getVideoUrl=function(e){return""+this.applicationParameters.clientTopology.videoUrl+e.fileOutput.video[0].url},e.prototype.itemToThumbnailUrl=function(e,t,i,n){var o,r=n&&n.crop,a=n&&n.alignment,s=n&&n.fit,l=n&&n.focalPoint;switch(e.mediaType.toLowerCase()){case AdiCoreSanta.MediaItemTypes.Audio:o="./images/audio.png";break;case AdiCoreSanta.MediaItemTypes.Shape:o="https://static.wixstatic.com/"+("svg"===e.relativeUri.substr(e.relativeUri.length-3)?e.relativeUri:e.relativeUri.substr(0,e.relativeUri.length-2)+"svg");break;case"pattern":case"image":case AdiCoreSanta.MediaItemTypes.Icon:if(o="https://static.wixstatic.com/media/"+e.relativeUri+"/v1",s)o+="/fit/w_"+t+",h_"+i+"/"+e.relativeUri;else if(r)o+="/crop/x_"+Math.round(r.x)+",y_"+Math.round(r.y)+",w_"+Math.round(r.width)+",h_"+Math.round(r.height)+"/fill/w_"+t+",h_"+i+"/"+e.relativeUri;else if(a)o+="/fill/w_"+t+",h_"+i+",al_"+a.substr(0,1)+"/"+e.relativeUri;else if(l){var c={x:(n.focalPoint.x/100).toFixed(2),y:(n.focalPoint.y/100).toFixed(2)};o+="/fill/w_"+t+",h_"+i+",fp_"+c.x+"_"+c.y+"/"+e.relativeUri}else o+="/fill/w_"+t+",h_"+i+"/"+e.relativeUri;break;case AdiCoreSanta.MediaItemTypes.Clipart:o="https://static.wixstatic.com/media/"+e.relativeUri+"/v1/fit/w_"+t+",h_"+i+"/b31076b78c214845bc6452ff208140d3.png";break;case AdiCoreSanta.MediaItemTypes.Video:o=e.fileOutput?"https://static.wixstatic.com/"+e.fileOutput.image[0].url:"./images/video.svg";break;case AdiCoreSanta.MediaItemTypes.ExtVideo.toLowerCase():o=this.videoProvidersUtils.getVideoThumbnailUrl(e.videoUrl,e)}return o},e.prototype.getOptionsFromData=function(e){var t=e.multiSelection?"multiple":"single";switch(e.mediaType){case"backgrounds":return{selectionType:t,mediaType:"picture",i18nPrefix:"background",canShowSelectButton:!0,canSubmitUntranscoded:!1,tabsList:["private","public"],path:"public",publicMediaRoot:"backgrounds"};case AdiCoreSanta.MediaItemTypes.Shape:return{selectionType:t,mediaType:"picture",i18nPrefix:e.multiSelection?"multiple_shape":"shape",canShowSelectButton:!0,canSubmitUntranscoded:!1,tabsList:["public"],path:"public",publicMediaRoot:"vector_art"};case AdiCoreSanta.MediaItemTypes.Audio:return{selectionType:t,mediaType:"music",i18nPrefix:"music",canShowSelectButton:!0,canSubmitUntranscoded:!0,tabsList:["private"],path:"private"};case AdiCoreSanta.MediaItemTypes.Clipart:return{selectionType:t,mediaType:"picture",i18nPrefix:e.multiSelection?"multiple_icons":"single_icon",canShowSelectButton:!0,canSubmitUntranscoded:!1,tabsList:["public","private"],path:"public",publicMediaRoot:"clipart"};case AdiCoreSanta.MediaItemTypes.Icon:return{selectionType:t,mediaType:"picture",i18nPrefix:e.multiSelection?"multiple_icons":"single_icon",canShowSelectButton:!0,canSubmitUntranscoded:!1,tabsList:["public"],path:"public",publicMediaRoot:"social_icons"};case AdiCoreSanta.MediaItemTypes.Video:return{selectionType:"single",mediaType:AdiCoreSanta.MediaItemTypes.Video,i18nPrefix:AdiCoreSanta.MediaItemTypes.Video,canShowSelectButton:!0,canSubmitUntranscoded:!0,tabsList:["public","private"],path:"public",publicMediaRoot:"videos"};default:return{selectionType:t,mediaType:"picture",i18nPrefix:e.multiSelection?"multiple_images":"single_image",canShowSelectButton:!0,canSubmitUntranscoded:!1,tabsList:["private","public","external","photoStock"],path:"public",publicMediaRoot:"photos",servicesList:["facebook","flickr","instagram","picasa"]}}},e.prototype.setMediaRef=function(e){switch(e.mediaType){case"pattern":e.mediaRef={type:"Image",uri:e.url||"",description:"",opacity:e.opacity,width:e.width,height:e.height};break;case"picture":case"image":e.mediaRef={type:"Image",uri:e.url||"",description:"",width:e.width,height:e.height};break;case AdiCoreSanta.MediaItemTypes.Video:e.mediaRef={mute:!0,type:"WixVideo",qualities:e.qualities,posterImageRef:e.posterImageRef,preload:"auto",opacity:1,duration:e.duration,videoId:e.fileBaseUrl,autoplay:!0,loop:!0}}},e.prototype.setBgObj=function(e,t){if(void 0===t&&(t={}),e.mediaType===AdiCoreSanta.MediaItemTypes.Video)if(e.fileOutput){var i=_.groupBy(e.fileOutput.video,"quality");i=_.map(i,function(e){var t=_.map(e,"format"),i=_.pick(e[0],["width","height","quality"]);return i.formats=t,i});var n=_.first(e.fileOutput.image),o=_.pick(n,["width","height","url"]);o.type="Image",o.uri=o.url.replace(/^(.*[\/])/,""),delete o.url,t.posterImageRef=o,t.qualities=i}else{var r=e.width/1920,a=e.height/1080;t.qualities=[{width:Math.round(854*r),height:Math.round(480*a),quality:"480p",formats:["mp4","webm"]},{width:Math.round(1280*r),height:Math.round(720*a),quality:"720p",formats:["mp4","webm"]},{width:Math.round(1920*r),height:Math.round(1080*a),quality:"1080p",formats:["mp4","webm"]}],t.posterImageRef={width:e.width,height:e.height,type:"Image",uri:e.relativeUri+"f000.jpg"},t.duration=Math.round(e.duration/1e3)||1}return t.url=e.relativeUri,t.width=e.width,t.height=e.height,t.mediaType=e.mediaType,"pattern"===e.mediaType?t.fittingType="tile":t.fittingType=t.fittingType||"fill",t.alignType=t.alignType||"center",t.fileBaseUrl=e.fileBaseUrl,e.fileInput&&(t.duration=Math.round(e.fileInput.duration/1e3)||1),this.setMediaRef(t),t},e.prototype.getItemId=function(e){return e.videoUrl||(e.relativeUri||"")+(e.fileUrl||"")},e.prototype.normalizeWixVideoItem=function(e){if(e.fileOutput)return e;var t=e.fileName,i=e.width,n=e.height,o=e.duration,r=e.displayAspectRatio,a=e.videoBitrate,s=e.audioBitrate,l=e.fps,c=e.title;return{mediaType:AdiCoreSanta.MediaItemTypes.Video,fileName:t,uri:t,fileUrl:"video/"+t,title:c,fileInput:{audioBitrate:s/1e3,videoBitrate:a/1e3,height:n,width:i,fps:l,duration:o,type:AdiCoreSanta.MediaItemTypes.Video,displayAspectRatio:r},fileOutput:{image:[{status:"READY",secure:!1,format:"jpg",url:"media/"+t+"f000.jpg",height:n,width:i,key:"poster.0"},{status:"READY",secure:!1,format:"jpg",url:"media/"+t+"f001.jpg",height:n,width:i,key:"poster.1"},{status:"READY",secure:!1,format:"jpg",url:"media/"+t+"f002.jpg",height:n,width:i,key:"poster.2"},{status:"READY",secure:!1,format:"jpg",url:"media/"+t+"f003.jpg",height:n,width:i,key:"poster.3"}],video:[{status:"READY",audioBitrate:-1,secure:!1,fps:l,format:"mp4",url:"video/"+t+"/480p/mp4/file.mp4",height:480,videoBitrate:877,tag:"High",key:"480p.mp4",duration:o,displayAspectRatio:r,quality:"480p",width:Math.round(480*i/n)},{status:"READY",audioBitrate:-1,secure:!1,fps:l,format:"webm",url:"video/"+t+"/480p/webm/file.webm",height:480,videoBitrate:1457,tag:"High",key:"480p.webm",duration:o,displayAspectRatio:r,quality:"480p",width:Math.round(480*i/n)},{status:"READY",audioBitrate:-1,secure:!1,fps:l,format:"mp4",url:"video/"+t+"/720p/mp4/file.mp4",height:720,videoBitrate:3362,tag:"HD",key:"720p.mp4",duration:o,displayAspectRatio:r,quality:"720p",width:Math.round(720*i/n)},{status:"READY",audioBitrate:-1,secure:!1,fps:l,format:"webm",url:"video/"+t+"/720p/webm/file.webm",height:720,videoBitrate:3954,tag:"HD",key:"720p.webm",duration:o,displayAspectRatio:r,quality:"720p",width:Math.round(720*i/n)},{status:"READY",audioBitrate:-1,secure:!1,fps:l,format:"mp4",url:"video/"+t+"/1080p/mp4/file.mp4",height:1080,videoBitrate:5753,tag:"HD",key:"1080p.mp4",duration:o,displayAspectRatio:r,quality:"1080p",width:Math.round(1080*i/n)},{status:"READY",audioBitrate:-1,secure:!1,fps:l,format:"webm",url:"video/"+t+"/1080p/webm/file.webm",height:1080,videoBitrate:7151,tag:"HD",key:"1080p.webm",duration:o,displayAspectRatio:r,quality:"1080p",width:Math.round(1080*i/n)}]},vendor:"bigstock&bigstock&bigstock&clipcanvas",reference:"v49780622&v493478872&v49737086&v318347",fileBaseUrl:"video/"+t,relativeUri:t,thumbnailUrl:"https://static.wixstatic.com/media/"+t+"f002.jpg/v1/fit/w_288,h_155/"+t+"f002.jpg",Title:c,Description:"",controls:0,playmode:{autoplay:!0,loop:!0},active:!0}},e}();e.MediaGallery=t,angular.module("adiCoreAppInternal").service("mediaGallery",t)}(S||(S={})),angular.module("adiCoreAppInternal").factory("$p",function(){return Promise.onPossiblyUnhandledRejection(function(e){throw e}),_.assign(this,{defer:function(){var e={};return e.promise=new Promise(function(t,i){e.resolve=t,e.reject=i}),e},resolve:Promise.resolve.bind(Promise),when:Promise.resolve.bind(Promise),reject:Promise.reject.bind(Promise),all:Promise.all.bind(Promise)})}),angular.module("adiCoreAppInternal").factory("previewService",["$p","spinnerService","$window","storyServices","$rootScope","toasterService","applicationParameters","flags","documentServicesMediator","siteInit","siteState","catalogStyleFetcher",function(e,t,i,n,o,r,a,s,l,c,d,u){var p,h,g,m,f,v,y,b,S,C,w,T,I=s.meshBlankTemplate?"a9262946-3ff5-48b4-8a48-68afacdc3386":"40b370cd-eb2f-4e65-a619-a57040ae7090",x=s.meshBlankTemplate?"edb6724e-9943-453f-be8b-d61f4dd17c7b":"bb80349d-97a4-48a5-b9f2-8ddc2463709a",P={};if(s.immediateViewer){var M=i.ADI.getPreviewUrlTemplates();g=M.newSiteUrl,h=M.existingSiteUrl,p=M.extraParam}else{var L="&isSantaEditor=true&isEdited=true&closeSectionGaps=true";s.removeDisableMobileConversion||(L+="&disableMobileConversion=true");p=L+"&petri_ovr=specs.DisableNewRelicScripts:true;sv_contactFormFinalMigrationEditor:old;",s.santaVersion&&(p+="&ReactSource="+s.santaVersion);var k="&experiments=onboardingviewportmode,sv_mobileConversionDisabled,sv_restrictTextHeightInEditor";s.santaExperiments&&(k+=","+s.santaExperiments),p+=k,s.experimentsoff&&(p+="&experimentsoff="+s.experimentsoff);var $=a.clientTopology.editorBaseUrl+"/html/editor/web/renderer/render/template/<%= siteId %>?metaSiteId=<%= metaSiteId %>",A=a.clientTopology.editorBaseUrl+"/html/editor/web/renderer/render/document/<%= siteId %>?metaSiteId=<%= metaSiteId %>";s.localSanta&&(p+="&ReactSource=https%3A%2F%2Flocalhost&baseVersion=https%3A%2F%2Flocalhost"),s.debugSanta&&(p+="&debug="+s.debugSanta),s.santaParams&&(p+=s.santaParams),s.debugProGallery&&(p+=a.tpaTypes.ProGallery.debugQueryParam),s.isqa&&(p+="&isqa=true"),s.dsTrace&&(p+="&dsQTrace=true"),$+=p+="&dsOrigin="+("string"!=typeof s.waasSrc?"onboarding":s.waasSrc.startsWith("logo")?"logo-adi":"onboarding"),A+=p,h=_.template(A),g=_.template($)}var E,D=[],F=!1;function B(e){if(D.length){var t=_.map(D,function(t){return t(e)});_.some(t)&&o.$apply()}}function O(e,t){return e+t}var H={registerUrlLoader:function(e){m=e,E&&(e(E,F),E=null,F=!1)},setDocumentServicesModel:function(e){w=e},setRendererModel:function(e){T=e},setSantaSiteModel:function(e){e?(e,s.realSantaVersion=e.baseVersion||"unknown"):(e={},s.realSantaVersion="unknown")},getHtmlRevision:function(){if(w)return w.revision},urlLoaded:function(e,t,n){var o=e.documentServices,r=e.documentServicesModel;r.editorSessionId=a.clientTopology.esi,y=t,b&&angular.element(b).off("click",B),b=n,angular.element(b).on("click",B),S=e&&e.document,C=e,this.setDocumentServicesModel(r),this.setRendererModel(e.rendererModel),this.setSantaSiteModel(e.siteModel),i.rendererModel=T,i.documentServices=o,i.santaBase=e.santaBase,s.debug&&i.console.log("SantaVersion: "+i.santaBase),this.setPreviewMode(this.isPreview),v&&(o?v.resolve({documentServices:o,overlay:y,iframeWindow:S}):v.reject("Can't load document services")),this.loadPreviewUrlDone()},loadPreviewUrlDone:function(){t.imDone("loadPreviewUrl",!0),s.loadPreviewAsap||"thin"===_.get(n,"story.locale.renderedModel.model.header.mode")&&t.imDone("dynamicSpinner")},urlLoadFailed:function(){v.reject()},loadUrl:function(n,o){return s.debug&&i.console.log("Viewer url: "+n),(n=this.normalizeUrl(n))!==f||o?(v&&!o&&v.reject(),v=e.defer(),t.waitForMe("loadPreviewUrl",!0),m?m(n,o):(E=n,F=o),f=n,v.promise):v.promise},loadObUrl:function(){return this.loadStoryUrl()},blankSiteUrl:function(){return this.templateUrl(I,x)},templateUrl:function(e,t){return g({siteId:e,metaSiteId:t})},siteUrl:function(e,t){return h({siteId:e,metaSiteId:t})},mobilePreviewUrl:function(e,t){return this.siteUrl(e,t)+"&showMobileView=true"},loadStoryUrl:function(e,t,i){if(s.loadPreviewAsap&&!i){var n=this.getLoadStoryPromise(e,t);if(n)return n}var o;if(o=e&&t?this.siteUrl(e,t):this.blankSiteUrl(),s.consumerMode&&(o+="&editorSessionId="+a.clientTopology.esi),s.loadPreviewAsap){var r=O(e,t);return(P={})[r]=this.loadUrl(o,i),P[r]}return this.loadUrl(o,i)},getLoadStoryPromise:function(e,t){if(s.loadPreviewAsap){var i=O(e,t);if(P[i])return P[i]}},hideOverlay:function(){angular.element(b).hide()},showOverlay:function(){angular.element(b).show()},getOverlay:function(){return y},getOverlayContainer:function(){return b},getIframeDocument:function(){return S},getIframeWindow:function(){return C},getDocumentServicesModel:function(){return w},normalizeUrl:function(e){if((e=e.replace("petri_ovr=specs.RenderReactByUser:false","")).indexOf(p)>-1)return e;var t=e.split("#"),i=t[0];return i.indexOf("?")>-1?i+="&":i+="?",i+=p,t[1]&&(i+="#"+t[1]),i},getIdsFromEditorUrl:function(e){var t=e.match(/\/edit\/(.*)\?/)[1];return{metaSiteId:e.match(/metaSiteId=([^&]*)/)[1],siteId:t}},addClickHandler:function(e){D.push(e)},removeClickHandler:function(e){_.pull(D,e)},onLoad:function(e){var t;try{t=e.innerHTML}catch(e){r.error("Can't load preview! Probably no permission."),f!==this.blankSiteUrl()?this.loadStoryUrl().then(v.resolve):(this.urlLoadFailed(),this.loadPreviewUrlDone())}return!!t},isFirstSave:function(){return l.isFirstSave()},isSitePublished:function(){return l.isSitePublished()},getSiteId:function(){return l.getSiteId()},getMetaSiteId:function(){return l.getMetaSiteId()},getPublicUrl:function(){return l.getPublicUrl()},setPublicUrl:function(e){l.setPublicUrl(e)},getSiteName:function(){return l.getSiteName()},setSiteName:function(e){return d.setSiteName(e)},isSiteNameValid:function(e){return l.isSiteNameValid(e)},validateSiteName:function(e){return l.validateSiteName(e)},getUsername:function(){return l.getUsername()},isPremium:function(){return l.isPremium()},getFreeDomain:function(){return l.getFreeDomain()},isDomainConnected:function(){if(c.isReady){var e=this.getPublicUrl(),t=this.getFreeDomain();return null!==e&&void 0!==e&&!_.includes(e,t)}},isValidStyle:function(e){return!s.separateVisualValidationFromSanta&&!!u.getStyleDefinition(e)},setFixedHeader:function(e){var t=l.getHeader();l.getLayout(t).fixedPosition!==e&&l.updateLayout(t,{fixedPosition:e})},isDocumentServicesLoaded:function(){return c.isReady},setPreviewMode:function(e){if(e=!!e,this.isPreview=e,c.isReady&&(l.hasOnboardingViewportMode()&&l.onboardingViewportMode(e?"auto":"parent"),l.setPreviewModeOptions(e),!e))try{l.closePopupsAndModal()}catch(e){i.console.log("closePopupsAndModal throws")}},isPreview:void 0};return AdiCoreSanta.setPreviewService(H),H}]),function(e){var t=function(){function e(e,t,i){var n=this;this.$p=e,this.documentServicesMediator=t,this.ComponentBuilder=i,this._containerId="ADI_VALIDATION_CONTAINER_ID",this._containerParams={layout:{rotationInDegrees:0,width:319,height:500,scale:1,x:-1e3,y:-1e3,fixedPosition:!0,anchors:[]},components:[],componentType:"mobile.core.components.Container",type:"Container",skin:"wysiwyg.viewer.skins.area.DefaultAreaSkin",style:"c2"},this.containerRef=null,this.getComponentId=function(e){return _.map(e).join("|")},this.getComponentRefId=function(e){return"ADI-VALIDATION-"+n.getComponentId(e.props).split(".").join("-")},t.whenInitialized().then(function(){return n.bindExistingContainer()})}return e.$inject=["$p","documentServicesMediator","ComponentBuilder"],e.prototype.onBeforeSave=function(){this.containerRef&&this.documentServicesMediator.doesComponentExistByRef(this.containerRef)&&this.documentServicesMediator.removeComponent(this.containerRef),this.containerRef=null},e.prototype.onAfterUseComponent=function(e,t){this.documentServicesMediator.removeComponent(t)},e.prototype.buildComponentForValidation=function(e,t,i){var n={layout:e,value:t,le:i,overrides:i&&i.overrides};return this.buildComponentsForValidation([n]).then(function(e){return e[0]})},e.prototype.buildComponentsForValidation=function(e){var t=this;return this.$p.all(e.map(function(e){return t.findExistingComponent(e)||t.buildComponent(e)}))},e.prototype.bindExistingContainer=function(){this.documentServicesMediator.doesComponentExist(this._containerId)&&this.documentServicesMediator.removeComponent(this._containerId)},e.prototype.findExistingComponent=function(e){var t=this.getComponentRefId(e);return this.documentServicesMediator.doesComponentExist(t)?this.documentServicesMediator.getComponentRef(t):null},e.prototype.getContainerRef=function(){return this.containerRef||(this.containerRef=this.buildContainer()),this.containerRef},e.prototype.buildComponent=function(e){var t=this.getContainerRef(),i=e.layout,n=e.value,o=e.le,r=e.overrides;i.type===AdiCoreSanta.ElementTypes.Button&&(i=_.assign({},i,{width:1,height:1}));var a=i.breakingText;return this.ComponentBuilder.buildComponent(t,i,n,r||{},o,void 0,!0).then(function(e){return a&&(i.breakingText=a),e})},e.prototype.buildContainer=function(){var e=this.documentServicesMediator.getSiteStructure();return this.documentServicesMediator.addComponent(e,this._containerParams)},e}();e.VisualValidationRenderer=t,angular.module("adiCoreAppInternal").service("visualValidationRenderer",t)}(d||(d={}));var p=function(){function e(e,t,i,n,o){var r=this;this.$p=e,this.modelStore=t,this.$log=i,this.applicationParameters=n,this.flags=o,this.initialized=this.$p.defer(),this.layoutKeys=["width","height","x","y","scale","rotationInDegrees","fixedPosition","bounding"],this.siteChanges={_queueOnce:[],_queue:[],register:function(e,t){void 0===t&&(t=!1),t?r.siteChanges._queue.push(e):r.siteChanges._queueOnce.push(e)},flush:function(e){if(void 0===e&&(e=!1),!e&&r.siteChanges._queueOnce.length<=0)return r.$p.when();var t=r.siteChanges._queueOnce.map(function(e){return e});r.siteChanges._queueOnce.length=0;var i=r.$p.defer();return r.waitForChangesApplied(function(){var e=t.map(function(e){return e()});r.$p.all(e).then(i.resolve.bind(i))}),i.promise}},this.tpa={addWidget:function(e,t,i){var n=r.documentServices.tpa.widget.add(t,_.assign(i,{pageId:e}));return r.setDock(n),n},getMasterPageWidgets:function(){return r.serializeComponent(r.getSiteStructure()).children.filter(function(e){return e.componentType.indexOf("TPAGluedWidget")>=0})}},AdiCoreSanta.setDocumentServicesMediator(this)}return e.$inject=["$p","modelStore","$log","applicationParameters","flags"],e.prototype.whenInitialized=function(){return this.initialized.promise},e.prototype.initialize=function(t){var i=this;this.iframeDocument=t.document,this.documentServices=t.documentServices,this.documentServices.registerToSiteChanged(_.debounce(function(){i.siteChanges._queue.map(function(e){return e()}),i.siteChanges._queueOnce.map(function(e){return e()}),i.siteChanges._queueOnce.length=0},e.SITE_CHANGES_DEBOUNCE)),this.flags.debug&&this.documentServices.registerToErrorThrown(this.logError.bind(this)),this.initialized.resolve()},e.prototype.logError=function(e){this.$log.error("Santa error: ",e)},e.prototype.registerToCompLoadedEvent=function(e,t){return!!this.documentServices.tpa.change.register.compLoadedHandler&&(this.documentServices.tpa.change.register.compLoadedHandler(e),this.changeEditorModeCallback=t,!0)},e.prototype.getMetaSiteId=function(){return this.documentServices.generalInfo.getMetaSiteId()},e.prototype.getSiteId=function(){return this.documentServices.generalInfo.getSiteId()},e.prototype.getPartContainer=function(e,t){return"body"===e?t?this.getPageReference(t):null:"header"===e?this.getHeader():this.getFooter()},e.prototype.getDesktopPartContainer=function(e,t){return this.getDesktopComponent(this.getPartContainer(e,t))},e.prototype.getMobilePartContainer=function(e,t){return this.getMobileComponent(this.getPartContainer(e,t))},e.prototype.cloneComponentAndChangeType=function(e,t){var i=this;if(!e)return null;if(e.type===t)return e;if("SOSP_CONTAINER_CUSTOM_ID"===e.id)return{type:t,id:e.id};if("DESKTOP"===e.type&&!this.doesComponentExistByRef(e))return null;if("DESKTOP"===e.type&&"MOBILE"===t&&this.getComponentType(e)===AdiCoreSanta.DROP_DOWN_MENU)return this.getTinyMenuComp();if("MOBILE"===e.type&&"DESKTOP"===t&&"TINY_MENU"===e.id){return this.documentServices.components.getChildren({type:"DESKTOP",id:"SITE_HEADER"}).filter(function(e){return i.getComponentType(e)===AdiCoreSanta.DROP_DOWN_MENU})[0]}var n=ob.deepClone(e);return n.type=t,n},e.prototype.getMobileComponent=function(e){return this.cloneComponentAndChangeType(e,"MOBILE")},e.prototype.getDesktopComponent=function(e){return this.cloneComponentAndChangeType(e,"DESKTOP")},e.prototype.setDocumentServicesStyles=function(e){var t=this;_.each(e,function(e,i){t.updateStyle(i,e.properties,e.skin)})},e.prototype.createStyle=function(e,t,i){return{componentClassName:"",pageId:"",compId:"",styleType:"system",style:{properties:t},type:"TopLevelStyle",id:e,skin:i}},e.prototype.hideMobileComponent=function(e){var t=this.getDesktopComponent(e),i=this.getMobileComponent(e);t&&!this.isMobileOnlyComponent(i)&&this.documentServices.components.mobileHints.update(t,{hidden:!0})},e.prototype.showMobileComponent=function(e){var t=this.getDesktopComponent(e),i=this.getMobileComponent(e);t&&!this.isMobileOnlyComponent(i)&&this.documentServices.components.mobileHints.update(t,{hidden:!1})},e.prototype.isMobileComponentHidden=function(e){var t=this.documentServices.components.mobileHints.get(e);return t&&t.hidden},e.prototype.unhideTinyMenu=function(){var e=this.getTinyMenuComp();this.documentServices.mobile.hiddenComponents.show(e.id,"masterPage")},e.prototype.validateMobileHints=function(){return this.documentServices.validate.allMobileHints()},e.prototype.isMobileOnlyComponent=function(e){if(!e)return!1;var t=this.getMobileComponent(e);return t&&this.documentServices.mobile.mobileOnlyComponents.isMobileOnlyComponent(t.id)},e.prototype.getTinyMenuComp=function(){return{type:"MOBILE",id:"TINY_MENU"}},e.prototype.syncMobileSite=function(){this.documentServices.mobileConversion.syncMobileSite()},e.prototype.resetMobileLayout=function(e){void 0===e&&(e=!0),e?this.documentServices.mobileConversion.resetMobileLayoutOnAllPages({heuristicStrategy:"onboarding"}):this.syncMobileSite()},e.prototype.resetMobileLayoutOnAllPages=function(e){void 0===e&&(e=!0),this.flags.debug&&"MOBILE"===this.documentServices.viewMode.get()&&this.$log.warn("resetMobileLayoutOnAllPages must not be called when editor mode is mobile"),this.resetMobileLayout(e)},e.prototype.save=function(e){var t=this;if(void 0===e&&(e=!0),e){this.resetMobileLayoutOnAllPages(e);var i=this.modelStore.model.get("header"),n=this.getDesktopPartContainer("header");this.documentServices.components.layout.update(n,{height:i.height})}if(!this.saving){var o=this.$p.defer();this.saving=o.promise,this.documentServices.save(function(){o.resolve(),t.saving=null},function(e){o.reject(e),t.saving=null})}return this.saving},e.prototype.publish=function(){var e=this,t=this.$p.defer();return this.documentServices.publish(function(){t.resolve(),e.documentServices.tpa.change.sitePublished()},t.reject),t.promise},e.prototype.saveAsTemplate=function(){return this.documentServices.saveAsTemplate()},e.prototype.getPagesData=function(){return this.documentServices.pages.getPagesData()},e.prototype.getPagesNotMarkedAsHiddenFromMenu=function(){var t=this;return _.filter(this.getPagesData(),function(i){return!t.documentServices.tpa.isPageMarkedAsHideFromMenu(i.tpaApplicationId,i.tpaPageId)||e.TPA_HIDDEN_SHOWN_PAGES.indexOf(i.tpaPageId)>=0})},e.prototype.getPageIdList=function(){return this.documentServices.pages.getPageIdList()},e.prototype.getPageReference=function(e){return this.documentServices.pages.getReference(e)},e.prototype.getMobilePageReference=function(e){return this.getMobileComponent(this.getPageReference(e))},e.prototype.getDesktopPageReference=function(e){return this.getDesktopComponent(this.getPageReference(e))},e.prototype.updatePageNameAndVisibility=function(e,t,i){this.updatePage(e,{title:t,hidePage:i})},e.prototype.doesPageExist=function(e){return this.documentServices.pages.doesPageExist(e)},e.prototype.addPage=function(e){return this.documentServices.pages.add(e)},e.prototype.removePage=function(e,t){(this.documentServices.homePage.get()!==e||t)&&this.documentServices.pages.remove(e)},e.prototype.removeTpaSection=function(e){this.documentServices.tpa.section.delete(e)},e.prototype.getPageData=function(e){return this.documentServices.pages.data.get(e)},e.prototype.updatePage=function(e,t){_.isMatch(this.getPageData(e),t)||this.documentServices.pages.data.update(e,t)},e.prototype.getHomePage=function(){return this.documentServices.homePage.get()},e.prototype.setHomePage=function(e){this.documentServices.homePage.set(e)},e.prototype.getCurrentPageId=function(){return this.documentServices.pages.getCurrentPageId()},e.prototype.getCurrentPage=function(){return this.documentServices.pages.getCurrentPage()},e.prototype.getCurrentDesktopPage=function(){return this.getDesktopComponent(this.getCurrentPage())},e.prototype.getCurrentMobilePage=function(){return this.getMobileComponent(this.getCurrentPage())},e.prototype.navigateToPage=function(e){var t=this.$p.defer();return this.documentServices.pages.navigateTo(e,function(){t.resolve(e)}),t.promise},e.prototype.navigateToPageByPageId=function(e){this.documentServices.pages.navigateTo(e)},e.prototype.getPagesTransition=function(){return this.documentServices&&this.documentServices.pages.transitions.get()},e.prototype.setPagesTransition=function(e){this.getPagesTransition()!==e&&this.documentServices.pages.transitions.set(e)},e.prototype.getPageBackground=function(e){return this.documentServices.pages.background.get(e,"desktop")},e.prototype.addComponent=function(e,t,i){return void 0===i&&(i={}),this.documentServices.components.add(e,t,i.compId,i.zIndex)},e.prototype.removeComponent=function(e){var t=e;"string"==typeof e&&(t=this.getComponentRef(e)),this.documentServices.components.remove(t)},e.prototype.getComponentData=function(e){return this.documentServices.components.data.get(e)},e.prototype.getComponentType=function(e){return this.documentServices.components.getType(e)},e.prototype.isForType=function(e,t){return new RegExp(t+"$").test(this.getComponentType(e))},e.prototype.checkIfComponentType=function(e){var t,i=this;return{is:function(n){return(t=t||i.getComponentType(e))===n},isNot:function(n){return(t=t||i.getComponentType(e))!==n}}},e.prototype.doesComponentExist=function(e){var t=this.getComponentRef(e);return this.doesComponentExistByRef(t)},e.prototype.getComponentRef=function(e,t){return e?this.documentServices.components.get.byId(e,t):null},e.prototype.getAllComponentsByType=function(e){return this.documentServices.components.get.byType(e)},e.prototype.getDesktopComponentRef=function(e){return this.getDesktopComponent(this.getComponentRef(e))},e.prototype.getMobileComponentRef=function(e){return this.getMobileComponent(this.getComponentRef(e))},e.prototype.doesComponentExistByRef=function(e){return!!e&&this.documentServices.components.is.exist(e)},e.prototype.isComponentGroupable=function(e){return!!e&&this.documentServices.components.is.groupable(e)},e.prototype.isComponentContainer=function(e){return this.documentServices.components.is.container(e)},e.prototype.isComponentRendered=function(e){return this.documentServices.components.is.rendered(e)},e.prototype.getPageOfComponent=function(e){return this.documentServices.components.getPage(e)},e.prototype.getAllComponents=function(e){return this.documentServices.components.getAllComponents(e)},e.prototype.getPagesContainer=function(){return this.documentServices.siteSegments.getPagesContainer()},e.prototype.getMobilePagesContainer=function(){return this.getMobileComponent(this.getPagesContainer())},e.prototype.getDesktopPagesContainer=function(){return this.getDesktopComponent(this.getPagesContainer())},e.prototype.getFooter=function(){return this.documentServices.siteSegments.getFooter()},e.prototype.getMobileFooter=function(){return this.getMobileComponent(this.getFooter())},e.prototype.getDesktopFooter=function(){return this.getDesktopComponent(this.getFooter())},e.prototype.getHeader=function(){return this.documentServices.siteSegments.getHeader()},e.prototype.getDesktopHeader=function(){return this.getDesktopComponent(this.getHeader())},e.prototype.getMobileHeader=function(){return this.getMobileComponent(this.getHeader())},e.prototype.getChildren=function(e){return this.documentServices.components.getChildren(e)},e.prototype.getDesktopChildren=function(e){return this.getChildren(this.getDesktopComponent(e))},e.prototype.getMobileChildren=function(e){return this.getChildren(this.getMobileComponent(e))},e.prototype.getLayout=function(e){return this.documentServices.components.layout.get(e)},e.prototype.getMobileLayout=function(e){return this.getLayout(this.getMobileComponent(e))},e.prototype.calculatePageHeightByChildren=function(e){var t=this;return(this.flags.lodash4?_.strictMaxBy:_.max)(_.map(this.getChildren(e),function(e){var i=t.getLayout(e);return i.y+i.height}))},e.prototype.isMobileRef=function(e){return"MOBILE"===e.type},e.prototype.updateLayout=function(e,t){var i=_.pick(t,this.layoutKeys);this.documentServices.components.layout.update(e,i)},e.prototype.updateData=function(e,t){this.documentServices.components.data.update(e,t)},e.prototype.updateDesign=function(e,t){this.documentServices.components.design.update(e,t)},e.prototype.setDock=function(e,t){t?this.documentServices.components.layout.setDock(e,t):this.documentServices.components.layout.isDocked(e)&&this.documentServices.components.layout.unDock(e)},e.prototype.isDocked=function(e){return this.documentServices.components.layout.isDocked(e)},e.prototype.updateAndAdjustLayout=function(e,t){return this.documentServices.components.layout.updateAndAdjustLayout(e,t)},e.prototype.updateProps=function(e,t){this.documentServices.components.properties.update(e,t)},e.prototype.forkMobileProps=function(e){this.documentServices.components.properties.mobile.fork(e)},e.prototype.isMobilePropsForked=function(e){return this.doesComponentExistByRef(e)&&this.documentServices.components.properties.mobile.isForked(e)},e.prototype.getMobileFontSize=function(e){return this.documentServices.mobile.text.implicitFontSize(e)},e.prototype.serializeComponent=function(e,t){var i=e&&this.documentServices.components.serialize(e,null,t);if(i&&i.behaviors&&i.behaviors.items){var n=i.behaviors.items;i.behaviors.items="string"==typeof n?JSON.parse(n):n}return i},e.prototype.getContainer=function(e){return this.documentServices.components.getContainer(e)},e.prototype.setContainer=function(e,t,i){void 0===i&&(i=!1);var n=this.getContainer(e),o=i||!n||n.id!==t.id;return o&&this.documentServices.components.setContainer(e,t),o},e.prototype.moveToIndex=function(e,t){this.documentServices.components.arrangement.moveToIndex(e,t)},e.prototype.canMoveForward=function(e){return this.documentServices.components.arrangement.canMoveForward(e)},e.prototype.moveForward=function(e){this.canMoveForward(e)&&this.documentServices.components.arrangement.moveForward(e)},e.prototype.moveToFront=function(e){this.canMoveForward(e)&&this.documentServices.components.arrangement.moveToFront(e)},e.prototype.setComponentStyleId=function(e,t){return this.documentServices.components.style.connectToTheme(e,t)},e.prototype.setComponentStyle=function(e,t){return this.documentServices.components.style.update(e,t)},e.prototype.previewSetAnimations=function(e,t){var i=this,n=this.documentServices.components.behaviors.get(e);n&&n.length>0&&n.forEach(function(n){t&&n.action!==t||i.componentPreviewAnimation(e,n)})},e.prototype.componentPreviewAnimation=function(e,t){this.documentServices.components.behaviors.previewAnimation(e,t)},e.prototype.previewAllSetAnimations=function(e,t){var i=this;this.previewSetAnimations(e,t);var n=this.getChildren(e);n.length>0&&n.forEach(function(e){i.previewAllSetAnimations(e,t)})},e.prototype.previewAnimation=function(e,t){return this.documentServices.components.behaviors.previewAnimation(e,t)},e.prototype.transitionInOut=function(e,t,i){var n=this;if(!t[0]&&!e[0])return this.$p.when();var o=this.$p.defer();return this.documentServices.components.behaviors.previewTransition(t,e,{name:i.type,duration:1,params:{callbacks:{onComplete:function(){t.forEach(function(e){var t=n.getElementByCompRef(e);t&&(t.style.visibility="hidden")}),o.resolve()}}}}),o.promise},e.prototype.stopPreviewAnimation=function(e){this.documentServices.components.behaviors.stopPreviewAnimation(e)},e.prototype.removeAnimations=function(e,t){this.documentServices.components.behaviors.remove(e,void 0,t)},e.prototype.removeAllAnimations=function(e,t){var i=this;this.removeAnimations(e,t);var n=this.getChildren(e);n.length>0&&n.forEach(function(e){i.removeAllAnimations(e,t)})},e.prototype.setAnimation=function(e,t){this.isComponentAnimatable(e)&&this.documentServices.components.behaviors.update(e,t)},e.prototype.executeBehavior=function(e,t,i){documentServices.components.behaviors.execute(e,t,i)},e.prototype.setAllAnimations=function(e,t){var i=this;this.setAnimation(e,t);var n=this.getChildren(e);n.length>0&&n.forEach(function(e){i.setAllAnimations(e,t)})},e.prototype.isComponentAnimatable=function(e){return!!e&&this.documentServices.components.is.animatable(e)},e.prototype.getSiteStructure=function(){return this.documentServices.siteSegments.getSiteStructure()},e.prototype.getSiteStructureId=function(){return this.documentServices.siteSegments.getSiteStructureId()},e.prototype.setHideTextComponent=function(e){this.documentServices.renderPlugins.setHideTextComponent(e)},e.prototype.addMenuLinkItem=function(e,t,i){return this.documentServices.mainMenu.addLinkItem(e,t,i)},e.prototype.removeMenuItem=function(e){this.documentServices.mainMenu.removeItem(e)},e.prototype.moveMenuItem=function(e,t,i){var n=this.getDataById(e);if(!n||n.isVisible){if(t){var o=this.getDataById(t);if(_.findIndex(o.items,{id:e})===i)return}else{var r=this.getMenuItems(!0);if(_.findIndex(r,{id:e})===i)return}this.documentServices.mainMenu.moveItem(e,t,i)}},e.prototype.getDataById=function(e){return this.documentServices.data.getById(e)},e.prototype.isMenuItemRemovable=function(e){return this.documentServices.mainMenu.isItemRemovable(e)},e.prototype.setMenuItemLabel=function(e,t){this.documentServices.mainMenu.setItemLabel(e,t)},e.prototype.updateMenuLinkItem=function(e,t){this.documentServices.mainMenu.updateLinkItem(e,t)},e.prototype.getMenuItems=function(e){return this.documentServices.mainMenu.getMenu(e)},e.prototype.getDsSaveErros=function(){return this.documentServices.errors.save},e.prototype.getMenuById=function(e){return this.documentServices.menu.getById(e)},e.prototype.getValidPageUriSEO=function(e,t){return this.documentServices.pages.data.pageUriSEO.getValid(e,t)},e.prototype.convertPageNameToUrl=function(e){return this.documentServices.pages.data.pageUriSEO.convertPageNameToUrl(e)},e.prototype.setSeoTitle=function(e){this.documentServices.seo.title.set(e)},e.prototype.setSeoKeywords=function(e){this.documentServices.seo.keywords.set(e)},e.prototype.setSeoDescription=function(e){this.documentServices.seo.description.set(e)},e.prototype.validateSeoTitle=function(e){return this.documentServices.seo.title.validate(e).success},e.prototype.validateSeoKeywords=function(e){return this.documentServices.seo.keywords.validate(e).success},e.prototype.validateSeoDescription=function(e){return this.documentServices.seo.description.validate(e).success},e.prototype.getStyleDefinitionByComp=function(e){return this.documentServices.components.style.get(e)},e.prototype.moveHeaderToFront=function(){this.moveToFront(this.getPartContainer("header"))},e.prototype.positionOf=function(e){var t=this.getContainer(e);return this.getChildren(t).findIndex(function(t){return t.id===e.id})},e.prototype.moveMobileHeaderToFront=function(){var e=this.getMobileHeader(),t=this.getMobilePagesContainer();this.positionOf(e)<this.positionOf(t)&&this.moveToFront(e)},e.prototype.getStyleDefinition=function(e){return this.documentServices.theme.styles.get(e)},e.prototype.getAllStyles=function(){return this.documentServices.theme.styles.getAll("masterPage")},e.prototype.getAllFonts=function(){return this.documentServices.theme.fonts.getAll()},e.prototype.updateStyle=function(e,t,i){var n=this.createStyle(e,t,i);return this.documentServices.theme.styles.update(e,n)},e.prototype.updateFonts=function(e){this.documentServices.theme.fonts.update(e)},e.prototype.updateColors=function(e){var t=this;e=ob.deepClone(e);var i=this.getThemeColors();_.each(e,function(n,o){t.flags.setStylesPerf2&&(n=n.toUpperCase()),i[o]===n&&delete e[o]}),_.isEmpty(e)||this.documentServices.theme.colors.update(e)},e.prototype.useSimpleTimeoutToDeferQueue=function(){this.documentServices&&this.documentServices.useSimpleTimeoutToDeferQueue&&this.documentServices.useSimpleTimeoutToDeferQueue()},e.prototype.useAnimationFrameToDeferQueue=function(){this.documentServices&&this.documentServices.useAnimationFrameToDeferQueue&&this.documentServices.useAnimationFrameToDeferQueue()},e.prototype.activateSantaRender=function(){this.flags.initRenderPerf&&this.documentServices.enableRenderPage()},e.prototype.updateComponentContent=function(e,t){this.documentServices.components.data.update(this.applicationParameters.isInMobileEditMode()?this.getMobileComponent(e):e,t),this.save()},e.prototype.getArrangement=function(){return this.documentServices.components.arrangement},e.prototype.getDefaultLayout=function(e,t){return this.documentServices.tpa.app.getDefaultLayout(e,t)},e.prototype.getTpaData=function(e){return this.documentServices.tpa.app.getData(e)},e.prototype.getSectionsToAutoInstallWidgetData=function(e){return this.documentServices.tpa.app.getSectionsToAutoInstallWidgetData&&this.documentServices.tpa.app.getSectionsToAutoInstallWidgetData(e)},e.prototype.tpaPostMessageHandler=function(e,t){this.documentServices.tpa.handlers(e,t)},e.prototype.toggleWixAds=function(){this.documentServices.documentMode.toggleWixAds()},e.prototype.waitForChangesApplied=function(e){return this.documentServices.waitForChangesApplied(e)},e.prototype.isSitePublished=function(){return this.documentServices&&this.documentServices.generalInfo.isSitePublished()},e.prototype.getPublicUrl=function(){return this.documentServices&&this.documentServices.generalInfo.getPublicUrl()},e.prototype.setPublicUrl=function(e){this.documentServices.generalInfo.setPublicUrl(e)},e.prototype.getUsername=function(){return this.documentServices.generalInfo.getUserInfo().name},e.prototype.getUserId=function(){return this.documentServices.generalInfo.getUserId()},e.prototype.isPremium=function(){return this.documentServices.premiumFeatures.get().length>0},e.prototype.getFreeDomain=function(){return this.documentServices.generalInfo.urlFormat.isSlash()?"wixsite.com":"wix.com"},e.prototype.setPreviewModeOptions=function(e){this.documentServices.documentMode.enablePlaying(e),this.documentServices.documentMode.enableZoom(e),this.documentServices.documentMode.enableSocialInteraction(!1),this.documentServices.documentMode.enableExternalNavigation(!1),this.documentServices.documentMode.enableSlideShowGalleryClick(e),this.documentServices.documentMode.enableTinyMenuOpening(e),this.documentServices.documentMode.enableRenderFixedPositionContainers(e),this.documentServices.documentMode.enableRenderFixedPositionBackgrounds(e),this.documentServices.documentMode.enableBackToTopButton(e),this.documentServices.documentMode.enablePageProtection(!1),this.documentServices.documentMode.enableBgVideoAutoplay(e),this.documentServices.documentMode.enableSiteMembersDialogsOpening(e),this.documentServices.documentMode.enableResetGalleryToOriginalState(e),this.documentServices.documentMode.enableResetComponent(!e),this.documentServices.documentMode.resetBehaviors(e),this.documentServices.documentMode.enableAction("screenIn",e),this.documentServices.documentMode.enableAction("bgScrub",e),this.documentServices.documentMode.enableShouldUpdateJsonFromMeasureMap(!e),this.documentServices.documentMode.allowSiteOverflow(e),this.documentServices.documentMode.setComponentViewMode(e?"preview":"editor"),this.documentServices.tpa.change.editMode(e?"preview":"editor"),this.documentServices.documentMode.enablePageTransitions(e)},e.prototype.allowSiteOverflow=function(e){this.documentServices.documentMode.allowSiteOverflow(e)},e.prototype.setComponentViewMode=function(e){this.documentServices.documentMode.setComponentViewMode(e)},e.prototype.changeEditMode=function(e){this.documentServices.tpa.change.editMode(e)},e.prototype.closePopupsAndModal=function(){this.documentServices.tpa.closePopupsAndModal()},e.prototype.onboardingViewportMode=function(e){this.documentServices.documentMode.onboardingViewportMode(e)},e.prototype.deleteWidget=function(e){this.documentServices.tpa.widget.delete(e)},e.prototype.getComponentSkins=function(e){return this.documentServices.theme.skins.getComponentSkins(e)},e.prototype.getSantaCompDefinition=function(e){return this.documentServices.components.getDefinition(e)},e.prototype.registerToErrorThrown=function(e){return this.documentServices.registerToErrorThrown(e)},e.prototype.waitForChanges=function(){if(!this.documentServices)return this.$p.when();var e=this.$p.defer();return this.waitForChangesApplied(function(){e.resolve()}),e.promise},e.prototype.getElementByCompRef=function(e){return this.iframeDocument.getElementById(e.id)},e.prototype.getIframeDocument=function(){return this.iframeDocument},e.prototype.addTpaSection=function(e,t){var i=this;if(this.flags.promisifyAddTpa)return new Promise(function(n,o){t.callback?o(new Error("callback should not be defined")):(t.callback=function(e){n(e)},i.documentServices.tpa.section.add(e,t,function(e){return o(e)}))});this.documentServices.tpa.section.add(e,t)},e.prototype.addBlogOld=function(e,t,i,n){this.documentServices.wixapps.classics.blog.addBlog(e,t,i,n)},e.prototype.addBlog=function(e,t,i){var n=this;return new Promise(function(o){n.documentServices.wixapps.classics.blog.addBlog(e,t,i,function(e){o(e)})})},e.prototype.addMembersArea=function(e){return this.documentServices.platform.provision(this.documentServices.platform.editorApps.SANTA_MEMBERS.appDefId,{origin:{initiator:"EDITOR",info:{type:"ADD_PANEL"}}}).then(function(){e&&e()})},e.prototype.getPlatformMembersAppDefId=function(){return this.documentServices.platform.editorApps.SANTA_MEMBERS.appDefId},e.prototype.getPlatformAppDataByAppDefId=function(e){return this.documentServices.platform.getAppDataByAppDefId(e)},e.prototype.getPlatformAppsContainer=function(){return this.documentServices.platform.getAppsContainer()},e.prototype.getDataByAppDefId=function(e){return this.documentServices.tpa.app.getDataByAppDefId(e)},e.prototype.getAllCompsByApplicationId=function(e){return this.documentServices.tpa.app.getAllCompsByApplicationId(e)},e.prototype.replaceBlogPages=function(e,t,i){this.documentServices.wixapps.classics.blog.replaceBlogPages(e,t,i)},e.prototype.setTpaData=function(e,t,i,n,o){this.documentServices.tpa.data.set(e,t,i,n,o)},e.prototype.updateTpaSettings=function(e,t,i){this.documentServices.tpa.change.trigger.settingsUpdated(e,t,i)},e.prototype.triggerEditorEvent=function(e,t){this.documentServices.tpa.change.trigger.editorEvent(Object.assign({type:e},t))},e.prototype.reloadApp=function(e){this.documentServices.wixapps.classics.reloadApp(e)},e.prototype.refreshApp=function(e){this.documentServices.tpa.app.refreshApp(e)},e.prototype.getRenderedReactCompsByApplication=function(e){return this.documentServices.tpa.app.getRenderedReactCompsByApplicationId(e)},e.prototype.isBlogPage=function(e){return this.documentServices.wixapps.classics.isBlogPage(e)},e.prototype.isSinglePost=function(e){return this.documentServices.wixapps.classics.blog.isSinglePost(e)},e.prototype.getMainSectionWidgetDataFromApplicationId=function(e){return this.documentServices.tpa.app.getMainSectionWidgetDataFromApplicationId(e)},e.prototype.getSectionRefByPageId=function(e){return this.documentServices.tpa.section.getSectionRefByPageId(e)},e.prototype.mapWixParamsToCssValues=function(e,t){this.documentServices.tpa.style.mapWixParamsToCssValues(e,t)},e.prototype.getNameToFontsKeyMap=function(){return this.documentServices.tpa.style.getNameToFontsKeyMap()},e.prototype.getThemeColor=function(e){return this.documentServices.theme.colors.get(e)},e.prototype.getThemeColors=function(){return this.documentServices.theme.colors.getAll()},e.prototype.getThemeFont=function(e){return this.documentServices.theme.fonts.get(e)},e.prototype.hasMapWixParamsToCssValues=function(){return!!this.documentServices.tpa.style.mapWixParamsToCssValues},e.prototype.hasOnboardingViewportMode=function(){return!!this.documentServices.documentMode.onboardingViewportMode},e.prototype.hasAddBlog=function(){return!!this.documentServices.wixapps.classics.blog.addBlog},e.prototype.isFirstSave=function(){this.documentServices.generalInfo.isFirstSave()},e.prototype.getAllSantaFontsMetaData=function(){return this.documentServices.fonts.getSiteFontsOptions()},e.prototype.getAllSantaFontsCSS=function(){return this.documentServices.fonts.css.getUrls()},e.prototype.getSiteScroll=function(){return this.documentServices.site.getScroll()},e.prototype.getSiteHeight=function(){return this.documentServices.site.getHeight()},e.prototype.getSiteName=function(){return this.documentServices&&this.documentServices.siteName.get()},e.prototype.setSiteName=function(e){return this.documentServices.siteName.set(e)},e.prototype.isSiteNameValid=function(e){return!!this.validateSiteName(e).success},e.prototype.validateSiteName=function(e){return this.documentServices.siteName.validate(e)},e.prototype.setSiteScrollAndScale=function(e,t,i){this.documentServices.site.setScrollAndScale(e,t,i)},e.prototype.setSiteScroll=function(e,t){this.documentServices.site.setScroll(e,t)},e.prototype.setEditorMode=function(e,t,i){var n=this;return void 0===t&&(t=!1),this.documentServices.viewMode.set(e),this.changeEditorModeCallback&&this.changeEditorModeCallback(),this.waitForChanges().then(function(){i||(n.documentServices.documentMode.enableAction("screenIn",t),n.documentServices.documentMode.enableAction("load",!0),n.documentServices.documentMode.enableAction("modeChange",t),n.documentServices.documentMode.enableAction("exit",t),n.documentServices.documentMode.enableAction("bgScrub",t),n.documentServices.documentMode.enableAction("pageTransition",t),n.documentServices.documentMode.enableBgVideoAutoplay(t))})},e.prototype.setMembersLoginDialogFirst=function(e){this.documentServices.siteMembers.setLoginDialogFirst(e)},e.prototype.setMembersSocialLoginVendorStatus=function(e,t){this.documentServices.siteMembers.setSocialLoginVendorStatus(e,t)},e.prototype.setMembersSignupPoliciesFieldEnabled=function(e,t){return this.documentServices.siteMembers.setSignupPoliciesFieldStatus(e,t)},e.prototype.setMembersSignupPoliciesPage=function(e,t){return this.documentServices.siteMembers.setSignupPoliciesLink(e,{pageId:"#"+t,target:"_self",type:"PageLink"})},e.prototype.setMembersSignupPoliciesAnchor=function(e,t,i,n){return this.documentServices.siteMembers.setSignupPoliciesLink(e,{anchorName:t,anchorDataId:i,pageId:"#"+n,type:"AnchorLink"})},e.prototype.getMembersSignupPoliciesLink=function(e){return this.documentServices.siteMembers.getSignupPoliciesLink(e)},e.prototype.setMembersAutoApproval=function(e){return this.documentServices.siteMembers.setAutoApproval(e)},e.prototype.updateTpaStyleByCompId=function(e,t){var i=this.$p.defer();return this.documentServices.tpa.style.setStyleParam(e,t,function(){i.resolve()}),i.promise},e.prototype.provision=function(e,t){return this.documentServices.platform.provision(e,t)},e.SITE_CHANGES_DEBOUNCE=1e3,e.TPA_HIDDEN_SHOWN_PAGES=["events"],e.MINIMUM_COMPONENT_HEIGHT=5,e}();angular.module("adiCoreAppInternal").service("documentServicesMediator",p),function(e){e.GENERAL_VALIDATIONS={PAGE_NAME_MAX_LENGTH:100,MAX_MEDIA_TITLE_LENGTH:100,MAX_MEDIA_DESCRIPTION_LENGTH:1200,MAX_PHONE_NUMBER_LENGTH:100};var t=function(){function e(e){var t=this;this.documentServicesMediator=e,this.setSiteScale=function(e,i){return t.documentServicesMediator.setSiteScrollAndScale(0,i||0,e)},this.setSiteScroll=function(e,i){return t.documentServicesMediator.setSiteScroll(e,i)},this.getSiteScroll=function(){return t.documentServicesMediator.getSiteScroll()},this.getSiteHeight=function(){return t.documentServicesMediator.getSiteHeight()},this.getSiteName=function(){return t.documentServicesMediator.getSiteName()},this.isSitePublished=function(){return t.documentServicesMediator.isSitePublished()},this.getDsSaveErros=function(){return t.documentServicesMediator.getDsSaveErros()},this.getMetaSiteId=function(){return t.documentServicesMediator.getMetaSiteId()},this.getUsername=function(){return t.documentServicesMediator.getUsername()},this.getUserId=function(){return t.documentServicesMediator.getUserId()},this.getSiteId=function(){return t.documentServicesMediator.getSiteId()},this.saveAsTemplate=function(){return t.documentServicesMediator.saveAsTemplate()},this.setHomePage=function(e){return t.documentServicesMediator.setHomePage(e)},this.isSiteNameValid=function(e){return!!t.validateSiteName(e).success},this.validateSiteName=function(e){return t.documentServicesMediator.validateSiteName(e)},this.setMobileMode=function(e){return t.documentServicesMediator.setEditorMode("MOBILE",!1,e)},this.setDesktopMode=function(e,i){return t.documentServicesMediator.setEditorMode("DESKTOP",e,i)},this.waitForChanges=function(){return t.documentServicesMediator.waitForChanges()}}return e.$inject=["documentServicesMediator"],e.prototype.setSiteName=function(e){if(this.getSiteName()!==e){var t=this.validateSiteName(e);return t.success?this.documentServicesMediator.setSiteName(e):t.errorCode}},e.prototype.setPreviewMode=function(){this.documentServicesMediator.changeEditMode("preview"),this.documentServicesMediator.setComponentViewMode("preview")},e.prototype.onSiteChanges=function(e){this.documentServicesMediator.siteChanges.register(e,!0)},e}();e.SiteState=t,angular.module("adiCoreAppInternal").service("siteState",t)}(S||(S={})),function(e){!function(e){e.google="google",e.facebook="facebook"}(e.SignupVendors||(e.SignupVendors={})),function(e){e.termsOfUse="termsOfUse",e.privacyPolicy="privacyPolicy",e.codeOfConduct="codeOfConduct"}(e.MembersPolicies||(e.MembersPolicies={}))}(S||(S={})),function(e){var t=function(){function e(e){this.documentServicesMediator=e}return e.$inject=["documentServicesMediator"],e.prototype.navigateToPage=function(e){this.documentServicesMediator.navigateToPageByPageId(e)},e}();e.SitePages=t,angular.module("adiCoreAppInternal").service("sitePages",t)}(S||(S={})),function(e){e.SeoFields=["pageTitleSEO","descriptionSEO","metaKeywordsSEO","pageUriSEO","indexable"]}(S||(S={}));var h=function(){function e(e){this.documentServicesMediator=e,this.SEO_VALIDATIONS_REGEX={HTML_CHARS:/[<>]/g,KEYWORD_CHARS:/[!#$%^&()+=\]\[}{";:\/><~]/g,URI_CHARS:/[^.,';()%@!?$&*+~a-zA-Z0-9\[\]_:\/\"\n=-]/gi,META_TAG:/^\s*((((<meta|<link)\s[^>]*>*[\s\n]*)*>)|[\s\n]*(<!--[^<>]*-->)[\s\n]*)*[\s\n]*$/i},this.SEO_VALIDATIONS={TITLE_MAX_LENGTH:70,DESCRIPTION_MAX_LENGTH:320,KEYWORDS_MAX_LENGTH:250,METATAGS_MAX_LENGTH:2e3,REDIRECT_MAX_LENGTH:149},AdiCoreSanta.setSeoManager(this)}return e.$inject=["documentServicesMediator"],e.prototype.removeEmojis=function(t){return t.replace(e.EMOJI,"")},e.prototype.hasEmoji=function(t){return!(!t||!t.match(e.EMOJI))},e.prototype.getValidSeoTitle=function(e){return this.validateSeoTitle(e)?e:this.removeEmojis(e).replace(this.SEO_VALIDATIONS_REGEX.HTML_CHARS,"").substring(0,this.SEO_VALIDATIONS.TITLE_MAX_LENGTH)},e.prototype.validateSeoTitle=function(e){return this.documentServicesMediator.validateSeoTitle(e)&&!this.hasEmoji(e)},e.prototype.getValidPageUriSEO=function(e,t){return this.documentServicesMediator.getValidPageUriSEO(e,t)},e.prototype.convertPageNameToUrl=function(e){return this.documentServicesMediator.convertPageNameToUrl(e)},e.prototype.setSeoTitle=function(e){this.documentServicesMediator.setSeoTitle(e)},e.prototype.setSeoKeywords=function(e){this.documentServicesMediator.setSeoKeywords(e)},e.prototype.setSeoDescription=function(e){this.documentServicesMediator.setSeoDescription(e)},e.prototype.validateSeoKeywords=function(e){return this.documentServicesMediator.validateSeoKeywords(e)&&this.rangeOfWords(e)},e.prototype.validateSeoDescription=function(e){return this.documentServicesMediator.validateSeoDescription(e)&&!this.hasEmoji(e)},e.prototype.getValidSeoDescription=function(e){return this.validateSeoDescription(e)?e:this.removeEmojis(e).replace(this.SEO_VALIDATIONS_REGEX.HTML_CHARS,"").substring(0,this.SEO_VALIDATIONS.DESCRIPTION_MAX_LENGTH)},e.prototype.rangeOfWords=function(e){var t=e&&e.split(/\W+/);return!_.isUndefined(t)&&t.length>=0&&t.length<=10},e.prototype.getValidSeoKeywords=function(e){return this.validateSeoKeywords(e)?e:this.removeEmojis(e).replace(this.SEO_VALIDATIONS_REGEX.KEYWORD_CHARS,"").substring(0,this.SEO_VALIDATIONS.KEYWORDS_MAX_LENGTH)},e.prototype.getPageSEODefaults=function(e,t,i,n){var o={},r=this.SEO_VALIDATIONS.TITLE_MAX_LENGTH,a=this.documentServicesMediator.convertPageNameToUrl(e);return o.pageUriSEO=this.documentServicesMediator.getValidPageUriSEO(t,a),o.pageTitleSEO=e,i&&i.length<=r-o.pageTitleSEO.length-3&&(o.pageTitleSEO+=" | "+i),n.City&&n.City.value&&n.City.value.length<=r-o.pageTitleSEO.length-3&&(o.pageTitleSEO+=" | "+n.City.value),o.pageTitleSEO=this.getValidSeoTitle(o.pageTitleSEO),n.BusinessTagline&&n.BusinessTagline.value&&(o.metaKeywordsSEO=this.getValidSeoKeywords(n.BusinessTagline.value)),o},e.EMOJI=/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|[\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|[\ud83c[\ude32-\ude3a]|[\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/g,e}();angular.module("adiCoreAppInternal").service("seoManager",h),function(e){var t=function(){function e(e){this.documentServicesMediator=e}return e.$inject=["documentServicesMediator"],e.prototype.triggerSettingsClosedEvent=function(e){this.documentServicesMediator.triggerEditorEvent("OB_SETTINGS_CLOSED",{tpaType:e})},e.prototype.tpaHandler=function(e,t){return this.documentServicesMediator.tpaPostMessageHandler(e,t)},e.prototype.dsForPostMessagesHandlers=function(){return this.documentServicesMediator.documentServices},e}();e.SiteTpa=t,angular.module("adiCoreAppInternal").service("siteTpa",t)}(S||(S={})),function(e){var t=function(){function e(e,t,i,n,o,r){this.$window=e,this.$p=t,this.obMonitoring=i,this.DSHealthCheck=n,this.flags=o,this.documentServicesMediator=r,this.isReady=!1,AdiCoreSanta.setSiteInit(this)}return e.$inject=["$window","$p","obMonitoring","DSHealthCheck","flags","documentServicesMediator"],e.prototype.onSiteReady=function(e){var t=this,i=this.$p.defer(),n=function(o){(t.flags.removeSpinnerOnPreviewReady?"santa.siteReady"===o.data:"documentServicesLoaded"===o.data)&&e.documentServices&&e.documentServicesModel&&(t.documentServicesMediator.initialize(e),t.loadingStarted()?t.documentServicesMediator.waitForChanges().then(function(){i.resolve()}):i.resolve(),t.$window.removeEventListener("message",n))};return this.$window.addEventListener("message",n),i.promise},e.prototype.loadingStarted=function(){var e=this;this.documentServicesMediator.useSimpleTimeoutToDeferQueue(),this.documentServicesMediator.toggleWixAds(),this.documentServicesMediator.registerToErrorThrown(function(t){t&&"components.arrangement.moveToBack"===t.methodName||e.obMonitoring.error("santa error: "+JSON.stringify(t))});var t=this.DSHealthCheck.validateAndFix();return this.isReady=!0,t},e.prototype.finishLoading=function(){this.documentServicesMediator.useAnimationFrameToDeferQueue()},e}();e.SiteInit=t,angular.module("adiCoreAppInternal").service("siteInit",t)}(S||(S={}));var g=function(){function e(e,t,i,n,o,r,a,s,l,c,d,u,p,h,g,m,f,v,y,b,S,C,w,T){this.data=e,this.HeaderLayoutElement=t,this.heightMutations=i,this.solutionStatusCodes=n,this.modelTree=o,this.$log=r,this.mediaOverride=a,this.selections=s,this.$p=l,this.toasterService=c,this.componentStyles=d,this.LayoutElement=u,this.SmartLayoutElement=p,this.designKit=h,this.applicationParameters=g,this.cropFaceService=m,this.flags=f,this.layoutDecoration=v,this.LayoutUtils=y,this.columnService=b,this.sitePartTypes=S,this.obMonitoring=C,this.segmentLayoutElements=w,this.sectionBackgroundService=T,this.contentElement=e.contentElement,this.forContent=e.forContent,this.height=e.height,this.left=e.left,this.node=e.node,this.top=e.top,this.width=e.width,this.page=e.page,this.partitionIndex=e.partitionIndex,this._zigZagVersion={},this.heightMutationsArr=this.heightMutations.heightMutations,this.renderedComponents=[],this.isMobile=e.isMobile}return e.$inject=["data","HeaderLayoutElement","heightMutations","solutionStatusCodes","modelTree","$log","mediaOverride","selections","$p","toasterService","componentStyles","LayoutElement","SmartLayoutElement","designKit","applicationParameters","cropFaceService","flags","layoutDecoration","LayoutUtils","columnService","sitePartTypes","obMonitoring","segmentLayoutElements","sectionBackgroundService"],e.prototype.getSegmentNode=function(){return this.node||this.modelTree.getGeneralInformation()},e.prototype.hasDecorativeContainerLayout=function(){var e=this.getLE();return e.layoutArray.some(function(t){return e.isDecorativeContainerLayout(t)})},e.prototype.getOptionalLayoutElements=function(){return this.optionalLayoutElements},e.prototype.isValidIndexArr=function(e,t){return _.isNumber(e)&&e>=0&&e<t},e.prototype.clearCache=function(){this._typeForLSS=void 0,this._typeForLSSWithoutNodeId=void 0,this._typeForLSSWithoutPartition=void 0,this._zigZagVersion={}},e.prototype.resetOptionalLayoutElements=function(){this.optionalLayoutElements=[]},e.prototype.revalidateMediaOverrides=function(){var e=this;if(!this.isMobile){var t=this.getLENoError();t&&t.recurseLayouts(function(i){t.isMediaLayout(i)&&e.mediaOverride.revalidate(t,i,e)})}},e.prototype.faceDetectionAutoCrop=function(){var e=this.getLENoError(),t=e&&e.getLayoutBySubType(AdiCoreSanta.ElementSubTypes.Image),i=e&&t&&e.getArgValue(t.argIndex)[0];if(i&&!this.node.getCropOfImage(t.argIndex,i.relativeUri,t)){var n=_.get(i,"fileInput.face"),o=(n=_.filter(n,function(e){return e.height&&e.width&&e.width+e.x<=i.width&&e.height+e.y<=i.height}))&&n.length;if(o){var r=0,a=!1,s=["TeamMember","Testimonial","Quote","Welcome"].indexOf(this.contentElement.type)>=0,l=_.some(n.filter(function(e){return e.height*e.width>i.height*i.width/2})),c=this.getLE().getLayoutBySubType(AdiCoreSanta.ElementSubTypes.Image).width;s||l?this.node.isListItem?(r=1,a=!0):1===o&&c<940?(r=1,a=!0):(r=2,a=!1):(r=2,a=!1),this.autoCrop(r,!a,!0,i)}else{var d=e.getLayoutSelectionStore().getImageStretch(e.containingSegment,e),u=this.node.getClosestCrop(t.argIndex,i.relativeUri,t);if(u&&u.data){var p={height:t.height,width:t.width},h={width:u.width,height:u.height};d&&(p.height+=d.top+d.bottom,p.width+=d.left+d.right,h.width+=d.left+d.right,h.height+=d.top+d.bottom);var g=this.cropFaceService.cropBasedOnAnotherCrop(p,h,u.data,i);this.$log.info("Reusing crop for - node:",this.node,"oldViewport:",h,"newViewport:",p,"closestCrop:",u.data,"newCrop:",g),this.node.setCropData(t.argIndex,i.relativeUri,t,g)}}}},e.prototype.faceDetectionAutoFocalPoint=function(){var e=this.getImageData(),t=e&&e.uri;if(!this.getFocalPoint(t)){var i=this.cropFaceService.getFocalPointByFacePosition(e);this.setFocalPoint(i,t)}},e.prototype.getImageData=function(){var e=this.getLENoError(),t=e&&e.getLayoutBySubType(AdiCoreSanta.ElementSubTypes.Image);return e&&t&&e.getArgValue(t.argIndex)[0]||this.getBgImageData()},e.prototype.getBgImageData=function(){var e=this.sectionBackgroundService.getBackground(this.node);if(e.mediaType===AdiCoreSanta.BgMediaTypes.IMAGE)return this.node.contentElement.allValuesByMediaType[e.mediaType].find(function(t){return(e.mediaId||e.mediaIds[0]).includes(t.relativeUri)})},e.prototype.autoCrop=function(e,t,i,n){var o;if(void 0===i&&(i=!1),!this.node.isListFooter()&&!this.node.isListHeader()){var r=this.getLENoError(),a=r&&r.getLayoutBySubType(AdiCoreSanta.ElementSubTypes.Image),s=_.get(n,"fileInput.face[0]");if(a&&s){var l=this.cropFaceService.combineFaces(_.get(n,"fileInput.face")),c=r.getLayoutSelectionStore().getImageStretch(r.containingSegment,r),d={height:a.height,width:a.width};c&&(d.height+=c.top+c.bottom,d.width+=c.left+c.right),0===e?o=this.cropFaceService.cropFaceMinAlpha(d,n,l):1===e?o=this.cropFaceService.cropFaceCustomAlpha(d,n,l,t):2===e&&(o=this.cropFaceService.cropFaceMaxAlpha(d,n,l,t)),o.source="auto";this.node.setCropData(a.argIndex,n.relativeUri,a,o,!0),this.flags.debug&&this.$log.info("Segment ran autoCrop on image","\nFaces found:",n.fileInput.face,"\nCombined faces:",this.cropFaceService.combineFaces(n.fileInput.face),"\nSegment:",this,"\nViewport:",d,"\nAlpha:",e,"\nCrop:",this.node.getCropOfImage(a.argIndex,n.relativeUri,a),"\nImage Layout:",a)}}},e.prototype.alignStripImage=function(){if(this.shouldAlignImage()){var e=this.node&&this.node.contentElement,t=e&&e.getValuesByMediaType(),i=t&&t.image&&t.image[0];if(!i)return;var n=this.node.getAlignment(i.relativeUri)||this.cropFaceService.getAlignmentByFacePosition(i);n&&this.setAlignment(n)}},e.prototype.getMediaOverrides=function(){var e=this.getLENoError(),t=e&&e.getMediaLayout();return t&&this.mediaOverride.getGallery(e,t,this)},e.prototype.setMediaOverrides=function(e){var t=this.getLE(),i=t&&t.getMediaLayout();e&&this.mediaOverride.setGallery(t,i,this,e)},e.prototype.getAlignment=function(){var e=this.getMediaOverrides();return this.selections.getForNode(this.node).alignment||e&&e.properties.alignType||"center"},e.prototype.setAlignment=function(e){this.selections.getForNode(this.node).alignment=e},e.prototype.setFocalPoint=function(e,t){this.flags.focalPointFocusOnFaces?(t=t||this.getCurrentImageRelativeUri(),this.node.setFocalPoint(t,e)):this.selections.getForNode(this.node).focalPoint=e},e.prototype.getFocalPoint=function(e){return this.flags.focalPointFocusOnFaces?(e=e||this.getCurrentImageRelativeUri(),this.node.getFocalPoint(e)):this.selections.getForNode(this.node).focalPoint},e.prototype.getCurrentImageRelativeUri=function(){var e=this.getImageData();return e&&e.relativeUri},e.prototype.updateAlignment=function(e,t){this.setAlignment(t),this.node.setAlignment(e,t,!0)},e.prototype.shouldAlignImage=function(){return this.hasStripImage()||this.hasColumnWithMediaBackground()||this.flags.focalPointFocusOnFaces&&this.hasColumnWithMediaBackgroundIntent()},e.prototype.canChangeScrollType=function(){return this.hasStripImage()||this.hasColumnWithMediaBackground()},e.prototype.updateScrollType=function(e){var t=this.getMediaOverrides();t&&(t.properties.scrollType=t.sourceProperties.scrollType=e,this.setMediaOverrides(t))},e.prototype.hasStripImage=function(){var e=this.getMediaOverrides();return e&&"Strip Image"===e.name},e.prototype.hasColumnWithAnyBackground=function(){var e=this.containingLG.columns;return _.some(e,function(e){return _.some(e,function(e){return!!e.currentSettings.backgroundMode})})},e.prototype.hasFullColumnWithBackground=function(){if(940===this.width){var e=this.containingLG.columns;return _.some(e,function(e){if(1===e.length)return!!e[0].currentSettings.backgroundMode})}},e.prototype.isPresetPreview=function(){if(!this.flags.coreNewMobileColumns)return this.page&&-1!==this.page.indexOf("layoutPresetPreview")},e.prototype.hasColumnWithColorBackground=function(){var e=this.containingLG.columns;if(this.isMobile){var t=this.columnService.getAnyColumnBackground(this.containingLG);if(!e&&t&&t.color)return!0}return _.some(e,function(e){return _.some(e,function(e){return"color"===e.currentSettings.backgroundMode})})},e.prototype.hasColumnWithMediaBackgroundIntent=function(){var e=this.containingLG.getColumnsData();if(e&&e.enable)return"image"===e.backgroundMode||"imageOrColor"===e.backgroundMode},e.prototype.hasColumnWithMediaBackground=function(){var e=this.containingLG.columns;return _.some(e,function(e){return _.some(e,function(e){return"image"===e.currentSettings.backgroundMode})})},e.prototype.hasAllColumnsWithMediaBackground=function(){var e=this.containingLG.columns;return e&&_.every(e,function(e){return _.every(e,function(e){return"image"===e.currentSettings.backgroundMode})})},e.prototype.allowedMobileMediaBackgroundPadding=function(){var e=this;if(this.isMobile)return!1;var t=this.containingLG.columns,i=_.map(t,function(t){return _.filter(t,function(t){return t.segment===e})}),n=i.length>1,o=_.some(i,function(e){return e.length>1}),r=this.hasColumnWithMediaBackgroundIntent(),a=_.uniq(_.map(_.flatten(t),"segment")).length>1;return r&&!o&&(!n||a)},e.prototype.getLayoutDataFromPreset=function(e){return this.LayoutUtils.getLayoutDataFromPreset(e,this.width,this.node)},e.prototype.calculateSegmentStatus=function(e,t){var i=this,n={},o=this.getLayoutSelectionStore().getLESelectionArr(this.getPageDescriptor(),this,!0);o&&(o=o.slice().reverse());var r=this.getSegBrothers();_.each(r,function(e){e.contentElement.extractCeFields(e.containingLG.allContentElements)});var a=!this.prevHeight||this.prevHeight>this.height||this.contentElement.ceFieldsChanged();this.prevHeight=this.height,this.contentElement.updatePrevCeFields();var s=_.sortBy(this.optionalLayoutElements,function(e){return-_.indexOf(o,e.id)});return this.setOverrides(),_.allPromises(s,function(o){return o.cluster&&n[o.cluster]&&o.cluster!==i.clusterExpanded?(o.active=!1,!0):o.calculateLayoutElementStatus(i.contentElement,e,t,a).then(function(){return!o.mutation&&(o.solutionStatus===i.solutionStatusCodes.pass&&o.cluster&&(n[o.cluster]?o.active=!1:(n[o.cluster]=!0,o.active=!0)),!0)})}).then(function(){return _.some(i.optionalLayoutElements,function(e){return e.isPassing()})})},e.prototype.isHeightValid=function(e){return!!this.heightMutationsArr[e]},e.prototype.cloneOptionalLayoutElements=function(e){var t=this,i=this.segmentLayoutElements.getSegLayoutElements(this);1!==this.containingLG.segments.length&&i&&i.length&&i[0].wantedArgs===this.getWantedArgs()&&!this.containingLG.isZigZagWithColumns()?(this.optionalLayoutElements=_.map(i[0].layoutElements,function(e){var i=e.shallowClone();return i.setLGContainer(t.containingLG),i.setSegContainer(t),Object.seal(i),i}),this.segmentLayoutElements.setSegLayoutElements(this,this.optionalLayoutElements)):(this.optionalLayoutElements=_.map(e,function(e){var i=new t.LayoutElement(e,e.solutionStatus,!0,e.editMode);return i.needsFirstTimeInit=!0,i.setLGContainer(t.containingLG),i.setSegContainer(t),i}),this.containingLG.segments.length>1&&this.segmentLayoutElements.setSegLayoutElements(this,this.optionalLayoutElements,!0))},e.prototype.changeSegmentHeight=function(e,t){var i=this;return!this.containingLG.isHeader()&&(!(!t&&this.selectedHeightMutation===e||!this.isValidIndexArr(e,this.heightMutationsArr.length))&&(e=e||0,this.selectedHeightMutation=e,this.height=parseInt(this.heightMutationsArr[this.selectedHeightMutation],10),_.each(this.optionalLayoutElements,function(e){e.passingHeight&&i.height>=e.passingHeight&&i.height<e.height&&e.reset()}),!0))},e.prototype.chooseLayoutElementOptionByIndex=function(e,t){var i=this.getLE(e,!0);if(i&&i.getSolutionStatus()===this.solutionStatusCodes.pass){var n=this.getLE(void 0,!0);n&&i.cluster&&i.cluster===n.cluster&&(n.active=!1),this.clusterExpanded!==i.cluster&&(this.clusterExpanded=-1),i.active=!0,t&&((i.structure||this.containingLG.isHeader())&&this.getLayoutSelectionStore().setPreferredLayoutData(this,i.getLayoutData()),this.getLayoutSelectionStore().setManualLESelection(this.getPageDescriptor(),this,i.id)),this.getLayoutSelectionStore().setLESelection(this.getPageDescriptor(),this,i.id)}},e.prototype.chooseLayoutElementOptionAndChangeHeight=function(e){var t=this,i=_.findIndex(this.optionalLayoutElements,{id:e}),n=this.getLENoError(i);if(n&&n.isPassing()){if(n.isValidForHeight())return this.chooseLayoutElementOptionById(e,!0),this.$p.when(!0);var o=this.containingLG.segments.indexOf(this);return this.containingLG.tryToChangeSegHeight(o,n.height).then(function(i){return i&&t.chooseLayoutElementOptionById(e,!0),i})}return this.$p.when(!1)},e.prototype.chooseLayoutElementOptionById=function(e,t){var i=_.findIndex(this.optionalLayoutElements,{id:e});return this.chooseLayoutElementOptionByIndex(i,t)},e.prototype.checkLEbyIndex=function(e){var t=this.getLE(e);return!!t&&((this.clusterExpanded>=0?t.cluster===this.clusterExpanded:!t.cluster||t.active)&&t.isValidForHeight())},e.prototype.chooseNextlayoutElementOption=function(e,t){if(0!==this.optionalLayoutElements.length){var i=isNaN(this.selectedOption)?-1:this.selectedOption,n=this.optionalLayoutElements.length,o=this.optionalLayoutElements.length,r=e?1:-1;do{i=((i+=r)+o)%o,n--}while(n>0&&!this.checkLEbyIndex(i));this.checkLEbyIndex(i)?this.chooseLayoutElementOptionByIndex(i,t):this.selectedOption=0}},e.prototype.getLE=function(e,t){if(void 0===e&&(e=void 0),void 0===t&&(t=!1),void 0===e&&(e=this.selectedOption),this.optionalLayoutElements&&this.optionalLayoutElements[e])return this.optionalLayoutElements[e];if(!t){var i=(new Error).stack,n="seg.getLE: leArr is undefined. seg type : "+this.contentElement.type;this.$log.error(n,i),this.reportError(n)}},e.prototype.reportError=function(e,t){this.obMonitoring.error("Segment: "+e,t)},e.prototype.getLENoError=function(e){return void 0===e&&(e=void 0),this.getLE(e,!0)},e.prototype.getLEByID=function(e){return _.find(this.optionalLayoutElements,{id:e})},e.prototype.getPageDescriptor=function(){return this.node&&this.node.crossPageConnected?"general":this.page||this.sitePart},e.prototype.findIdentifyingNode=function(){return this.modelTree.findIdentifyingNode(this.node)},e.prototype.findIdentifyingNodeId=function(){return this.modelTree.findIdentifyingNodeId(this.node)},e.prototype.getTypeForLSSWithoutNodeIdAndPartition=function(){return this.modelTree.getTypeForLSS(this.node)},e.prototype.getRealNodeFromPreviewNode=function(){switch(this.sitePart){case this.sitePartTypes.BODY:return this.modelTree.getNodeFromPagesById(this.node.id);case this.sitePartTypes.HEADER:return this.modelTree.getGeneralInformation();case this.sitePartTypes.FOOTER:return this.modelTree.getFooterInformation()}},e.prototype.getTypeForLSSWithoutNodeId=function(){if(!this._typeForLSSWithoutNodeId){var e=this.getTypeForLSSWithoutNodeIdAndPartition();this._typeForLSSWithoutNodeId=e+"|"+(void 0!==this.partitionIndex?this.partitionIndex:-1)}return this._typeForLSSWithoutNodeId},e.prototype.isZigZag=function(){if(this.node&&this.node.isListItem&&!this.isMobile){var e=!1,t=this.selections.getForNode(this.findIdentifyingNode());return t.zigZag&&t.zigZag.cols&&this.containingLG.segments.indexOf(this)%2&&(e=!e),t.zigZag&&t.zigZag.rows&&this.containingLG.odd&&(e=!e),e}return!1},e.prototype.calcTypeForLss=function(e){var t=this.getTypeForLSSWithoutNodeIdAndPartition();return t+="|"+_.last(this.findIdentifyingNodeId().split(".")),this.isMobile||e||this.isZigZag()&&(t+="zigzag"),t},e.prototype.getTypeForLSSWithoutPartition=function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!1),(e=e||t)?this.calcTypeForLss(t):(this._typeForLSSWithoutPartition||(this._typeForLSSWithoutPartition=this.calcTypeForLss(t)),this._typeForLSSWithoutPartition)},e.prototype.getTypeForLSS=function(e){if(void 0===e&&(e=!1),this._typeForLSS&&!e)return this._typeForLSS;var t=this.getTypeForLSSWithoutPartition(e);return t+="|"+(void 0===this.partitionIndex||this.containingLG.isLGrepeater()?-1:this.partitionIndex),e?t:(this._typeForLSS=t,this._typeForLSS)},e.prototype.getValidLayoutsFirstLEs=function(){var e=this;return _.filter(this.optionalLayoutElements,function(t){return t.getSolutionStatus()===e.solutionStatusCodes.pass&&(t.active||!t.cluster)})},e.prototype.setOverrides=function(){var e=this,t=this.getLayoutSelectionStore().getOverrideMap(),i=this.getTypeForLSSWithoutPartition();_.each(this.optionalLayoutElements,function(n){var o=!!(n=n.getMaster()).overrides&&!!n.overrides.media,r=n.getMediaLayout(),a=r&&e.mediaOverride.getOverrides(r,e,n);(a||t.style[i])&&(n.overrides=n.overrides||{}),a?(n.overrides.media=n.overrides.media||{},n.overrides.media[r.argIndex]=a,o||n.handleOverrides()):n.overrides.media&&delete n.overrides.media[r.argIndex],t.style[i]?n.overrides.style=t.style[i]:delete n.overrides.style,t.extra&&t.extra[i]?n.overrides.extra=t.extra[i]:delete n.overrides.extra})},e.prototype.inflateCluster=function(e,t){var i=this;return void 0===t&&(t=!1),this.$p.resolve().then(function(){if(e!==i.clusterExpanded)return i.deflateCluster()}).then(function(){return _.sequencePromises(i.optionalLayoutElements,function(n){if(n.cluster===e||i.isContact())return n.calculateLayoutElementStatus(i.contentElement,void 0,void 0,t)})}).then(function(){i.clusterLayouts(e).length>1&&i.clusterExpanded!==e&&(i.clusterExpanded=e)})},e.prototype.deflateCluster=function(){return this.clusterExpanded>=0&&(this.clusterExpanded=-1),this.$p.resolve()},e.prototype.toggleCluster=function(e){return this.clusterExpanded===e?this.deflateCluster():this.inflateCluster(e)},e.prototype.clusterLayouts=function(e){var t=this;return _(this.optionalLayoutElements).filter(function(i){return i&&i.cluster===e&&i.getSolutionStatus()===t.solutionStatusCodes.pass}).value()},e.prototype.clusterCount=function(e){var t=this;return _.filter(this.optionalLayoutElements,function(i){return i&&i.cluster===e&&i.solutionStatus!==t.solutionStatusCodes.fail}).length},e.prototype.getCompOverrides=function(e){var t=e.type,i=e.subType;if(t===AdiCoreSanta.ElementTypes.Media){var n=this.mediaOverride.getOverrides(e,this,this.getLE());n&&(t=n.superType,i=n.type)}var o=i||t;"image"===o&&(o="media");var r=this.getLayoutSelectionStore().getOverride("style",this),a=e.style;return r&&r[o+this.componentStyles.getDecorationUniqueID(e)]&&(a=r[o+this.componentStyles.getDecorationUniqueID(e)]),{stylesKey:o,type:t,subType:i,styleId:a,mediaType:o,button_invert:r&&r.button_invert}},e.prototype.calculateLeComponents=function(){var e=this,t=[],i=[],n=!1,o=null;if(this.selectedOption>-1){var r=this.getLE(void 0,!0);if(!r)return;n=r.hasAlign,r.recurseLayouts(function(n){var a=e.getCompOverrides(n),s=e.componentStyles.styles[a.stylesKey];r.isMediaLayout(n)?(null===o&&(o=n),t.push(n)):s&&s.length>1&&i.push(n)})}else n=!1;return(i=_(i).filter(function(e){return"structure"!==e.containerRole}).sortBy("type").value()).push.apply(i,t),{leComponents:i,firstMediaLayout:o,leHasVAlign:n}},e.prototype.hasStyles=function(e){var t=this.getCompOverrides(e),i=this.componentStyles.styles[t.stylesKey];return!!i&&i.length>1},e.prototype.getStyleIndex=function(e){var t=this.getCompOverrides(e),i=this.componentStyles.styles[t.stylesKey];if(i)return i.indexOf(t.styleId)},e.prototype.changeStyle=function(e,t,i){var n=this.getCompOverrides(e);if(i)this.getLayoutSelectionStore().setOverride("style",this,i,!n[i]);else{var o=this.componentStyles.styles[n.stylesKey],r=o.indexOf(n.styleId);r=(r+o.length+(t?-1:1))%o.length,this.getLayoutSelectionStore().setOverride("style",this,n.stylesKey+this.componentStyles.getDecorationUniqueID(e),o[r])}},e.prototype.setComponentCustomColor=function(e,t,i){this.designKit.setComponentCustomColor(this,this.getOverrideKey(e)+i,t)},e.prototype.getComponentCustomColor=function(e,t){return this.designKit.getComponentCustomColor(this,this.getOverrideKey(e)+t)},e.prototype.getOverrideKey=function(e){return this.getCompOverrides(e).stylesKey+this.componentStyles.getDecorationUniqueID(e)},e.prototype.isSelectedLE=function(e){var t=this.getLENoError();return t&&t.id===e.id},e.prototype.getSegBrothers=function(){var e=this;return _.filter(this.containingLG.segments,function(t){return t.width===e.width&&t.getTypeForLSS()===e.getTypeForLSS()})},e.prototype.reset=function(){var e=_.chain(this.optionalLayoutElements).reject({solutionStatus:this.solutionStatusCodes.unknown}).each(function(e){e.reset()});this.flags.lodash4&&e.value()},e.prototype.minPassingHeight=function(){return(this.flags.lodash4?_.strictMinBy:_.min)(_(this.optionalLayoutElements).filter({solutionStatus:this.solutionStatusCodes.pass}).map("passingHeight").value())},e.prototype.getRenderedHeight=function(){return this.rendererHeight||this.height},e.prototype.getLayoutSelectionStore=function(){return this.containingLG.getLayoutSelectionStore()},e.prototype.isAggregator=function(){return this.contentElement&&this.contentElement.aggregator},e.prototype.addContentElementItemToAggregator=function(e,t){if(!this.isAggregator()||!this.contentElement.ceArray)throw"Wrong use of aggregator";var i=this.contentElement.ceArray;t||(t=i.length,"ListFooter"===_.last(i).type&&t--),i.splice(t,0,e)},e.prototype.removeContentElementItemFromAggregator=function(e){if(!this.isAggregator()||!this.contentElement.ceArray||!e)throw"Wrong use of aggregator";var t=this.contentElement.ceArray;"ListHeader"===_.first(t).type&&e++,t.splice(e,1)},e.prototype.isContact=function(){return this.contentElement&&"Contact"===this.contentElement.type},e.prototype.setSitePart=function(e){this.sitePart=e},e.prototype.getSafeId=function(){return this.node?this.node.id:this.sitePart},e.prototype.hasPredefinedLayout=function(e){var t=this.predefinedLayout||this.getLayoutSelectionStore().getPredefinedLayout(this);if(!t)return!1;if(this.flags.predefinedHeaderLayout){if(void 0!==e&&!(this.flags.lodash4?_.isEqual:_.eq)(t.argsSignature,e))return!1}else if(void 0!==e&&t.argsSignature!==e)return!1;return t.width===this.width},e.prototype.setPredefinedLayout=function(e){this.getLayoutSelectionStore().setPredefinedLayout(this,e),this.predefinedLayout=e},e.prototype.setPredefinedOptionalLayoutElement=function(){if(this.predefinedLayout)this.optionalLayoutElements=[this.predefinedLayout];else{var e=this.getLayoutSelectionStore().getPredefinedLayout(this),t=void 0;this.containingLG.isHeader()?((t=new this.HeaderLayoutElement(e.templateId,e.structureSuffix,e.argsSignature,e.html,e.mode,e.width)).setLGContainer(this.containingLG),t.setSegContainer(this),this.optionalLayoutElements=[t]):(t=this.containingLG.getCleanLayoutElementById(e),this.cloneOptionalLayoutElements([t])),this.predefinedLayout=this.optionalLayoutElements[0]}},e.prototype.setStripGalleryRef=function(e){this.stripGalleryRef=e},e.prototype.updateRenderTime=function(){this._renderTime=(new Date).getTime()},Object.defineProperty(e.prototype,"renderTime",{get:function(){return this._renderTime},enumerable:!0,configurable:!0}),e.prototype.addRenderedComponent=function(e,t){this.renderedComponents.push({layout:e,compRef:t})},e.prototype.getRenderedComponent=function(e){var t=_.find(this.renderedComponents,function(t){return t.layout.type===e.type&&t.layout.subType===e.subType&&t.layout.containerRole===e.containerRole});if(t)return t.compRef},e.prototype.clearRenderedComponents=function(){this.renderedComponents=[]},e.prototype.getRenderedComponents=function(){return this.renderedComponents},e.prototype.setMobileLg=function(e){this.mobileLg=e,e.setDesktopSegment(this)},e.prototype.getMobileLg=function(){return this.mobileLg},e.prototype.getMobileSegment=function(){return this.getMobileLg().segments[0]},e.prototype.getDesktopSegment=function(){return this.isMobile?this.containingLG.desktopSegment:this},e.prototype.getWantedArgs=function(){return this.contentElement.getWantedArgs(this.isMobile)},e}();angular.module("adiCoreAppInternal").factory("segmentFactory",["HeaderLayoutElement","heightMutations","solutionStatusCodes","modelTree","$log","mediaOverride","selections","$p","toasterService","componentStyles","LayoutElement","SmartLayoutElement","designKit","applicationParameters","cropFaceService","flags","layoutDecoration","LayoutUtils","columnService","sitePartTypes","obMonitoring","segmentLayoutElements","sectionBackgroundService",function(e,t,i,n,o,r,a,s,l,c,d,u,p,h,m,f,v,y,b,S,C,w,T){return function(I){return new g(I,e,t,i,n,o,r,a,s,l,c,d,u,p,h,m,f,v,y,b,S,C,w,T)}}]),angular.module("adiCoreAppInternal").factory("siteLayoutLoader",["$http","wixAngular","ContentElement","LayoutElement","LayoutGroup","layoutGroups","layoutElementsFetcher","HeaderLayoutElement","designPolicies","storyServices","$q","heightMutations","applicationParameters","$log","headerLayouts","mobileHeaderLayouts","mobileFooterLayouts","footerLayouts","ContactGenerator","modelTree","flags",function(e,t,i,n,o,r,a,s,l,c,d,u,p,h,g,m,f,v,y,b,S){var C={300:{header:m(S.membersArea),footer:f},940:{header:g(S.membersArea),footer:v}},w=_.memoize(function(e){return e.indexOf("List")>-1&&-1===i.specialListItems.indexOf(e)});function T(e,t){return e.forContent&&-1!==e.forContent.indexOf(t)||e.aggregationStrategy&&w(t)||-1!==b.getAvailableWidgetsTypes().indexOf(t)&&-1!==e.forContent.indexOf("AnyWidget")||-1!==b.getAvailableTpaTypes().indexOf(t)&&-1!==e.forContent.indexOf("AnyTpaSection")}function I(e){return T(e,"Contact")&&e.generator}function x(e){return!e.columnPartition&&_.every(e.segments,function(t){return t.width===e.segments[0].width})}var P,M={centeredMenuUp:4,centeredMenuDown:5,leftLogoCenteredMenuDown:6,leftLogoMenuBaseline:7,leftLogoMenuCenter:8,leftLogoMenuDown:1,leftLogoMenuUp:2,joker:9},L={editMode:!1,layouts:{},layoutParseObjects:[],layoutGroups:[],loadedScenarios:[],autoGeneratedGroups:{},contactLayoutsForSize:function(){return[]},contactLayoutsForSizeHash:function(e){return e},layoutsForSize:function(){return[]},layoutsForSizeHash:function(e,t){return e+"|"+t},ensureContactLayoutElements:function(e,t,i){var n=this;if(i=i||this.layoutsForSize(e,t),0===_.filter(i,I).length){var o=y.createContactLayouts(this.contactLayoutsForSize(e),t);angular.forEach(o,function(e){n.addToCache(e),n.layouts[e.id]=e})}},internalLayoutsForContentElementTypeAndSize:function(e,t,i,n,o){var r=this;return(S.consumerMode&&!S.isNewSite&&S.loadLayoutsLater&&"Contact"===e?a.prepareContactLEsForFetch(r.registerLEs.bind(r)):a.prepareLEsForFetch(i,t,r.registerLEs.bind(r))).then(function(){var a=r.layoutsForSize(i,t);"Contact"===e&&r.ensureContactLayoutElements(i,t,a);var s=a.filter(function(t){return t.sitePartFit(o)&&T(t,e)&&(void 0===n||t.cluster===n)});return(S.lodash4?_.sortBy:_.sortByAll)(s,function(e){return e.cluster||1e4},_.property("priority"))})},registerLEs:function(e,t){var i=this;e.forEach(function(e){var o=new n(n.getLayoutData(e),void 0,void 0,i.editMode);if(i.layouts[o.id])h.debug("duplicate le id : "+o.id);else{var r=I(o);r||(i.layouts[o.id]=o),t?(e.le=o,i.layoutParseObjects.push(e)):(o.isOriginalSmartHeight=!0,i.addToCache(o,r))}})},getCleanLayoutElementById:function(e){var t=o.siteLayoutLoader.layouts[e.id];return t||(t=new n(n.getLayoutData(e)),o.siteLayoutLoader.layouts[t.id]=t,o.siteLayoutLoader.addToCache(t)),t},layoutsForHeader:function(e,t,i){function n(t){return _.some(t.split("|"),function(t){return _.includes(e,t)})}var o=C[t][i];return _(o).map(function(i){if(i.required&&!n(i.required))return null;var o=[new s(i.id,i.structure,e,i.html,i.css,t)];return i.modes&&i.modes.length&&(o=_.union(o,_.map(i.modes,function(o){if(o.required&&!n(o.required))return null;var r=o.structure||i.structure+"$"+o.css.replace(/\s/g,"_");return new s(i.id,r,e,i.html,(i.css||"")+" "+o.css,t)}))),o}).flatten().filter(function(t){return t&&t.matchWantedArgs(e)}).sortBy(function(e){return M[e.structureSuffix]||100}).value()},layoutsForContentElementTypeAndSize:function(e,t,i,n,o){var r=this;return _.sequencePromises(n||[void 0],function(n){return r.internalLayoutsForContentElementTypeAndSize(e,t,i,n,o)}).then(function(e){return _.flatten(e)})},expandGeneratorGroup:function(e,t){var i=e.segments.filter(function(e){return!!e.generator})[0];if(i){var n={};angular.copy(e,n),n.segments=n.segments.filter(function(e){return!e.generator});for(var r=n.segments.length?n.segments[0].height:0,a=i.heights,s=i.space,l=i.multiple,c=!i.generator||"h"===i.generator,d=0;d<a.length;d++){var u,h=i.top,g=i.left;u=c?(940-(l-1)*s)/l:i.width;var m=(a[d]-1)*p.gridStep+p.minHeight,f={};angular.copy(n,f);for(var v=0;v<l;v++){var y={forContent:[]};angular.copy(i.forContent,y.forContent),y.top=h,y.left=g,y.height=m,y.width=u,c?g=g+u+s:h=h+m+s,f.segments.push(y)}f.name=e.name+" h: "+m,f.sourceName=e.name,f.targetHeight=m+20+(r?r+20:0),t(new o(f))}}},addToCache:function(e,t){var i=this.ensureCache(e.width,e.getArgsSignature(),t);!function(e){if(e.width<=320&&e.layoutArray&&e.structure&&e.structure[0]&&1===e.structure[0].length){var t=_.find(e.layoutArray,function(e){return"button"===e.type});if(t&&t.fixedBottom&&(t.fixedBottom=!1,t.rowIndex>0)){var i=e.structure[t.rowIndex-1][0],n=_.find(e.layoutArray,function(e){return e.argIndex===i});n&&e.addRule({childType:t.type,childComponent:t,childFacet:"top",parentType:e.argList[i].subType,parentComponent:n,parentFacet:"bottom"})}}}(e),i.push(e)},ensureCache:function(e,t,i){var n,o;if(i?(n=this.contactLayoutsForSizeHash(e),o=this.contactLayoutsForSize.cache):(n=this.layoutsForSizeHash(e,t),o=this.layoutsForSize.cache),o.has(n))return o.get(n);var r=[];return o.set(n,r),r},leIsGeneratorContact:I,initialize:function(e){var t=this;return n.prototype.cleanLayouts=this.layouts,P||(P=d.when().then(function(){var e=o.createMobileLg();return S.consumerMode?(r.unshift(e),r):S.mobileEditorPresets?[e]:r}).then(function(e){e.forEach(function(e){var i=o.getLayoutData(e);if("header"===i.sitePart&&(i.sitePart="body"),"footer"!==i.sitePart)if(i.isGenerator)t.expandGeneratorGroup(i,function(e){t.layoutGroups.push(e)});else{var n=new o(i);t.layoutGroups.push(n)}}),S.consumerMode&&(t.layoutGroups=_.filter(t.layoutGroups,x)),t.layoutGroups=t.layoutGroups.concat(o.createPartialSegmentsLG()),t.layoutGroups=t.layoutGroups.concat(_(t.layoutGroups).map(function(e){if(e.segmentSignature||(e.segmentSignature=_.fill(new Array(e.segments.length),"1").join("")),x(e)&&(2===e.segmentSignature.length||3===e.segmentSignature.length))return o.createAsymmetricSplitLG(e)}).filter().value()),t.expandGeneratorGroup({id:"headerLayoutGroup",isGenerator:!0,targetWidth:940,targetHeight:130,sitePart:"header",segments:[{forContent:["GeneralDescription"],generator:"h",heights:[2],left:0,multiple:1,space:20,top:0}]},function(e){t.headerLayoutGroup=e;var i=ob.deepClone(e);i.segments[0].width=300,i.segments[0].isMobile=!0,t.mobileHeaderLayoutGroup=i})}).then(function(){if(S.isNewSite||!S.loadLayoutsLater)return a.init(t.registerLEs.bind(t),e,p.onlyLe)}).then(function(){t.createEmptyLes()})),P},downloadLayouts:function(){return a.init(this.registerLEs.bind(this),!1,p.onlyLe)},createEmptyLes:function(){var e=this,t=[220,300,460,940].map(function(t){return e.createEmptyLe(t)});this.registerLEs(t,!1)},createEmptyLe:function(e){return{arguments:[],layout:[],forContent:["About","AnyList","AnyTpaSection","AnyWidget","CV","Careers","Client","Contact","Donation","Event","FAQ","Facility","Feature","File","GeneralDescription","HomePageTeaser","Homepage_about","Inner_about","ListFooter","ListHeader","Membership","News","OpeningHours","PageHeader","Portfolio","Price","Product","Project","Quote","ScheduleItem","Service","Social","SpecialOffer","Subscribe","TeamMember","Testimonial","Tpa_Header","Welcome","Widget"],width:e,height:100,family:"x"+p.getGridUnits(e),ruleTree:'{"id":null,"arrayIndex":-1,"facet":"root","children":[]}',argsSignature:"",isAllowedFooter:!0,isAllowedHeader:!1,scenarioId:"empty_le",cluster:49,structure:[],boxesStructure:[[],[],[],[],[],[]],priority:100,version:3}}};return L.layoutsForSize=_.memoize(L.layoutsForSize,L.layoutsForSizeHash),L.contactLayoutsForSize=_.memoize(L.contactLayoutsForSize,L.contactLayoutsForSizeHash),L.internalLayoutsForContentElementTypeAndSize=_.memoize(L.internalLayoutsForContentElementTypeAndSize,function(e,t,i,n,o){return[e,t,i,n,o].join("|")}),L.findLayoutElementIDFromLayoutElementAndWantedWidth=function(e,t,i,n){var r=e.getLayoutSelectionStore(),a=r.getPreferredLayoutData(t),s=r.calculateFallBackClusterAndStructure(t,a);return o.siteLayoutLoader.layoutsForContentElementTypeAndSize(t.contentElement.type,i.getArgsSignature(),n,void 0,"body").then(function(e){var t=r.findFirstLEofClusterWithMediaWidth(e,s,a,!1,void 0,!0);return t&&t.le})},o.setSiteLayoutLoader(L),AdiCoreSanta.setSiteLayoutLoader(L),L}]),angular.module("adiCoreAppInternal").factory("SmartLayoutElement",["$log","$p","flags","SmartLayoutRuleNode","SmartLayoutRuleUtils","LayoutUtils","applicationParameters","solutionStatusCodes","callInLayout","BoxDecorationTypes",function(e,i,n,o,r,a,s,l,c,d){function u(e,i){t.dfs(e,function(e,t,n){-1===i(e,t,n)&&(n.cutoff=!0)})}var p=s.quarterBaseLine;function h(e){return e.verticalAlign||e.fixedBottom||e.horizontalAlign||e.fixedTop}function g(e){_.forEach(e,function(e){_.forEach(e.component,function(t,i){e.originalComponent[i]=t})})}function m(e,t){var i=_.map(e.structure[t],function(t){return e.getLayoutWithArgIndex(t)}),o=e.structure[0].length,r=(n.lodash4?_.strictMaxBy:_.max)(_.filter(i,function(i,n){return!(t<e.structure.length-1)||0!==e.spanHints[(t+1)*o+n].y}),function(e){return e.top+e.height});return r.top+r.height}var f=function(){};return f.prototype={layoutDiff:function(e){var t;if("Layout Element"===e.type)t=this.smartLayoutRulesNodesMap.LayoutElement.top;else{var i=_.find(this.smartLayoutRulesNodesMap[this.getLayoutSubType(e)],function(t){return t.top.component===e});i&&(t=i.top)}return t.getOffsets().height+(t.component.missingHeight||0)+(t.component.missingTop||0)+(t.component.missingBottom||0)},getColumnDiff:function(e,t){var i=this,n=0,o=this.getLayoutParent(t),r=e.getLayoutOriginalSizes(t),a=r.left,s=r.width;return _.each(o.layout,function(o){var l=(r=e.getLayoutOriginalSizes(o)).left,c=r.width;o!==t&&Math.max(l,a)<Math.min(l+c,a+s)&&(o.top>=t.top+t.height||o.top+o.height<=t.top)&&(n+=i.layoutDiff(o))}),n},checkIfDescendant:function(e,t){if(this.findNode(t))return!1;var i=!1;return u(t,function(t,n,o){e===t&&(o.cutoff=!0,i=!0)}),i},makeChild:function(e,t){t&&e&&(t.parent.children=_.without(t.parent.children,t),e.children.push(t),t.parent=e)},findOrAddNode:function(e){this.findNode(e)||this.rootNode.children.push(e)},findNode:function(e){var t=!1;return u(this.rootNode,function(i,n,o){e===i&&(o.stop=!0,t=!0)}),t},trySetRule:function(t){var i=t.parentCandidate,n=t;if(i){if(this.findNode(n)){if(this.checkIfDescendant(i,n))return t.parentCandidate=t.parent,!1;this.makeChild(i,n)}else i.children.push(n),n.parent=i;try{this.ensureForest(t.parent)}catch(t){e.debug(this),e.error("I'm my own grandpa!")}}else t.parent&&(t.parent.parent&&t.parent.parent===this.rootNode&&(this.rootNode.children=_.without(this.rootNode.children,t),t.parent.parent=void 0),t.parent.children=_.without(t.parent.children,t),t.parent=void 0,this.hangBottomOnTop());return!0},removeRule:function(e){e.parent&&(e.parent.children=_.without(e.parent.children,e),e.parent=this.rootNode,e.parentCandidate=this.rootNode,this.rootNode.children.push(e),this.hangBottomOnTop())},addRule:function(e){var t,i,n=this.smartLayoutRulesNodesMap[e.parentType],o=this.smartLayoutRulesNodesMap[e.childType];if(1===o.length)t=o[0][e.childFacet];else for(i=0;i<o.length;i++)o[i][e.childFacet].component===e.childComponent&&(t=o[i][e.childFacet]);if(1===n.length)t.parentCandidate=n[0][e.parentFacet];else for(i=0;i<n.length;i++)n[i][e.parentFacet].component===e.parentComponent&&(t.parentCandidate=n[i][e.parentFacet]);return this.trySetRule(t),t},ensureForest:function(e){e!==this.rootNode&&(e.parent?this.ensureForest(e.parent):(e.parent=this.rootNode,this.rootNode.children.push(e)))},fixComponentsAlign:function(e,t,i){angular.forEach(this.alignRules,function(n){n.componentAlignHandler(e,t,i)})},mutate:c(function(e,t,i){var n,r=_.findIndex(this.layoutArray,{argIndex:e}),a=this.smartLayoutRulesNodes[r];if(i=i||[],this.mutationCounter=0,n=a.bottom.mutate(this,!1,i,t),i.unshift(n),this.fixComponentsAlign(this,!1,i),_.some(i,function(e){return e.result===o.mutationResult.failure}))return{result:o.mutationResult.failure,containerMutation:!1};if(!_.some(i,function(e){return e.result===o.mutationResult.success}))return{result:o.mutationResult.nop,containerMutation:!1};var s=_.some(i,function(e){return e.containerMutation});return s&&this.updateHeightFromNode(),this.generator&&this.postProcessing(),{result:o.mutationResult.success,containerMutation:s}}),updateHeightFromNode:function(){this.originalHeight||(this.originalHeight=this.height),this.height=this.smartLayoutRulesNodes[this.smartLayoutRulesNodes.length-1].top.component.height},nodesForComponent:function(e,t){return this.smartLayoutRulesNodes[e][t]},nodesForComponentDropDown:function(e){this.smartLayoutRulesNodes||this.initSmartLayoutRules();var t=[],i=this;return this.smartLayoutRulesNodes.forEach(function(n,o){o!==e&&(n.top.description=i.getLayoutSubType(n.top.component)+" top",n.bottom.description=i.getLayoutSubType(n.bottom.component)+" bottom",t.push(n.top),t.push(n.bottom))}),t},indexesForRelativeMediaDropDown:function(e){this.smartLayoutRulesNodes||this.initSmartLayoutRules();var t=[];return this.argList.forEach(function(i,n){n!==e&&"media"===i.type&&t.push(n)}),t},initAlignRules:c(function(){var e=this;this.alignRules=[],angular.forEach(this.layoutArray,function(t,i){h(t)&&e.alignRules.push(e.smartLayoutRulesNodes[i].bottom)})}),mutateByStretching:c(function(t,i,r,a){if(t>this.maxHeight)return n.debug&&e.error("mutateByStretching failed because "+t+" is bigger than max height "+this.maxHeight),!1;var s,l=this;this.fakeOriginal(),i=i||[],this.mutationCounter=0;try{s=this.smartLayoutRulesNodes[this.smartLayoutRulesNodes.length-1].bottom.mutate(this,!r,i,t,!0)}catch(t){return e.info("Smart exception in stretch, probably SO. failing this LE:"+this.id+" counter: "+this.mutationCounter+" exception:"+t),{result:o.mutationResult.failure,containerMutation:!1}}if(s.result===o.mutationResult.success){if(this.updateHeightFromNode(),this.stretched=!0,a||(this.originalHeight=this.height,angular.forEach(this.smartLayoutRulesNodes,function(e){angular.forEach(e,function(e){angular.forEach(Object.keys(e.component),function(t){e.originalComponent[t]=e.component[t]})})})),this.fixComponentsAlign(this,!0,i),this.generator&&this.postProcessing(),this.isTextOnlyCluster()){var c=(this.height-this.passingHeight)/2;_.each(this.layout,function(e){l.isMobile()&&e.fixedBottom||(e.top+=c,l.isDecorativeContainerLayout(e)&&(e.height-=2*c))})}}else this.resetMutations(this);return s}),resetMutations:function(){var e=this;this.height=this.originalHeight||this.height,angular.forEach(this.smartLayoutRulesNodes,function(t){t.top.resetMutation(e,[],!0),t.bottom.resetMutation(e,[],!0)}),this.updateHeightFromNode()},initSmartLayoutRules:c(function(e){if(this.smartLayoutRulesNodes&&this.smartLayoutRulesNodes.length&&!e)return!0;var t={top:0,left:0,height:this.height,width:this.width,type:"Layout Element",isLayoutElement:!0},i=new o(t,"top",null),n=new o(t,"bottom",null);this.rootNode=new o({},"root",null),this.smartLayoutRulesNodes=[],this.smartLayoutRulesNodesMap={},this.alignRules=[];var r=this,a=0;this.layout&&(this.layoutArray=[],this.recurseLayouts(function(e,t){var i=t?r.smartLayoutRulesNodes[t.ruleNodeIndex].bottom:n;return function(e,t,i,n,r){var a=10*(r+1);e.layoutArray.push(i);var s=new o(i,"top",a,null),l=new o(i,"bottom",a+1,n);e.smartLayoutRulesNodes[r]={top:s,bottom:l};var c=e.getLayoutSubType(i);e.smartLayoutRulesNodesMap[c]||(e.smartLayoutRulesNodesMap[c]=[]),e.smartLayoutRulesNodesMap[c].push(e.smartLayoutRulesNodes[r]),e.isMediaType(s.component)&&(s.mediaBottomDomParent=n,i.mediaMinHeight||(i.mediaMinHeight=i.height)),h(i)&&e.alignRules.push(e.smartLayoutRulesNodes[r].bottom)}(r,t?t.height:r.height,e,i,a),e.ruleNodeIndex=a,a++,!1}));var s=10*(a+1);return i.id=s,n.id=s+1,this.smartLayoutRulesNodes[a]={top:i,bottom:n},this.smartLayoutRulesNodesMap.LayoutElement=[this.smartLayoutRulesNodes[a]],this.containerBottomNode=n,this.postInit(),!0}),postInit:function(){var e=this;angular.forEach(this.smartLayoutRulesNodes,function(t){var i;t.bottom.component.mediaDomParent>-1&&null!==t.bottom.component.mediaDomParent&&(e.recurseLayouts(function(e){if(e.argIndex===t.bottom.component.mediaDomParent&&"media"===e.type)return i=e,!0}),t.bottom.domParent=i?e.smartLayoutRulesNodes[e.layoutArray.indexOf(i)].bottom:e.smartLayoutRulesNodes[t.bottom.component.mediaDomParent].bottom)})},copyTree:function(e,t){var i,n=this;return"root"===e.facet?i=this.rootNode:((i=this.smartLayoutRulesNodes[parseInt(e.id/10)-1][e.facet]).parent=t,i.parentCandidate=t),i.children=_.map(e.children,function(e){return n.copyTree(e,i)}),i},deserializeTree:function(e){if(e&&e.length){var i=JSON.parse(e),n=this;t.map(i,function(e,t){if("root"===e.facet)return n.rootNode;var i=n.smartLayoutRulesNodes[e.arrayIndex][e.facet];return i.parent=t,i.parentCandidate=t,i})}this.hangBottomOnTop()},hangBottomOnTop:function(){angular.forEach(this.smartLayoutRulesNodes,function(e){e.bottom.parent||(e.bottom.parent=e.top,e.bottom.parentCandidate=e.top,e.top.children.push(e.bottom))})},serializeTree:function(){return JSON.stringify(this.rootNode)},fakeOriginal:c(function(){_.forEach(this.smartLayoutRulesNodes,function(e){g(e)})}),fakeOriginalToSpecificLayoutForSpecificAttribute:c(function(e,t){var i=this.smartLayoutRulesNodes[this.layoutArray.indexOf(e)];_.forEach(i,function(e){e.originalComponent[t]=e.component[t]})}),fakeOriginalToSpecificLayout:c(function(e){g(this.smartLayoutRulesNodes[this.layoutArray.indexOf(e)])}),reset:c(function(){var e=this.getCleanLE();this.layout=ob.deepClone(e.layout),this.height=e.height;var t=e.serializeTree();this.initSmartLayoutRules(!0),this.deserializeTree(t),this.passingHeight=0,this.solutionStatus&&(this.solutionStatus=l.unknown),this.decorationTypes="",this.calculateDesignStructure()}),calculateAbsoluteLocations:function(){this.recurseLayouts(function(e,t){e.absoluteLeft=t?t.absoluteLeft+e.left:e.left,e.absoluteTop=t?t.absoluteTop+e.top:e.top})},lastBaseLine:function(e){var t=e.absoluteTop+e.height;return"button"!==e.subType&&(t+=(e.baseLineMargin||0)-(e.lineHeight||0)),t},letterHeight:function(e){return this.firstBaseLine(e)-(e.absoluteTop+(e.topMargin||0))},firstBaseLine:function(e){var t=e.absoluteTop;return"button"!==e.subType&&(t+=e.baseLineMargin||0),t},linePositionArea:function(e,t){return this.layoutBaselineDistance(e,t)-10-this.letterHeight(e)},layoutBaselineDistance:function(e,t){var i=this.lastBaseLine(t);return this.firstBaseLine(e)-i},getNeededLineOffset:function(e,t){if(this.isContact())return 0;var i=this,n=0,o=t?"absoluteTop":"top";if(e.designMargin&&(this.calculateAbsoluteLocations(),_.each(e.designMargin,function(t,r){if(-1===(r=+r))n=Math.max(n,t-e[o]-e.baseLineMargin);else if(-2!==r){var a=i.getLayoutWithArgIndex(r),s=i.layoutBaselineDistance(e,a);n=Math.max(n,t-s)}})),!this.isMobile()&&(e[o]+n+(e.baseLineMargin||0))%p!=0){var r=e[o]+n+(e.baseLineMargin||0),a=r-Math.floor(r/p)*p;n>a?n-=a:n=n-a+p}return n},getMinTopByDesign:function(e){var t=this,i=0;return e.designMargin&&(this.calculateAbsoluteLocations(),_.each(e.designMargin,function(n,o){if(-1===(o=+o))i=Math.max(i,n-e.baseLineMargin);else if(-2!==o){var r=t.getLayoutWithArgIndex(o);i=Math.max(i,r.top+r.height+n)}})),i},getFixedBottomComponentTopByBaseLine:function(e,t,i){var n=i+(e.baseLineMargin||0);if(n%p!=0){for(var o=Math.floor(n/p)*p;o<t;)o+=p;i=o-(e.baseLineMargin||0)}return i},getNeededBottomMargin:function(e){if(e.designMargin&&e.designMargin[-2])return Math.max(0,e.designMargin[-2])},getArgumentLateralOptions:c(function(e,t){var i={},n=this.getArgumentGridWidth(e);if(!n)return i;var o=this.filterLayoutsWithMyStructure(t);if(!o||!o.length)return i;for(var r=0;r<o.length;r++){var a=o[r],s=a.getArgumentGridWidth(e);if(a.thatWidth=s,s<n?(!i.smaller||i.smaller.thatWidth<s)&&(i.smaller=a):s>n&&(!i.bigger||i.bigger.thatWidth>s)&&(i.bigger=a),i.bigger&&i.bigger.thatWidth===n+1&&i.smaller&&i.smaller.thatWidth===n)break}return i}),filterLayoutsWithMyStructure:function(e){var t=this;return _.filter(e,function(e){return e&&e.solutionStatus===l.pass&&e.id!==t.id&&_.isEqual(e.structure,t.structure)})},getArgumentGridWidth:function(e){return a.getArgumentGridWidthFromSignature(e,this.family)},getMediaGridWidth:function(){return a.getMediaGridWidthFromSignature(this.family)},isButtonInContainer:function(){return a.isButtonInContainerFromSignature(this.family)},EMPTY_LAYOUT:{subType:"empty",type:"empty",argIndex:-1},structureToDesignStructure:function(e,t,i){var n=this;return _.map(e,function(e){return _.map(e,function(e){var o=n.getLayoutWithArgIndex(e);if(t){for(var r=0;r<n.boxTypes.length;r++){var a=n.boxTypes[r];if(a<d.ON_MEDIA&&_.flatten(n.boxesStructure[a]).indexOf(e)>-1)return n.EMPTY_LAYOUT}var s=function(e,t){var i=e.getLayoutWithArgIndex(t);if(i.mediaDomParent>-1)return i;var n=e.getLayoutParent(i);return n.mediaDomParent>-1?n:void 0}(n,e);if(s)return-1===i.indexOf(s)&&i.push(s),n.EMPTY_LAYOUT}return o})})},getDesignStructure:function(){return this.designStructure||this.calculateDesignStructure(),this.designStructure},calculateDesignStructure:function(){var e=this;if(this.designStructure=[],this.structure){var t=[];this.designStructure.push(this.structureToDesignStructure(this.structure,!0,t)),this.onMediaStructure&&this.designStructure.push(this.structureToDesignStructure(this.onMediaStructure));var i=_.filter(this.boxTypes,function(e){return-1===[d.ON_MEDIA,d.FULL].indexOf(e)});angular.forEach(i,function(t){e.designStructure.push(e.structureToDesignStructure(e.boxesStructure[t]))}),_.each(t,function(t){var i=e.calcStructure(t);e.designStructure.push(e.structureToDesignStructure(i))})}},isMediaType:function(e){return"media"===e.type||"gallery"===e.type||"map"===e.type||"widget"===e.type},fakeMutateUp:function(e,t){var i=this.layoutArray.indexOf(e),n=this.smartLayoutRulesNodes[i].bottom.domParent.component,o=e.top+e.height-e.lineHeight+e.baseLineMargin,r=t-(n.height-o);return!(r>0)||!(r>n.top)&&(n.top-=r,void(n.height+=r))},getMappedArgList:function(){var e=this;return _.map(this.argList,function(t){return e.getArgSignature(t)})},getMappedStructures:function(){var e=this.getMappedArgList();return{structure:_.map(this.structure,function(t){return _.map(t,function(t){return e[t]})}),onMediaStructure:_.map(this.onMediaStructure,function(t){return _.map(t,function(t){return e[t]})})}},getLayoutData:function(){var e=this.getMappedStructures(),t=s.getGridUnits(this.width),i={cluster:this.cluster,templateId:this.templateId,argsSignature:this.argsSignature,structure:e.structure,onMediaStructure:e.onMediaStructure,mediaGridWidth:12*this.getMediaGridWidth()/t,isButtonInContainer:this.isButtonInContainer()};return n.keepColumnsWidth&&!this.isContact()&&(i.textGridWidth={lt:a.normalizeWidth("p",this.family,t),t:a.normalizeWidth("t",this.family,t),s:a.normalizeWidth("s",this.family,t),b:a.normalizeWidth("b",this.family,t)}),i},calcStructure:function(e){var t=[];if(e.layout)for(var i=void 0!==e.onMediaIndex?this.onMediaStructure:this.structure,o=_.map(e.layout,"rowIndex"),r=_.map(e.layout,"colIndex"),a=(n.lodash4?_.strictMinBy:_.min)(r),s=(n.lodash4?_.strictMinBy:_.min)(o),l=(n.lodash4?_.strictMaxBy:_.max)(r),c=(n.lodash4?_.strictMaxBy:_.max)(o),d=s;d<=c;d++)for(var u=a;u<=l;u++){var p=d-s;t[p]||(t[p]=[]),t[p][u-a]=i[d][u]}else t=[[e.argIndex]];return t},postProcessing:function(){if(this.getCleanLE()){var e=this;_.each(this.layoutArray,function(t){"text"===t.type&&(t.clientRect?t.height=t.clientRect.height:t.height=e.getCleanLELayoutByArgIndex(t.argIndex).height)});var t=m(this,this.structure.length-1);_.each(this.structure,function(t,i){if(i>0){var n=m(e,i-1);!function(e,t,i){var n=e.structure[0].length;_.each(e.structure[t],function(o,r){var a=t*n+r;0!==e.spanHints[a].y&&0!==e.spanHints[a].x&&(e.getLayoutWithArgIndex(o).top=i)})}(e,i,n+20)}}),t!==this.height&&(this.height=s.getValidHeight(t)),this.fakeOriginal()}}},f}]),function(e){var t=function(){function e(e,t,i,n,o,r,a){var s=this;this.$rootScope=e,this.applicationEvents=t,this.$q=i,this.$p=n,this.$log=o,this.$timeout=r,this.flags=a,this.user={},this.isPreview=_.noop,this.storyDefer=this.$q.defer(),this.generateRandomOffset=function(e,t){void 0===t&&(t=101);var i=e+(s.story?s.story.id:"0"),n=Math.random();Math.seedrandom(i);var o=Math.floor(Math.random()*t);return Math.seedrandom(n),o},this.initForUser=function(e){s.userRoles=_.map(e.roles,function(e){return e.name}),s.user=e},this.onStoryChanged=function(e,t){s.story=t,s.story&&s.storyDefer.resolve(s.story)},this.isStoryAvailablePromise=this.$p.defer(),this.prodBaseURL="https://www.wix.com/website/generator?petri_ovr=specs.SiteGenerator:true;#!/stories/",e.storyServices=this,_.each(t,function(t,i){var n=i.charAt(0).toUpperCase()+i.slice(1),o="emit"+n;s["on"+n]=e.$on.bind(e,t),s[o]=s.createEmitMethod(t)}),AdiCoreSanta.setStoryServices(this)}return e.$inject=["$rootScope","applicationEvents","$q","$p","$log","$timeout","flags"],e.prototype.getPermission=function(e){if(!this.userRoles)return!1;switch(e){case"filter":case"assign":case"topMenu":return-1!==this.userRoles.indexOf("studio");default:return!0}},e.prototype.getSavedSite=function(){var e=this.story.getActiveLocale().savedSites;return e&&this.user&&e[this.user.id]},e.prototype.onDataChanged=function(e,t){t&&t.segment&&t.segment.revalidateMediaOverrides()},e.prototype.isStoryOwner=function(){return this.user.id===this.story.owner.id},e.prototype.userIsNotStudioOrStoryLocked=function(){return-1===this.userRoles.indexOf("studio")||!this.storyHasStudioRole()},e.prototype.storyHasStudioRole=function(){return this.story.createdByStudioUser},e.prototype.toggleLockStory=function(){var e=[],t=!this.storyHasStudioRole();return this.story.ACL.setRoleWriteAccess("studio",t),e.push(this.story.save()),angular.forEach(this.story.storyLocales,function(i){i.ACL.setRoleWriteAccess("studio",t),e.push(i.save())}),this.$q.all(e)},e.prototype.calculateMaxPageAndNodeId=function(e){var t=this.calculateNextPageAndNodeId(e.bft);this.nextFirstLevelNodeId=t.nextFirstLevelNodeId,this.nextPageNodeId=t.nextPageNodeId},e.prototype.calculateNextPageAndNodeId=function(e){var t=this,i=[],n=[],o={nextFirstLevelNodeId:100,nextPageNodeId:1e3};return e&&e.data&&(_.each(e.data.children,function(e){var o;"Page"===e.contentElementType?(o=e.id.split("page")[1],t.isNumeric(o)&&n.push(parseInt(o,10)),t.flags.noMasterNodes&&_.each(e.children,function(e){var n=e.id.split(".")[1];t.isNumeric(n)&&i.push(parseInt(n,10))})):"Footer"!==e.contentElementType&&(o=e.id.split(".")[1],t.isNumeric(o)&&i.push(parseInt(o,10)))}),o.nextFirstLevelNodeId=i.length>0?Math.max(parseInt((this.flags.lodash4?_.strictMaxBy:_.max)(i),10),o.nextFirstLevelNodeId):o.nextFirstLevelNodeId,o.nextPageNodeId=n.length>0?Math.max(parseInt((this.flags.lodash4?_.strictMaxBy:_.max)(n),10),o.nextPageNodeId):o.nextPageNodeId),o},e.prototype.setStructureAndIndustry=function(e,t){void 0===e&&(e=this.story.structureId),void 0===t&&(t=this.story.industryId),this.story.structureId=e,this.story.industryId=t},e.prototype.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},e.prototype.createEmitMethod=function(e){var t=this;return function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];var o=[].slice.call(i);o.unshift(e),t.$timeout(function(){t.$log.debug("emitting event: "+e),t.$rootScope.$emit.apply(t.$rootScope,o)})}},e.prototype.getIsStoryAvailablePromise=function(){return this.isStoryAvailablePromise.promise},e.prototype.resolveIsStoryAvailablePromise=function(){this.isStoryAvailablePromise.resolve()},e}();e.StoryServices=t,angular.module("adiCoreAppInternal").service("storyServices",t)}(S||(S={}));var m=function(){function e(e,t,i,n,o,r,a,s,l,c,d,u,p,h,g,m,f,v,y){var b=this;this.$p=e,this.newKitColorationProperties=t,this.BackendTheme=i,this.storyServices=n,this.$log=o,this.flags=r,this.toasterService=a,this.DesignPolicyDefaultPlanes=s,this.themeChooserParameters=l,this.designKitParameters=c,this.dataFlags=d,this.$injector=u,this.sitePartTypes=p,this.themeChooserUtils=h,this.documentServicesMediator=g,this.spinnerService=m,this.colorConfigurationBuilder=f,this.themesProvider=v,this.catalogStyleFetcher=y,this.layoutSelectionStoreProvider=null,this.regularThemes=[],this.customThemes=[],this.colorThemes=[],this.fontThemes=[],this.replacementKitsNotInUse=[],this.active={},this.initialized=!1,this.pendingRequest=[],this.isBusy=!1,this.archiveKey="archive",this.fontKey="font",this.colorKey="color",this.invertedProperty="inverted",this.FIELDS=[this.fontKey,this.colorKey],this.sortedFonts=this.themeChooserParameters.sortedFonts,this.fontsKeys=this.themeChooserParameters.fontsKeys,this.fontNames=this.themeChooserParameters.fontNames,this.headerBackgroundLssPath="siteOverrides.headerBackground",this.footerBackgroundLssPath="siteOverrides.footerBackground",this.DEFAULT_THEMES={color:"eeohehes6m_custom-1",font:{font_0:"lulo-clean",font_1:"georgia-new",font_2:"lulo-clean",font_3:"lulo-clean",font_4:"lulo-clean",font_5:"lulo-clean",font_6:"lulo-clean",font_7:"georgia-new",font_8:"lulo-clean",font_9:"georgia-new",font_10:"georgia-new"},mainKit:"all-evolution"},this.chosenFonts={},this.coloration={isActiveKitColorationModeIsDark:function(){return 1===b.coloration.getActiveKitColorationMode()},isKitColorationModeIsDark:function(e){return 1===b.coloration.getSpecificKitColorationMode(e)},getkitUsedForConfigurations:function(){return b.kitForConfigurations||b.getThemeByID(b.active[b.colorKey])},setKitColorDefinitionProperties:function(e,t){_.each(t,function(i,n){e.definition.properties[n]={type:"color",value:t[n]}})},setActiveKitColorsAndMode:function(e,t,i,n){if(void 0===e&&void 0===t&&void 0===n&&void 0===i)return b.$p.resolve();var o=b.getActiveTheme("mainKit"),r=b.coloration.setKitColorsAndMode(o,e,t,i,n),a=r[0],s=r[1],l=a&&!i?b.coloration.setActiveKitForColorationChanges(s):b.$p.when();return b.coloration.updateStoryOnKitColorationChanges(s),l},setKitColorsAndMode:function(e,t,i,n,o,r){return e.originalKit||(e.originalKit=ob.deepClone(e)),t&&(e=b.coloration.calculateAndUpdateColorPalette(t,e)),e=b.coloration.updateColorationSettings(e,i,o),b.coloration.updateColorationConfigurations(e,n,r)},updateColorationSettings:function(e,t,i){var n=e.kitFonts.colors;return void 0!==t&&n.currentState!==t&&(n.currentState=t,b.flags.debug&&b.$log.info("asked to change coloration mode to: ",0===t?"light":1===t?"dark":"mix")),void 0!==i&&n.colorationLevel!==i&&(n.colorationLevel=i,b.flags.debug&&b.$log.info("asked to change coloration level to: ",i)),void 0===n.colorationLevel&&b.themeChooserUtils.isNewColorationPalette(void 0,e)&&(n.colorationLevel=AdiCoreSanta.COLORATION_LEVEL.colorful,b.flags.debug&&b.$log.info("No Coloration Level found, set coloration level to: ",AdiCoreSanta.COLORATION_LEVEL.colorful)),void 0===n.colorationLevel||b.themeChooserUtils.isNewColorationPalette(void 0,e)||(delete n.colorationLevel,n.currentState===AdiCoreSanta.COLORATION_METHOD_TYPE.mix&&(n.currentState=AdiCoreSanta.COLORATION_METHOD_TYPE.dark)),e},calculateAndUpdateColorPalette:function(e,t,i,n){if(e){var o=t.kitFonts.colors,r=b.themeChooserUtils.updateKitColorsIfPaletteChanged(e,o);if(r&&r.didColorsChange||i){var a=b.themeChooserUtils.generate6Colors(e),s=b.themeChooserUtils.convertCoreToSantaColors(a);b.flags.santaCompleteColorPalette&&(s=b.themeChooserUtils.calculateFullColorPaletteFromSixMainSantaColors(s)),b.coloration.setKitColorDefinitionProperties(t,s),n||b.setDocumentServicesColor(s),b.flags.debug&&(b.$log.info("asked to set: ",e),b.$log.info("current method: ",o.currentState),b.themeChooserUtils.logColors("info","6 colors: "+a,a))}}return t},updateColorationConfigurations:function(e,t,i){var n;if(b.themeChooserUtils.isNewColorationPalette(void 0,e)){var o=void 0;o=t&&b.coloration.storyHasNewColorationConfigurations()?b.coloration.extractColorationConfigurationFromStoryToKit(e):b.colorConfigurationBuilder.calculateAndSetConfig(e),i||(b.adjustStyles(o.styles),b.setDocumentServicesStyles(o.styles)),n=o.changed}else{var r=e.kitFonts.colors,a=void 0,s=b.themeChooserUtils.getKitColors(e),l=b.themeChooserUtils.getKitColors(e.originalKit);if(!_.isEqual(s,l))a=b.themeChooserUtils.calculateKitConfiguration(r,r.currentState);else a=r.currentState===b.coloration.getSpecificKitColorationMode(e.originalKit)?e.id:r.kitForToggle;if(b.kitForConfigurations=a===e.id?e.originalKit:b.getThemeByID(a),b.colorConfigurationBuilder.completeMissingConfig(b.kitForConfigurations),b.kitForConfigurations){o=b.themeChooserUtils.getConfigurationsData(e,b.kitForConfigurations);b.adjustStyles(o.styles),b.documentServicesMediator.setDocumentServicesStyles(o.styles),n=o.changed,b.flags.debug&&b.$log.info("configurations from: "+a+" : "+b.kitForConfigurations.displayName)}else b.$log.error("couldn't find kit for configurations "+a),b.$log.error("are you using updated version of metaData?")}return[n,e]},updateStoryOnKitColorationChanges:function(e){if(b.storyServices.story){var t=e.kitFonts.colors;b.storyServices.story.selectedStyle.coloration=ob.deepClone(t),b.storyServices.story.selectedStyle.coloration.kitId=e.id,b.coloration.updateStoryColorationConfig(e)}},updateStoryColorationConfig:function(e){b.storyServices.story&&(b.storyServices.story.selectedStyle.colorationConfigs&&delete b.storyServices.story.selectedStyle.colorationConfigs,b.themeChooserUtils.isNewColorationPalette(void 0,e)&&(b.storyServices.story.selectedStyle.colorationConfigs=ob.deepClone(b.coloration.extractColorationConfigurationFromKitToStory(e))))},setActiveKitColorsForCustomPalette:function(e){if(void 0===e)return b.$p.resolve();var t=b.getActiveTheme("mainKit"),i=t.kitFonts.colors;t.originalKit||(t.originalKit=ob.deepClone(t));var n=ob.deepClone(i);e.customPaletteDarkMapping=b.themeChooserUtils.isPaletteMappedDark(n,t);var o=b.themeChooserUtils.updateKitColorsIfPaletteChanged(e,i);if(o&&o.didColorsChange){var r=b.themeChooserUtils.generate6ColorsFrom6NewColoration(e),a=[r.l1,r.l2,r.l3,r.d1,r.d2,r.d3],s=b.themeChooserUtils.convertCoreToSantaColors(a);b.flags.santaCompleteColorPalette&&(s=b.themeChooserUtils.calculateFullColorPaletteFromSixMainSantaColors(s)),b.coloration.setKitColorDefinitionProperties(t,s),b.setDocumentServicesColor(s),b.flags.debug&&(b.$log.info("asked to set: ",e),b.$log.info("modified color: ",o.modifiedColors[0]," , to: ",e[o.modifiedColors[0]]))}var l=b.coloration.setActiveKitForColorationChanges(t);return b.storyServices.story&&(b.storyServices.story.selectedStyle.coloration=ob.deepClone(i),b.storyServices.story.selectedStyle.coloration.kitId=t.id),l},setActiveKitForColorationChanges:function(e){return b.spinnerService.waitForMe("settingColoration"),b.designKit.setConfigurationsOfKit(e),b.documentServicesMediator.waitForChanges().then(function(){return b.storyServices.reRenderAllPages().then(function(){b.spinnerService.imDone("settingColoration")})})},storyHasNewColorationConfigurations:function(){return!!b.storyServices.story.selectedStyle.colorationConfigs},recalculateColorationConfigurations:function(){var e=b.getActiveTheme("mainKit"),t=e.kitFonts.colors,i=t.colorationLevel,n=t.currentState,o=b.themeChooserUtils.getKitColors(e);b.coloration.isActiveKitWithNewColoration()?b.coloration.setActiveKitColorsAndMode(o,n,!1,i):b.coloration.updateStoryColorationConfig(e)},isActiveKitWithNewColoration:function(){var e=b.getActiveTheme("mainKit");return b.coloration.isKitWithNewColorationMethod(e)},isKitWithNewColorationMethod:function(e){return b.themeChooserUtils.isNewColorationPalette(void 0,e)},extractColorationConfigurationFromStoryToKit:function(e){var t=b.storyServices.story.selectedStyle.colorationConfigs,i=t.confPattern,n=t.headerAndFooter,o=t.configurations,r=t.styles;e.kitFonts.confPattern=i,e.kitFonts.headerAndFooter=n,e.configurations=o;var a=b.themeChooserParameters.headerStyleProperties.concat(b.themeChooserParameters.footerStyleProperties),s=["bg","bgctr","brd"];return a.forEach(function(t){r[t]&&e.definition.styles[t]&&s.forEach(function(i){r[t][i]&&e.definition.styles[t].properties[i]&&(e.definition.styles[t].properties[i]=r[t][i])})}),{changed:!0,styles:_.pick(e.definition.styles,a)}},extractColorationConfigurationFromKitToStory:function(e){var t={confPattern:{},headerAndFooter:{},configurations:{},styles:{}};t.confPattern=e.kitFonts.confPattern,t.headerAndFooter=e.kitFonts.headerAndFooter,t.configurations=e.configurations;var i=["bg","bgctr","brd"];return b.themeChooserParameters.headerStyleProperties.concat(b.themeChooserParameters.footerStyleProperties).forEach(function(n){e.definition.styles[n]&&(t.styles[n]={},i.forEach(function(i){e.definition.styles[n].properties[i]&&(t.styles[n][i]=e.definition.styles[n].properties[i])}))}),t},setActiveKitColors:function(e){return b.coloration.setActiveKitColorsAndMode(e)},getActiveKitColorsFromStory:function(e){var t=_.get(e,"selectedStyle.mainKit");if(t){var i=b.getThemeByID(t);if(i)return b.themeChooserUtils.getKitColors(i)}},getActiveKitColors:function(){var e=b.getActiveTheme("mainKit");return b.themeChooserUtils.getKitColors(e)},getActiveKitDefaultColors:function(){var e=b.getActiveTheme("mainKit");return b.coloration.getKitDefaultColors(e)},getKitDefaultColors:function(e){var t=e.originalKit||e;return b.themeChooserUtils.getKitColors(t)},getSpecificKitColors:function(e){return b.themeChooserUtils.getKitColors(e)},setActiveKitColorationMode:function(e){return b.coloration.setActiveKitColorsAndMode(void 0,e)},setKitColorationMode:function(e,t,i){return b.coloration.setKitColorsAndMode(e,void 0,t,void 0,void 0,i)},setActiveKitColorationLevel:function(e){return b.coloration.setActiveKitColorsAndMode(void 0,void 0,void 0,e)},setKitColorationLevel:function(e,t,i){return b.coloration.setKitColorsAndMode(e,void 0,void 0,void 0,t,i)},getActiveKitColorationMode:function(){var e=b.getActiveTheme("mainKit");return e&&b.coloration.getSpecificKitColorationMode(e)},getActiveKitColorationLevel:function(){var e=b.getActiveTheme("mainKit");return e&&e.kitFonts.colors.colorationLevel},getActiveKitDefaultColorationMode:function(){var e=b.getActiveTheme("mainKit");return e=e.originalKit||e,b.coloration.getSpecificKitColorationMode(e)},getSpecificKitColorationMode:function(e){return e.kitFonts.colors.currentState},getSpecificKitColorationLevel:function(e){return e.kitFonts.colors.colorationLevel},getColorsForCurrentColoration:function(e,t){void 0===t&&(t=!1);var i=b.designKit.isSitePartDark(e),n=i?"D":"L",o=b.designKit.darkColorsSantaFormat,r=b.designKit.lightColorsSantaFormat;return t?o.map(function(e,t){return{color:"D"+(t+1),hex:b.previewColors.getRGBColor(e)}}).concat(r.map(function(e,t){return{color:"L"+(t+1),hex:b.previewColors.getRGBColor(e)}})):(i?o:r).map(function(e,t){return{color:""+n+(t+1),hex:b.previewColors.getRGBColor(e)}})},isValidTextContrast:function(e,t){var i=b.previewColors.getRGBColor(e),n=b.previewColors.getRGBColor(t);return b.colorConfigurationBuilder.isValidTextContrast(i,n)}},AdiCoreSanta.setThemeChooser(this),_.each(this.fontsKeys,function(e,t){b.chosenFonts[e]={name:b.fontNames[t],themeName:void 0,themeId:void 0}}),this.getDefaultThemes=_.memoize(this._getDefaultThemes.bind(this))}return e.$inject=["$p","newKitColorationProperties","BackendTheme","storyServices","$log","flags","toasterService","DesignPolicyDefaultPlanes","themeChooserParameters","designKitParameters","dataFlags","$injector","sitePartTypes","themeChooserUtils","documentServicesMediator","spinnerService","colorConfigurationBuilder","themesProvider","catalogStyleFetcher"],e.prototype.initLss=function(){this.layoutSelectionStoreProvider=this.$injector.get("layoutSelectionStoreProvider")},Object.defineProperty(e.prototype,"previewColors",{get:function(){return this._previewColors||(this._previewColors=this.$injector.get("previewColors")),this._previewColors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"designKit",{get:function(){return this._designKit||(this._designKit=this.$injector.get("designKit")),this._designKit},enumerable:!0,configurable:!0}),e.prototype._getDefaultThemes=function(e){var t,i,n,o=this;e?n=(_.find(this.regularThemes,{name:this.DEFAULT_THEMES.mainKit})||_.first(this.regularThemes)).id:(t=(_.find(this.regularThemes,{name:this.DEFAULT_THEMES.color})||_.first(this.regularThemes)).id,i=_.transform(this.DEFAULT_THEMES.font,function(e,t,i){var n=_.find(o.regularThemes,{name:t})||_.first(o.regularThemes);return e[i]=n.id,e}));return{color:t,font:i,mainKit:n}},e.prototype._getFontPalette=function(){return this.flags.designKit?this.designKitParameters.orderedPalette:this.themeChooserParameters.PaletteColorsOrder},e.prototype._getLineHeight=function(e){var t=this.fontsKeys.indexOf(e);return this.themeChooserParameters.lineHeights[this.dp.lineHeight||0][t]},e.prototype._checkPendingRequests=function(){if(this.pendingRequest.length>0){var e=this.pendingRequest.shift();this.setThemeByID(e.themesIDs).then(function(){e.deferred.resolve()})}},e.prototype._queuePendingRequest=function(e){var t={deferred:this.$p.defer(),themesIDs:e};return this.pendingRequest.push(t),t.deferred.promise},e.prototype._hsb2rgb=function(e,t,i){var n,o,r,a,s,l,c,d;return e%=360,0===i?{r:0,g:0,b:0}:(l=(i/=100)*(1-(t/=100)),c=i*(1-t*(s=(e/=60)-(a=Math.floor(e)))),d=i*(1-t*(1-s)),0===a?(n=i,o=d,r=l):1===a?(n=c,o=i,r=l):2===a?(n=l,o=i,r=d):3===a?(n=l,o=c,r=i):4===a?(n=d,o=l,r=i):5===a&&(n=i,o=l,r=c),{r:n=Math.round(255*n),g:o=Math.round(255*o),b:r=Math.round(255*r)})},e.prototype._rgb2hsb=function(e,t,i){var n,o,r,a;return e/=255,t/=255,i/=255,(n=Math.min(Math.min(e,t),i))===(o=Math.max(Math.max(e,t),i))?{h:0,s:0,l:100*o}:(r=e===n?t-i:t===n?i-e:e-t,a=e===n?3:t===n?5:1,{h:Math.round(60*(a-r/(o-n)))%360,s:Math.round((o-n)/o*100),l:o=Math.round(100*o)})},e.prototype._cutHex=function(e){return"#"===e.charAt(0)?e.substring(1,7):e},e.prototype._hexToR=function(e){return parseInt(this._cutHex(e).substring(0,2),16)},e.prototype._hexToG=function(e){return parseInt(this._cutHex(e).substring(2,4),16)},e.prototype._hexToB=function(e){return parseInt(this._cutHex(e).substring(4,6),16)},e.prototype._modifyHsbOfHex=function(e,t){var i,n;return i=this.parseRGB(e),n=t(n=this._rgb2hsb(i.r,i.g,i.b)),i=this._hsb2rgb(n.h,n.s,n.l),this.themeChooserUtils.rgbToHex(i.r,i.g,i.b)},e.prototype._generateColors=function(e,t){var i,n,o,r,a=this._hexToR(e),s=this._hexToG(e),l=this._hexToB(e),c=this._rgb2hsb(a,s,l),d=c.l,u=Math.sqrt((100-c.l)*(100-c.l)+c.s*c.s),p=Math.floor(5*d/(d+u)),h=[];for(i=0;i<5;i++)n=c.s,i<p?o=(i+1)/(p+1)*d:i===p?o=d:(o=(i-p)/(5-p)*(100-d)+d,n=c.s/(i-p+1)),r=this._hsb2rgb(c.h,n,o),h.push(this.themeChooserUtils.rgbToHex(r.r,r.g,r.b));return t||h.reverse(),h},e.prototype._saveTheme=function(e){var t=this;return e.save().then(function(){return t.toasterService.info("Theme saved",!0),e},function(i){return t.toasterService.error("Failed to save theme",!0),t.$log.error(i),e})},e.prototype._filterThemes=function(e,t){var i=this;return this.regularThemes.filter(function(n){return!n[i.archiveKey]&&n[e]&&!n[t]})},e.prototype._filterKitThemes=function(){var e=this;return this.regularThemes.filter(function(t){return e.isKit(t)})},e.prototype._isCustomTheme=function(e){return void 0!==e.Custom},e.prototype._isCustomOfGivenIdOrCurrentStory=function(e,t){return!(!t&&!this.storyServices.story)&&(t||this.storyServices.story.id)===e.Custom},e.prototype._filterThemesByType=function(e){this.flags.designKit?(this.colorThemes=this._filterKitThemes(),this.fontThemes=this.colorThemes):(this.colorThemes=this._filterThemes(this.colorKey,this.fontKey),this.fontThemes=this._filterThemes(this.fontKey,this.colorKey)),e&&this.colorThemes.unshift(e)},e.prototype._setThemeAttributes=function(e,t,i,n,o,r,a,s){e.source=t,e.definition=i,e.metaSiteId=n,e.siteId=o,e.isTemplate=r,e.kitFonts=s,e[this.invertedProperty]=a},e.prototype._isRussianLang=function(e){return"ru"===e},e.prototype._isLatinExtendedLang=function(e){return this.themeChooserParameters.LatinExtendedLanguages.indexOf(e)>-1},e.prototype._sortByDisplayName=function(e,t){return e.displayName<t.displayName?-1:e.displayName>t.displayName?1:0},e.prototype._sortByLatinExtended=function(e,t){return!e.latinExtendedFallback&&t.latinExtendedFallback?-1:e.latinExtendedFallback&&!t.latinExtendedFallback?1:0},e.prototype._sortByRussian=function(e,t){return!e.russianFallback&&t.russianFallback?-1:e.russianFallback&&!t.russianFallback?1:0},e.prototype._sortRegularThemes=function(){var e=this._isLatinExtendedLang(),t=this._isRussianLang();this.regularThemes.sort(this._sortByDisplayName),e?this.regularThemes.sort(this._sortByLatinExtended):t&&this.regularThemes.sort(this._sortByRussian)},e.prototype._getFallback=function(e,t){if(e)return e[t]||e.id},e.prototype._fillObjWithThemeIdForAllFonts=function(e,t){var i=this;e[this.fontKey]={},angular.forEach(this.chosenFonts,function(n,o){e[i.fontKey][o]=t})},e.prototype.getNumberOfLineHeightsOptions=function(){return this.themeChooserParameters.lineHeights.length},e.prototype.lineHeightChanged=function(){var e=_.mapValues(this.chosenFonts,"themeId");this.setThemeByID({font:e})},e.prototype.setDesignPolicy=function(e){this.dp=e},e.prototype.getDesignPolicy=function(){return this.dp},e.prototype.getFontPointer=function(e){return this.storyServices.story&&this.storyServices.story.selectedStyle.fontPointer?this.storyServices.story.selectedStyle.fontPointer[e]:this.themeChooserParameters.defaultFontColor},e.prototype.setFontPointer=function(e,t){this.storyServices.story.selectedStyle.fontPointer=this.storyServices.story.selectedStyle.fontPointer||{},this.storyServices.story.selectedStyle.fontPointer[e]=this.getIndexInPalette(t)},e.prototype.createNewTheme=function(e,t,i,n,o,r,a,s){var l=this.BackendTheme.build({});return this._setThemeAttributes(l,e,i,o,r,a,s),l.name=t,l.fontPalette=this.getFontsOrderedForPalette(l),n?(l.color=!0,l.Custom=n,this.customThemes.push(l)):this.regularThemes.push(l),l.save()},e.prototype.createOrUpdateCustomColorTheme=function(e,t){var i=this,n={};angular.copy(e.definition,n);var o=-1!==(e.displayName||e.name).indexOf("invert"),r=this.getCustomColorTheme(t),a={};return angular.copy(e.source,a),a.custom=t||this.storyServices.story.id,a.hasOwnSite=!1,r?(this._setThemeAttributes(r,a,n,e.metaSiteId,e.siteId,e.isTemplate,o,e.kitFonts),this.$p.when(r)):this.createNewTheme(a,"Custom",n,t||this.storyServices.story.id,e.metaSiteId,e.siteId,e.isTemplate,o).then(function(e){return i.colorThemes.unshift(e),e})},e.prototype.getFieldsArr=function(){return this.FIELDS},e.prototype.getArchiveKey=function(){return this.archiveKey},e.prototype.getChosenFonts=function(){return this.chosenFonts},e.prototype.getFontsFields=function(){return this.fontsKeys},e.prototype.getFontsNames=function(){return this.fontNames},e.prototype.getKitFontsCategories=function(){return this.designKitParameters.kitFontsCategories},e.prototype.getKitFontsStyle=function(){return this.designKitParameters.kitFontsStyle},e.prototype.loadSingleTheme=function(e){return this.BackendTheme.find(e)},e.prototype.initialize=function(){var e=this;return this.initPromise?this.initPromise:(this.initPromise=this.getAllThemes().then(function(t){e.flags.consumerMode&&(t=t.filter(function(t){return e.dataFlags.areFulfilled(t)})),t.forEach(function(t){t.fontPalette=e.getFontsOrderedForPalette(t)}),e.flags.consumerMode&&(t=e.replaceOldKits(t)),e.regularThemes=t.filter(function(t){return!e._isCustomTheme(t)}),e._sortRegularThemes(),e.customThemes=t.filter(function(t){return e._isCustomTheme(t)}),e._filterThemesByType(),e.initialized=!0,e._checkPendingRequests()}),this.initPromise)},e.prototype.getAllThemes=function(){var e,t=this;if(this.flags.coreUseKitlerCatalog){var i=this.themesProvider.getSystemThemes();e=this.$p.when(i)}else e=this.BackendTheme.search({limit:1e3,where:[["Custom","==",""]]});return e.then(function(e){return t.flags.consumerMode&&(e=t.replaceKitsWithNewColorationProperties(e)),e})},e.prototype.replaceOldKits=function(e){var t=this,i=this.storyServices.story.selectedStyle,n=_.filter(e,"kitFonts.replacingKitId");return _.each(n,function(n){var o,r=_.get(n,"kitFonts.replacingKitId");_.includes(i,r)?(o=_.findIndex(e,{id:n.id}),t.replacementKitsNotInUse.push(n)):o=_.findIndex(e,{id:r});var a=e.splice(o,1)[0];n.displayName=a.displayName,n.name=a.name}),e},e.prototype.replaceKitsWithNewColorationProperties=function(e){var t,i,n=this.newKitColorationProperties,o=this.storyServices.story.selectedStyle;return this.shouldNotReplaceActiveKit(o)&&(!(t=o.mainKit)&&o.coloration&&(t=o.coloration.kitId),n[t]&&delete n[t],i=o.colorKit,n[i]&&delete n[i]),e.forEach(function(e){if(n[e.id]){var t=n[e.id],i=t.properties,o=t.colors;_.forEach(i,function(t,i){e.definition.properties[i].value=t}),_.forEach(o,function(t,i){e.kitFonts.colors[i]=t}),e.kitFonts.colors.colorationVersion=1}}),e},e.prototype.shouldNotReplaceActiveKit=function(e){return!0===e.newStoryKit?(delete e.newStoryKit,!1):!("coloration"in e)||"coloration"in e&&1!==e.coloration.colorationVersion},e.prototype.loadCustomTheme=function(e){var t=this;return this.initialize().then(function(){return t.BackendTheme.search({Custom:e}).then(function(i){t.flags.consumerMode&&(t.customThemes=i.filter(function(e){return t.dataFlags.areFulfilled(e)})),t.customThemes.forEach(function(e){e.fontPalette=t.getFontsOrderedForPalette(e)}),t._filterThemesByType(t.getCustomColorTheme(e))})})},e.prototype.reloadTheme=function(e){return this.BackendTheme.findOne(e.id)},e.prototype.isActive=function(e,t){return this.active[t]===e},e.prototype.getActiveTheme=function(e){return this.getThemeByID(this.active[e])},e.prototype.getThemeByID=function(e){return _.find(this.regularThemes,{id:e})||_.find(this.customThemes,{id:e})||_.find(this.replacementKitsNotInUse,{id:e})||_.find(this.regularThemes,{objectId:e})||_.find(this.customThemes,{objectId:e})},e.prototype.getCalculatedThemeByID=function(e){var t=this.getThemeByID(e);return this.coloration.updateColorationConfigurations(t,!1,!0),this.coloration.calculateAndUpdateColorPalette(t.kitFonts.colors,t,!0,!0),t},e.prototype.getActiveFontTheme=function(){return this.getThemeByID(this.chosenFonts.font_0.themeId)},e.prototype.setThemeByID=function(e,t,i){if(!this.initialized||this.isBusy)return this._queuePendingRequest(e);var n,o={},r=e[this.colorKey];return r&&(n=this.getThemeByID(r),this.flags.designKit&&!this.isKit(n)&&(n=_.find(this.colorThemes,{name:"all-delight"})),this.coloration.isKitWithNewColorationMethod(n)?(this.coloration.updateColorationConfigurations(n,!1,!0),this.coloration.calculateAndUpdateColorPalette(n.kitFonts.colors,n,!0,!0)):this.colorConfigurationBuilder.completeMissingConfig(n),n&&(o[this.colorKey]=n,this.flags.designKit&&n.kitFonts&&(n.configurations&&(e.color&&e.font&&e.color===e.font&&(this.themeChooserUtils.resetKit(this.getActiveTheme("mainKit")),this.themeChooserUtils.resetKit(n),this.kitForConfigurations=void 0),this.coloration.isKitWithNewColorationMethod(n)&&!i&&this.coloration.updateStoryOnKitColorationChanges(n),this.designKit.setConfigurationsOfKit(n)),void 0===n.kitFonts.lineHeight||t||e.color!==e.font||(this.dp.lineHeight=n.kitFonts.lineHeight,this.dp.formula="dp"+n.kitFonts.lineHeight,this.DesignPolicyDefaultPlanes.setCurrentFormula(this.dp.formula))))),e[this.fontKey]&&("object"!=typeof e[this.fontKey]&&this._fillObjWithThemeIdForAllFonts(e,e[this.fontKey]),o[this.fontKey]=this.getFontMapToThemes(e[this.fontKey])),this.setTheme(o,i)},e.prototype.setAllFontsFromOneTheme=function(e){var t={};return this._fillObjWithThemeIdForAllFonts(t,e),this.setThemeByID(t)},e.prototype.getFontMapToThemes=function(e){var t=this,i={};return angular.forEach(this.chosenFonts,function(n,o){if(e[o]){var r=t.getThemeByID(e[o]);r&&(i[o]=r)}}),i},e.prototype.getStylesFallbackForLocale=function(e,t){var i,n=this,o={themeFonts:{}};return this._isLatinExtendedLang(t)||this._isRussianLang(t)?this.fontsKeys.forEach(function(r){i=n.getThemeByID(e.themeFonts[r]),o.themeFonts[r]=n._getFallback(i,n._isLatinExtendedLang(t)?"latinExtendedFallback":"russianFallback")}):this.fontsKeys.forEach(function(t){o.themeFonts[t]=e.themeFonts[t]}),o},e.prototype.setColorTheme=function(e){var t={};return t[this.colorKey]=e,this.setTheme(t)},e.prototype.getBgColorFromLss=function(e){var t=this[e+"BackgroundLssPath"],i=_.get(this.getLss(),t),n=i&&this.designKitParameters[i];if(n)return"color_"+n},e.prototype.updateSitePartBg=function(t){return this.updateBg(e[t+"StyleKey"],t,e.styleKeys.background,this.getBgColorFromLss(t))},e.prototype.toggleHeaderTransparent=function(t,i){return void 0===i&&(i=!0),this.updateBg(e.headerStyleKey,this.sitePartTypes.HEADER,e.styleKeys.opacity,t?"0":"1",i)},e.prototype.updateHeaderBg=function(){return this.updateSitePartBg(this.sitePartTypes.HEADER)},e.prototype.updateFooterBg=function(){return this.updateSitePartBg(this.sitePartTypes.FOOTER)},e.prototype.getHeaderBg=function(){return this.getSitePartBg(this.sitePartTypes.HEADER)},e.prototype.getSitePartBg=function(t){if(this.flags.mergedHeaderPhase2){var i=this.designKit.getSitePartBg(t);return{color:i,hex:this.previewColors.getRGBColor(i)}}var n=this.coloration.getkitUsedForConfigurations().definition.styles[e[t+"StyleKey"]],o=_.get(n,this.getPartBackgroundPath());return{color:o,hex:this.previewColors.getRGBColor(o)}},e.prototype.getPartBackgroundPath=function(){return e.PROPERTIES_PREFIX+e.styleKeys.background[0]},e.prototype.updateBg=function(e,t,i,n,o){if(void 0===o&&(o=!0),this.flags.mergedHeader){var r=this.coloration.getkitUsedForConfigurations();if(r){var a=r.definition.styles[e];if(this.updateBackgroundStyle(a,i,n),this.documentServicesMediator.updateStyle(e,a.properties,a.skin),this.flags.mergedHeader)return o?this.storyServices.invalidateAndReRenderAllPages():this.storyServices.invalidateAllPages()}}return this.$p.resolve()},e.prototype._overrideStyles=function(e){e.mg1&&e.mg1.properties&&(e.mg1.properties["alpha-bgHover"]="0.3")},e.prototype.shouldHeaderBeTransparent=function(){if(!this.mergedHeaderService){if(!this.$injector.has("mergedHeaderService"))return!1;this.mergedHeaderService=this.$injector.get("mergedHeaderService")}return this.mergedHeaderService.shouldHeaderBeTransparent()},e.prototype.adjustStyles=function(t){if(this.flags.mergedHeader){var i=this.getBgColorFromLss(this.sitePartTypes.HEADER);this.updateBackgroundStyle(t[e.headerStyleKey],e.styleKeys.background,i)}this.flags.mergedHeader&&this.shouldHeaderBeTransparent()&&this.updateBackgroundStyle(t[e.headerStyleKey],e.styleKeys.opacity,"0")},e.prototype.filterExistingStyles=function(e,t){return _.reduce(e,function(e,i,n){var o=_.get(t[n],"style.properties");return _.isEqual(o,i.properties)||(e[n]=i),e},{})},e.prototype.filterExistingFonts=function(e,t){return _.reduce(e,function(e,i,n){return t[n]!==i&&(e[n]=i),e},{})},e.prototype.buildFontStyleObject=function(e){var t=this,i={};return angular.forEach(e,function(e,n){var o=e.definition.properties[n];if(o){var r=o.value;r=r.replace(/[0-9,.]*em/,t._getLineHeight(n));var a=t.getFontPointer(n);void 0!==a&&(r=r.replace(/color_\d*/,"color_"+a)),i[n]=r}else t.$log.error("Failed to set font")}),i},e.prototype.setDSFontStyles=function(e){var t=this.documentServicesMediator.getAllFonts(),i=this.filterExistingFonts(e,t);if(_.isEmpty(i))return!0;this.documentServicesMediator.updateFonts(i)},e.prototype.setDocumentServicesColor=function(e){this.flags.setStylesPerf2&&this.initialization?this.colorsToSetAfterInitialization=e:this.documentServicesMediator.updateColors(e)},e.prototype.setDSColorStylesAndDefinitions=function(e){var t=e.definition,i={};_.each(t.properties,function(e,t){"color"===e.type&&(i[t]=e.value)}),this.setDocumentServicesColor(i),this.adjustStyles(t.styles),this._overrideStyles(t.styles),this.setDocumentServicesStyles(t.styles)},e.prototype.setDocumentServicesStyles=function(e){if(this.initialization)this.stylesToSetAfterInitialization=_.defaults(e,this.stylesToSetAfterInitialization);else{var t=this.documentServicesMediator.getAllStyles();this.documentServicesMediator.setDocumentServicesStyles(this.filterExistingStyles(e,t))}},e.prototype.setChosenFonts=function(e){var t=this;angular.forEach(e,function(e,i){t.chosenFonts[i]&&(t.chosenFonts[i].themeId=e.id,t.chosenFonts[i].themeName=e.displayName||e.name)})},e.prototype.setTheme=function(e,t){var i=this;this.isBusy=!0;var n=!1,o=this.flags.designKit&&e.font&&e.font.font_0===e.color;if(e.font){var r=this.buildFontStyleObject(e.font);n=this.setDSFontStyles(r)}e.color&&this.setDSColorStylesAndDefinitions(e.color),e.font&&this.setChosenFonts(e.font),this.active.color=e.color?e.color.id:this.active.color;var a=this.$p.when();return e.font&&(this.flags.consumerMode?t&&this.flags.perfDontWaiteForDSLoadedToCalcSolution||(this.storyServices.resetCache(),a=this.flags.generalPerf&&n?this.storyServices.setUpCacheByKit(t):this.documentServicesMediator.waitForChanges().then(function(){return i.storyServices.setUpCacheByKit(t)})):this.storyServices.emitClearAllCaches()),a.then(function(){if(o&&(i.active.mainKit=e.color.id),!i.initialization)if(i.flags.designKit){if(i.flags.consumerMode)return e.font?i.storyServices.onNodeChangedClearCacheSynchronous():i.storyServices.reRender();i.storyServices.emitNodeChangedClearCache()}else e.font?i.storyServices.emitNodeChanged():i.storyServices.emitLayoutSolutionChanged()}).then(function(){i.isBusy=!1,i._checkPendingRequests()})},e.prototype.getLss=function(){return this.layoutSelectionStoreProvider||this.initLss(),this.layoutSelectionStoreProvider.getLayoutSelectionStore()},e.prototype.updateStyle=function(t,i,n){(Array.isArray(i)?i:[i]).forEach(function(i){return _.set(t,""+e.PROPERTIES_PREFIX+i,n)})},e.prototype.updateBackgroundStyle=function(e,t,i){i&&this.updateStyle(e,t,i)},e.prototype.getRegularThemes=function(){return this.regularThemes},e.prototype.getColorThemes=function(){return this.colorThemes},e.prototype.getFontThemes=function(){return this.fontThemes},e.prototype.getCustomThemes=function(){return this.customThemes},e.prototype.getCustomColorTheme=function(e){var t=this;return this.customThemes.filter(function(i){return t._isCustomOfGivenIdOrCurrentStory(i,e)})[0]},e.prototype.getColorFromActiveColorTheme=function(e){if(this.active.color&&void 0!==e){var t=this.getThemeByID(this.active.color);return this.getColorByColorTheme(t,e)}return"#032340"},e.prototype.getColorByColorTheme=function(e,t){if(e){var i=e.definition.properties;if(i[t])return this.themeChooserUtils.colorStyle(i[t].value)}return"#032340"},e.prototype.getFontColor=function(e){var t=this.chosenFonts[e].themeId,i=this.getThemeByID(t);if(i){var n=i.definition.properties;if(n[e]){var o=this.getFontPointer(e);if(o)return"color_"+o;var r=n[e];if(r)return(r=r.value).match(/\{(.*)\}/)[1]}}},e.prototype.getFontsOrderedForPalette=function(e){var t,i,n=this,o=e.definition.properties,r=/\{(.*)\}/,a=[];return this.fontsKeys.forEach(function(e){(t=o[e])&&(t=t.value,i=t.match(r),a.push({title:n.chosenFonts[e].name,style:t.replace(" "+i[0],""),color:i[1]}))}),a},e.prototype.getMainColorsOrderedForPalette=function(e){var t=this.flags.designKit?this.designKitParameters.orderedPalette:this.themeChooserParameters.mainColorsOrder;return this.themeChooserUtils.colorsOrderedByIndexArr(e,t)},e.prototype.getThemeProperties=function(e){return e.definition.properties},e.prototype.setThemeProperties=function(e,t){e.definition.properties=t},e.prototype.getSelectedMainColorsOrderedForPalette=function(){var e=this.getThemeByID(this.active[this.colorKey]);if(e)return this.getMainColorsOrderedForPalette(e)},e.prototype.getColorsOrderedForPalette=function(e){return this.themeChooserUtils.colorsOrderedByIndexArr(e,this._getFontPalette())},e.prototype.getColorByIndexInPalette=function(e,t){return this.themeChooserUtils.colorByIndexInPalette(e,this._getFontPalette()[t])},e.prototype.getActiveColorsOrderedForPalette=function(){var e=this.getThemeByID(this.active[this.colorKey]);if(e)return this.getColorsOrderedForPalette(e)},e.prototype.getActiveColorByIndexInPalette=function(e){var t=this.getThemeByID(this.active[this.colorKey]);if(t)return this.themeChooserUtils.colorByIndexInPalette(t,e)},e.prototype.setCustomMainColor=function(e,t,i){for(var n=e.definition.properties,o=this._generateColors(i,e[this.invertedProperty]),r=this.themeChooserParameters.mainColorsOrder[t]-2,a=0;a<5;a++)n["color_"+r].value=o[a],r++;this.callDebounceSetThemeByID({color:e.id})},e.prototype.setCustomColor=function(e,t,i){e.definition.properties["color_"+this.getIndexInPalette(t)].value=i,this.callDebounceSetThemeByID({color:e.id})},e.prototype.registerReimportCallback=function(e){this.themeReimportCallback=e},e.prototype.updateThemeIfCustom=function(){if(this.storyServices.story&&this.themeReimportCallback){var e=this.getCustomColorTheme(this.storyServices.story.id);e&&this.themeReimportCallback(e)}},e.prototype.parseRGB=function(e){return{r:this._hexToR(e),g:this._hexToG(e),b:this._hexToB(e)}},e.prototype.rgb2hsb=function(e){var t=this._rgb2hsb(e.r,e.g,e.b);return{h:t.h,s:t.s,b:t.l}},e.prototype.hsb2rgb=function(e){return this._hsb2rgb(e.h,e.s,e.b)},e.prototype.increaseBrightness=function(e){return this._modifyHsbOfHex(e,function(e){return e.l+=10,e.l>100&&(e.l=100),e})},e.prototype.invertColorsOfCustomTheme=function(e){var t,i,n=e.definition.properties;function o(e,i,n){t=e["color_"+i].value,e["color_"+i].value=e["color_"+n].value,e["color_"+n].value=t}for(i=0;i<5;i++)o(n,this.getIndexInPalette(i),this.getIndexInPalette(i+20));for(i=5;i<10;i++)o(n,this.getIndexInPalette(i),this.getIndexInPalette(i+10));o(n,1,2),this.callDebounceSetThemeByID({color:e.id}),e[this.invertedProperty]=!e[this.invertedProperty]},e.prototype.getIndexInPalette=function(e){return this._getFontPalette()[e]},e.prototype.callDebounceSetThemeByID=function(e){this.debounceSetThemeByID||(this.debounceSetThemeByID=_.debounce(this.setThemeByID.bind(this),this.themeChooserParameters.debounceInterval)),this.debounceSetThemeByID(e)},e.prototype.saveTheme=function(e){return this._saveTheme(e)},e.prototype.getLineHeight=function(e){return this._getLineHeight(e)},e.prototype.getFontStyle=function(e){return this.getSpecificKitFontStyle(this.getActiveFontTheme(),e)},e.prototype.getSpecificKitFontStyle=function(e,t){var i=this.fontsKeys.indexOf(t);return e.fontPalette[i].style},e.prototype.getFontOrder=function(e){return this.sortedFonts[this.chosenFonts[e].name]},e.prototype.isButtonStyleTransparent=function(e){var t;if(this.flags.separateVisualValidationFromSanta){var i=this.getActiveTheme("mainKit");t=this.catalogStyleFetcher.getStyleDefinition2(i,e)}else t=this.catalogStyleFetcher.getStyleDefinition(e);return t&&"wysiwyg.viewer.skins.button.TextOnlyButtonSkin"===t.skin},e.prototype.isKit=function(e){return e&&!e[this.archiveKey]&&e[this.colorKey]&&e[this.fontKey]},e.prototype.filterNewVersionKits=function(e){var t=this;return e.filter(function(e){return t.isNewKitVersion(e)})},e.prototype.isNewKitVersion=function(e){return e&&1===e.kitVersion},e.prototype.isKitIdNewKitVersion=function(e){return this.isNewKitVersion(this.getThemeByID(e))},e.prototype.isActiveMainKitNewKitVersion=function(){var e=this.getActiveTheme("mainKit");return!!e&&this.isNewKitVersion(e)},e.prototype.isActiveFontKitNewKitVersion=function(){var e=this.getActiveFontTheme();return!!e&&this.isNewKitVersion(e)},e.prototype.isActiveMainKitWithNewColorationPalette=function(){return this.themeChooserUtils.isNewColorationPalette(void 0,this.getActiveTheme("mainKit"))},e.prototype.isOldKitVersion=function(e){return!this.isNewKitVersion(e)},e.prototype.getTransformedDsFonts=function(){var e=this,t=this.documentServicesMediator.getAllFonts();return _.transform(t,function(t,i,n){var o=i.match(/(\d+)px/)[1];return t[n]={name:n,size:o,definition:i,description:e.chosenFonts[n]&&e.chosenFonts[n].name},t})},e.prototype.getFontSize=function(e){if(-1===e.indexOf("font_"))return e.match(/(\d+)px/)[1];var t=this.chosenFonts[e].themeId,i=this.getThemeByID(t).definition.properties[e].value.match(/(\d+)px/)[1];return this.flags.textEditOnStage2?+i:i},e.prototype.serializeSelctions=function(e,t){if("themeFonts"===e){this.storyServices.story.getActiveLocale().styles[e]=t}else{var i=this.storyServices.story.selectedStyle||{};i[e]=t,this.storyServices.story.selectedStyle=i}this.serializeKitToStory(e,t)},e.prototype.serializeKitToStory=function(e,t){if("mainKit"===e||"fontKit"===e){var i=this.storyServices.story&&this.storyServices.story.selectedStyle;if(this.removeKitDataInStorySelectedStyle(e),t&&this.isKitIdNewKitVersion(t)){var n=this.themesProvider.getSystemThemeById(t,!0);n&&(i.kitData=i.kitData||{},i.kitData[e]=n)}}},e.prototype.removeKitDataInStorySelectedStyle=function(e){var t=this.storyServices.story.selectedStyle;if(t&&t.kitData){switch(e){case"mainKit":delete t.kitData.mainKit;break;case"fontKit":delete t.kitData.fontKit;break;default:console.log("kitData to delete does not exists")}_.isEmpty(t.kitData)&&delete t.kitData}},e.prototype.serializeMainKitSelection=function(e,t){this.serializeSelctions("mainKit",e),t&&this.serializeSelctions("newStoryKit",t)},e.prototype.serializeFontKitSelection=function(e){this.serializeSelctions("fontKit",e)},e.prototype.serializeColorKitSelection=function(e){this.serializeSelctions("colorKit",e)},e.prototype.serializeOneFontSelection=function(e,t){var i=this.storyServices.story.getActiveLocale().styles;i.themeFonts=i.themeFonts||{},i.themeFonts[e]=t},e.prototype.replaceSystemKitsWithStoryKits=function(e){if(e&&e.selectedStyle&&e.selectedStyle.kitData){var t=e.selectedStyle.kitData,i=[this.getColorThemes(),this.getFontThemes(),this.getRegularThemes()];this.themeChooserUtils.replaceKitDataInThemeSets(t,i)}},e.prototype.setStaticStoryStyles=function(e){var t=e.selectedStyle&&ob.deepClone(e.selectedStyle)||{},i=this.getDefaultThemes(!0).mainKit,n=t.mainKit&&this.getThemeByID(t.mainKit)?t.mainKit:i,o={};o.font=t.fontKit&&this.getThemeByID(t.fontKit)?t.fontKit:n,o.color=t.colorKit&&this.getThemeByID(t.colorKit)?t.colorKit:n;var r={},a=this.getThemeByID(o[this.fontKey]);this._fillObjWithThemeIdForAllFonts(r,a),this.setChosenFonts(r[this.fontKey]),this.active.mainKit=n,this.active.color=o.color;var s=this.getThemeByID(n);return this.coloration.updateColorationConfigurations(s,!1,!0),this.coloration.calculateAndUpdateColorPalette(s.kitFonts.colors,s,!0,!0),this.designKit.setConfigurationsOfKit(s),this.storyServices.setUpCacheByKit(!0)},e.prototype.setStoryStyles=function(e,t){var i,n,o=this,r={};if(this.flags.designKit){n=e.selectedStyle&&ob.deepClone(e.selectedStyle)||{};var a=this.getDefaultThemes(!0).mainKit;i=n.mainKit&&this.getThemeByID(n.mainKit)?n.mainKit:a,r.font=n.fontKit&&this.getThemeByID(n.fontKit)?n.fontKit:i,r.color=n.colorKit&&this.getThemeByID(n.colorKit)?n.colorKit:i}else{var s=e.getActiveLocale().styles;r.font=s.themeFonts||this.getDefaultThemes().font,r.color=e.selectedStyle&&e.selectedStyle.themeColors||this.getDefaultThemes().color,s.themeFonts||(s.themeFonts=r.font)}return this.replaceSystemKitsWithStoryKits(e),this.initialization=!t,this.dp.formula&&this.DesignPolicyDefaultPlanes.setCurrentFormula(this.dp.formula),this.setThemeByID(r,void 0!==this.dp.formula,!0).then(function(){var e;return o.active.mainKit=i,n.coloration&&i===n.coloration.kitId?e=o.coloration.setActiveKitColorsAndMode(n.coloration,n.coloration.currentState,o.initialization,n.coloration.colorationLevel):o.coloration.isActiveKitWithNewColoration()&&(e=o.coloration.setActiveKitColorsAndMode(void 0,void 0,o.initialization,void 0)),o.initialization=!1,o.setDocumentServicesStyles(o.stylesToSetAfterInitialization),delete o.stylesToSetAfterInitialization,o.setDocumentServicesColor(o.colorsToSetAfterInitialization),e})},e.styleKeys={background:["bg","bgctr","brd"],opacity:["alpha-bg","alpha-bgctr","alpha-brd"]},e.PROPERTIES_PREFIX="properties.",e.headerStyleKey="hc1",e.footerStyleKey="fc1",e}();angular.module("adiCoreAppInternal").service("themeChooser",m),angular.module("adiCoreAppInternal").service("toasterService",["$rootScope","$window","$log","flags",function(e,t,i,n){var o={pop:_.noop},r=["info","success","error","warning","wait","debug"],a=_.reduce(r,function(e,t){return e[t]=5e3,e},{}),s={};function l(r,l,c,d,u){var p,h;if(_.isObject(c))p=c.message,h=c.callback;else{if(!_.isString(c))throw"message arg in toaster should be string or object";p=c}if(void 0===u&&_.isBoolean(d)&&(u=d,d=void 0),"debug"===l){if(!n.debugMode)return;l="warning",void 0===d&&(d="Debug")}if(!t.__karma__){var g=["|"+l.toUpperCase()+"|"];void 0!==d&&g.push(d+","),g.push(p),i.info(g.join(" "))}var m,f=0;u&&(f=a[l]||0),r&&(s[r]=s[r]||[],s[r][l]=s[r][l]||[],(m=s[r][l]).splice(0,0,p)),m&&m.length>1?m.restartTimeout&&m.restartTimeout():o.pop({type:l,title:d,body:r?"views/toast.html":p,timeout:f,bodyOutputType:m||r?"template":"",messages:m||[p],callback:h,index:0}),_.defer(function(){e.$apply()})}_.assign(this,{setToaster:function(e){o=e},group:function(e){return _.transform(r,function(t,i){return e?(t[e]=t[e]||{},t[e][i]=l.bind(void 0,e,i)):t[i]=l.bind(void 0,e,i),t})}}),_.assign(this,this.group()),_.assign(this,this.group("consumer"))}]);a=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){e.done?o(e.value):new i(function(t){t(e.value)}).then(a,s)}l((n=n.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var i,n,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};var f=function(){function e(e,t,i,n,o,r,a,s,l,c,d,u,p,h,g,m,f){var v=this;this.flags=e,this.$window=t,this.toasterService=i,this.applicationParameters=n,this.$p=o,this.addBlogService=r,this.tpaDefinition=a,this.bookingService=s,this.$timeout=l,this.dashboardSdk=c,this.tpaStyleService=d,this.documentServicesMediator=u,this.platformService=p,this.themeChooser=h,this.tpaTypes=g,this.modelTree=m,this.$translate=f,this.duringAdditionOfTpa=!1,this.tpaManagementIFrameCallbacks={},this.tpaManagerOpeners={},this.invertColor=function(e,t,i){return e},this.masterPage=function(){return v.documentServicesMediator.getSiteStructure()},AdiCoreSanta.setTpaService(this),this._addTpaManagementMessageHandlers()}return e.$inject=["flags","$window","toasterService","applicationParameters","$p","addBlogService","tpaDefinition","bookingService","$timeout","dashboardSdk","tpaStyleService","documentServicesMediator","platformService","themeChooser","tpaTypes","modelTree","$translate"],e.prototype.getClientSpecByAppId=function(e){return this.documentServicesMediator.getTpaData(e)},e.prototype.getApplicationIdByCompRef=function(e){if(this.flags.lessUpdateLayout){if(t=e&&this.documentServicesMediator.getComponentData(e))return t.applicationId}else{var t,i=e&&this.documentServicesMediator.serializeComponent(e);if(i)return(t=i.data).applicationId}},e.prototype.getOldBlogAppData=function(){return this.documentServicesMediator.getDataByAppDefId("61f33d50-3002-4882-ae86-d319c1a249ab")||{}},e.prototype.getBlogAppId=function(){return this.getOldBlogAppData().applicationId},e.prototype.isOldBlogInstalled=function(){return"Initialized"===this.getOldBlogAppData().state},e.prototype.registerTpaManagementCallback=function(e,t){this.tpaManagementIFrameCallbacks[e]=this.tpaManagementIFrameCallbacks[e]||[],this.tpaManagementIFrameCallbacks[e].push(t)},e.prototype.deRegisterTpaManagementCallback=function(e,t){if(this.tpaManagementIFrameCallbacks[e]){var i=this.tpaManagementIFrameCallbacks[e].indexOf(t);i>-1&&this.tpaManagementIFrameCallbacks[e].splice(i,1)}},e.prototype.registerTpaOpener=function(e,t){e&&e.length&&_.isFunction(t)&&(this.tpaManagerOpeners[e]=t||this.tpaManagerOpeners[e])},e.prototype.filterHiddenTpaPages=function(e){var t=this,i=this.documentServicesMediator.getPagesNotMarkedAsHiddenFromMenu(),n=_.map(i,"tpaPageId");return _.filter(e,function(e){return!(!t.flags.postPage&&"post"===e.appPage.id)&&-1!==n.indexOf(e.appPage.id)})},e.prototype.preferredLanguage=function(){return this.$translate.preferredLanguage()},e.prototype.getRenderModelTpaType=function(e){return{subscribe:AdiCoreSanta.TpaWidgetTypes.GetSubscribers_Widget}[e]},e.prototype.addTpaOld=function(e,t,i,n){return this.addTpa(e,i,n,t)},e.prototype.addTpa=function(e,t,i,n){var o=this,r=this.tpaDefinition.tpaByType(e);if(this._isTpaAdded(r))return this.toasterService.info(e+" exist already",!0),this.flags.promisifyAddTpa?Promise.reject(new Error(e+" exist already")):void 0;var a=this.tpaDefinition.templateIdByType(e);if(a&&this.$window.console.log("adding "+e+" with template id: "+a),i&&(t=t||this.getTpaPreset(i)),e===this.tpaTypes.Blog)return this.flags.promisifyAddTpa?this.addBlog(t,a,r):void this.addBlogOld(t,a,n,r);if(this.flags.membersArea&&e===this.tpaTypes.Members)return this.flags.promisifyAddTpa?this.addMembers().then(function(){return[]}):void this.addMembersOld(n);var s=function(i){if(t&&t.data&&t.data.style){var a=t.data.style;o.tpaTypes[e]||1!==o.themeChooser.coloration.getActiveKitColorationMode()||(a=o.createInvertedStyle(a,t));var s=o.documentServicesMediator.getComponentRef(i.sectionId);o._updateStyleOfComp(s,a)}var l=o.documentServicesMediator.getComponentRef(i.sectionId),c=o.getApplicationIdByCompRef(l),d=o.documentServicesMediator.getSectionsToAutoInstallWidgetData(c);if(e===o.tpaTypes.Blog2&&o.flags.postPage&&o.documentServicesMediator.getPagesData().find(function(e){return"post"===e.tpaPageId})){var u=o.getAppIdByType(e),p=o.documentServicesMediator.getDataByAppDefId(u);if(p&&p.widgets){var h=o.tpaDefinition.widgetIdByType(AdiCoreSanta.TpaWidgetTypes.Blog2_Post),g=p.widgets[h];g&&d.push(g)}}o._setTpaObj(r,i.page.id,i.sectionId),e===o.tpaTypes.Stores&&o._updateCartLayout(),o.duringAdditionOfTpa=!1,o.addingTpa&&(o.addingTpa.resolve(),o.addingTpa=void 0);var m=o.filterHiddenTpaPages(d);if(o.flags.promisifyAddTpa)return m;n(m)};this.flags.membersArea&&this.platformService.onTpaAdded();var l={sourceTemplateId:a,widgetId:void 0,callback:this.flags.promisifyAddTpa?void 0:s};if(this.duringAdditionOfTpa=!0,this.flags.promisifyAddTpa)return this.documentServicesMediator.addTpaSection(this._getAppId(e),l).then(s);this.documentServicesMediator.addTpaSection(this._getAppId(e),l)},e.prototype.addBlogOld=function(e,t,i,n){this.addBlog(e,t,n,i)},e.prototype.addBlog=function(e,t,i,n){var o=this,r=e&&e.data&&e.data.blogStructure||this.addBlogService.getBlogDefaults();if(this.documentServicesMediator.hasAddBlog()){if(this.flags.promisifyAddTpa)return this.documentServicesMediator.addBlog(t,this._getStripWithComponents(r.feed),this._getStripWithComponents(r.singlePost)).then(function(e){return o.documentServicesMediator.waitForChanges().then(function(){return e})}).then(function(e){var t=o.documentServicesMediator.getComponentRef(e),n=o.documentServicesMediator.getChildren(t),r=1===n.length&&n[0];return o._setTpaObj(i,e,void 0,r),[{appPage:{name:"Blog"}},{appPage:{name:"Single post"},widgetId:o.tpaTypes.Blog+"_Single_Post_Widget"}]});this.documentServicesMediator.addBlogOld(t,this._getStripWithComponents(r.feed),this._getStripWithComponents(r.singlePost),function(e){o.documentServicesMediator.waitForChanges().then(function(){var t=o.documentServicesMediator.getComponentRef(e),r=o.documentServicesMediator.getChildren(t),a=1===r.length&&r[0];n([{appPage:{name:"Blog"}},{appPage:{name:"Single post"},widgetId:o.tpaTypes.Blog+"_Single_Post_Widget"}]),o._setTpaObj(i,e,void 0,a)})})}else if(this.toasterService.info("waiting for blog API",!0),this.flags.promisifyAddTpa)return Promise.reject(new Error("waiting for blog API"))},e.prototype.addMembers=function(){return this.documentServicesMediator.addMembersArea()},e.prototype.addMembersOld=function(e){this.documentServicesMediator.addMembersArea().then(function(){e([])})},e.prototype.getTpaPreset=function(e){return this.tpaStyleService.getTpaPreset(e)},e.prototype.addTpaWidget=function(e,t,i,n,o,r){return n=n||this.getTpaPreset(o),this._addWidget(e,t,i,n,o,r)},e.prototype.removeTpaWidget=function(e,t){e&&t&&this.documentServicesMediator.removeComponent(t)},e.prototype.widgetAutoInstalledSection=function(e){var t=this.getApplicationIdByCompRef(e.widgetRef);return this.documentServicesMediator.getSectionsToAutoInstallWidgetData(t)},e.prototype.getNaiveType=function(e){return e?e.split("_")[0]:""},e.prototype.getNaiveTypeByPageId=function(e){if(!e)return null;var t=this.modelTree.getNodeById(e);return t&&this.getNaiveType(t.tpaExtraPage||t.tpaSection)},e.prototype.changeTpaTop=function(e,t){var i=this.tpaDefinition.tpaByType(e);i&&this._updateTpaTopLeft(i.comp,t)},e.prototype.getContainingStripRef=function(e){if(e.widgetRef){var t=this.documentServicesMediator.getContainer(e.widgetRef);if(/.StripContainer$/.test(this.documentServicesMediator.getComponentType(t)))return t;if(/\.components\.Column$/.test(this.documentServicesMediator.getComponentType(t)))return this.documentServicesMediator.getContainer(t)}return null},e.prototype.shouldRenderInStrip=function(e){return!(!e||!e.isTpaWidget)&&(!(e.widgetRef&&this.documentServicesMediator.doesComponentExistByRef(e.widgetRef))||this.getContainingStripRef(e))},e.prototype.hasShoppingCart=function(){return this.isTpaAdded("Stores")||(this.tpaDefinition.cartComp=void 0),!!this.tpaDefinition.cartComp},e.prototype.getShoppingCartId=function(){return this.isTpaAdded("Stores")||(this.tpaDefinition.cartComp&&(this.tpaDefinition.deletedCartComp=this.tpaDefinition.cartComp),this.tpaDefinition.cartComp=void 0),this.tpaDefinition.cartComp},e.prototype.getDeletedShoppingCartId=function(){return this.tpaDefinition.deletedCartComp},e.prototype.updateCartPosition=function(e,t,i,n){return!!this.tpaDefinition.cartComp&&(i&&this.documentServicesMediator.setContainer(this.tpaDefinition.cartComp,i),(e||t)&&this._updateTpaTopLeft(this.tpaDefinition.cartComp,e,t),n&&this.documentServicesMediator.setComponentStyleId(this.tpaDefinition.cartComp,n),this.documentServicesMediator.getLayout(this.tpaDefinition.cartComp).width!==this.tpaDefinition.cartLayout.width&&this.documentServicesMediator.updateLayout(this.tpaDefinition.cartComp,this.tpaDefinition.cartLayout),!0)},e.prototype.addBookingService=function(e,t){return this.bookingService.addService(this._getBookingsInstance(),e,t)},e.prototype.addBookingServices=function(e,t,i){return this.bookingService.addServices(this._getBookingsInstance(),e,t,i)},e.prototype.addBookingServicesNew=function(e,t,i){return this.bookingService.addServices(this._getBookingsInstance(),e,t,i)},e.prototype.deleteBookingsCategory=function(e){return this.bookingService.deleteCategory(this._getBookingsInstance(),e)},e.prototype.createBookingCategory=function(e,t){return this.bookingService.createCategory(this._getBookingsInstance(),e,t).then(function(e){return e.data.id})},e.prototype.createBookingCategoryNew=function(e){return this.bookingService.createCategory(this._getBookingsInstance(),e).then(function(e){return e.data.id})},e.prototype.getBookingBusiness=function(){return this.bookingService.getBusiness(this._getBookingsInstance())},e.prototype.wasBookingEverUpdated=function(){return a(this,void 0,void 0,function(){var e;return s(this,function(t){switch(t.label){case 0:return[4,this.bookingService.getSetup(this._getBookingsInstance())];case 1:return[2,(e=t.sent())&&e.data&&e.data.modifiedOffering]}})})},e.prototype.waitUntilBookingsIsReady=function(e,t){var i=this,n=this._getBookingsInstance();return n?(e=e||0,t=t||this.$p.defer(),this.bookingService.isAppReady(n).then(function(o){if(o.data.ready)t.resolve(!0);else{if(0===e)try{i.bookingService.wakeAppHack(n)}catch(e){i.$window.console.log("couldnt kick booking app e:"+e)}e<5?i.$timeout(function(){i.waitUntilBookingsIsReady(e+1,t)},2e3):t.resolve(!1)}}),t.promise):this.$p.when(!1)},e.prototype.refreshApp=function(e){return this._refreshApp(e)},e.prototype.setComp=function(e,t,i){this._setTpaObj(this.tpaDefinition.tpaByType(e),t,void 0,i),e===this.tpaTypes.Stores&&this._saveCartComp()},e.prototype.getCompRef=function(e){return this.tpaDefinition.tpaByType(e).comp},e.prototype.isCurrentPageIsBlog=function(e){return e=e&&e.id||this.documentServicesMediator.getCurrentPageId(),this.documentServicesMediator.isBlogPage(e)},e.prototype.updateIsCurrentPageBlogSinglePost=function(){var e=this.documentServicesMediator.getCurrentPageId();this._isCurrentPageBlogSinglePost=this.documentServicesMediator.isSinglePost(e)},e.prototype.isCurrentPageIsBlogSinglePost=function(e){return this.flags.stopExcessiveDSCalls&&!e&&void 0!==this._isCurrentPageBlogSinglePost?this._isCurrentPageBlogSinglePost:(e=e&&e.id||this.documentServicesMediator.getCurrentPageId(),this.documentServicesMediator.isSinglePost(e))},e.prototype.clearDeletedForBlogSinglePost=function(e,t){var i=this,n=this.documentServicesMediator.getChildren(e).filter(function(e){return t.indexOf(e.id)<0});if(n.filter(function(e){var t=i.documentServicesMediator.serializeComponent(e);return!i.isAppPartContainer(t)}).forEach(function(e){return i.documentServicesMediator.removeComponent(e)}),this.flags.fixDuplicatedBlogPosts){var o=n.filter(function(e){var t=i.documentServicesMediator.serializeComponent(e);return i.isAppPartContainer(t)});(o=o.slice(1,o.length)).forEach(function(e){return i.documentServicesMediator.removeComponent(e)})}},e.prototype.isAppPartContainer=function(e){var t=this;return e.componentType.indexOf(".AppPart")>0||e.components&&!!_.find(e.components,function(e){return t.isAppPartContainer(e)})},e.prototype.getBlogPageIds=function(){var e=this;return _.filter(this.documentServicesMediator.getPageIdList(),function(t){return e.isCurrentPageIsBlog(e.documentServicesMediator.getComponentRef(t))})},e.prototype.getBlogFeedHeight=function(e){var t=this._getBlogContainerRef();if(t){e&&(t=this.documentServicesMediator.getMobileComponent(t));var i=this.documentServicesMediator.serializeComponent(t);return i.components?this._getBottomChildEnd(i.components):i.layout.height}},e.prototype.getTypeByWidgetId=function(e,t){return this.tpaDefinition.widgetTypeById(e,t)},e.prototype.getTypeByAppId=function(e){var t=_.find(this.applicationParameters.tpaTypes,{appId:e});return t&&t.type},e.prototype.isTpaAdded=function(e){var t=this.tpaDefinition.tpaByType(e);return this._isTpaAdded(t)},e.prototype.getPageIdByTpaType=function(e){if(this.isTpaAdded(e))return this.tpaDefinition.tpaByType(e).page},e.prototype.getSectionsAdded=function(){return this.tpaDefinition.getSectionsBy(function(e){return e&&e.page})},e.prototype.deletePreset=function(e){this.tpaStyleService.deletePreset(e)},e.prototype.setPreset=function(e,t){this.tpaStyleService.setPreset(e,t)},e.prototype.getChosenPresetId=function(e){return this.tpaStyleService.getChosenPresetId(e)},e.prototype.updateStyle=function(e,t,i,n,o){void 0===o&&(o=!1),this._updateStyle(e,i,t,n,o)},e.prototype.getEditWidgetUrl=function(e){var t,i,n,o,r;if(this.getNaiveType(e.contentElementType)!==this.tpaTypes.Blog&&(e.isTpa?(t=this.getCompRef(e.contentElementType),o=this.getApplicationIdByCompRef(t),n=this.documentServicesMediator.getMainSectionWidgetDataFromApplicationId(o)):e.isTpaWidget&&(t=e.widgetRef,i=this.tpaDefinition.widgetIdByType(e.contentElementType),o=this.getApplicationIdByCompRef(t),r=this.getClientSpecByAppId(o),n=_.get(r,["widgets",i])),t&&n&&(i||e.isTpa))){var a=n.settings.onboardingUrl;if(!a)return;var s=-1!==a.indexOf("?")?"&":"?";return r=r||this.getClientSpecByAppId(o),a+=s+"origCompId="+t.id,a+="&locale="+this.applicationParameters.clientTopology.locale,a+="&compId=tpaSettings",a+="&endpointType=settings",a+="&instance="+r.instance,a+="&viewMode=editor",this.flags.debugProGallery&&"ProGallery_Widget"===e.contentElementType&&(a+=this.applicationParameters.tpaTypes.ProGallery.debugQueryParam),a}},e.prototype.setTpaTypeToTemplateIdMap=function(e){this.tpaDefinition.setTpaTypeToTemplateIdMap(e)},e.prototype.getTpaTypeToTemplateIdMap=function(){return this.tpaDefinition.getTpaTypeToTemplateIdMap()},e.prototype.getCompByTypeAndWidgetId=function(e,t,i){var n=i?this.getApplicationIdByCompRef(i):void 0;return this._getCompByTypeAndWidgetId(e,t,n)},e.prototype.sectionDeleted=function(e){e===this.tpaTypes.Stores&&this.tpaDefinition.cartComp&&(this.tpaDefinition.deletedCartComp=this.tpaDefinition.cartComp,this.tpaDefinition.cartComp=void 0)},e.prototype.setHeightOfPreset=function(e,t){this.tpaStyleService.setHeightOfPreset(e,t)},e.prototype.getHeightOfPreset=function(e){return this.tpaStyleService.getHeightOfPreset(e)},e.prototype.serializeToReAdd=function(e){e.serializedWidget=this.documentServicesMediator.serializeComponent(e.widgetRef)},e.prototype.restoreFromSerialized=function(e,t,i){t.serializedWidget&&t.widgetRef.id&&(this.$window.proGalleryToUse&&this.$window.proGalleryToUse[t.id]&&(t.widgetRef=this.$window.proGalleryToUse[t.id]),this._makeSureStyleIsValid(t,t.serializedWidget),this.documentServicesMediator.addComponent(e,t.serializedWidget,{compId:t.widgetRef.id}),this.documentServicesMediator.updateLayout(t.widgetRef,i))},e.prototype.cloneStyle=function(e,t){this.tpaStyleService.cloneStyle(e,t)},e.prototype.serialize=function(){return this.tpaStyleService.serialize()},e.prototype.deserialize=function(e){this.tpaStyleService.deserialize(e)},e.prototype.getAppId=function(e,t){void 0===t&&(t=!1);var i=this.getNaiveType(e.contentElementType);return e.isTpa||i===this.tpaTypes.Blog||t&&e.isTpaWidget?this._getAppIdForBI(i):e.isTpaWidget?this.tpaDefinition.widgetIdByType(e.contentElementType):""},e.prototype.getAppIdByType=function(e){return this._getAppIdForBI(e)},e.prototype.getAppIdByPageNode=function(e){return e.tpaSection?this._getAppIdForBI(e.tpaSection):""},e.prototype.getInstalledOnMasterPage=function(){var e=this;return this.documentServicesMediator.tpa.getMasterPageWidgets().map(function(t){var i=e.documentServicesMediator.getComponentRef(t.id),n=e.documentServicesMediator.getComponentData(i);return{widgetRef:i,widgetType:e.tpaDefinition.widgetTypeById(n.widgetId)}})},e.prototype.getInstanceId=function(e){if(!e)return null;var t,i=this.getNaiveType(e.contentElementType);if("Blog"===i)t=this.getBlogAppId();else{var n=e&&this.getCompRef(i)||e&&e.widgetRef;t=n&&this.getApplicationIdByCompRef(n)}var o=t&&this.getClientSpecByAppId(t);return o&&(o.instanceId||o.datastoreId)},e.prototype.sectionType=function(e){var t=this.applicationParameters.tpaTypes[e];return t?t.sectionType:null},e.prototype.getWidgetsHiddenSection=function(e){var t=e.getContentElementType(),i=this.getNaiveType(t),n=this.applicationParameters.tpaTypes[i],o=n&&"hidden"===n.sectionType;if(e.widgetRef&&o){var r=this.getApplicationIdByCompRef(e.widgetRef);return this.documentServicesMediator.getSectionsToAutoInstallWidgetData(r)}return null},e.prototype.ensureCanEnsurePages=function(){return this.duringAdditionOfTpa?(this.addingTpa=this.addingTpa||this.$p.defer(),this.addingTpa.promise):this.$p.when()},e.prototype.getApplicationId=function(e){var t=this.getNaiveType(e.contentElementType),i=this.getCompRef(t)||e&&e.widgetRef;return this.getApplicationIdByCompRef(i)},e.prototype.getTpaInstance=function(e){var t=this.getApplicationId(e);return t&&this.getClientSpecByAppId(t)},e.prototype.getAppDefId=function(e){var t=this.getTpaInstance(e);return t&&t.appDefinitionId},e.prototype.openManageForApp=function(e,t){var i=this.getClientSpecByAppId(e),n=i&&i.appDefinitionId,o=n&&this.getTypeByAppId(n);this.tpaManagerOpeners[o]&&this.tpaManagerOpeners[o](t)},e.prototype.isDynamicHeightComp=function(e){return this.tpaDefinition.isDynamicHeightComp(e)},e.prototype.findBlogStripInPage=function(e){var t=this,i=this.documentServicesMediator.getComponentRef(e);if(i){var n=this.documentServicesMediator.getChildren(i);return _.find(n,function(e){return t._compContainsBlog(e)})}},e.prototype.getSectionRefByPageId=function(e){return this.documentServicesMediator.getSectionRefByPageId(e)},e.prototype.getTpaPageId=function(e){if(this.flags.membersArea&&e.membersArea)return e.membersArea&&e.membersArea.tpaPageId;var t=e.tpaExtraPage||e.tpaSection;return t&&this.tpaDefinition.tpaPageIdByType(t)},e.prototype.createInvertedStyle=function(e,t){var i=this;return e=ob.deepClone(e),Object.keys(e.style.propertiesSource).filter(function(t){return"theme"===e.style.propertiesSource[t]}).filter(function(t){return e.style.properties[t].match(/^color_\d+$/)}).map(function(n){return{key:n,value:i.invertColor("{"+e.style.properties[n]+"}",n,t)}}).forEach(function(t){return e.style.properties[t.key]=t.value.substr(1,t.value.length-2)}),e},e.prototype._setTpaObj=function(e,t,i,n){e.page=t,e.compId=i,(n=n||this.documentServicesMediator.getComponentRef(e.compId))&&(e.comp=n)},e.prototype._isTpaAdded=function(e){if(e&&e.page){if(-1!==this.documentServicesMediator.getPageIdList().indexOf(e.page))return!0;delete e.page}},e.prototype._getAppId=function(e){var t=this.applicationParameters.tpaTypes[e];return this.flags.tpaQA&&t&&t.qaAppId?t.qaAppId:t&&t.appId},e.prototype._updateTpaTopLeft=function(e,t,i){if(e){var n={};"number"==typeof t&&(n.y=t),"number"==typeof i&&(n.x=i),this.documentServicesMediator.isComponentRendered(e)&&this.documentServicesMediator.updateLayout(e,n)}},e.prototype._saveCartComp=function(){if(this.tpaDefinition.cartComp=this._getCompByTypeAndWidgetId(this.tpaTypes.Stores,this.tpaDefinition.cartCompWidgetId),this.tpaDefinition.cartComp){var e=this.documentServicesMediator.getDesktopHeader(),t=this.documentServicesMediator.getContainer(this.tpaDefinition.cartComp);t&&t.id!==e.id&&this.documentServicesMediator.setContainer(this.tpaDefinition.cartComp,e)}},e.prototype._updateCartLayout=function(){this._saveCartComp(),this.documentServicesMediator.updateLayout(this.tpaDefinition.cartComp,this.tpaDefinition.cartLayout)},e.prototype._updateStyleOfComp=function(e,t){this.documentServicesMediator.setComponentStyle(e,t)},e.prototype._getStripWithComponents=function(e){var t=this._getStripDefinition();return t.components=e,t.layout.height=this._getBottomChildEnd(e),[t]},e.prototype._getStripDefinition=function(){return{type:"Container",skin:"wysiwyg.viewer.skins.stripContainer.DefaultStripContainer",layout:{width:1040,height:0,x:0,y:0,scale:1,rotationInDegrees:0,anchors:[],fixedPosition:!1},componentType:"wysiwyg.viewer.components.StripContainer",components:[],data:{type:"StripContainer"},style:"strc1",design:{type:"MediaContainerDesignData",background:{type:"BackgroundMedia",color:"{color_11}",colorOpacity:1,alignType:"center",fittingType:"fill",scrollType:"none",colorOverlay:"",colorOverlayOpacity:0}}}},e.prototype._getBottomChildEnd=function(e){return e.reduce(function(e,t){var i=t.layout;return Math.max(e,i.y+i.height)},0)},e.prototype._addAppPartWidget=function(e,t,i,n){var o=i&&i.data||this.addBlogService.getPostGalleryDefault(),r=this.getBlogAppId();if(!r)return this.toasterService.info("No blog ",!0),this.$p.when();o.compSerialization.data.appInnerID=r,o.compSerialization.layout=t;var a=this.documentServicesMediator.addComponent(e,o.compSerialization);return n.widgetRef=a,this.$p.when(a)},e.prototype._addWidget=function(e,t,i,n,o,r){var a=this;if(t=t||this.documentServicesMediator.getCurrentPage(),-1!==this.applicationParameters.appPartTypes.indexOf(e))return this._addAppPartWidget(t,i,n,o);var s=this.flags.tpaSource||this.tpaDefinition.templateIdByType(e,o);s||r||(s=this.tpaDefinition.defaultTemplateId[e]),s&&this.$window.console.log("adding "+e+" with template id: "+s);var l={sourceTemplateId:s,widgetId:this.tpaDefinition.widgetIdByType(e),showOnAllPages:!1},c=this.getNaiveType(e)===this.tpaTypes.ProGallery&&_.get(o,"widgetRef.id");c&&(l.optionalCustomId=c);var d=this._getAppId(e)||this._getAppId(this.getNaiveType(e));return o.widgetRef=this.documentServicesMediator.tpa.addWidget(t.id,d,l),i&&this.documentServicesMediator.updateLayout(o.widgetRef,i),n&&n.data&&n.data.style&&this._updateStyle(o,this.modelTree.canInvertTpa(o)&&1===this.themeChooser.coloration.getActiveKitColorationMode(),n),this.documentServicesMediator.waitForChanges().then(function(){if(r){var t=_.assign({type:e},r);a.$window.console.log("sending "+o.widgetRef.id+" data",t),a.documentServicesMediator.setTpaData(o.widgetRef,"OB_INTRO_DATA",t)}})},e.prototype._getBookingsInstance=function(){var e=this.documentServicesMediator.getDataByAppDefId(this._getAppId(this.tpaTypes.Bookings));return e&&e.instance},e.prototype._getCompByTypeAndWidgetId=function(e,t,i){if((e=this.getNaiveType(e))!==this.tpaTypes.Blog){i||(i=this.getApplicationIdByCompRef(this.getCompRef(e)));var n=this.documentServicesMediator.getAllCompsByApplicationId(i),o=_.find(n,{widgetId:t});return o?this.documentServicesMediator.getComponentRef(o.id):void 0}},e.prototype._getBlogContainerRef=function(){var e=this.getCompRef(this.tpaTypes.Blog);return e&&"wysiwyg.viewer.components.StripColumnsContainer"===this.documentServicesMediator.getComponentType(e)&&(e=this.documentServicesMediator.getChildren(e)[0]),e},e.prototype._adjustStyles=function(e,t){e===this.tpaTypes.ProGallery+"_Widget"&&(t.style.properties.param_boolean_isInAdi="true")},e.prototype._updateStyle=function(e,t,i,n,o){var r=this;void 0===o&&(o=!1);var a,s,l=this.$p.when(),c=(i=i||this.getTpaPreset(e))&&i.data,d=c&&c.data;if(s=c&&(c.style||c.blogStructure||c.compSerialization)){if(e.contentElementType===this.tpaTypes.Blog)this.documentServicesMediator.replaceBlogPages(s.feed,this._getStripWithComponents(s.singlePost),this._getBlogContainerRef());else if(c.isAppPart){var u=this.documentServicesMediator.getLayout(e.widgetRef),p=this.documentServicesMediator.getContainer(e.widgetRef);u.height=c.originalHeight||u.height;var h=e.widgetRef;l=this._addWidget(e.contentElementType,p,u,i,e).then(function(e){return r.documentServicesMediator.removeComponent(h),e})}else{t&&(s=this.createInvertedStyle(s,i));var g=e.contentElementType;this._adjustStyles(g,s),this._getAppId(g)?a=this.getCompRef(g):this.tpaDefinition.widgetIdByType(g)&&e.widgetRef&&(a=e.widgetRef),a||this.toasterService.info("trying to update tpa style but no comp",!0),d&&this.updateTpaData(d,e.contentElementType,a);var m=this.tpaStyleService.getPersistedStyles(e.contentElementType);if(Object.keys(m).length>0&&this.documentServicesMediator.isComponentRendered(a)){var f=this.documentServicesMediator.getStyleDefinitionByComp(a);Object.keys(m).map(function(e){return"param_"+m[e]+"_"+e}).filter(function(e){return void 0!==f.style.properties[e]}).forEach(function(e){return s.style.properties[e]=f.style.properties[e]})}this.flags.fixTpaFullWidth&&o||this._updateStyleOfComp(a,s)}e.contentElementType===this.tpaTypes.Bookings&&this.refreshApp(this.tpaTypes.Bookings),this.setPreset(i,e)}var v=e.widgetRef||this.getCompRef(e.contentElementType);e.dockToWidget&&(e.dockToWidget.fullWidth?this.documentServicesMediator.setDock(v,e.dockToWidget&&e.dockToWidget.margins||{left:{vw:0,px:0},right:{vw:0,px:0}}):this.documentServicesMediator.isDocked(v)&&this._undock(v,e)),n&&l.then(function(){r.documentServicesMediator.waitForChanges().then(n)})},e.prototype.updateTpaData=function(e,t,i){var n=this;_.forEach(e,function(e,o){n.isGetSubscribersWidgetType(t)&&e.signupForm&&(e.language=n.$translate.preferredLanguage()||e.language,e.signupForm=n.translateValues("subscribe",e.signupForm)),n.documentServicesMediator.setTpaData(i,o,e,void 0,function(){n.isGetSubscribersWidgetType(t)&&n.documentServicesMediator.updateTpaSettings(n.getApplicationIdByCompRef(i),i.id,e)})})},e.prototype.translateValues=function(e,t){var i=this;return _.keys(t).forEach(function(n){return t[n]="string"==typeof t[n]&&t[n].length?i.translateContent(e,i.getSubscribeTranslationKey(n,t[n])):t[n]}),t},e.prototype.getSubscribeTranslationKey=function(e,t){switch(e){case"buttonText":return"submit";case"subtitleText":return"stay up to date";case"titleText":return"subscribe";default:return t}},e.prototype.isGetSubscribersWidgetType=function(e){return e===this.tpaTypes.GetSubscribers+"_Widget"},e.prototype._undock=function(e,t){this.documentServicesMediator.setDock(e);var i,n=this.getAppId(t);try{i=this.tpaDefinition.widgetIdByType(t.contentElementType)||this.documentServicesMediator.getMainSectionWidgetDataFromApplicationId(this.getApplicationIdByCompRef(e)).widgetId||void 0}catch(e){}var o=this.documentServicesMediator.getDefaultLayout(n,i);this.documentServicesMediator.updateLayout(e,o)},e.prototype._addTpaManagementMessageHandlers=function(){var e=this;this.dashboardSdk.closeWindow=function(){_.each(e.tpaManagementIFrameCallbacks.closeWindow,function(e){return e()})}},e.prototype._refreshApp=function(e){if(e===this.tpaTypes.Blog)this.documentServicesMediator.reloadApp("blog");else{var t=this.documentServicesMediator.getDataByAppDefId(this._getAppId(e));if(t){var i=t.applicationId,n=this.documentServicesMediator.getRenderedReactCompsByApplication(i);this.documentServicesMediator.refreshApp(n)}}},e.prototype._getAppIdForBI=function(e){if(e===this.tpaTypes.Blog)return"61f33d50-3002-4882-ae86-d319c1a249ab";var t=this.applicationParameters.tpaTypes[e];return t&&t.appId||""},e.prototype._isBlogComp=function(e){var t=this.documentServicesMediator.getComponentData(e);return t&&"4de5abc5-6da2-4f97-acc3-94bb74285072"===t.appPartName},e.prototype._compContainsBlog=function(e){var t=this;return e&&(this._isBlogComp(e)||_.some(this.documentServicesMediator.getChildren(e),function(e){return t._compContainsBlog(e)}))},e.prototype._makeSureStyleIsValid=function(e,t){(t.style&&_.isString(t.style)&&!this.documentServicesMediator.getStyleDefinition(t.style)||!t.style)&&(delete t.style,this.getTpaPreset(e).data.style&&(t.style=this.getTpaPreset(e).data.style))},e.prototype.translateContent=function(e,t){var i=t.toLowerCase().replace(/['-]/g,"").replace(/\s/g,"-"),n="tpa."+e.toLowerCase()+"."+i,o=this.$translate.instant(n);return o===n?t:o},e}();angular.module("adiCoreAppInternal").service("tpaService",f);var v=function(){function e(e,t,i,n,o,r,a){var s=this;this.flags=e,this.documentServicesMediator=t,this.$p=i,this.$timeout=n,this.tpaService=o,this.modelTree=r,this.pagesManager=a,this.loadedTpas=[],this.promises=[],this.loaded="loaded",this.timeout="timeout",this.compLoaded=function(e){var t=e&&e.compPointer;if(t&&"MOBILE"===t.type){var i=t.id;s.loadedTpas.push(i),s.promises=_.reject(s.promises,function(e){if(s.removeComponentFromArray(e.comps,i),0===e.comps.length)return e.deferred.resolve(s.loaded),!0})}},this.resetLoadedComps=function(){s.loadedTpas=[]},this.flags.headlessApi&&this.documentServicesMediator.whenInitialized().then(function(){s.listening=s.documentServicesMediator.registerToCompLoadedEvent(s.compLoaded,s.resetLoadedComps)})}return e.$inject=["flags","documentServicesMediator","$p","$timeout","tpaService","modelTree","pagesManager"],e.prototype.removeComponentFromArray=function(e,t){var i=e.indexOf(t);-1!==i&&e.splice(i,1)},e.prototype.removeLoadedComps=function(e){var t=this;return _.filter(e,function(e){return 0!==t.loadedTpas.indexOf(e)})},e.prototype.resolveAfterTimeout=function(e){var t=this;this.$timeout(function(){var i=_.findIndex(t.promises,{deferred:e});-1!==i&&(t.promises.splice(i,1),e.resolve(t.timeout))},3500)},e.prototype.isBlogPage=function(e){return this.tpaService.getBlogPageIds().indexOf(this.pagesManager.getSantaPageIdByPageNodeId(e))>=0},e.prototype.promiseTimeout=function(e){var t=this.$p.defer();return this.$timeout(function(){t.resolve()},e||1e3),t.promise},e.prototype.waitForTpasToLoad=function(e){if(!this.listening)return this.$p.when(this.timeout);var t=this.pagesManager.getPageTpas(e);if(0===(t=this.removeLoadedComps(t)).length&&!this.isBlogPage(e))return this.$p.when(this.loaded);var i=this.$p.defer();return this.promises.push({deferred:i,comps:t}),this.resolveAfterTimeout(i),i.promise},e.prototype.waitForOtherComps=function(e){if(this.flags.headlessSnapshotWaitForContact||this.flags.headlessSnapshotWaitForContactFiveSec){var t=this.flags.headlessSnapshotWaitForContactFiveSec?5e3:1e3,i=this.modelTree.getPageNodeById(e);if(i)if((this.flags.lodash4?_.some:_[String("any")])(i.children,{contentElementType:"Contact"}))return this.promiseTimeout(t)}},e}();angular.module("adiCoreAppInternal").service("tpasLoadedService",v),angular.module("adiCoreAppInternal").factory("urlStateKeeper",["$rootScope","$location","$window","heightMutations","applicationParameters","designPolicyService","flags",function(e,t,i,n,o,r,a){function s(){var n={};function r(e,t){n[e]&&t(n[e])}_.each(t.search(),function(e,t){"true"!==e&&"false"!==e||(e="true"===e),n[t]=a[t]=e}),["$stateChangeSuccess","$stateChangeError"].forEach(function(i){e.$on(i,function(){angular.forEach(n,function(e,i){t.search(i,e)})})}),r("cropFacePadding",function(e){!isNaN(e)&&e<1&&(a.cropFacePadding=Number(e))}),r("cropTopMargin",function(e){!isNaN(e)&&e<1&&(a.cropTopMargin=Number(e))}),r("debug",function(){a.debugMode=e.debugMode=!0}),a.scaleFactor=1,r("scaleFactor",function(e){a.scaleFactor=e?+e:1;var t=a.lodash4?Math.min(2,a.scaleFactor):_.min([2,a.scaleFactor]);a.scaleFactor=a.lodash4?Math.max(t,.1):_.max([t,.1])}),a.extraWide=0,r("extraWide",function(e){a.extraWide=e||0}),r("debugSanta",function(e){!0===e&&(e="documentServices"),a.debugSanta=e}),r("autoCrop",function(e){e=Number.parseInt(e),a.autoCrop=Number.isNaN(e)?3:e}),r("e2e",function(){a.e2eMode=e.e2eMode=!0,i.onbeforeunload=null}),r("debugColorationMode",function(e){a.debugColorationMode=e||!1}),r("deepLink",function(e){a.deepLink=e}),r("baseline",function(e){o.quarterBaseLine=e||1}),r("onlyLe",function(e){o.onlyLe=e.split(",")}),r("noSpinners",function(){a.noSpinners=!0}),n.reimport&&(a.reimport=!0);var s=t.search();angular.element(i).on("hashchange",function(){var e=t.search();e.lang&&e.lang===s.lang&&!_.isEqual(e,s)&&i.location.reload()})}return s.prototype.getFlag=function(e){return t.search()[e]},new s}]),function(e){var t=function(){function t(e,t,i,n,o,r,a,s,l,c,d,u,p,h,g,m){this.$log=e,this.obMonitoring=t,this.visualValidationContainer=i,this.componentAttributesBuilder=n,this.visualValidationRenderer=o,this.themeChooser=r,this.$p=a,this.$window=s,this.mobileFonts=l,this.documentServicesMediator=c,this.$timeout=d,this.validationCache=p,this.richTextService=h,this.visualValidatorCreator=g,this.flags=m,this.validators={},this.styles={},this.masterButtonLayouts={height:10,left:0,top:0,type:AdiCoreSanta.ElementTypes.Button,width:520,subType:AdiCoreSanta.ElementSubTypes.Button},this.masterTextLayouts={componentClass:"wysiwyg.viewer.components.WRichText",height:51,left:0,skinClass:"wysiwyg.viewer.skins.WRichTextNewSkin",style:"txtNew",top:0,type:AdiCoreSanta.ElementTypes.Text,width:620},this.c100Validator={type:"container",div:angular.element("<div/>"),lineHeight:11,lineMargin:11,fontFamily:"Arial, Helvetica, sans-serif",fontSize:10,topMargin:1,key:{style:"c100",skin:"wysiwyg.viewer.skins.area.RectangleArea",caps:"",isMobile:!1}},u.onClearAllCaches(this.resetCache.bind(this)),u.resetCache=this.resetCache.bind(this),u.setUpCacheByKit=this.setUpCacheByKit.bind(this)}return t.$inject=["$log","obMonitoring","visualValidationContainer","componentAttributesBuilder","visualValidationRenderer","themeChooser","$p","$window","mobileFonts","documentServicesMediator","$timeout","storyServices","validationCache","richTextService","visualValidatorCreator","flags"],t.prototype.setProps=function(e,t){_.each(e,function(e,i){t.style[i]=e}),t.children.length&&this.setProps(e,t.children[0])},t.prototype.getComputedStyleCssText=function(e){var t=this.$window.getComputedStyle(e),i=t.cssText;if(i)return i;i="";for(var n=0;n<t.length;n++)i+=t[n]+": "+t.getPropertyValue(t[n])+"; ";return i},t.prototype.copyElement=function(e,t){var i=this,n=!1;e.parentNode||(n=!0,this.visualValidationContainer.$element.get(0).appendChild(e));var o=this.getComputedStyleCssText(e);t&&(o+=t);var r=this.$window.document.createElement(e.tagName);return angular.element(r).attr("style",o),_.each(e.children,function(e){r.appendChild(i.copyElement(e,t))}),n&&e.parentNode.removeChild(e),r},t.prototype.measure=function(e,t,i){var n=e.div,o=this.innerChild(n),r=angular.element(o);this.setProps(i,n),r.html(t),this.visualValidationContainer.$element.get(0).appendChild(n);var a=e.div.offsetHeight,s=Math.max(e.div.scrollWidth,e.div.offsetWidth),l=Math.ceil(a/e.lineHeight);return this.visualValidationContainer.$element.get(0).removeChild(n),r.html(""),{width:s,height:a,lines:l,lineHeight:e.lineHeight,lineMargin:e.lineMargin}},t.prototype.getStyleProps=function(e,t,i,n){var o;if(this.flags.textEditOnStage2){var r="font_"+e.font,a=(e.type===AdiCoreSanta.ElementTypes.Text||e.type===AdiCoreSanta.ElementTypes.Button)&&!!(t&&t.isMobile()||e.isMobile);o={font:e.font,fontSize:a?this.mobileFonts.getFontSize(r):e.fontSizeOverride||this.themeChooser.getFontSize(r),caps:n&&n.isCapsLock()||"",isMobile:a}}else{var s=this.componentAttributesBuilder.createAttributes(e,"",i,t);o={font:s.layout.font,style:s.styleId,skin:s.skin,caps:n&&n.isCapsLock()||"",isMobile:(e.type===AdiCoreSanta.ElementTypes.Text||e.type===AdiCoreSanta.ElementTypes.Button)&&!!(t&&t.isMobile()||e.isMobile)}}return o},t.prototype.getShapeSVG=function(e,t,i){var n=this;return i=i||0,this.visualValidationRenderer.buildComponentForValidation(e,[t]).then(function(o){return n.documentServicesMediator.waitForChanges().then(function(){var r,a=n.documentServicesMediator.getElementByCompRef(o),s=a&&a.getElementsByTagName("svg")[0],l=s&&s.getBoundingClientRect(),c=l&&l.width&&l.height;return c||i>=2?(c||n.$log.error("failed to measure shape "+JSON.stringify(t)),r={width:l&&l.width||60,height:l&&l.height||60,html:a.innerHTML}):r=n.$timeout(function(){return n.getShapeSVG(e,t,++i)},500),n.documentServicesMediator.removeComponent(o),r})})},t.prototype.shouldUseValidator=function(e){return e.type===AdiCoreSanta.ElementTypes.Text||e.type===AdiCoreSanta.ElementTypes.Button},t.prototype.getOrBuildValidator=function(e,t){var i=this;if(t&&!this.shouldUseValidator(e))return this.$p.when({lineHeight:0,lineMargin:0,topMargin:0});var n=t&&t.getFormatting(e,!0),o=t&&t.overrides,r=this.getStyleProps(e,t,o,n),a=this.getValidator(r);return a?this.$p.when(a):this.visualValidatorCreator.create([{layout:e,props:r}]).then(function(e){return a=e[0],i.registerValidator(a),i.$p.when(a)})},t.prototype.requiredValidators=function(){var e=this,t=this.themeChooser.getActiveFontTheme(),i=_.chain(t.kitFonts).map(function(e){if(e.font)return{type:AdiCoreSanta.ElementTypes.Text,font:e.font}}).filter()[this.flags.lodash4?"uniqBy":"uniq"](function(e){return _.map(e).join("|")}).value();return _.chain(i).map(function(t){var i;return _.map([!0,!1],function(n){return _.map([!1],function(o){var r=_.assign({font:t.font.replace("font_",""),isMobile:n},e.masterTextLayouts);return(i=e.getStyleProps(r,void 0,void 0,void 0)).caps=o,{layout:r,value:"x",props:i}})})}).flattenDeep().value()},t.prototype.createRequiredValidators=function(e){var t=this;return this.visualValidatorCreator.create(e).then(function(e){e.forEach(function(e,i){t.registerValidator(e)})})},t.prototype.setUpCacheByKit=function(t){var i=this,n={name:e.BIWizardServiceInitBSteps.SetUpVisualValidationCache,parent:e.BIWizardServiceInitBSteps.SetStyles,init:!0===t};this.obMonitoring.mark(n);var o=this.requiredValidators();return this.createRequiredValidators(o).then(function(){i.obMonitoring.measure(n)})},t.prototype.getThemeFonts=function(e,t){var i=this,n={};return _.allPromises(e||["0","1","2","3","4","5","6","7","8","9","10"],function(e){var o=_.assign({font:e,isMobile:t},i.masterTextLayouts),r="font_"+e;return i.getOrBuildValidator(o).then(function(e){return n[r]={fontSize:e.fontSize,lineHeight:e.lineHeight,lineMargin:e.lineMargin,topMargin:e.topMargin,css:e.css},!0})}).then(_.constant(n))},t.prototype.validate=function(e,t,i){var n=this,o=i.getLayoutValue(e,t);return this.getOrBuildValidator(e,i).then(function(r){var a=n.richTextService.isRichText(t)?n.richTextService.unMarkRichText(o):n.richTextService.transformForEditor(o,i.getFormatting(e,!0)),s={width:"auto",height:"auto"};e.type===AdiCoreSanta.ElementTypes.Button?(s.whiteSpace="nowrap",s.maxWidth="none",s.display="inline-block"):(s.display="block",s.whiteSpace="normal",s.maxWidth=e.width+"px",i.ignoreUglyRules()?s.wordWrap="break-word":s.wordWrap="normal");var l=n.measure(r,a,s);return e.type===AdiCoreSanta.ElementTypes.Button&&(l.lineMargin=15),l})},t.prototype.innerChild=function(e){for(;e.children.length&&"BR"!==_.last(e.children).nodeName;)e=_.last(e.children);return e},t.prototype.getValidator=function(e){return"c100"===e.style?this.c100Validator:this.validators[this.getValidatorKey(e)]},t.prototype.getValidatorKey=function(e){return this.flags.textEditOnStage2?this.makeClassName(e.font,e.fontSize,e.caps,void 0):this.makeClassName(e.font,void 0,e.caps,e.isMobile)},t.prototype.makeClassName=function(e,t,i,n){return this.flags.textEditOnStage2?"adi-text-validator-font-"+e+"-"+t+(i?"Caps":""):"adi"+(n?"-mobile":"")+"-text-validator-font-"+e+(i?"Caps":"")},t.prototype.setValidator=function(e,t){var i=this;_.each([!0,!1],function(n){var o=i.flags.textEditOnStage2?i.makeClassName(e.font,e.fontSize,n,void 0):i.makeClassName(e.font,void 0,n,e.isMobile);if(!i.validators[o]){var r=angular.element("<style></style>").attr("id",o),a=_.map(["p","h1","h2","h3","h4","h5","h6","li"],function(e){return"."+o+" "+e}).join(",\n"),s="font_"+e.font,l=i.themeChooser.getFontStyle(s),c=i.themeChooser.getLineHeight(s),d=i.getComputedStyleCssText(t.div)+";max-width:none;width:auto;height:auto;font:"+l+";font-size:"+t.fontSize+"px;line-height:"+c+";text-transform:"+(n?"uppercase":"none")+";";r.html("\n"+a+" {\n"+d+"word-wrap:inherit;\n}"),angular.element("head").append(r),i.styles[o]=r;var u=angular.element('<div class="adi-text-validator"></div>').addClass(o).attr("style",d);i.validators[o]=_.assign(_.clone(t),{div:u[0],css:d})}})},t.prototype.registerValidator=function(e){this.validators[e.name]=e,e.style&&(this.styles[e.name]=e.style,angular.element("head").append(e.style))},t.prototype.resetCache=function(){this.validators={},_.each(this.styles,function(e){e.remove()}),this.styles={},this.visualValidatorCreator.resetCache(),this.validationCache.resetCache()},t}();e.VisualValidation=t,angular.module("adiCoreAppInternal").service("visualValidation",t)}(S||(S={})),function(e){var t=function(){function e(e,t,i,n,o,r,a,s){this.$p=e,this.flags=t,this.fontLoader=i,this.$window=n,this.santaFontMetadata=o,this.themeChooser=r,this.mobileFonts=a,this.visualValidationContainer=s,this.baselineMargins={},this.cacheFontFamilyFull={}}return e.$inject=["$p","flags","fontLoader","$window","santaFontMetadata","themeChooser","mobileFonts","visualValidationContainer"],e.prototype.create=function(e){var t=this;return _.collectPromises(e,function(e){return t.createTextValidator(e.props)})},e.prototype.getFontFallback=function(e){var t=e.replace(/\+/g," ").toLowerCase(),i=this.santaFontMetadata[t];if(i){var n=i.fallbacks;return n&&(n+=","),n+=i.genericFamily}return""},e.prototype.getFullFontFamily=function(e){if(this.cacheFontFamilyFull[e])return this.cacheFontFamilyFull[e];var t=e,i=this.getFontFallback(e);return i&&(t=t+","+i),t=t.replace(/[^,]*[^\w,\d\-][^,]*/g,function(e){return"'"+e.replace(/\+/g," ")+"'"}),this.cacheFontFamilyFull[e]=t,t},e.prototype.extractFontFamilyFromFontStyle=function(e){return e&&e.split(" ").splice(4).join(" ")},e.prototype.getFontFamily=function(e){var t=this.themeChooser.getFontStyle(e).replace(/\+/g," "),i=this.extractFontFamilyFromFontStyle(t);return this.getFullFontFamily(i)},e.prototype.createTextValidator=function(e){var t,i=AdiCoreSanta.ElementTypes.Text,n="font_"+e.font,o=this.themeChooser.getFontStyle(n).replace(/\+/g," "),r=this.getFontFamily(n),a=this.themeChooser.getLineHeight(n),s=e.isMobile?this.mobileFonts.getFontSize(n):this.flags.textEditOnStage2?e.fontSize:this.themeChooser.getFontSize(o),l=this.flags.textEditOnStage2?"adi-text-validator-font-"+e.font+"-"+s+(e.caps?"Caps":""):"adi"+(e.isMobile?"-mobile":"")+"-text-validator-font-"+e.font+(e.caps?"Caps":"");t=r?"max-width:none;width:auto;text-rendering:initial;height:auto;font:"+o+";font-size:"+s+"px;font-family:"+r+";line-height:"+a+";text-transform:"+(e.caps?"uppercase":"none")+";":"max-width:none;width:auto;text-rendering:initial;height:auto;font:"+o+";font-size:"+s+"px;line-height:"+a+";text-transform:"+(e.caps?"uppercase":"none")+";";var c=angular.element('<div class="adi-text-validator"></div>').addClass(l).attr("style",t)[0],d=angular.element("<style></style>").attr("id",l),u=_.map(["p","h1","h2","h3","h4","h5","h6","li"],function(e){return"."+l+" "+e}).join(",\n");return d.html("\n"+u+" {\n"+t+"word-wrap:inherit;\n}"),this.measureValidator(t,i).then(function(n){return Object.assign({type:i,div:c,css:t,name:l,key:e,style:d},n)})},e.prototype.fixedLineHeight=function(e,t,i){var n=angular.element(e),o=angular.element(t);o.css("height","auto"),i===AdiCoreSanta.ElementTypes.Text&&o.css("display","block");var r=o.html(),a=n.parent();o.html("X");var s=o.height();return o.css("line-height",s+"px"),o.html(r),a.length?a.append(e):n.remove(),parseFloat(s)},e.prototype.measureBaselineMargin=function(e,t){var i=angular.element(t),n=i.css("font")||i[0].style.font;if(!this.baselineMargins[n]){var o=angular.element(e),r=o.css("height"),a=angular.element('<div class="font-baseline"></div>'),s=i.css("line-height");a.css("height",s),o.css("height",s);var l=angular.element("<span>T</span>")[0];a.append(l),i.append(a);var c=l.offsetTop+l.offsetHeight;a.append('<span class="fixer"></span>');var d=l.offsetTop+l.offsetHeight-c,u=e.offsetHeight-d,p=parseInt(i.css("font-size"),10);this.baselineMargins[n]={baselineMargin:u,fontFamily:i.css("font-family"),fontSize:p,topMargin:l.offsetHeight-p},o.css("height",r),a.remove()}return this.baselineMargins[n]},e.prototype.resetCache=function(){this.baselineMargins={}},e.prototype.measureValidator=function(e,t){var i=this,n=angular.element("<div></div>").attr("style",e);return this.$p.when().then(function(){i.visualValidationContainer.$element.append(n);var e=i.$window.getComputedStyle(n[0]).fontFamily.split(",").map(i.fontLoader.sanitizeFontFamily),t=e[0];return e=e.map(function(e){if(e)return i.fontLoader.loadFont(e,t)}),Promise.all(e)}).then(function(){var e=i.fixedLineHeight(n[0],n[0],t),o=i.measureBaselineMargin(n[0],n[0]);return n.remove(),{fontFamily:o.fontFamily,fontSize:o.fontSize,lineHeight:e,lineMargin:o.baselineMargin,topMargin:o.topMargin}})},e}();e.VisualValidatorCreator=t}(S||(S={})),angular.module("adiCoreAppInternal").service("visualValidatorCreator",S.VisualValidatorCreator),function(){"use strict";t.$inject=["$log","flags","clientTopology"];var e=window.wixmp;function t(t,i,n){var o={name:"Untitled",tags:["_imported"],mediaType:"picture"};function r(t){var r=i.MediaManager3||i.MediaManager3Migrate?new e.Source(e.sources.PRIVATE_SITE,{siteMediaToken:n.siteMediaToken}):new e.Source(e.sources.PRIVATE),a=_.assign({},o,t);return r.item.uploadByUrl(a)}function a(){throw t.error("wixMediaPlatformSDK not loading"),"wixMediaPlatformSDK not loading"}return{uploadPrivateImage:e?r:a,uploadPrivateImages:e?function(e){return _.map(e,r)}:a}}angular.module("adiCoreAppInternal").factory("wixMediaPlatform",t)}(),angular.module("adiCoreAppInternal").factory("colorThiefService",["mediaGallery","$p",function(e,t){var i={},n={},o="|";function r(e,t){var i=e.relativeUri;return"https://static.wixstatic.com/media/"+i+"/v1/fill/w_"+t.width+",h_"+t.height+"/"+i}function a(e,t,r,a){var s=function(e,t){return t?e+o+t.top+o+t.left+o+t.width+o+t.height:e+o+"full"}(e,a);if(!n[s]){var l=new ColorThief;if(!i[e]||!i[e].width)return;if(a){if(i[e].width<t){var c=i[e].width/t;a.width*=c,a.left*=c}if(i[e].height<r){var d=i[e].height/r;a.top*=d,a.height*=d}}var u=l.getPalette(i[e],5,void 0,a);n[s]=u&&u[0]||[255,255,255]}return n[s]}return{cacheImage:function(e,n){var o=r(n,e.getLayoutBySubType("image"));if(i[o])return i[o].then?i[o]:t.when();var a=t.defer(),s=new Image;return s.crossOrigin="anonymous",s.onload=function(){!function(e,t){i[e]=t}(o,s),a.resolve()},s.onerror=function(){a.resolve()},s.src=o+"?t="+(new Date).getTime(),i[o]=a.promise,a.promise},getColorOfImageBehindText:function(e,t,i){var n,o=t.getLayoutWithArgIndex(i.onMediaIndex),s=t.getLayoutParent(i);if(s)return function(e,t){return+e.getStripImageArgIndex()===t.argIndex}(t,o)||(n={top:s.top+i.top-o.top,left:s.left+i.left-o.left,width:i.width,height:i.height}),a(r(e,o),o.width,o.height,n)},getColorOfStripImage:function(e,t){return a(r(t,e.getLayoutBySubType("image")))},isColorDark:function(e){return(299*e[0]+587*e[1]+114*e[2])/1e3<128}}}]),function(e){var t=function(){function t(e,t,i,n,o,r,a,s,l,c,d,u,p,h,g){var m=this;this.previewService=e,this.wizardCallbacksService=t,this.documentServicesMediator=i,this.obMonitoring=n,this.storyServices=o,this.spinnerService=r,this.flags=a,this.modelSiteChanges=s,this.visualValidationRenderer=l,this.pagesManager=c,this.studioToolUserService=d,this.$p=u,this.modelTree=p,this.modelRenderGoToEditor=h,this.platformService=g,this.siteWasPublished=function(){return!m.previewService.isFirstSave()},this.saveStory=function(){return m.wizardCallbacksService.saveStory()}}return t.$inject=["previewService","wizardCallbacksService","documentServicesMediator","obMonitoring","storyServices","spinnerService","flags","modelSiteChanges","visualValidationRenderer","pagesManager","studioToolUserService","$p","modelTree","modelRenderGoToEditor","platformService"],t.prototype.dsPublish=function(){var e=this;return this.obMonitoring.mark({name:"dsPublish"}),this.documentServicesMediator.publish().then(function(){return e.obMonitoring.measure({name:"dsPublish"}),e.wizardCallbacksService.publishStory()})},t.prototype.onBeforePublish=function(){if(this.flags.membersArea){var t=this.modelTree.getGeneralInformation().getContentElement().values.Login.value;if(t.hasMembersArea){this.documentServicesMediator.setMembersSocialLoginVendorStatus(e.SignupVendors.google,!!t.enableGoogleLogin),this.documentServicesMediator.setMembersSocialLoginVendorStatus(e.SignupVendors.facebook,!!t.enableFacebookLogin),this.documentServicesMediator.setMembersLoginDialogFirst(!!t.isLoginFirst),this.flags.santaCompleteColorPalette||this.modelRenderGoToEditor.updateSantaColorPalette(),this.modelRenderGoToEditor.updateAllSantaStyles();for(var i=0,n=t.policies||[];i<n.length;i++){var o=n[i],r=(o.key!==e.MembersPolicies.codeOfConduct||this.platformService.hasSocialLayer())&&o.active&&o.link&&this.pagesManager.getSantaPageIdByPageNodeId(o.link);this.documentServicesMediator.setMembersSignupPoliciesFieldEnabled(o.key,!!r),r&&this.documentServicesMediator.setMembersSignupPoliciesPage(o.key,r)}}}},t.prototype.publishConsumerStory=function(){var e=this;return this.flags.debugMobilePerf&&console.time("publish"),this.spinnerService.waitForMe("publishConsumerStory"),this.publishStory().then(function(){return e.dsPublish()}).catch(function(e){throw e}).finally(function(){e.flags.debugMobilePerf&&console.timeEnd("publish"),e.spinnerService.imDone("publishConsumerStory")})},t.prototype.shouldRenderMobile=function(){return this.storyServices.story.mobileEditorActive},t.prototype.stopListeningToRenderChanges=function(){return this.modelSiteChanges.deactivate()},t.prototype.publishStory=function(e,t,i){var n,o=this;return this.storyServices.nodesRefMap={},i?n=this.$p.when():this.shouldRenderMobile()?(t&&this.stopListeningToRenderChanges(),n=this.storyServices.calculateAndRenderDesktopAndMobilePages("all",!!t,!0)):n=this.storyServices.calculateAndRenderAllPages(t),n.then(function(){return o.onBeforePublish()}).then(function(){o.flags.debugMobilePerf&&console.time("save");var t,i=!o.previewService.isFirstSave()&&o.previewService.getSiteId(),n=o.storyServices.getSavedSite();return n&&(t=n.siteId),(i||t)&&i!==t?o.$p.reject("Something's up with the site ids. Something bad."):(o.visualValidationRenderer.onBeforeSave(),i?o.rePublishStory():o.firstPublishStory(e))}).then(function(){return o.saveStory()}).then(function(){if(o.flags.debugMobilePerf&&console.timeEnd("save"),!o.flags.consumerMode&&t)return o.storyServices.reRender()})},t.prototype.firstPublishStory=function(e){var t=this.previewService.setSiteName(e);return t?this.$p.reject(t):this.flags.consumerMode?this.consumerFirstPublish():this.studioFirstPublish()},t.prototype.consumerFirstPublish=function(){var e=this;return this.dsSave().then(function(){var t=e.storyServices.story.getActiveLocale();t.savedSites=t.savedSites||{},t.savedSites[void 0]={nodesRefMap:e.storyServices.nodesRefMap,pagesMap:e.pagesManager.getNameToPageMap()},t.savedSites[void 0].siteId=e.previewService.getSiteId(),t.savedSites[void 0].metaSiteId=e.previewService.getMetaSiteId()})},t.prototype.studioFirstPublish=function(){var e=this;return this.studioToolUserService.getCurrentUser().then(function(t){return e.dsSave().then(function(){var i=e.storyServices.story.getActiveLocale();i.savedSites=i.savedSites||{},i.savedSites[t.id]={nodesRefMap:e.storyServices.nodesRefMap,pagesMap:e.pagesManager.getNameToPageMap()},i.savedSites[t.id].siteId=e.previewService.getSiteId(),i.savedSites[t.id].metaSiteId=e.previewService.getMetaSiteId()})})},t.prototype.rePublishStory=function(){return this.flags.consumerMode?this.consumerRePublishStory():this.studioRePublishStory()},t.prototype.consumerRePublishStory=function(){var e=this;return this.dsSave().then(function(){var t=e.storyServices.story.getActiveLocale();t.savedSites[void 0].nodesRefMap=e.storyServices.nodesRefMap,t.savedSites[void 0].pagesMap=e.pagesManager.getNameToPageMap()})},t.prototype.studioRePublishStory=function(){var e=this;return this.dsSave().then(function(){return e.studioToolUserService.getCurrentUser()}).then(function(t){var i=e.storyServices.story.getActiveLocale();i.savedSites[t.id].nodesRefMap=e.storyServices.nodesRefMap,i.savedSites[t.id].pagesMap=e.pagesManager.getNameToPageMap()})},t.prototype.dsSave=function(){var e=this;this.flags.consumerMode&&this.wizardCallbacksService.onDsSaveStart();var t=!this.shouldRenderMobile();this.obMonitoring.mark({name:"dsSave"});var i=this.documentServicesMediator.save(t);return i?i.then(function(){return e.obMonitoring.measure({name:"dsSave"})}).catch(function(t){return e.wizardCallbacksService.onDsSaveError(t)}):this.$p.when()},t}();angular.module("adiCoreAppInternal").service("publishApiService",t)}(S||(S={})),function(e){var t=function(){function t(e,t,i,n,o,r,a,s,l,c,d,u,p,h,g,m,f,v,y,b,S,C,w,T,I,x,P,M,L,k,$,A,E,D){var F=this;this.modelTree=e,this.menuService=t,this.$location=i,this.$p=n,this.$log=o,this.themeChooser=r,this.pagesManager=a,this.previewService=s,this.documentServicesMediator=l,this.layoutSolver=c,this.stories=d,this.TreeNode=h,this.ContentElement=g,this.layoutSelectionStoreProvider=m,this.defaultsService=f,this.storyServices=v,this.spinnerService=y,this.toasterService=b,this.siteLayoutLoader=S,this.studioToolUserService=C,this.designPolicies=w,this.designPolicyService=T,this.wizardCallbacksService=I,this.flags=x,this.applicationEvents=P,this.tpaService=M,this.richTextLinks=L,this.healthCheck=k,this.masterPageActions=$,this.obMonitoring=A,this.modelSiteChanges=E,this.publishApiService=D,this.activateWhenWelcomeEnds=!1,this.storyNameValidator=function(e){return F.previewService.isSiteNameValid(e)},this.siteWasPublished=function(){return F.publishApiService.siteWasPublished()},this.isFixedHeader=function(){return F.layoutSelectionStoreProvider.getLayoutSelectionStore().getFixedHeader()},this.saveStory=function(){return F.publishApiService.saveStory()},this.dsPublish=function(){return F.publishApiService.dsPublish()},this.registerWithSaveCustomeTheme=function(e){return F.wizardCallbacksService.saveCustomeTheme=e},this.initAfterWaitForChanges=function(e,t){return(F.flags.preloadMetadata?F.documentServicesMediator.whenInitialized():F.$p.resolve()).then(function(){return F.masterPageActions.syncFromSite()}).then(function(){return F.initStoryStyles(e).then(function(){if(!t)return F.flags.consumerMode?F.initNodeChanged():void F.storyServices.emitNodeChangedClearCache()}).then(function(){return F.spinnerService.imDone("wizard service",!0),e})})},this.initModelTree=function(e){if(F.modelTree.initFromStory(e),F.modelTree.traverse(function(e){e.layoutFilter=e.layoutFilter||F.layoutSelectionStoreProvider.getLayoutSelectionStore().nodeFilterFromNode(e)}),F.storyServices.routeSelectedPage&&(e.selectedPage=F.storyServices.routeSelectedPage),!F.modelTree.getPageNodeById(e.selectedPage)){var t=F.modelTree.getPagesNodes();e.selectedPage=t.length?t[0].getId():null}},this.initDesignPolicy=function(){var e=F.designPolicies.getAll();F.flags.designKit&&(F.layoutSelectionStoreProvider.getLayoutSelectionStore().designPolicy=F.layoutSelectionStoreProvider.getLayoutSelectionStore().designPolicy||{},F.layoutSelectionStoreProvider.getLayoutSelectionStore().designPolicy.id="linear");var t=F.layoutSelectionStoreProvider.getLayoutSelectionStore().designPolicy&&F.layoutSelectionStoreProvider.getLayoutSelectionStore().designPolicy.id;F.designPolicyService.designPolicy=_.find(e,{id:t})||_.first(e);var i=F.layoutSelectionStoreProvider.getLayoutSelectionStore().designPolicy;F.themeChooser.setDesignPolicy(i)},v.onChangingPage(I.changePageCB),v.onLocaleChanged(function(){e.switchLocale(),_.each(e.getPagesNodes(),function(e){return a.updatePageNameAndVisibility(e)})}),AdiCoreSanta.setBackendStory(u),AdiCoreSanta.setBackendStoryLocale(p),AdiCoreSanta.setWizardService(this)}return t.$inject=["modelTree","menuService","$location","$p","$log","themeChooser","pagesManager","previewService","documentServicesMediator","layoutSolver","stories","BackendStory","BackendStoryLocale","TreeNode","ContentElement","layoutSelectionStoreProvider","defaultsService","storyServices","spinnerService","toasterService","siteLayoutLoader","studioToolUserService","designPolicies","designPolicyService","wizardCallbacksService","flags","applicationEvents","tpaService","richTextLinks","healthCheck","masterPageActions","obMonitoring","modelSiteChanges","publishApiService"],t.prototype.loadLayouts=function(t){var i=this;return this.obMonitoring.mark({name:e.BIWizardServiceInitSteps.LoadLayouts,parent:e.BIWizardServiceInitSteps.Init,init:!0}),this.siteLayoutLoader.initialize(!1).then(function(){t.scenarioId=i.siteLayoutLoader.loadedScenarios.join(","),i.obMonitoring.measure({name:e.BIWizardServiceInitSteps.LoadLayouts,parent:e.BIWizardServiceInitSteps.Init,init:!0})})},t.prototype.downloadLayouts=function(){return this.siteLayoutLoader.downloadLayouts()},t.prototype.initStoryStyles=function(t){var i=this;return this.obMonitoring.mark({name:e.BIWizardServiceInitBSteps.SetStyles,parent:e.BIWizardServiceInitBSteps.Init,init:!0}),this.themeChooser.setStoryStyles(t).then(function(){return i.obMonitoring.measure({name:e.BIWizardServiceInitBSteps.SetStyles,parent:e.BIWizardServiceInitBSteps.Init,init:!0}),i.documentServicesMediator.siteChanges.flush()})},t.prototype.initNodeChanged=function(){var t,i,n=this;if(this.obMonitoring.mark({name:e.BIWizardServiceInitBSteps.NodeChanged,parent:e.BIWizardServiceInitBSteps.Init,init:!0}),this.flags.perfDontWaiteForDSLoadedToCalcSolution)this.flags.perfDontWaitForRenderInInit&&!this.flags.headlessApi?(this.flags.perfRenderInPostInit||(i=this.storyServices.reRender()),t=this.$p.when()):t=this.flags.perfRenderInPostInit?this.$p.when():this.storyServices.reRender();else if(!this.flags.perfDontWaitForRenderInInit||this.flags.headlessApi||this.flags.perfRenderInPostInit)t=this.flags.perfRenderInPostInit&&!this.flags.headlessApi?this.layoutSolver.performAction():this.layoutSolver.onNodeChanged();else{var o;t=new Promise(function(e){o=e}),i=this.layoutSolver.onNodeChanged(null,null,null,null,o)}return t.then(function(){if(n.obMonitoring.measure({name:e.BIWizardServiceInitBSteps.NodeChanged,parent:e.BIWizardServiceInitBSteps.Init,init:!0}),n.previewService.isPreview)return n.obMonitoring.mark({name:e.BIWizardServiceInitBSteps.PreviewCalcAllPages,parent:e.BIWizardServiceInitBSteps.Init,init:!0}),n.getRenderPromise(i).then(function(){return n.storyServices.calculateAndRenderAllPages(!1)}).then(function(){n.obMonitoring.measure({name:e.BIWizardServiceInitBSteps.PreviewCalcAllPages,parent:e.BIWizardServiceInitBSteps.Init,init:!0})})})},t.prototype.getRenderPromise=function(e){return this.flags.perfRenderInPostInit?this.layoutSolver.reRenderPage():e||this.$p.when()},t.prototype.calculateSolution=function(t){var i=this;return this.obMonitoring.mark({name:e.BIWizardServiceInitSteps.CalculateSolution,parent:e.BIWizardServiceInitSteps.Init,init:!0}),this.themeChooser.setStaticStoryStyles(t).then(function(){return i.storyServices.recalculateCurrentPage(!0,!0)}).then(function(){return i.layoutSolver.calculateFooter()}).then(function(){i.obMonitoring.measure({name:e.BIWizardServiceInitSteps.CalculateSolution,parent:e.BIWizardServiceInitSteps.Init,init:!0})})},t.prototype.init=function(e,t,i){return this.spinnerService.waitForMe("wizard service",!0),this.flags.consumerMode?this.consumerInit(e,t):this.studioInit(e,t)},t.prototype.preSolutionInit=function(e,t){var i=this,n=e.then(function(e){return i.initThemeChooser()});return this.$p.all([this.loadLayouts(t),n,this.initLayoutSolver()])},t.prototype.consumerInit=function(e,t){var i,n=this,o=this.loadStory(t,e),r=o.then(function(e){return n.loadPreview(e)}),a=this.preSolutionInit(o,e);return this.flags.perfDontWaiteForDSLoadedToCalcSolution&&(i=a.then(function(){return n.calculateSolution(e)})),this.$p.all([r,a]).then(function(){return n.initBackwardCompatibility()}).then(function(){return n.documentServicesMediator.whenInitialized()}).then(function(){return n.initChangeStory()}).then(function(){return n.flags.perfDontWaiteForDSLoadedToCalcSolution?n.$p.all([n.initHeader(),i]):n.initHeader()}).then(function(){return n.storyServices.story})},t.prototype.studioInit=function(e,t,i){var n=this,o=this.flags.consumerMode?this.$p.when(e):this.stories.get(e),r=o.then(function(e){return n.loadLayouts(e)}),a=o.then(function(e){return n.loadStory(t,e)}),s=a.then(function(e){return n.healthCheck.validateAndSave()}),l=a.then(function(e){return n.loadPreview(e)}),c=a.then(function(e){return n.initThemeChooser()}),d=this.initLayoutSolver(),u=this.themeChooser.loadCustomTheme(e);return this.$p.all([o,r,s,l,c,u,d]).then(function(){return n.initBackwardCompatibility()}).then(function(){return n.documentServicesMediator.whenInitialized()}).then(function(){return n.initChangeStory()}).then(function(){return n.initHeader()}).then(function(){return n.storyServices.story})},t.prototype.initForStudio=function(e,t){var i=this;return this.init(e,t).then(function(e){return i.initAfterWaitForChanges(e,!1)}).then(function(e){return i.listenToRenderChanges(),e})},t.prototype.reloadStory=function(){var e=this.storyServices.story.id,t=this.storyServices.story.activeLocale;return this.init(e,t)},t.prototype.initChangeStory=function(){var t=this;return this.obMonitoring.mark({name:e.BIWizardServiceInitSteps.ChangeStory,parent:e.BIWizardServiceInitSteps.Init,init:!0}),this.pagesManager.changeStory().then(function(){t.obMonitoring.measure({name:e.BIWizardServiceInitSteps.ChangeStory,parent:e.BIWizardServiceInitSteps.Init,init:!0}),t.menuService.initialize()})},t.prototype.initLayoutSolver=function(){var t=this;return this.obMonitoring.mark({name:e.BIWizardServiceInitSteps.InitLayoutSolver,parent:e.BIWizardServiceInitSteps.Init,init:!0}),this.layoutSolver.initialize().then(function(){return t.obMonitoring.measure({name:e.BIWizardServiceInitSteps.InitLayoutSolver,parent:e.BIWizardServiceInitSteps.Init,init:!0})})},t.prototype.initThemeChooser=function(){var t=this;return this.obMonitoring.mark({name:e.BIWizardServiceInitSteps.InitThemeChooser,parent:e.BIWizardServiceInitSteps.Init,init:!0}),this.themeChooser.initialize().then(function(){t.obMonitoring.measure({name:e.BIWizardServiceInitSteps.InitThemeChooser,parent:e.BIWizardServiceInitSteps.Init,init:!0})})},t.prototype.initBackwardCompatibility=function(){var t=this;return this.obMonitoring.mark({name:e.BIWizardServiceInitSteps.BackwardCompatibility,parent:e.BIWizardServiceInitSteps.Init,init:!0}),this.backwardCompatibility().then(function(){t.obMonitoring.measure({name:e.BIWizardServiceInitSteps.BackwardCompatibility,parent:e.BIWizardServiceInitSteps.Init,init:!0})})},t.prototype.loadNewSantaIframe=function(){var e=this;return this.spinnerService.waitForMe("reloadSantaIframe"),this.init(this.storyServices.story).then(function(){e.spinnerService.imDone("reloadSantaIframe")}).catch(function(e){console.log(e)})},t.prototype.reloadSantaIframe=function(){var e=this;return this.spinnerService.waitForMe("reloadSantaIframe"),this.loadPreview(this.storyServices.story,!0).then(function(){return e.layoutSolver.onNodeChanged().then(function(){e.spinnerService.imDone("reloadSantaIframe")})})},t.prototype.loadPreview=function(e,t){return void 0===t&&(t=!1),this.flags.consumerMode?this.consumerLoadPreview(e,t):this.studioLoadPreview(e,t)},t.prototype.consumerLoadPreview=function(e,t){var i=this;void 0===t&&(t=!1);var n=e.getActiveLocale().savedSites,o=n&&n[void 0],r=o&&o.siteId,a=o&&o.metaSiteId;return a?this.loadStoryUrl(r,a,t).catch(function(){return delete n[void 0],i.loadStoryUrl()}):this.loadStoryUrl()},t.prototype.studioLoadPreview=function(e,t){var i=this;return void 0===t&&(t=!1),this.studioToolUserService.getCurrentUser().then(function(n){var o=e.getActiveLocale().savedSites,r=n.id,a=o&&o[r],s=a&&a.siteId,l=a&&a.metaSiteId;return l?i.wizardCallbacksService.getMetaSiteDetails(l).then(function(){return i.loadStoryUrl(s,l,t)}).catch(function(){return delete o[r],i.loadStoryUrl()}):i.loadStoryUrl()})},t.prototype.loadStoryUrl=function(t,i,n){var o=this;if(this.flags.loadPreviewAsap&&!n){var r=this.previewService.getLoadStoryPromise(t,i);if(r)return r}return this.obMonitoring.mark({name:e.BIWizardServiceInitSteps.LoadPreview,parent:e.BIWizardServiceInitSteps.Init,init:!0}),this.previewService.loadStoryUrl(t,i,n).then(function(){o.obMonitoring.measure({name:e.BIWizardServiceInitSteps.LoadPreview,parent:e.BIWizardServiceInitSteps.Init,init:!0}),o.flags.loadPreviewAsap&&o.storyServices.getIsStoryAvailablePromise().then(function(){"thin"===_.get(o.storyServices,"story.locale.renderedModel.model.header.mode")&&o.spinnerService.imDone("dynamicSpinner")})})},t.prototype.loadStory=function(e,t){var i=this;return this.storyServices.story=t,this.flags.loadPreviewAsap?(this.defaultsService.init(this.storyServices.story.vertical,this.storyServices.story.subVertical),this.stories.loadStoryLocales(t).then(function(){return e&&(t.activeLocale=e),i.layoutSelectionStoreProvider.getLayoutSelectionStore().deserialize(t.getActiveLocale().layoutSelections),i.initModelTree(t),i.storyServices.resolveIsStoryAvailablePromise(),t.mainMenu?i.menuService.deserialize(t.mainMenu):i.menuService.reset(),i.richTextLinks.setData(t.richTextLinks||{}),i.initDesignPolicy(),t})):(this.defaultsService.init(this.storyServices.story.vertical,this.storyServices.story.subVertical),this.stories.loadStoryLocales(t).then(function(){e&&(t.activeLocale=e),i.layoutSelectionStoreProvider.getLayoutSelectionStore().deserialize(t.getActiveLocale().layoutSelections),i.initModelTree(t),t.mainMenu?i.menuService.deserialize(t.mainMenu):i.menuService.reset(),i.richTextLinks.setData(t.richTextLinks||{}),i.initDesignPolicy()}).then(_.constant(t)))},t.prototype.saveStoryWithVisualEffects=function(){var e=this;this.spinnerService.waitForMe("saveStory"),this.saveStory().then(function(){e.toasterService.info("Saved",!0),e.spinnerService.imDone("saveStory")},function(){e.toasterService.error("Error saving story",!0),e.spinnerService.imDone("saveStory")})},t.prototype.publishConsumerStory=function(){return this.publishApiService.publishConsumerStory()},t.prototype.publishStory=function(e,t,i){return this.publishApiService.publishStory(e,t,i)},t.prototype.firstPublishStory=function(e){return this.publishApiService.firstPublishStory(e)},t.prototype.rePublishStory=function(){return this.publishApiService.rePublishStory()},t.prototype.dsSave=function(){return this.publishApiService.dsSave()},t.prototype.shouldRenderMobile=function(){return this.storyServices.story.mobileEditorActive},t.prototype.setActiveLocale=function(e){var t=this,i=this.storyServices.story;i.storyLocales[e].id&&(this.spinnerService.forceStart(),i.getActiveLocale().layoutSelections=this.layoutSelectionStoreProvider.getLayoutSelectionStore().serialize(),i.getActiveLocale().save().then(function(){t.toasterService.info("Locale "+i.activeLocale+" has been saved",!0),t.$location.search("lang",e),i.activeLocale=e,t.layoutSelectionStoreProvider.getLayoutSelectionStore().deserialize(i.getActiveLocale().layoutSelections),t.themeChooser.setThemeByID({font:i.getActiveLocale().styles.themeFonts}),t.storyServices.emitLocaleChanged()}))},t.prototype.onReferenceFieldChanged=function(e,t,i,n){var o=this,r=[];if(i||n){var a=i?angular.equals(e.getVisibleFieldsKeys(),[t]):!e.hasVisibleFields();this.modelTree.updateReferenceFieldsVisibility(e,t,i),r=this.modelTree.updateNodeVisibility(e,void 0,a)}var s=t.split("."),l=s[0],c=s[1];if(this.modelTree.traverse(function(i,n){i!==e&&"contentElement"===i.getNodeType()&&("GeneralDescription"===i.getContentElementType()||n.isPage()||n.isFooter())&&i.contentElement.getReferenceFields()[t]&&o.modelTree.updateReferenceFieldsVisibility(i,t),"contentElement"===i.getNodeType()&&(n.isPage()||n.isFooter())&&i.getContentElementType()===l&&o.modelTree.updateFieldsVisibility(i,n,c)}),r&&r.length)this.storyServices.emitNodeChanged(e,r,"userHidden");else{if(this.flags.consumerMode)return this.layoutSolver.handleValueChange(e.getContentElement(),"reference",!0,!1,l);this.storyServices.emitReferenceFieldChanged(e)}return this.$p.when()},t.prototype.onFieldChanged=function(e,t,i,n,o,r){var a=this;this.onInnerFieldChanged(e,t,i,n,o,r,function(e,t,i,n,o,r){switch(e){case a.applicationEvents.nodeChanged:a.storyServices.emitNodeChanged(t,i,"userHidden");break;case a.applicationEvents.blurChanged:a.storyServices.emitBlurChanged(t.getContentElement(),n,o);break;case a.applicationEvents.valueChanged:a.storyServices.emitValueChanged(t.getContentElement(),n,o,r)}return a.$p.when()})},t.prototype.onSynchronousFieldChanged=function(e,t,i,n,o,r){var a=this;return this.onInnerFieldChanged(e,t,i,n,o,r,function(e,t,i,n,o,r){switch(e){case a.applicationEvents.nodeChanged:return a.$log.error("we should never get here!!! (onSynchronousFieldChanged with nodeChanged)"),a.layoutSolver.onNodeChanged(null,t,i,"userHidden");case a.applicationEvents.blurChanged:return a.layoutSolver.handleValueChange(t.getContentElement(),n,o,!0);case a.applicationEvents.valueChanged:return o?a.layoutSolver.handleMaskChange(t.getContentElement(),n):a.layoutSolver.handleValueChange(t.getContentElement(),n,!1,r)}})},t.prototype.onInnerFieldChanged=function(e,t,i,n,o,r,a){var s=this,l=[],c=e.getArgsMatchingPolicy()[t];if(n||o||r){var d=r&&(o||r.type===AdiCoreSanta.ElementTypes.Media)&&e.getContentElement().isEmptyField(r),u=n?angular.equals(e.getVisibleFieldsKeys(),[t]):!e.hasVisibleFields();this.modelTree.updateFieldsVisibility(e,i,t,n,d),l=this.modelTree.updateNodeVisibility(e,i,u)}var p=e.getArgsMatchingPolicy()[t];if(n=n||c!==p,this.modelTree.updateLayoutFilter(e,i,t)&&(l=i&&i.isList()?i.children:[e]),this.modelTree.isReferenceField(e.getContentElementType(),t)){var h=e.getContentElementType()+"."+t;this.modelTree.traverse(function(t,i){t!==e&&"contentElement"===t.getNodeType()&&("GeneralDescription"===t.getContentElementType()||i.isPage()||i.isFooter())&&t.contentElement.getReferenceFields()[h]&&s.modelTree.updateReferenceFieldsVisibility(t,h)})}if(n&&!p){var g=e.getContentElement().getDependencies();_.each(g,function(i){if(i!==e&&("GeneralDescription"===i.getContentElementType()||i.containerPageId)){var n=i.isListItem?s.modelTree.findIdentifyingNode(i):void 0;s.modelTree.updateFieldsVisibility(i,n,t),s.modelTree.updateNodeVisibility(i,n)}})}return l&&l.length?a(this.applicationEvents.nodeChanged,e||i,l).then(function(){if(e.getContentElement()&&e.getContentElement().isGateField(t))return s.onGateFieldChanged(e,t,i,a)}):e.getContentElement()&&e.getContentElement().isGateField(t)?this.onGateFieldChanged(e,t,i,a):o?a(this.applicationEvents.blurChanged,e,null,t,n).then(function(){if(e.getContentElement()&&e.getContentElement().isDependentField(t)&&n)return s.onGateDependentMaskChanged(e,e.getContentElement().values[t].dependent,a)}):n||e.getArgsMatchingPolicy()[t]?a(this.applicationEvents.valueChanged,e,null,t,n,o).then(function(){if(e.getContentElement()&&e.getContentElement().isDependentField(t)&&n)return s.onGateDependentMaskChanged(e,e.getContentElement().values[t].dependent,a)}):this.$p.when()},t.prototype.onGateDependentMaskChanged=function(e,t,i){var n=e.getContentElement().values[t].dependencies;return 0===_.filter(e.getArgsMatchingPolicy(),function(e,t){return n.indexOf(t)>-1&&e}).length?(e.getArgsMatchingPolicy()[t]=!1,this.onInnerFieldChanged(e,t,e,!0,!1,null,i)):this.$p.when()},t.prototype.onGateFieldChanged=function(e,t,i,n){var o=this,r=e.getContentElement(),a=[];return angular.forEach(r.getFieldValue(t).dependencies,function(r){e.getArgsMatchingPolicy()[r]!==e.getArgsMatchingPolicy()[t]&&(e.getArgsMatchingPolicy()[r]=e.getArgsMatchingPolicy()[t],a.push(o.onInnerFieldChanged(e,r,i,!0,!1,null,n)))}),a.length>0?this.$p.all(a):this.$p.when()},t.prototype.getLayoutFeaturesForNode=function(e){var t=[];e.asymmetric&&t.push("columnsPhase2");var i=this.pagesManager.getCurrentPageName(),n=this.getSegmentByNode(e,i).getLENoError().getColumns();return(n=n&&n[0])&&n.length>1&&(t.push("columns"),n[0].isVirtual&&t.push("virtualColumns")),t},t.prototype.getSegmentByNode=function(e,t){var i;if("header"===t){var n=this.layoutSolver.getSelectedSolution("header");i=n&&n[0].segments[0]||void 0}else{var o="footer"===t?"footer":"body";_.find(this.layoutSolver.getSelectedSolution(o,t),function(t){return _.find(t.segments,function(t){if(""+t.node.id==""+e.id)return i=t,!0})})}return i},t.prototype.initHeader=function(){this.flags.mergedHeader&&this.documentServicesMediator.moveHeaderToFront(),this.setFixedHeader()},t.prototype.setFixedHeader=function(e){void 0===e?e=this.isFixedHeader():this.layoutSelectionStoreProvider.getLayoutSelectionStore().setFixedHeader(e),this.previewService.setFixedHeader(e)},t.prototype.backwardCompatibility=function(){var e=this,t=this.$p.when();if(this.flags.consumerMode){var i=this.modelTree.getPagesNodes(),n=_.find(i,{tpaSection:"Blog"});if(n){var o=this.storyServices.getSavedSite().pagesMap,r=o[n.id];if(r&&!this.tpaService.findBlogStripInPage(r)){var a=_.find(i,{tpaExtraPage:"Blog_Single_Post_Widget"}),s=o[a.id];if(this.documentServicesMediator.getHomePage()===r){var l=_.filter(this.documentServicesMediator.getPageIdList(),function(e){return e!==r&&e!==s});if(0===l.length){var c=this.documentServicesMediator.addPage("blank");l.push(c.id),t=this.documentServicesMediator.waitForChanges()}t=t.then(function(){var t=l[0];return e.documentServicesMediator.setHomePage(t),e.documentServicesMediator.navigateToPage(t)}).then(function(){return e.documentServicesMediator.waitForChanges()})}t=t.then(function(){return _.each(e.documentServicesMediator.getPageIdList(),function(t){e.documentServicesMediator.updatePage(t,{pageUriSEO:""})}),e.documentServicesMediator.doesPageExist(r)&&e.documentServicesMediator.removePage(r),delete o[n.id],e.documentServicesMediator.doesPageExist(s)&&e.documentServicesMediator.removePage(s),delete o[a.id],e.documentServicesMediator.waitForChanges()})}}}return t},t.prototype.listenToRenderChanges=function(){return this.modelSiteChanges.activate()},t.prototype.stopListeningToRenderChanges=function(){return this.modelSiteChanges.deactivate()},t.prototype.paasInit=function(e,t){var i=this,n=this.loadStory(t,e);return this.preSolutionInit(n,e).then(function(){return i.themeChooser.setStaticStoryStyles(e)}).then(function(){var e=i.modelTree.getAllVisibleContentElements();return i.layoutSolver.createHeaderSolutions(e)}).then(function(){return i.layoutSolver.createFooterSolutions()}).then(function(){return i.storyServices.story})},t}();angular.module("adiCoreAppInternal").service("wizardService",t)}(S||(S={})),angular.module("adiCoreAppInternal").provider("BackendUser",function(){var e;this.setFirebaseConfig=function(t){e=t},this.$get=["$q","$window",function(t,i){return e&&i.firebase.initializeApp(e),{find:function(n){return"me"===n&&e?t.when(i.firebase.auth().setPersistence(i.firebase.auth.Auth.Persistence.LOCAL)).then(function(){return i.firebase.auth().getRedirectResult().catch(function(e){throw new Error("unauthorized: "+e.message)})}).then(function(){var e=i.firebase.auth().currentUser;if(null===e){var t=new i.firebase.auth.GoogleAuthProvider;throw t.setCustomParameters({prompt:"select_account"}),i.firebase.auth().signInWithRedirect(t),new Error("redirecting to sign in page...")}return{id:e.email}}):t.when(null)}}}]}).factory("studioToolUserService",["$q","BackendUser","flags",function(e,t,i){return{getCurrentUser:function(){return i.consumerMode?e.when({}):t.find("me")}}}]),function(e){var t=function(){function e(){this.getTimestamp="object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()}}return e.prototype.reset=function(e){void 0===e&&(e=null),this.startBITimestamp=e||this.getTimestamp(),this.prevLoadTimestamp=this.startBITimestamp},Object.defineProperty(e.prototype,"sample",{get:function(){var e=this.getTimestamp(),t=void 0===this.prevLoadTimestamp?-1:Math.round(e-this.prevLoadTimestamp);return this.prevLoadTimestamp=e,t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"total",{get:function(){return void 0===this.startBITimestamp?-1:Math.round(this.getTimestamp()-this.startBITimestamp)},enumerable:!0,configurable:!0}),e}();e.InitStopwatch=t,angular.module("adiCoreAppInternal").service("initStopwatch",t)}(S||(S={})),function(e){var t=function(){function e(){}return e.CalculateSolution="calculate solution",e.Init="init wizard service",e.LoadLayouts="load layouts",e.LoadPreview="load preview",e.InitThemeChooser="init theme chooser",e.InitLayoutSolver="init layout solver",e.BackwardCompatibility="backward compatibility",e.ChangeStory="change story",e.HealthCheck="health check",e}();e.BIWizardServiceInitSteps=t;var i=function(){function e(){}return e.Init="init core B",e.SetStyles="set styles",e.NodeChanged="node changed",e.PreviewCalcAllPages="preview calc all pages",e.SetUpVisualValidationCache="setUpCacheByKit",e}();e.BIWizardServiceInitBSteps=i;var n=function(){function e(){AdiCoreSanta.setObMonitoring(this)}return e.prototype.warning=function(e,t){},e.prototype.error=function(e,t){},e.prototype.mark=function(e){},e.prototype.measure=function(e){},e.prototype.dataFixerWarning=function(e,t){},e}();e.ObMonitoring=n,angular.module("adiCoreAppInternal").service("obMonitoring",n)}(S||(S={})),angular.module("adiCoreAppInternal").directive("visualValidation",["visualValidation","visualValidationContainer",function(e,t){return{restrict:"AE",link:function(e,i){t.init(i),i.html("")}}}]).service("visualValidationContainer",function(){_.assign(this,{$element:void 0,init:function(e){this.$element=e},$headerLayoutSolver:void 0,initHeaderLayoutSolver:function(e){this.$headerLayoutSolver=e}})}),angular.module("adiCoreAppInternal").directive("cropperController",["$window","cropFaceService","flags","obMonitoring",function(e,t,i,n){return{restrict:"E",scope:{node:"=",imgdata:"=",viewport:"=",crop:"=",isclosed:"=",oncropclose:"=",bindoutsideclick:"=",autoclose:"="},templateUrl:"views/cropper-controls.html",controller:["$scope","$element",function(o,r){o.flags=i,o.currentImageIndex=0,o.crop=o.crop||[];var a,s=e.Cropper.create(o.imgdata[o.currentImageIndex],o.viewport,o.crop[o.currentImageIndex]),l=s.cropper,c={};o.zoom=l.getZoom(),o.type="p5a",o.changeImg=function(e){if(o.currentImageIndex!==e){o.crop[o.currentImageIndex]=s.cropper.getUnadjustedCropData(),s.cropper.setImgData(o.imgdata[e]);var t=o.crop[e];t&&s.cropper.setUnadjustedCrop(t.x,t.y,t.w,t.h),s.update(!0),o.currentImageIndex=e}},o.$watch("crop",function(){var e=o.crop&&o.crop[o.currentImageIndex];e&&s.cropper.setUnadjustedCrop(e.x,e.y,e.w,e.h),s.update(!0)},!0),o.$watch("imgdata",function(){s.cropper.setImgData(o.imgdata[o.currentImageIndex]),s.update(!0)},!0),o.$watch("viewport",function(){s.cropper.setViewport(o.viewport,!1),s.update(!0)},!0),o.$watch("isclosed",function(){o.isclosed?r.empty():r.append(s.$root)}),o.$on("$destroy",function(){s.destroy(),s=null,l=null}),s.onUpdate=function(){o.$applyAsync(function(){o.zoom=Math.round(100*s.cropper.getZoom())})};var d=_.debounce(function(e){a=e,n.mark({name:"imageCropZoomInZoomOut",data:{nodeId:o.node.getId(),sectionType:o.node.contentElementType,sectionAlias:o.node.alias,zoomType:e<a?"zoom out":"zoom in"}})},300);o.setZoomValue=function(e){var t=e instanceof jQuery.Event?+e.target.value:+e;isNaN(t)||s&&(c=s.cropper.getCropData(),s.cropper.setCrop(c.x,c.y,c.w,c.h),function(e){void 0===a&&(a=100*s.cropper.getZoom()),d(e)}(t),s.cropper.setZoom(t/100),s.update())},o.closeCropper=function(e){o.autoclose&&r.empty(),o.crop[o.currentImageIndex]=s.cropper.getUnadjustedCropData(),o.oncropclose(e?"ok":"cancel",o.crop),e?(n.measure({name:"imageCropSuccess",data:{nodeId:o.node.getId(),sectionType:o.node.contentElementType,sectionAlias:o.node.alias}}),o.$parent.consumerBiLogger.contentEditor.imageCropSave(o.node.id,o.node.alias,o.node.contentElementType)):n.measure({name:"imageCropCancel",data:{nodeId:o.node.getId(),sectionType:o.node.contentElementType,sectionAlias:o.node.alias}})},o.bindoutsideclick(o.closeCropper.bind(!0)),o.smartCrop=function(){s.cropper.setSmartCrop(s.update)},o.faceCrop=function(i,n){var r=o.imgdata[o.currentImageIndex];o.lastFaceCrop&&o.lastFaceCrop.imgIndex===o.currentImageIndex?o.lastFaceCrop.faceIndex=(o.lastFaceCrop.faceIndex+1)%r.fileInput.face.length:o.lastFaceCrop={imgIndex:o.currentImageIndex,faceIndex:0};var a=r.fileInput.face[o.lastFaceCrop.faceIndex];e.console.log("------------------------------------------------"),e.console.log("Face crop: ",r.fileInput),e.console.log("ViewPort: ",o.viewport),e.console.log("Image: ",r),0===i?a=t.cropFaceMinAlpha(o.viewport,r,a):1===i?a=t.cropFaceCustomAlpha(o.viewport,r,a,n):2===i&&(a=t.cropFaceMaxAlpha(o.viewport,r,a,n)),s.cropper.setUnadjustedCrop(a.x,a.y,a.width,a.height),s.update()},o.facesCrop=function(){var e=o.imgdata[o.currentImageIndex];if(!i.lodash4||e&&e.fileInput&&e.fileInput.face&&e.fileInput.face.length){var n=t.combineFaces(e.fileInput.face);n=t.cropFaceMaxAlpha(o.viewport,e,n,!0),s.cropper.setUnadjustedCrop(n.x,n.y,n.width,n.height),s.update()}}}],link:function(t,i){var n,o,r=i.find(".cropper-tool-controls");r&&(n=t.viewport.left-0,o=t.flags.updatedCropper||t.viewport.top>e.innerHeight-t.viewport.top-t.viewport.height?t.viewport.top-r.height()-12:t.viewport.top+t.viewport.height+12,r.css({top:o,left:n}))}}}]),angular.module("adiCoreAppInternal").directive("tpaPreview",["$compile","previewService","$timeout","flags","designKit","documentServicesMediator","themeChooser","fontLoader","$window",function(e,t,i,n,o,r,a,s,l){return{restrict:"E",scope:{tpaPreset:"=",isInverted:"=?",tpaFitToWidth:"<",onClick:"&"},link:function(t,i){if(!(n.debug&&l.tpaPresetsToShow&&l.tpaPresetsToShow.length&&-1===_.indexOf(l.tpaPresetsToShow,t.tpaPreset.id))){var c={},d=void 0===t.isInverted?1===a.coloration.getActiveKitColorationMode():t.isInverted;!function(e){e&&e.data&&e.data.html&&(e.data.html=e.data.html.replace(/<img[^>]*?display: none[^>]*>/g,""))}(t.tpaPreset);var u={"white/black":"color_1","black/white":"color_2","primery-1":"color_3","primery-2":"color_4","primery-3":"color_5","color-1":"color_11","color-2":"color_12","color-3":"color_13","color-4":"color_14","color-5":"color_15","color-6":"color_16","color-7":"color_17","color-8":"color_18","color-9":"color_19","color-10":"color_20","color-11":"color_21","color-12":"color_22","color-13":"color_23","color-14":"color_24","color-15":"color_25","color-16":"color_26","color-17":"color_27","color-18":"color_28","color-19":"color_29","color-20":"color_30","color-21":"color_31","color-22":"color_32","color-23":"color_33","color-24":"color_34","color-25":"color_35"},p=t.tpaPreset.data;if(p){var h=p.presetImageUrl;if(h)return h=h.replace("http://","https://"),void i.append("<img src="+h+"><img>");if(r.hasMapWixParamsToCssValues()){var g=_.get(p,"style.style.properties");d&&(g=ob.deepClone(g),_.each(g,function(e,t){"string"==typeof e&&0===e.indexOf("color")&&(g[t]=n.invertTpaBlogWidget?function(e){var t=P(e);return t===e?P(u[e]):t}(e):P(e))})),r.mapWixParamsToCssValues(g,function(e){c=e})}var m=_.invert(r.getNameToFontsKeyMap()),f=angular.element(p.html),v=angular.element('<a ng-click="onClick()"></a>'),y=p.originalWidth,b=p.originalHeight,S=p.isFullWidth;t.$watch(function(){return t.tpaFitToWidth},function(e){var t=function(e){var t;if(e=e||300,S)t=e/y;else{t=(e-60)/y}return t}(e);f.css({transform:"scale("+t+")"});var n=b*t+(S?0:20);"Stores_Slider_Gallery_Widget"===p.name&&(n+=20),i.css("height",n),v.css("height",n)}),f.css({"transform-origin":"top left",width:y-1+"px",height:b+"px"}),S||i.css("padding-top",10),i.css("overflow","hidden"),v.css({position:"absolute",width:"100%",top:"0px",left:"0px","z-index":"1"}),i.css({display:"block",position:"relative","background-color":d?r.getThemeColor("color_15"):r.getThemeColor("color_11")});var C,w=e(v)(t);if(i.append(w),i.append(f),t.getParamValue=function(e){for(var t,i,n=0;n<e.length;n++){if(t=e[n],c[t])return c[t];if(void 0!==(i=L(t)))return i}},n.loadTPAPreviewFonts&&p.fonts?(p.fonts.forEach(function(e){s.makeCustomFont(e)}),C=p.css):C=p.css.replace(/@font-face\{.*?\}/gm,""),d){var T=i.children()[1].id;i.children()[1].id="inv"+T,C=C.replace(new RegExp(T,"g"),"inv"+T)}var I=angular.element("<style>").html(C),x=e(I)(t);i.prepend(x)}}function P(e){return o.invertColor("{"+e+"}").slice(1,-1)}function M(e,t,i){return d&&!i&&(e=P(e)),d&&t?function(e,t){var i="#"===e[0]?e.substr(1):e,n=i.length/3,o=i.substr(0,n),r=i.substr(n,n),a=i.substr(2*n);return 1===n&&(o+=o,r+=r,a+=a),"rgba("+parseInt(o,16)+","+parseInt(r,16)+","+parseInt(a,16)+","+t+")"}(r.getThemeColor(e),t):r.getThemeColor(e)}function L(e,t){if(0!==e.indexOf("style")){var i=e.split("~"),n=i[1];return e=i[0],u[e]?M(u[e],n,t):-1!==_.values(u).indexOf(e)?M(e,n,t):m[e]?"font: "+r.getThemeFont(m[e]).replace(/{.*}/,"").trim()+";":e}}}}}]);var y;S.ObMonitoring;!function(e){e.duplicateNodeId="duplicateNodeId",e.moreThanOneContactMasterNode="moreThanOneContactMasterNode",e.unusedMenuAnchors="unusedMenuAnchors",e.headerWithWrongIndex="headerWithWrongIndex",e.removeDuplicateMediaValues="removeDuplicateMediaValues",e.removeIllegalListItems="removeIllegalListItems",e.removeIllegalSingleNodeWithChildren="removeIllegalSingleNodeWithChildren",e.deletePageHeader="deletePageHeader",e.deleteUnusedNonTPAMasterNodes="deleteUnusedNonTPAMasterNodes",e.deleteUnusedTPAMasterNodes="deleteUnusedTPAMasterNodes",e.deleteUnusedContentElements="deleteUnusedContentElements"}(y||(y={}));var b=function(){function e(e,t,i,n,o,r,a,s,l,c,d,u,p,h){this.obMonitoring=e,this.mobileSolutionManager=t,this.seoManager=i,this.$log=n,this.storyServices=o,this.richTextService=r,this.contentNormalizer=a,this.flags=s,this.$p=l,this.layoutSolver=c,this.modelTree=d,this.designKit=u,this.layoutSelectionStoreProvider=p,this.PresetMediaType=h,this.fixLog={}}return e.$inject=["obMonitoring","mobileSolutionManager","seoManager","$log","storyServices","richTextService","contentNormalizer","flags","$p","layoutSolver","modelTree","designKit","layoutSelectionStoreProvider","PresetMediaType"],e.prototype.pagesWithCalculatedDesktopSolutions=function(){var e=this;return this.modelTree.getPagesList().filter(function(t){return e.layoutSolver.getSelectedSolution("body",t)}).concat("header").concat("footer")},e.prototype.pagesWithCalculatedDesktopAndMobileSolutions=function(){var e=this;return this.modelTree.getPagesList().filter(function(t){var i=e.layoutSolver.getSelectedSolution("body",t),n=e.mobileSolutionManager.getMobileSolution(i||[]);return i&&(0===i.length||n.length>0)}).concat("header").concat("footer")},e.prototype.purgeObjectKeyedByPageAndLg=function(e){if(e){var t={},i=function(e){var i=e.getPageDescriptor();t[i]=t[i]||[],t[i].push(e.getUniqueIdForSolution())};this.layoutSolver.doForCalculatedDesktopLgs(i),this.mobileSolutionManager.doForCalculatedMobileLgs(i),this.pagesWithCalculatedDesktopAndMobileSolutions().forEach(function(i){var n=Object.keys(e[i]||{}).filter(function(e){return e.indexOf("#")>=0});_.difference(n,t[i]||[]).forEach(function(t){return delete e[i][t]})})}},e.prototype.purgeObjectKeyedByPageAndSegment=function(e){var t=this;if(e){var i={};this.layoutSolver.doForCalculatedDesktopLgs(function(e){var n=e.getPageDescriptor();i[n]=(i[n]||[]).concat(t.layoutSolver.getSegmentKeysInLg(e))}),this.pagesWithCalculatedDesktopSolutions().forEach(function(t){var n=Object.keys(e[t]||{}).filter(function(e){return e.indexOf("|")>=0});_.difference(n,i[t]||[]).forEach(function(i){return delete e[t][i]})})}},e.prototype.purgeObjectKeyedBySegment=function(e){var t=this;if(e&&this.layoutSolver.allDesktopPagesAreCalculated()){var i=[];this.layoutSolver.doForCalculatedDesktopLgs(function(e){return i=i.concat(t.layoutSolver.getSegmentKeysInLg(e))});var n=Object.keys(e);_.difference(n,i).forEach(function(t){return delete e[t]})}},e.prototype.validateBeforeSave=function(){var e=this.layoutSelectionStoreProvider.getLayoutSelectionStore();this.purgePresetPages(e.pages),this.flags.coreCleanLssOnRemove&&this.purgePresetPages(e.lgData),this.purgeObjectKeyedByPageAndLg(e.lgData),this.purgeObjectKeyedBySegment(e.overrides.style),this.purgeObjectKeyedBySegment(e.overrides.media),this.purgeObjectKeyedBySegment(e.textFormatting),this.purgeObjectKeyedBySegment(e.decorations),this.purgeObjectKeyedByPageAndLg(e.pages),this.purgeObjectKeyedByPageAndSegment(e.pages),this.purgeObjectKeyedBySegment(e.variations),this.flags.noMasterNodes&&this.storyServices.story&&(this.storyServices.story.missingMasterNodes=!0)},e.prototype.purgePresetPages=function(e){e&&(delete e.dummyPage,Object.keys(e).forEach(function(t){0===t.indexOf("layoutPresetPreview")&&delete e[t]}))},e.prototype.validateAndSave=function(){var e=this,t=this.$p.when(),i=!1,n=this.layoutSelectionStoreProvider.getLayoutSelectionStore().variations,o=[];return _.each(n,function(e,t){(Array.isArray(e)||e&&Array.isArray(e.mobile))&&o.push({key:t,value:e})}),_.each(o,function(e){delete n[e.key]}),o.length>0&&(t=t.then(function(){return e.flags.consumerMode&&!e.flags.previewRevision&&e.storyServices.story.save()}).then(function(){n=e.layoutSelectionStoreProvider.getLayoutSelectionStore().variations,_.each(o,function(e){n[e.key]={},_.forEach(e.value,function(t,i){if(t)if("mobile"===i){var o={};_.forEach(t,function(e,t){e&&(o[t]=e)}),n[e.key][i]=o}else n[e.key][i]=t})}),i=!0})),t.then(function(){return i&&e.flags.consumerMode&&!e.flags.previewRevision&&e.storyServices.story.save()})},e.prototype.getFieldKey=function(e,t){var i=AdiCoreSanta.contentElementTypes.find(function(e){return t.contentElementType===e.description});if(i){var n=i.fields.find(function(t){return t.subType===e});if(n)return n.name;this.$log.warn("can't find the "+e+" field",t)}},e.prototype.fixArgsMatchingPolicy=function(e){var t="GeneralDescription"===e.contentElementType;if(t){if(t&&"footer"===e.containerPageId){var i=this.getFieldKey(AdiCoreSanta.ElementSubTypes.Image,e);e.argsMatchingPolicy[i]=!1}if(!e.userHidden&&!e.isTpaWidget&&!e.isTpa&&!_.some(e.argsMatchingPolicy)&&!_.some(e.referenceFields)){var n=t?AdiCoreSanta.ElementSubTypes.Title:AdiCoreSanta.ElementSubTypes.Image,o=this.getFieldKey(n,e);o&&void 0!==e.argsMatchingPolicy[o]&&(e.argsMatchingPolicy[o]=!0)}}else e.userHidden||"ListFooter"!==e.contentElementType||_.some(e.argsMatchingPolicy)||_.some(e.referenceFields)||(e.userHidden=!0)},e.prototype.fixBftNodes=function(e){var t=this;_.each(e,function(e){t.fixArgsMatchingPolicy(e),t.fixNodeCrop(e),e.children&&t.fixBftNodes(e.children)})},e.prototype.validateAndFix=function(e){var t=this;this.obMonitoring.mark({name:S.BIWizardServiceInitSteps.HealthCheck,init:!0});var i=_.get(e.blob,["bft","data","children"]),n=_.filter(i,function(e){return"Page"===e.contentElementType}),o=_.find(i,function(e){return"MasterPage"===e.contentElementType}),r=_.get(e.blob,["locale","contentElements"]);!this.flags.noMasterNodes&&e.blob.missingMasterNodes&&(n.forEach(function(e){return t.addMissingMasterNodes(i,e)}),e.blob.missingMasterNodes=!1);var a=n.concat([o]);this.flags.passoverCleaning?this.deletePageHeader(n):this.makeSurePageHeaderExist(n),this.deleteUnusedMasterNodes(e,a),i=_.get(e.blob,["bft","data","children"]),this.deleteUnusedContentElements(r,i),this.fixLog={};var s=this.getDuplicateIds(i);if(!_.isEmpty(s)){this.flags.newDataFixerBI?this.reportDataFixer(y.duplicateNodeId,{metaSiteId:e.storyId.metaSiteId}):this.reportWarning("story has duplicate nodeId",{metaSiteId:e.storyId.metaSiteId}),this.$log.warn("found duplicate ids");var l=this.storyServices.calculateNextPageAndNodeId(e.blob.bft);this.$log.warn("calculated next ids: "+JSON.stringify(l)),_.each(s,function(i,n){t.fixNodeIdDuplication(e,n,i,l)}),this.$log.warn("update next in bft ids: "+JSON.stringify(l)),e.blob.bft.data.nextFirstLevelNodeId=l.nextFirstLevelNodeId,e.blob.bft.data.nextPageNodeId=l.nextPageNodeId}this.removeIllegalChildren(i,e.storyId.metaSiteId),this.fixBftNodes(i),this.scanCEValues(i,r,e),this.removeAggregatorLayouts(e,n),this.scanPages(e,i,r,n),this.resetPagesBackground(e,n),this.moveZigZagToLss(e,n),this.moveDesignKitToLss(e,n),this.moveSiteDesignProperties(e),this.removeUnusedMenuAnchors(i,n,e),this.testForEmoji(e.blob.mainMenu,n,r),this.fixPhoneNumbers(e.blob.richTextLinks),this.flags.passoverCleaning||this.fixHeaderIndex(n,e),this.fixStoryColorationIfMainKitNotPresent(e),this.purgeStaleLssNodeOverrides(e),this.purgeStaleLssTpaServices(e),this.purgeUndefinedPage(e),this.fixTpaBackgrounds(e,n),this.addMissingMasterNodes(i,o),this.obMonitoring.measure({name:S.BIWizardServiceInitSteps.HealthCheck,init:!0})},e.prototype.addMissingMasterNodes=function(e,t){t&&_.each(t.children,function(t){if("PageHeader"!==t.contentElementType&&!_.find(e,function(e){return e.id===t.id})){var i=_.clone(t);delete i.containerPageId,e.push(i)}})},e.prototype.fixTpaBackgrounds=function(e,t){var i=this,n=this.getNonInvertibleTpas(t),o=_.get(e,"blob.locale.layoutSelections.lgData",{});n.forEach(function(e){return i.fixStripColorIfNeeded(o,e)})},e.prototype.getNonInvertibleTpas=function(e){var t=this;return _.flatten(e.map(function(e){return e.children.filter(function(i){return(i.isTpa||i.isTpaWidget)&&!t.modelTree.canInvertTpa(i,e)})}))||[]},e.prototype.fixStripColorIfNeeded=function(e,t){var i=e[t.containerPageId];for(var n in i)this.isLgIdMatchNodeId(n,t.id)&&this.isStripColorDark(i[n])&&(i[n].strip.color=this.designKit.lightColorsSantaFormat[0])},e.prototype.isStripColorDark=function(e){var t=_.get(e,"strip.color");return t&&this.designKit.isDarkColor(t)},e.prototype.isLgIdMatchNodeId=function(e,t){return e.split(".")[1]===t.split(".")[1]+"#"},e.prototype.fixNodeCrop=function(e){_.each(e.crop,function(t,i){_.each(t,function(t,n){null!==t.x&&null!==t.y&&t.width&&t.height||delete e.crop[i][n]})})},e.prototype.purgeUndefinedPage=function(e){e.blob.locale&&delete e.blob.locale.layoutSelections.pages.undefined},e.prototype.purgeStaleLssTpaServices=function(e){if(e.blob.bft){for(var t=[],i=[e.blob.bft.data];i.length;){var n=i.shift();t.push(n.id),i.push.apply(i,n.children)}Object.keys(e.blob.locale.layoutSelections.tpaService).filter(function(e){return t.indexOf(e)<0}).forEach(function(t){return delete e.blob.locale.layoutSelections.tpaService[t]})}},e.prototype.purgeStaleLssNodeOverrides=function(e){if(e.blob.bft){var t=function(e){return e.id};e.blob.bft.data.children.filter(function(e){return"Page"===e.contentElementType}).forEach(function(i){_.difference(function(t){return Object.keys(e.blob.locale.layoutSelections.pages[t.id]||{}).filter(function(e){return 0===e.indexOf("node_")}).map(function(e){return e.substr("node_".length)})}(i),function(e){return _.flatten(e.children.map(function(e){return e.children.map(t).concat(e.id)}).concat(e.id))}(i)).forEach(function(t){return function(t,i){delete e.blob.locale.layoutSelections.pages[t]["node_"+i]}(i.id,t)})})}},e.prototype.getContactsInPage=function(e){return _.filter(e.children,function(e){return"Contact"===e.contentElementType})},e.prototype.removeNodes=function(e,t,i,n){var o=this;_.each(i,function(i){if(o.$log.warn("remove "+i.contentElementType+" node: "+i.id+" from page "+t.id),t.children.splice(t.children.indexOf(i),1),n){var r=_.findIndex(e,function(e){return e.id===i.id});r>-1&&e.splice(r,1)}})},e.prototype.scanPage=function(e,t,i,n){var o=this,r=_.filter(t.children,function(e){return!!e.widgetRef});r.length>0&&(r=_.groupBy(r,function(e){return e.widgetRef.id}),_.each(r,function(i){i.length>1&&o.removeNodes(e,t,i.slice(0,1),!0)}));var a=this.getContactsInPage(t);if(i&&(this.removeNodes(e,t,_.filter(a,function(e){return e.id!==i.id})),a=this.getContactsInPage(t)),a.length>1&&this.removeNodes(e,t,a.slice(0,1)),this.flags.removeDuplicateSectionsInPage){var s=_.filter(_.groupBy(t.children,function(e){return e.id}),function(e){return e.length>1});_.each(s,function(i){o.removeNodes(e,t,i.slice(1))})}t.alias=t.alias&&this.normalizePageName(t.alias),t.displayName=t.displayName&&this.normalizePageName(t.displayName);var l=n[t.id];l&&l.displayName&&(l.displayName.value=this.normalizePageName(l.displayName.value))},e.prototype.scanPages=function(e,t,i,n){var o,r=this,a=_.filter(t,function(e){return"Contact"===e.contentElementType});if(a){o=a[0];for(var s=1;s<a.length;s++)this.flags.newDataFixerBI?this.reportDataFixer(y.moreThanOneContactMasterNode,{metaSiteId:e.storyId.metaSiteId}):this.reportWarning("story has more than one contact master node",{metaSiteId:e.storyId.metaSiteId}),this.$log.warn("remove contact master node: "+a[s].id),t.splice(t.indexOf(a[s]),1)}_.each(n,function(e){r.scanPage(t,e,o,i)})},e.prototype.resetPagesBackground=function(t,i){var n=_.filter(i,function(t){var i=t.bgObj&&t.bgObj.color;return i&&i!==e.DEFAULT_BACKGROUND_PAGE_COLOR});if(n.length)for(var o=t.blob.locale.savedSites.undefined.pagesMap,r=0,a=n;r<a.length;r++){var s=a[r];o[s.id]&&(s.bgObj.color=e.DEFAULT_BACKGROUND_PAGE_COLOR)}},e.prototype.testForEmoji=function(e,t,i){var n=this;_.each(t,function(t){["alias","displayName"].forEach(function(e){n.seoManager.hasEmoji(t[e])&&(t[e]=n.seoManager.removeEmojis(t[e]))});var o=t.id.replace(/\./g,"_");_.each(i[o],function(e,t){"pageTitleSEO"!==t&&"displayName"!==t||n.seoManager.hasEmoji(e.value)&&(e.value=n.seoManager.removeEmojis(e.value))}),_.each(e,function(e){n.seoManager.hasEmoji(e.name)&&(e.name=n.seoManager.removeEmojis(e.name))})})},e.prototype.normalizePageName=function(e){return(e=this.richTextService.toPlainText(e)).substr(0,100)},e.prototype.moveSiteDesignProperties=function(e){var t=_.get(e,["blob","locale","layoutSelections"]);t&&void 0===t.siteOverrides&&(this.$log.warn("creating siteOverrides and moving site design pars there"),t.siteOverrides={},_.each(["siteAnimation","siteFontAdditionalSize","siteScrollType"],function(e){void 0!==t[e]&&(t.siteOverrides[e]=t[e]),delete t[e]}))},e.prototype.removeAggregatorLayouts=function(e,t){var i=_.get(e,["blob","locale","layoutSelections","pages"]);i&&_.each(t,function(e){var t=i[e.id];_.each(t,function(e){e&&e.LE&&(e.LE=_.map(e.LE,function(e){return e.replace("#ag","")}),e.manualLE&&(e.manualLE=e.manualLE.replace("#ag","")))})})},e.prototype.moveZigZagToLss=function(e,t){var i=_.get(e,["blob","locale","layoutSelections"]);_.each(t,function(e){_.each(e.children,function(t){if("contentElementList"===t.type&&t.zigZagState){var n=_.get(i,["pages",e.id,"solutionLGs",t.id]),o=_.find(n,function(e){return"ListHeader"!==e.ceType&&"ListFooter"!==e.ceType});_.set(i,["pages",e.id,"node_"+t.id,"zigZag"],{cols:!0,rows:o&&("5680125272e7a231006e2621"===o.id||"5680125272e7a231006e2624"===o.id)})}})})},e.prototype.moveDesignKitToLss=function(e,t){var i=_.get(e,["blob","locale","layoutSelections"],{});i.designKit&&(_.each(i.designKit,function(e,n){e&&_.each(t,function(t){var o=_.cloneDeep(e);o.colorIndex=o.colorIndex||0,_.set(i,["pages",t.id,n,"designKit"],o)})}),delete i.designKit,this.fixLog.resetHeaderFoterDesignKitConfig=!0)},e.prototype.fixStoryColorationIfMainKitNotPresent=function(e){var t=e.blob.selectedStyle;t&&!t.mainKit&&t.coloration&&t.coloration.kitId&&(t.mainKit=t.coloration.kitId)},e.prototype.fixImageFitForColumnBg=function(e){var t=this,i=_.get(e,["blob","locale","layoutSelections","overrides","media"]);_.each(i,function(e){e&&e.allowedMediaOverrides===t.PresetMediaType.COLUMNBG&&_.each(e._preferred,function(e){e&&"Image"===e.name&&e.properties&&"full"===e.properties.displayMode&&(e.properties.displayMode="fill")})})},e.prototype.removeUnusedMenuAnchors=function(e,t,i){var n=this;if(_.isString(i.blob.mainMenu)&&(i.blob.mainMenu=JSON.parse(i.blob.mainMenu)),e&&e.length>0&&i.blob.mainMenu.length>0){var o=i.blob.mainMenu.length;i.blob.mainMenu=i.blob.mainMenu.filter(function(e){if(e.page)return!0;for(var i,o=0;o<t.length;o++)if(i=_.find(t[o].children,function(t){return t.id===e.id}))return!0;return i||n.$log.warn("removed unused menu anchor",e.name,"for node",e.id,"in page",e.pageId),!1}),o>i.blob.mainMenu.length&&(this.flags.newDataFixerBI?this.reportDataFixer(y.unusedMenuAnchors,{metaSiteId:i.storyId.metaSiteId}):this.reportWarning("story has unused menu anchors",{metaSiteId:i.storyId.metaSiteId}))}},e.prototype.fixPhoneNumber=function(e){e&&e.targetPhone&&e.targetPhone.length>S.GENERAL_VALIDATIONS.MAX_PHONE_NUMBER_LENGTH&&(e.targetPhone=e.targetPhone.substr(0,S.GENERAL_VALIDATIONS.MAX_PHONE_NUMBER_LENGTH))},e.prototype.fixPhoneNumbers=function(e){var t=this;this.flags.fixLongPhoneNumbers&&_.each(e,function(e){t.fixPhoneNumber(e)})},e.prototype.fixHeaderIndex=function(e,t){var i=this,n=!1;_.each(e,function(e){var t=e.id,o=e.children,r=_.findIndex(o,function(e){var t=e.id;return(void 0===t?"":t).endsWith(".header")});if(r>0){n=!0;for(var a=o[r],s=r;s>0;--s)o[s]=o[s-1];o[0]=a,i.$log.warn('header "'+a.id+'" on page "'+t+'" moved from position '+r+" to position 0")}}),n&&(this.flags.newDataFixerBI?this.reportDataFixer(y.headerWithWrongIndex,{metaSiteId:t.storyId.metaSiteId}):this.reportWarning("story has header with wrong index",{metaSiteId:t.storyId.metaSiteId}))},e.prototype.scanCEValues=function(e,t,i){var n=this;_.each(t,function(t,o){_.each(t,function(t){if(n.flags.fixLongPhoneNumbers&&t.type===AdiCoreSanta.ElementTypes.Button&&n.fixPhoneNumber(t.value),t.type===AdiCoreSanta.ElementTypes.Media){n.flags.dataFixerReduceMediaBlob?_.isArray(t.value)||(t.value=[]):t.value||(t.value=[]),n.flags.dataFixerReduceMediaBlob&&(t.value=_.map(t.value,function(e){return n.contentNormalizer.normalizeMedia(e)})),_.each(t.value,function(e){e.Title&&e.Title.length>S.GENERAL_VALIDATIONS.MAX_MEDIA_TITLE_LENGTH&&(e.Title=e.Title.substr(0,S.GENERAL_VALIDATIONS.MAX_MEDIA_TITLE_LENGTH)),e.Description&&e.Description.length>S.GENERAL_VALIDATIONS.MAX_MEDIA_DESCRIPTION_LENGTH&&(e.Description=e.Description.substr(0,S.GENERAL_VALIDATIONS.MAX_MEDIA_DESCRIPTION_LENGTH))});var r=t.value.length;if(t.subType!==AdiCoreSanta.ElementSubTypes.Social&&(t.value=(n.flags.lodash4?_.uniqBy:_[String("uniq")])(t.value,function(e){return(e.relativeUri||e.videoUrl)+e.mediaType})),t.value.length<r){n.flags.newDataFixerBI?n.reportDataFixer(y.removeDuplicateMediaValues,{metaSiteId:i.storyId.metaSiteId}):n.reportWarning("story has duplicate media values",{metaSiteId:i.storyId.metaSiteId});var a=o.replace(/_/g,"."),s="",l=[];_.each(e,function(e){"Page"===e.contentElementType&&_.each(e.children,function(t){t.id===a&&(s=t.alias||t.contentElementType,l.push(e.alias)),_.each(t.children,function(t){t.id===a&&(s=t.alias||t.contentElementType,l.push(e.alias))})})}),n.$log.warn("removed duplicate media values in content element",s,"in pages",l)}_.each(t.value,function(e){e.mediaType===AdiCoreSanta.MediaItemTypes.ExtVideo&&"string"==typeof e.videoUrl&&(e.videoUrl=e.videoUrl.trim())})}})})},e.prototype.removeIllegalChildren=function(e,t){var i=this,n=["page","masterpage","footer"];_.each(e,function(e){if(-1!==n.indexOf(e.contentElementType.toLowerCase()))i.removeIllegalChildren(e.children,t);else if(e.children.length>0){if("contentElementList"===e.type){var o=e.id+".",r=_.filter(e.children,function(e){return!e.id.startsWith(o)}),a=_.findIndex(e.children,function(e){return"ListFooter"===e.contentElementType});if(a>-1&&a<e.children.length-1){for(var s=a+1;s<e.children.length;s++)r.push(e.children[s]);r=_.uniq(r)}r.length>0&&(i.flags.newDataFixerBI?i.reportDataFixer(y.removeIllegalListItems,{metaSiteId:t}):i.reportWarning("story has illegal list items",{metaSiteId:t}),i.$log.warn("found illegal list items in list",e.alias||e.contentElementType,e.id),_.each(r,function(t){i.$log.warn("remove illegal list item: "+t.id),e.children.splice(e.children.indexOf(t),1)}))}else i.$log.warn("single node has children",e.alias||e.contentElementType,e.id),i.flags.newDataFixerBI?i.reportDataFixer(y.removeIllegalSingleNodeWithChildren,{metaSiteId:t}):i.reportWarning("story has single node with children - "+e.contentElementType,{metaSiteId:t});i.removeIllegalChildren(e.children,t)}})},e.prototype.setId=function(e,t){e.id=t,_.each(e.children,function(e,i){e.id=t+"."+i})},e.prototype.safeId=function(e){return e.replace(/\./g,"_")},e.prototype.fixNodeIdDuplication=function(e,t,i,n){var o=this;if("Page"===i[0].contentElementType){_.isString(e.blob.mainMenu)&&(e.blob.mainMenu=JSON.parse(e.blob.mainMenu));for(var r=1;r<i.length;r++){var a=i[r],s=e.blob.bft.data.children.indexOf(a);e.blob.bft.data.children.splice(s,1);var l=_.findIndex(e.blob.mainMenu,function(e){return!(!0===e.page&&e.id===t)});e.blob.mainMenu.splice(l,1),this.$log.warn("remove duplicate page: "+a.id+" page name: "+a.displayName)}}else{_.each(e.blob.bft.data.children,function(i){if("Page"===i.contentElementType){var n=0;i.children=_.filter(i.children,function(r,a){if(r.id===t){o.$log.warn("remove node ceType:"+(r.alias||r.contentElementType)+", id:"+r.id+", index:"+a+", pageId:"+i.id+", pageName: "+i.displayName);var s=_.get(e.blob.locale.layoutSelections,["pages",i.id,"solutionLGs"]);return s&&delete s[r.id],_.isString(e.blob.mainMenu)&&(e.blob.mainMenu=JSON.parse(e.blob.mainMenu)),e.blob.mainMenu=_.filter(e.blob.mainMenu,function(e){return!(e.pageId===i.id&&e.id===t)}),o.fixLog.removedNodes=o.fixLog.removedNodes||[],o.fixLog.removedNodes.unshift({alias:r.alias,ceType:r.contentElementType,index:a-n,pageId:i.id,pageName:i.displayName}),n++,!1}return!0})}}),_.each(i,function(t){var i=e.blob.bft.data.id+"."+ ++n.nextFirstLevelNodeId;o.$log.warn("change id of master node "+(t.alias||t.contentElementType)+" from "+t.id+" to "+i),o.setId(t,i)});var c=this.safeId(t);_.each(_.keys(e.blob.locale.contentElements),function(t){(t===c||t.startsWith(c+"_"))&&(o.$log.warn("remove content of "+t),delete e.blob.locale.contentElements[t])})}},e.prototype.getDuplicateIds=function(e){return _.chain(e).groupBy(function(e){return e.id})[this.flags.lodash4?"pickBy":String("pick")](function(e){return e.length>1}).value()},e.prototype.getProblematicIds=function(e){var t=e.blob.bft.data.children,i=_.chain(t).filter(function(e){return e.id.indexOf("NaN")>=0}).uniq().value(),n=t.filter(function(e){return e.id.indexOf("NaN")<0});return{nans:i,dups:_.chain(n).groupBy(function(e){return e.id}).filter(function(e){return e.length>=2}).flatten().value()}},e.prototype.removeNode=function(e,t){var i=e.blob.bft.data.children.reduce(function(e,i){return i.id!==t.id&&(i.children=i.children.filter(function(e){return e.id!==t.id}),e.push(i)),e},[]),n=e.blob.locale.contentElements,o=t.id.replace(".","_"),r=Object.keys(n).filter(function(e){return 0!==e.indexOf(o)}).reduce(function(e,t){return e[t]=n[t],e},{});return e.blob.locale.contentElements=r,delete e.blob.locale.savedSites.undefined.pagesMap[t.id],e.blob.bft.data.children=i,e},e.prototype.reportWarning=function(e,t){if(this.flags.newDataFixerBI&&this.flags.debug)throw new Error("reportWarning method is deprecated. Please use reportDataFixer.");this.obMonitoring.warning("HealthCheck: "+e,t)},e.prototype.reportDataFixer=function(e,t){this.obMonitoring.dataFixerWarning(String(e),t)},e.prototype.createNewPageHeader=function(e){return{id:e+".header",displayName:e+".header",userHidden:!0,contentElementType:"PageHeader",type:"contentElement",containerPageId:e,argsMatchingPolicy:{PageDescription:!0,PageMedia:!0,PageTitle:!0},mobileArgsPolicy:{},referenceFields:{},mobileReferenceFields:{},crossPageConnected:!0,layoutFilter:"f",children:[]}},e.prototype.makeSurePageHeaderExist=function(e){var t=this;_.each(e,function(e){var i=_.get(e,"children[0]");i&&"PageHeader"===i.contentElementType||(e.children=e.children||[],e.children.unshift(t.createNewPageHeader(e.id)))})},e.prototype.deletePageHeader=function(e){var t=this,i=0;_.each(e,function(e){var n=_.get(e,"children[0]");n&&"PageHeader"===n.contentElementType&&(t.flags.debug&&t.$log.warn("deletePageHeader - Removing pageHeader:",n.id),e.children.splice(0,1),i+=1)}),i&&(this.flags.newDataFixerBI?this.reportDataFixer(y.deletePageHeader,{numOfPageHeaders:i}):this.reportWarning("deleted pageHeaders",{numOfPageHeaders:i}))},e.prototype.deleteUnusedMasterNodes=function(e,t){var i=this,n=0,o=0,r=_.get(e.blob,["bft","data"]);if(r&&r.children){var a=_.get(e,"blob.locale.layoutSelections.tpaService"),s=["MasterPage","Page","Members_Page","Contact","Social","footer","GeneralDescription","Footer"],l=_(t).map(function(e){if(e&&e.children)return _.map(e.children,function(e){return e.id})}).flatten().value();r.children=_.filter(r.children,function(e){if(i.flags.noMasterNodes){if(i.modelTree.shouldHaveMasterNode(e))return!0}else if(s.indexOf(e.contentElementType)>-1)return!0;var t=l.indexOf(e.id)>-1;return t||(a&&(e.isTpa||e.isTpaWidget)?(delete a[e.id],o+=1,i.flags.debug&&i.$log.warn("Removing Tpa master node and preset:",e.id,e.contentElementType)):(n+=1,i.flags.debug&&i.$log.warn("Removing master node:",e.id,e.contentElementType))),t}),n&&(this.flags.newDataFixerBI?this.reportDataFixer(y.deleteUnusedNonTPAMasterNodes,{numOfDeletedNodes:n}):this.reportWarning("deleted unused TPA maseter nodes and preset",{numOfDeletedNodes:n})),o&&(this.flags.newDataFixerBI?this.reportDataFixer(y.deleteUnusedTPAMasterNodes,{numOfDeletedNodes:o}):this.reportWarning("deleted unused content elements",{numOfDeletedNodes:o}))}},e.prototype.deleteUnusedContentElements=function(e,t){var i=this,n=0;if(t){var o,r=[];this.flags.noMasterNodes?(o=[],_.each(t,function(e){"Page"===e.contentElementType&&o.push(_.map(e.children,function(e){return e.id.replace(/\./g,"_")})),o.push(e.id.replace(/\./g,"_"))}),o=_.flatten(o)):(o=_.map(t,function(e){return i.flags.passoverCleaning||"Page"===e.contentElementType&&e.children[0]&&r.push(e.children[0].id.replace(/\./g,"_")),e.id.replace(/\./g,"_")}),this.flags.passoverCleaning||o.push.apply(o,r)),_.each(e,function(t,r){var a=r,s=r.split("_");s.length>2&&(s.length=2,r=s.join("_")),-1===_.indexOf(o,r)&&(n+=1,delete e[a],i.flags.debug&&i.$log.warn("Removing content of: "+a))}),n&&(this.flags.newDataFixerBI?this.reportDataFixer(y.deleteUnusedContentElements,{numOfDeletedCEs:n}):this.reportWarning("deleted unused content elements",{numOfDeletedCEs:n}))}},e.DEFAULT_BACKGROUND_PAGE_COLOR="#FFFFFF",e}();angular.module("adiCoreAppInternal").service("healthCheck",b);var S,C=function(){function e(e,t,i,n,o,r,a,s,l,c){this.RichTextTags=e,this.themeChooser=t,this.LayoutElementFormatting=i,this.richTextLinks=n,this.modelTree=o,this.pagesManager=r,this.flags=a,this.$p=s,this.richTextUtils=l,this.focusKeeper=c,AdiCoreSanta.setRichTextService(this)}return e.$inject=["RichTextTags","themeChooser","LayoutElementFormatting","richTextLinks","modelTree","pagesManager","flags","$p","richTextUtils","focusKeeper"],e.prototype.initForRender=function(){var e=this;if(!this.initPromise){var t=this.$p.defer();this.flags.consumerMode?wixRichtext.init(function(){wixRichtext.createOfflineCommandInstance(function(i){e.offlineEditor=i,t.resolve()})}):t.resolve(),this.initPromise=t.promise}return this.initPromise},e.prototype.getEditorLinksManager=function(){var e=this;return{convertExternalLinkToLinkRef:function(t){return e.addLink({isPageRef:!1,targetUrl:t})},convertLinkRefToLinkRef:function(t){var i=e.richTextLinks.getLink(t);if(i){if(_.get(i,["link","type"])===AdiCoreSanta.DSLinkTypes.Anchor){var n=e.modelTree.findById(i.link.nodeId,i.link.targetPage);n&&e.pagesManager.addAnchorLink(n)}return e.addLink(ob.deepClone(i))}},convertLinkRefToAttributes:function(e){return{adilinkid:e}},convertAttributesToLinkRef:function(e){return e.adilinkid}}},e.prototype.addLink=function(e){return this.richTextLinks.addLink(e)},e.prototype.getLink=function(e){return this.richTextLinks.getLink(e)},e.prototype.removeLink=function(e){this.richTextLinks.removeLink(e)},e.prototype.convertToValidHtml=function(e){return this.offlineEditor&&this.offlineEditor.convertToValidHtml?this.offlineEditor.convertToValidHtml(e,function(e){return e},function(e){return e}):e},e.prototype.markRichText=function(e){return this.richTextUtils.markRichText(e)},e.prototype.unMarkRichText=function(e){return this.richTextUtils.unMarkRichText(e)},e.prototype.isRichText=function(e){return this.richTextUtils.isRichText(e)},e.prototype.resetFormatting=function(e){return this.richTextUtils.resetFormatting(e)},e.prototype.toPlainText=function(e){return this.richTextUtils.toPlainText(e)},e.prototype.isEmpty=function(e){return this.richTextUtils.isEmpty(e)},e.prototype.parseAndReplaceLinks=function(t,i){var n=this;return e.dataQueryRegex.test(t)?t.replace(e.dataQueryRegex,function(e,t){var o=n.richTextLinks.getLink(t);if(o){var r=n.richTextLinks.generateLinkId();return i[r]=o,'dataquery="#'+r+'"'}return""}):t},e.prototype.tryToExtractPlainText=function(e,t){return this.richTextUtils.tryToExtractPlainText(e,t)},e.prototype.transformForEditor=function(e,t){var i;return e=e||"",t&&((i=new this.LayoutElementFormatting).setBold(t.isBold()),i.setItalic(t.isItalic()),i.setUnderline(t.isUnderline())),_.map(e.split("\n"),function(e){var t=_.htmlEncode(e)||"&nbsp;";return i&&(t=i.format(t)),'<p class="font_7">'+t+"</p>"}).join("\n")},e.prototype.transformForViewer=function(e,t,i,n,o,r,a){var s="font_"+t,l={formatBlock:{tag:this.RichTextTags[t]||"p",class:s,shouldRetainThemesAndStyles:!0},lineHeight:this.themeChooser.getLineHeight(s)};switch(this.flags.textEditOnStage2&&i&&(l.fontSize=i+"px"),o&&(l.bidirtl=!0),n){case"left":l.justifyleft=!0;break;case"center":l.justifycenter=!0;break;case"right":l.justifyright=!0}if(r){var c=r.getColor();c&&(l.foreColor="#"===c[0]?c:"color_"+c);var d=r.getBGColor();d&&(l.backColor="#"===d[0]?d:"backcolor_"+d),r.isCapsLock()&&(l.toUpperCase=!0)}var u=this.parseAndReplaceLinks(this.unMarkRichText(e),a);this.focusKeeper.setIsIgnoringBlurOnActiveEditor(!0);var p=this.offlineEditor.execOfflineCommands(u,l);return this.focusKeeper.setIsIgnoringBlurOnActiveEditor(!1),p},e.prototype.setAccessibilityHTag=function(e,t){return e.replace(/^<(?:[^\s>]+)/,"<"+t).replace(/<\/(?:\w+)>$/,"</"+t+">")},e.dataQueryRegex=/adilinkid="(.*?)"/g,e}();angular.module("adiCoreAppInternal").service("richTextService",C),function(e){var t=function(){function e(t,i,n){var o=this;this.renderedModelApi=t,this.modelLookup=i,this.sitePartTypes=n,this.ensureEntry=function(e,t){void 0===t&&(t={});var i=t.contentElementType,n=t.id,o=_.find(e,{ceType:i,nodeId:n});return o||(o={ceType:i,nodeId:n,children:[]},e.push(o)),o},this.identifyingNode=function(e){return _.get(e,"from.lgs[0].segments[0].node.identifyingNode")||_.get(e,"from.lg.segments[0].node.identifyingNode")},this.entryItem=function(e,t){void 0===t&&(t={});var i=t.bftNode||_.get(e,"from.le.containingSegment.node"),n=t.type||e.from.layout.type,o=t.subType||e.from.layout.subType||n;return{id:e.compRef.id,type:n,subType:o,nodeId:i&&i.id,ceType:i&&i.contentElementType}},e.renderedModel={get:function(e){return o.renderedModelApi.get(e)},getHeader:function(){return o.renderedModelApi.get(o.sitePartTypes.HEADER)},getFooter:function(){return o.renderedModelApi.get(o.sitePartTypes.FOOTER)},getMobile:function(e){return o.renderedModelApi.get(e,void 0,!0)},mobileHeader:function(){return e.renderedModel.getMobile(o.sitePartTypes.HEADER)},mobileFooter:function(){return e.renderedModel.getMobile(o.sitePartTypes.FOOTER)},clear:function(){return o.renderedModelApi.modelStore.store={}},automation:function(e,t){return o.renderedModelApi.get(e,void 0,t).children.reduce(function(t,i){var n,r=o.identifyingNode(i);if(r||"header"===e||"footer"===e){var a=o.ensureEntry(t,r),s=o.modelLookup.flatten(i).reduce(function(e,t){if(t.from.layout)e.push(o.entryItem(t));else{var i=o.specialNode(t,r);i&&e.push(i)}return e},[]);(n=a.children).push.apply(n,s)}return t},[])}}}return e.$inject=["renderedModelApi","modelLookup","sitePartTypes"],e.prototype.specialNode=function(e,t){return _.get(e,"compDef.design.background.mediaRef")||"ImageList"===_.get(e,"compDef.data.type")?this.entryItem(e,{bftNode:_.get(e,"from.segment.node")||t,type:AdiCoreSanta.ElementTypes.Media,subType:"background"}):_.get(e,"compDef.design.background.color")&&_.get(e,"from.segment")?this.entryItem(e,{bftNode:_.get(e,"from.segment.node")||t,type:AdiCoreSanta.ElementTypes.Container,subType:AdiCoreSanta.ElementTypes.Container}):void 0},e}();e.CorePublic=t,angular.module("adiCoreAppInternal").service("corePublic",t)}(S||(S={}));var w=function(){function e(e,t,i,n,o,r,a,s,l,c,d,u,p,h,g,m,f,v,y,b,S,C){var w=this;this.$window=e,this.$injector=t,this.layoutSolver=i,this.sitePartTypes=n,this.healthCheck=o,this.storyServices=r,this.layoutSelectionStoreProvider=a,this.modelTree=s,this.LayoutGroup=l,this.renderedModelApi=c,this.modelLookup=d,this.flags=u,this.wizardService=p,this.simpleSolutionManager=h,this.mobileSolutionManager=g,this.prettyLayoutService=m,this.pagesManager=f,this.nodeManipulationService=v,this.mergedHeaderService=y,this.catalogDebug=b,this.overlayModel=S,this.lssModifier=C,this.services={},this.renderedModelPrintRecurse=function(e,t){var i=e.children&&e.children.length,n=e.compDef?t+": "+e.key+"\t\t"+e.compDef.componentType+"\t\tx: "+e.compDef.layout.x+"  y: "+e.compDef.layout.y+"  h: "+e.compDef.layout.height+"  w: "+e.compDef.layout.width:"root: height: "+e.height;i?console.group(n):console.log(n),_.each(e.children,function(e){w.renderedModelPrintRecurse(e,t+1)}),i&&console.groupEnd()},this.overlayStoreModel={get:function(e,t){return void 0===e&&(e=w.sitePartTypes.BODY),void 0===t&&(t=w.storyServices.story.selectedPage),w.overlayModel.get(e,t)},getMobile:function(e,t){return void 0===e&&(e=w.sitePartTypes.BODY),void 0===t&&(t=w.storyServices.story.selectedPage),w.overlayModel.getMobile(e,t)}},this.renderedModel={print:function(e){void 0===e&&(e=w.sitePartTypes.BODY);var t=w.renderedModelApi.get(e);w.renderedModelPrintRecurse(t,0)},printMobile:function(e){void 0===e&&(e=w.sitePartTypes.BODY);var t=w.renderedModelApi.get(e,void 0,!0);w.renderedModelPrintRecurse(t,0)},get:function(e){return void 0===e&&(e=w.sitePartTypes.BODY),w.renderedModelApi.get(e)}},this.debugLoading={printTimes:function(){if(w.$window.marks){var e=(w.flags.lodash4?_.strictMaxBy:_.max)(w.$window.marks,function(e){return e.name.length}).name.length+3;return _.map(w.$window.marks,function(t){return""+t.name+" ".repeat(e-t.name.length)+t.duration}).join("\n")+" \nTotal duration: "+(w.flags.lodash4?_.strictSumBy:_[String("sum")])(w.$window.marks,"duration")}console.log("You must be in debug mode")}},this.dp={changeDesignPolicyFactor:function(e){return w.lssModifier.setSiteDesignPolicy({factor:e}),w.modelTree.dirtifyAllPages(),w.storyServices.onNodeChangedClearCacheSynchronous()},getDesignPolicyFactor:function(){return this.lssModifier.getSiteDesignPolicy().factor}},this.debugDs={get:function(e){return documentServices.debug.trace.get(e)},clean:function(){documentServices.debug.trace.clean()},stop:function(){documentServices.debug.trace.stop()},start:function(){documentServices.debug.trace.start()},getOperations:function(e){return e?w.debugDs.get(e):_(w.debugDs.get()).filter({type:"Q OPERATION ADDED"}).value()},getGroupedOperations:function(e){return _.groupBy(w.debugDs.getOperations(e),"methodName")},getOperationsFiltered:{includes:function(e,t){return _.filter(w.debugDs.getOperations(t),function(t){return!0===t.methodName.includes(e)})},without:function(e,t){return _.filter(w.debugDs.getOperations(t),function(t){return!1===t.methodName.includes(e)})}},getOperationsNames:function(e){return _.map(w.debugDs.getOperations(e),"methodName")},getRendered:function(e,t,i,n){var o=_(w.debugDs.get()).filter({type:"VIEWER RENDERED FROM Q"}).value();return(t||i)&&(t=t||0,i=i?i-t+1:o.length,o=o.splice(t||0,i)),e&&(o=_.map(o,"traceTimes."+e),n&&(o=(w.flags.lodash4?_.strictSumBy:_.sum)(o))),o},getRenderedNotMe:function(e,t,i){return w.debugDs.getRendered("notMe",e,t,i)},getRenderedTotal:function(e,t,i){return w.debugDs.getRendered("total",e,t,i)},getBatches:function(){var e=[];return _.each(w.debugDs.getOperations(),function(t){e[t.handle]=t.handle+t.methodName}),_.map(w.debugDs.getRendered(),function(t){return _.map(t.items,function(t){return e[t]})})}},this.eds={setId:function(e){this.id=e},getCompById:function(e){return"object"==typeof(e=e||this.id)?e:documentServices.components.get.byId(e)},isContainer:function(e){var t=this.getCompById(e);return documentServices.components.is.container(t)},getPages:function(){return documentServices.pages.getPageIdList()},getLayoutById:function(e){var t=this.getCompById(e);return documentServices.components.layout.get(t)},updateLayoutById:function(e,t){var i=this.getCompById(e);return documentServices.components.layout.update(i,t)},getData:function(e){var t=this.getCompById(e);return documentServices.components.data.get(t)},getStyleByCompId:function(e){var t=this.getCompById(e);return documentServices.components.style.get(t)},serializeById:function(e){var t=this.getCompById(e);return documentServices.components.serialize(t)},isExistById:function(e){var t=this.getCompById(e);return documentServices.components.is.exist(t)},printTpaPages:function(){_.each(this.getPages(),function(e){var t=documentServices.tpa.section.getPageData(e);t.hasSection&&console.log(e+" "+t.title+" : has tpa section of type "+t.appData.appDefinitionName)})},getCurrentPage:function(){return documentServices.pages.getCurrentPage()},getCurrentPageSerialized:function(){return this.serializeById(this.getCurrentPage().id)},getCurrentPageChildren:function(){return documentServices.components.getChildren(this.getCurrentPage())},getChildrenOfComp:function(e){var t=this.getCompById(e);return documentServices.components.getChildren(t)},removeComponentById:function(e){var t=this.getCompById(e);"DESKTOP"===t.type?documentServices.components.remove(t):documentServices.mobile.hiddenComponents.hide(t,{updateLayout:!1})},showMobileComponent:function(e){var t=this.getCompById(e);"MOBILE"===t.type&&documentServices.mobile.hiddenComponents.show(t.id,documentServices.components.getPage({id:t.id,type:"DESKTOP"}).id)},getContainerById:function(e){var t=this.getCompById(e);return documentServices.components.getContainer(t)},printHeaderChildren:function(){return w.eds.printChildren(w.eds.getHeader())},printFooterChildren:function(){return w.eds.printChildren(w.eds.getFooter())},printChildren:function(e){function t(e){var t=documentServices.components.getType(e);_.each(["wysiwyg.viewer.components.","mobile.core.components.","wysiwyg.common.components.anchor.viewer."],function(e){t=t.replace(e,"")});var i="tpapps.TPAWidget"===t,n="tpapps.TPASection"===t;if(n||i){var o=documentServices.components.serialize(e).data,r=rendererModel.clientSpecMap[o.applicationId];r&&(t="TPA: ",n&&(t+=r.appDefinitionName),i&&(t+=r.widgets[o.widgetId].tpaWidgetId))}return t}void 0===e&&(e=documentServices.pages.getCurrentPage()),function e(i,n){var o=documentServices.components.is.container(i),r=n+": "+i.id+"\t\t"+t(i)+"\t\t"+function(e){var t=documentServices.components.layout.get(e);return"x: "+t.x+"  y: "+t.y+"  h: "+t.height+"  w: "+t.width}(i);o?console.group(r):console.log(r);var a=_.sortBy(documentServices.components.getChildren(i),function(e){return("Anchor"===t(e)?1e4:0)+documentServices.components.layout.get(e).y});_.each(a,function(t){e(t,n+1)}),o&&console.groupEnd()}(e,0)},getHeader:function(){return documentServices.siteSegments.getHeader()},getFooter:function(){return documentServices.siteSegments.getFooter()},getPagesContainer:function(){return documentServices.siteSegments.getPagesContainer()},serializeHeader:function(){return w.eds.serializeById(w.eds.getHeader())},serializeFooter:function(){return w.eds.serializeById(w.eds.getFooter())},serializeAllSiteSegments:function(){var e=this.serializeHeader(),t=this.serializePagesConatiner(),i=this.serializeFooter();return console.log("\n      header:\n        y: "+e.layout.y+"\n        height: "+e.layout.height+"\n\n      pagesContainer y should be : "+(e.layout.y+e.layout.height)+"\n      pagesContainer:\n        y: "+t.layout.y+"\n        height: "+t.layout.height+"\n\n      footer y should be : "+(t.layout.y+t.layout.height)+"\n      footer:\n        y: "+i.layout.y+"\n        height: "+i.layout.height+"\n      "),{header:e,pagesConatiner:t,footer:i}},serializePagesConatiner:function(){return w.eds.serializeById(w.eds.getPagesContainer())},serializeCurrentPage:function(){return w.eds.serializeById(w.eds.getCurrentPage())},switchToDesktop:function(){return documentServices.viewMode.set("DESKTOP")},switchToMobile:function(){return documentServices.viewMode.set("MOBILE")},resetMobile:function(){return documentServices.mobileConversion.resetMobileLayoutOnAllPages({heuristicStrategy:"minimal"})}},this.solution={getBody:function(){return w.layoutSolver.getSelectedSolution(w.sitePartTypes.BODY,w.storyServices.story.selectedPage)},getBodyLE:function(){return w.solution.getBody()[0].segments[0].getLE()},getHeader:function(){return w.layoutSolver.getSelectedSolution(w.sitePartTypes.HEADER)},getHeaderLE:function(){return w.solution.getHeader()[0].segments[0].getLE()},getFooter:function(){return w.layoutSolver.getSelectedSolution(w.sitePartTypes.FOOTER)},getMobileBody:function(){return w.mobileSolutionManager.getMobileSitePartSolution(w.sitePartTypes.BODY,w.storyServices.story.selectedPage)},getMobileHeader:function(){return w.mobileSolutionManager.getMobileSitePartSolution(w.sitePartTypes.HEADER)},getMobileHeaderLE:function(){return w.solution.getMobileHeader()[0].segments[0].getLE()},getMobileFooter:function(){return w.mobileSolutionManager.getMobileSitePartSolution(w.sitePartTypes.FOOTER)},recalculate:function(){return w.storyServices.recalculateCurrentPage(!0)},recalculateMobile:function(e,t){return void 0===e&&(e="body"),void 0===t&&(t=w.storyServices.story.selectedPage),w.mobileSolutionManager.calculatePart(e,t,!0)}},this.prettyLayout={getAdditionalHeight:function(e){return w.solution.getBody()[e].getAdditionalHeight()},resetAdditionalHeight:function(e){var t=w.solution.getBody()[e];return t.getLayoutSelectionStore().setLGAdditionalHeight(t,0)},getPrettyHeight:function(e){var t=w.solution.getBody()[e].segments[0].getLE();return w.prettyLayoutService.getLayoutPrettyHeight(t)},getFinalHeight:function(e){return w.solution.getBody()[e].segments[0].getLE().getWantedHeight()}},this.getSantaDupComponent=function(){return _.filter(w.$window.documentServices.components.getAllComponents().map(function(e){return e.id}),function(e,t,i){return _.includes(i,e,parseInt(t)+1)})},this.siteLayoutLoader=l.siteLayoutLoader,setTimeout(function(){return angular.module("adiCoreAppInternal")._invokeQueue.filter(function(e){return"service"===e[1]}).forEach(function(e){return w.services[e[2][0]]=w.$injector.get(e[2][0])})})}return e.$inject=["$window","$injector","layoutSolver","sitePartTypes","healthCheck","storyServices","layoutSelectionStoreProvider","modelTree","LayoutGroup","renderedModelApi","modelLookup","flags","wizardService","simpleSolutionManager","mobileSolutionManager","prettyLayoutService","pagesManager","nodeManipulationService","mergedHeaderService","catalogDebug","overlayModel","lssModifier"],e.prototype.reRender=function(e){this.storyServices.reRender(e)},e.prototype.reRenderMobile=function(e){this.storyServices.renderMobileSolution(e)},e.prototype.getCurrentPageNodes=function(){var e=this.modelTree.getPageNodeById(this.storyServices.story.selectedPage);return _.filter(e.children,function(e){return!e.userHidden})},e.prototype.getLayoutSelectionStore=function(){return this.layoutSelectionStoreProvider.getLayoutSelectionStore()},e.prototype.getProblematicIds=function(e){return this.healthCheck.getProblematicIds(e)},e.prototype.removeNode=function(e,t){this.healthCheck.removeNode(e,t)},e.prototype.reduceDbStory=function(e){var t=(e=JSON.parse(JSON.stringify(e||this.storyServices.story.dbStory))).isDraft;if(t)return{isDraft:t,instanceId:e.storyId.instanceId,metaSiteId:e.storyId.metaSiteId};var i,n,o=function(e,t){var i={};return t.forEach(function(t){"string"==typeof t?i[t]=e[t]:i[t[1]]=e[t[0]]}),i},r=function(e,t){var i=o(t,["userHidden","alias","id",["contentElementType","ceType"]]);return t.children&&t.children.length?i.children=a(e,t.children):i.fields=function(e,t){var i={},n=e.blob.locale.contentElements[t.id.replace(/\./g,"_")];return Object.keys(n).forEach(function(e){var r=i[n[e].subType]={};Array.isArray(n[e].value)?r.value=n[e].value.map(function(e){return o(e,["mediaType","relativeUri","fileName"])}):r.value=n[e].value,r.visible=t.argsMatchingPolicy[e],r.visible&&(r.mobileVisible=!t.mobileArgsPolicy[e])}),i}(e,t),i},a=function(e,t){return(t=t.filter(function(e){return!e.userHidden})).map(function(t){return r(e,t)})},s=e.blob.bft,l=s.data.children,c=l.filter(function(e){return"page"===e.type});return c=c.map(function(t){var i=o(t,["id","displayName","userHidden"]);return i.children=a(e,t.children),i}),l.forEach(function(e){"GeneralDescription"===e.contentElementType?i=e:"footer"===e.id&&(n=e)}),{pages:c,header:r(e,i),footer:r(e,n),revision:e.revision,instanceId:e.storyId.instanceId,metaSiteId:e.storyId.metaSiteId,homePageId:s.homePageId,isDraft:t,selectedStyle:{mainKit:e.blob.selectedStyle.mainKit}}},e.prototype.mapProGalleryWidgetRefs=function(e){var t=this,i=_.get(e.blob,["bft","data","children"]),n=_.filter(i,function(e){return"Page"===e.contentElementType});return this.flags.mapProGallery&&(this.$window.proGalleryMap={},_.each(n,function(e){var i=_.filter(e.children,{contentElementType:"ProGallery_Widget"});i.length&&_.each(i,function(e){t.$window.proGalleryMap[e.id]=e.widgetRef})})),this.$window.proGalleryMap},e.prototype.dsSave=function(){this.wizardService.publishStory()},e.prototype.listOfFlags=function(){var e=(this.flags.lodash4?_.pickBy:_[String("pick")])(_.omit(this.flags,_.functions(this.flags)),_.identity);return _.keys(e)},e.prototype.getAllTpaWidgetNodes=function(){var e=[];return this.modelTree.traverse(function(t,i){t.isTpaWidget&&t.containerPageId&&!t.isTpaMultiSection()&&e.push(t)}),e},e.prototype.getAllPages=function(){return this.modelTree.getPagesNodes()},e.prototype.cleanTpaWidgets=function(e){var t=this,i=[];_.each(this.modelTree.getPagesNodes(),function(n){i.push.apply(i,t.modelTree.getTpaWidgetsInPage(n,e))}),_.each(i,function(e){t.nodeManipulationService.deleteNode(e,e.containerPageId,void 0,function(){t.modelTree.markPageAsDirty(e.containerPageId),t.simpleSolutionManager.removeSectionFromSolutionLGs(e.containerPageId,e.id)})})},e.prototype.deletePage=function(e){var t=this,i=this.modelTree.getNodeById(e),n=i.tpaSection;this.pagesManager.isHome(e)||(n&&(_.each(this.pagesManager.getTpaExtraPages(n),function(e){t.nodeManipulationService.deletePage(e,"body",_.noop,_.noop)}),this.cleanTpaWidgets(n)),this.nodeManipulationService.deletePage(i,"body",_.noop,_.noop))},e.prototype.drawCatalogPlayground=function(){this.catalogDebug.drawPlayground()},e}();angular.module("adiAppCoreDebug",["adiCoreAppInternal"]).service("coreDebug",w).run(["coreDebug","$window",function(e,t){t.coreDebug=e}]);var T=function(){function e(){}return e.prototype.create=function(e){return e.properties&&Object.keys(e.properties).length>0&&Object.assign(e.properties,{bg:"#663898",brd:"#7FCCF7"}),{componentType:"mobile.core.components.Container",layout:{x:0,y:0,fixedPosition:!1,width:120,height:120,scale:1,rotationInDegrees:0},type:"Container",components:[],style:{type:"TopLevelStyle",styleType:"custom",skin:e.skin,style:e},activeModes:{}}},e}();angular.module("adiCoreAppInternal").service("boxComponentCreator",T);var I=function(){function e(){}return e.prototype.create=function(e){return{componentType:"wysiwyg.viewer.components.SiteButton",layout:{x:0,y:0,width:121,height:45,font:"9",align:"center",margin:20},style:{type:"TopLevelStyle",styleType:"custom",skin:e.skin,style:e},data:{label:"Button",type:"LinkableButton"},type:"Component",props:{align:"center",margin:20,type:"ButtonProperties"}}},e}();angular.module("adiCoreAppInternal").service("buttonComponentCreator",I);var x=function(){function e(e){this.flags=e}return e.$inject=["flags"],e.prototype.create=function(e){return{componentType:"wysiwyg.viewer.components.ContactForm",layout:{x:0,y:0,fixedPosition:!1,width:290,height:365,scale:1,rotationInDegrees:0},style:{type:"TopLevelStyle",styleType:"custom",skin:e.skin,style:e},type:"Component",skin:e.skin,data:{addressFieldLabel:"Address",bccEmailAddress:"",emailFieldLabel:"Email",errorMessage:"Please add a valid email.",messageFieldLabel:"Message",nameFieldLabel:"Name",phoneFieldLabel:"Phone",subjectFieldLabel:"Subject",submitButtonLabel:"Send",successMessage:"Thanks! Message sent.",textDirection:"left",toEmailAddress:"foo@gmail.com",type:"ContactForm",validationErrorMessage:"Please add required info.",onSubmitBehavior:"message"},props:{hidden_addressFieldLabel:!1,hidden_emailFieldLabel:!0,hidden_messageFieldLabel:!0,hidden_nameFieldLabel:!0,hidden_phoneFieldLabel:!1,hidden_subjectFieldLabel:!0,required_addressFieldLabel:!1,required_emailFieldLabel:!0,required_messageFieldLabel:!1,required_nameFieldLabel:!0,required_phoneFieldLabel:!1,required_subjectFieldLabel:!1,type:"ContactFormProperties",useCookie:!0},activeModes:{}}},e}();angular.module("adiCoreAppInternal").service("contactFormComponentCreator",x);var P=function(){function e(){}return e.prototype.create=function(e){return{componentType:"wysiwyg.viewer.components.FiveGridLine",layout:{x:0,y:0,fixedPosition:!1,width:280,height:40,scale:1,rotationInDegrees:0},style:{type:"TopLevelStyle",styleType:"custom",skin:e.skin,style:e},type:"Component",props:{type:"FiveGridLineProperties"},activeModes:{}}},e}();angular.module("adiCoreAppInternal").service("horizontalLineCreator",P);var M=function(){function e(e){this.flags=e}return e.$inject=["flags"],e.prototype.create=function(e){return{componentType:"wysiwyg.viewer.components.WPhoto",layout:{x:0,y:0,fixedPosition:!1,width:254,height:170,scale:1,rotationInDegrees:0},style:{type:"TopLevelStyle",styleType:"custom",skin:e.skin,style:e},type:"Component",skin:e.skin,data:{width:4743,height:3162,uri:"e74ada189a6b4b21badde4860665a1ef.jpg",title:"",type:"Image",description:"",originalImageDataRef:null},props:{type:"WPhotoProperties",displayMode:"fill",onClickBehavior:"goToLink",filterEffect:null,overrideCrop:null},activeModes:{}}},e}();angular.module("adiCoreAppInternal").service("imageComponentCreator",M);var L=function(){function e(e){this.flags=e}return e.$inject=["flags"],e.prototype.create=function(e){return{componentType:"wysiwyg.viewer.components.menus.DropDownMenu",layout:{x:0,y:0,fixedPosition:!1,width:480,height:60,scale:1,rotationInDegrees:0},type:"Component",data:{menuRef:"#CUSTOM_MAIN_MENU",type:"CustomMenuDataRef"},props:{alignButtons:"center",alignText:"center",moreButtonLabel:"More",moreItemHeight:15,sameWidthButtons:!1,stretchButtonsToMenuWidth:!0,type:"HorizontalMenuProperties",rtl:!1},style:{type:"TopLevelStyle",styleType:"custom",skin:e.skin,style:e},activeModes:{}}},e}();angular.module("adiCoreAppInternal").service("menuComponentCreator",L);var k=function(){function e(e){this.flags=e}return e.$inject=["flags"],e.prototype.create=function(e,t){return void 0===t&&(t="36px"),{componentType:"wysiwyg.viewer.components.WRichText",layout:{x:0,y:0,fixedPosition:!1,width:600,height:39,scale:1,rotationInDegrees:0},type:"Component",data:{text:'<h6 class="font_6" style="font-size: '+t+';">'+e+"</h6>",type:"StyledText",stylesMapId:"CK_EDITOR_PARAGRAPH_STYLES",linkList:[]},props:{type:"WRichTextProperties",packed:!0},style:"txtNew",activeModes:{}}},e}();angular.module("adiCoreAppInternal").service("textComponentCreator",k);var A=function(){function e(e,t,i,n,o,r,a,s,l,c){var d=this;this.catalog=e,this.themeCatalogMapping=t,this.documentServicesMediator=i,this.buttonComponentCreator=n,this.imageComponentCreator=o,this.contactFormComponentCreator=r,this.menuComponentCreator=a,this.boxComponentCreator=s,this.horizontalLineCreator=l,this.textComponentCreator=c,this.creators={buttons:function(e){return d.buttonComponentCreator.create(e)},images:function(e){return d.imageComponentCreator.create(e)},contactForms:function(e){return d.contactFormComponentCreator.create(e)},menus:function(e){return d.menuComponentCreator.create(e)},boxes:function(e){return d.boxComponentCreator.create(e)},horizontalLines:function(e){return d.horizontalLineCreator.create(e)}}}return e.$inject=["catalog","themeCatalogMapping","documentServicesMediator","buttonComponentCreator","imageComponentCreator","contactFormComponentCreator","menuComponentCreator","boxComponentCreator","horizontalLineCreator","textComponentCreator"],e.prototype.drawPlayground=function(){this.drawNewComponents(),this.updateComponentStyle("hc1",this.catalog.headers.headerD1),this.updateComponentStyle("fc1",this.catalog.footers.footerD1)},e.prototype.drawNewComponents=function(){var e,t=this,i=this.countOccurrences();_.each(this.catalog,function(n,o){var r=t.creators[o];if(r){var a=t.textComponentCreator.create(o);t.setLayoutAndAdd(a,10,10,e),e=a,_.each(n,function(n,a){var s=t.textComponentCreator.create(a);t.setLayoutAndAdd(s,10,10,e);var l=i[o+"-"+a]||0,c=t.textComponentCreator.create("("+l+")","17px");t.setLayoutAndAdd(c,360,25,e);var d=r(n);t.setLayoutAndAdd(d,400,10,e),e=d})}})},e.prototype.updateComponentStyle=function(e,t){this.documentServicesMediator.updateStyle(e,t.properties,t.skin)},e.prototype.setLayoutAndAdd=function(e,t,i,n){e.layout.x=t,e.layout.y=(n?n.layout.y+n.layout.height:0)+i,this.addComponent(e)},e.prototype.addComponent=function(e){var t=this.documentServicesMediator.getCurrentPage();this.documentServicesMediator.addComponent(t,e)},e.prototype.countOccurrences=function(){var e={};return _.each(this.themeCatalogMapping,function(t){_.each(t,function(t){var i=t.type+"-"+t.id;e[i]||(e[i]=0),e[i]=e[i]+1})}),e},e}();angular.module("adiCoreAppInternal").service("catalogDebug",A),angular.module("adiCoreAppInternal").service("chroma",function(){return chroma});var E,D=function(){function e(e,t,i,n){this.$window=e,this.$log=t,this.flags=i,this.chroma=n,this.LogoColorExtraction=new this.$window.LogoColorExtraction}return e.$inject=["$window","$log","flags","chroma"],e.getResizedWixImageURL=function(t){var i=t.relativeUri,n=t.width,o=t.height,r=e.getDesiredImageDimensions(n,o);return"//static.wixstatic.com/media/"+i+"/v1/fill/w_"+r.width+",h_"+r.height+"/"+i},e.prototype.loadImageFromURL=function(e){var t=new Image;return new Promise(function(i,n){$(t).on("load",function(){i(t)}),t.crossOrigin="anonymous",t.src=e})},e.getDesiredImageDimensions=function(e,t){var i=Math.min(this.CANVAS_DIMENSION,e);return{height:Math.round(t*(i/e)),width:i}},e.prototype.resizeImage=function(t){var i=e.getDesiredImageDimensions(t.width,t.height);this.flags.debug&&this.$log.info("Logo color: resizing image to ",i),t.height=i.height,t.width=i.width},e.prototype.colorsAndModeFromImage=function(e){var t=document.createElement("canvas");document.body.appendChild(t),t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0,e.width,e.height);var i=this.chroma(AdiCoreSanta.COLORS.BLACK).rgb(),n=this.chroma(AdiCoreSanta.COLORS.WHITE).rgb(),o=this.LogoColorExtraction.computePaletteNew(t,i,n,this.$log,this.flags.debug);return document.body.removeChild(t),o},e.prototype.colorsFromImage=function(e){var t=document.createElement("canvas");document.body.appendChild(t),t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0,e.width,e.height);var i=this.chroma(AdiCoreSanta.COLORS.BLACK).rgb(),n=this.chroma(AdiCoreSanta.COLORS.WHITE).rgb(),o=this.LogoColorExtraction.computePalette(t,i,n);return document.body.removeChild(t),o},e.prototype.mapPaletteToColoration=function(e){var t=this,i=e.map(function(e){return t.rgbToHex(e)});return{colors:{black:i[1],white:i[2],mainColor:i[3],secondaryColor:i[4],thirdColor:i[5],fourthColor:i[6]},mode:_.isEqual(e[0],[128,128,128,1])?null:_.isEqual(e[0],e[1])?AdiCoreSanta.COLORATION_METHOD_TYPE.dark:AdiCoreSanta.COLORATION_METHOD_TYPE.light}},e.prototype.extractLogoColors=function(e){var t=e.contentElement.getFieldValue("Logo").value[0];return this.extractLogoColorsFromWixImage(t)},e.prototype.extractLogoColorsFromWixImage=function(t,i){var n=this;return this.loadImageFromURL(e.getResizedWixImageURL(t)).then(function(e){return i&&i(),n.handleImage(e)})},e.prototype.extractLogoColorsFromURL=function(e){var t=this;return this.loadImageFromURL(e).then(function(e){return t.handleImage(e)})},e.prototype.handleImage=function(e){var t,i=this;if(this.resizeImage(e),this.flags.newPaletteFromLogo)t=this.colorsAndModeFromImage(e),this.flags.debug&&this.$log.info("Logo color: palette generated ",t.colors);else{var n=this.colorsFromImage(e);this.flags.debug&&this.$log.info("Logo color: palette generated ",n.map(function(e){return i.rgbToHex(e)})),t=this.mapPaletteToColoration(n)}return t},e.prototype.rgbToHex=function(e){return this.LogoColorExtraction.rgb2hex(e)},e.CANVAS_DIMENSION=400,e}();angular.module("adiCoreAppInternal").service("logoColorService",D);try{angular.module("adiCorePreload")}catch(e){angular.module("adiCorePreload",[])}angular.module("adiCorePreload").run(["$templateCache",function(e){"use strict";e.put("views/preset-preview/preset-preview.html","<div class='preset-preview-outer-wrapper' ng-style='{width: $ctrl.wrapWidth, height: $ctrl.wrapHeight}' preset-id='{{$ctrl.presetPreview.preset.id}}'>\n<div class='preset-preview-inner-wrapper' ng-style='{transform: &#39;matrix(&#39; + $ctrl.effectiveScale + &#39;, 0, 0, &#39; + $ctrl.effectiveScale + &#39;, 0, 0)&#39;}'>\n<multi-preset-preview flags='$ctrl.flags' is-selected='$ctrl.isSelected' kit='$ctrl.kit' on-after-render='$ctrl.afterRenderHandler()' on-before-render='$ctrl.beforeRenderHandler()' preset-preview-array='$ctrl.presetPreviewArray' preview-position='$ctrl.previewPosition' static='$ctrl.static'></multi-preset-preview>\n</div>\n</div>\n")}]);try{angular.module("adiCorePreload")}catch(e){angular.module("adiCorePreload",[])}angular.module("adiCorePreload").run(["$templateCache",function(e){"use strict";e.put("views/preset-preview/multi-preset-preview.html","<single-preset-preview is-selected='$ctrl.isSelected' kit='$ctrl.kit' ng-repeat='presetPreview in $ctrl.presetPreviewArray' on-after-render='$ctrl.afterRenderHandler()' on-before-render='$ctrl.beforeRenderHandler()' preset-preview='presetPreview' preview-position='$ctrl.previewPosition' static='$ctrl.static'></single-preset-preview>\n")}]),function(e){function t(e,t){var i=e.height(),n=t.height();return{headerHeight:i,mediaHeightOld:n,mediaHeightNew:i+n}}function i(e,t,i){var n=e.css("background-image");n&&(n=n.replace(new RegExp("([,/]h_)"+t+"([,/])"),"$1"+i+"$2"),e.css("background-image",n))}function n(e,n,o){var r=t(o,n),a=r.headerHeight,s=r.mediaHeightOld,l=r.mediaHeightNew;i(n,s,l),function(e,t){var i=e.children("video");i.length>0&&i.height(t)}(n,l),function(e,t,n){e.hasClass("slider-media-layout-preview")&&e.children(".img").each(function(e,o){return i($(o),t,n)})}(n,s,l),n.add(n.parentsUntil(".lg-container")).each(function(e,t){var i=$(t);if(t.style.height){var n=i.height();i.height(n+a)}!!t.style.top&&function(e,t){e.siblings().each(function(e,i){if(i.style.top){var n=$(i),o=parseInt(n.css("top"));n.css("top",o+t+"px")}})}(i,a)}),e.css("margin-top",-a)}e.PresetsTransforms={mergeHeader:function(e){var o=e.eq(0),r=e.eq(1).find(".strip-preview"),a=r.find("> .media-bg"),s=r.find(".strip-media-layout-preview").filter(function(e,t){return 0===parseInt($(t).parent().css("top"))}).eq(0);!function(e){e.css({zIndex:10,position:"relative",background:"none"})}(o),a.length>0?function(e,n,o){var r=t(o,n),a=r.headerHeight,s=r.mediaHeightOld,l=r.mediaHeightNew;i(n,s,l),n.css("height",l),e.css({marginTop:-a,paddingTop:a})}(r,a,o):n(r,s,o)},limitLastPresetHeight:function(e){var t=e.last().find(".strip-preview");if(t.length>0){var i=t.hasClass("strip-preview-mobile"),n=parseInt(t.css("margin-top")),o=(i?175:224)+(n<0?Math.abs(n):0);t.css({maxHeight:o,boxSizing:"content-box"})}},slideShowPreset:function(e,t){var i=e.eq(0),n=i.find(".lg-container").filter('[data-contentElementType != "ListHeader"][data-contentElementType != "ListFooter"]');if(n.wrapAll('<div class="slide-show-film"></div>'),!(n.length<2)){var o=n.parent(),r=i.find(".slideshow-arrows"),a=o.height()/2-40+"px";r.css("padding",a+" 25px 0");var s=!1,l=function(){s&&!o.hasClass("-is-sliding")&&(o.addClass("-is-sliding"),o.one("transitionend",function(){o.removeClass("-is-sliding"),o.children(":first").appendTo(o),setTimeout(l,1e3)}))};o.on("preview-slide-show-start",function(){s=!0,l()}),o.on("preview-slide-show-stop",function(){s=!1}),t.$on("$destroy",function(){o.off("preview-slide-show-start"),o.off("preview-slide-show-stop")})}}},angular.module("adiCoreAppInternal").constant("presetsTranforms",e.PresetsTransforms)}(E||(E={})),function(e){var t=function(){function e(e,t,i,n){var o=this;this.applicationParameters=e,this.slideShowService=t,this.$element=i,n.$watch(function(){return o.presetPreview},function(e){o.presetPreviewArray=_.isArray(e)?e:[e]})}return e.$inject=["applicationParameters","slideShowService","$element","$scope"],e.prototype.beforeRenderHandler=function(){this.calculateEffectiveScale(),this.onBeforeRender&&this.onBeforeRender()},e.prototype.afterRenderHandler=function(){this.calculateWrapperSize(),this.onAfterRender&&this.onAfterRender()},e.prototype.calculateEffectiveScale=function(){void 0===this.scale&&(this.scale=1),this.effectiveScale=this.applicationParameters.isInMobileEditMode()?.675:this.scale},e.prototype.calculateWrapperSize=function(){var e=this.$element.find(".preset-preview-inner-wrapper");this.wrapWidth=this.effectiveScale*e.width(),this.wrapHeight=this.effectiveScale*e.height()},e}();angular.module("adiCoreAppInternal").component("presetPreview",{templateUrl:"views/preset-preview/preset-preview.html",controller:t,bindings:{presetPreview:"<",isSelected:"<?",scale:"<?",onBeforeRender:"&?",onAfterRender:"&?",previewPosition:"<?",static:"<?",flags:"<?",kit:"<?"}})}(E||(E={})),function(e){e.UPDATE_ALL_PREVIEWS_KEY="update-all-previews",e.UPDATE_SELECTED_PREVIEWS_KEY="update-selected-preview";var t={0:"flex-start",50:"center",100:"flex-end"},i=function(){function i(e,t,i,n,o,r,a,s,l,c,d,u,p,h,g,m,f){this.$scope=e,this.$element=t,this.$p=i,this.getLayoutPreview=n,this.getVideoBgPreview=o,this.mediaGallery=r,this.previewColors=a,this.modelTree=s,this.designKit=l,this.flags=c,this.$log=d,this.applicationParameters=u,this.columnService=p,this.slideShowService=h,this.userOverrides=g,this.mediaOpacity=m,this.nodeManipulationService=f,this.PAGE_WIDTH=this.applicationParameters.isInMobileEditMode()?this.applicationParameters.mobilePageWidth:this.applicationParameters.desktopPageWidth,this.getImageStretch=function(e){return e.variationsMap&&e.variationsMap.media&&e.variationsMap.media.imageStretch}}return i.$inject=["$scope","$element","$p","getLayoutPreview","getVideoBgPreview","mediaGallery","previewColors","modelTree","designKit","flags","$log","applicationParameters","columnService","slideShowService","userOverrides","mediaOpacity","nodeManipulationService"],i.prototype.$onInit=function(){var t=this;this.$scope.$watch(function(){return t.presetPreview},function(e){if(e){if(!e.solution)return void t.$log.error("preset with no solution");t.reRender(e)}}),this.static||(this.$scope.$watch(function(){return t.previewPosition},function(e,i){e&&i!==e&&t.reRender(t.presetPreview)}),this.$scope.$on(e.UPDATE_ALL_PREVIEWS_KEY,function(){return t.reRender(t.presetPreview)}),this.$scope.$on(e.UPDATE_SELECTED_PREVIEWS_KEY,function(){t.isSelected&&t.reRender(t.presetPreview)}))},i.prototype.getLayoutBoundary=function(e,t,i){var n=e.width,o=e.left,r=e.top,a=e.rendererHeight||e.height;if(t.isMediaType(e)){var s=t.overrides&&t.overrides.media&&t.overrides.media[e.argIndex];if(!s||"Image"===s.name){var l=this.getImageStretch(t);l&&(r-=l.top,o-=l.left,n+=l.left+l.right,a+=l.top+l.bottom)}}else if(e.type===AdiCoreSanta.ElementTypes.Line){var c=t.getLineWidthAndLeftPosition(e);if(n=c.width,e.docked&&e.docked.left&&e.docked.right){var d=this.applicationParameters.isInMobileEditMode()?320:1200;n=d-e.docked.left.px-e.docked.right.px,o=i?(i-n)/2:(e.width-d)/2}else o=c.left}return{width:n,height:a,top:r,left:o}},i.prototype.renderLEPreview=function(e,t,i,n,o,r,a){var s=this;e.containingSegment.contentElement.fillValuesByMediaType();var l=this.$p.when(),c=[];return t.forEach(function(t){var d=s.getLayoutBoundary(t,e,a),u=angular.element('<div class="layout-preview"></div>').css(d);l=l.then(function(){return s.getLayoutPreview(t,e,o,d,s.kit).then(function(o){o?(o=Array.isArray(o)?o:[o]).forEach(function(o){if(e.isMapStripType(t)&&(u.css({left:_.get(t,"docked.left.px",0),right:_.get(t,"docked.right.px",0),position:"absolute",width:"auto"}),o.css("width","auto"),i.css("position","static"),n&&n.css("position","static")),o.is(".strip-media-layout-preview")){var a=s.mediaOpacity.getOpacity(e.containingSegment.node),l=s.mediaOpacity.getColor(e.containingSegment.node);a<1&&(l?angular.element('<div class="media-bg"></div>').css({width:"100%",height:"100%",backgroundColor:s.previewColors.getRGBColor(l),opacity:1-a}).addClass("color-bg").prependTo(o):o.css("opacity",a)),u.parents(".column-preview").length||u.css("left",0),isNaN(r)||o.css("marginLeft",-r-t.left)}if(o.is(".media-layout-shadow-preview")&&u.parents(".column-container-preview").css("overflow","visible"),t.type===AdiCoreSanta.ElementTypes.Map){var c=e.getMapStyleOverride(t);switch(c||(c=s.designKit.getDefaultMapStyle(e,t)),c){case"white":o.addClass("map-layout-preview-light");break;case"black":o.addClass("map-layout-preview-dark")}}o.addClass((t.type||"").toLowerCase()+"-layout-preview").prependTo(u)}):(u.css("background-color","blue"),u.text(t.type))})}).catch(function(e){s.flags.debug&&s.$log.error(e)}),t.layout&&c.push(s.renderLEPreview(e,t.layout,u,null,o,r)),u.appendTo(i)}),this.$p.all([l].concat(c))},i.prototype.getPageBgColor=function(e,t){var i;if("footer"===t.containerPageId)i=this.previewColors.getRGBColor(this.flags.designKit&&this.designKit.getFooterBg(e)||1,{kit:this.kit});else if("GeneralDescription"===t.contentElementType)i=this.previewColors.getRGBColor(this.flags.designKit&&this.designKit.getHeaderBg(e)||1,{kit:this.kit});else{var n=this.modelTree.getPageNodeById(t.containerPageId);i=this.previewColors.getRGBColor(n&&n.bgObj&&n.bgObj.color||1,{kit:this.kit})}return i},i.prototype.stripBackgroundThumbnail=function(e,t,i){var n=e.posterImageRef||e;return this.mediaGallery.itemToThumbnailUrl({mediaType:n.type.toLowerCase(),relativeUri:n.uri},t,i)},i.prototype.calculateStripHeight=function(e,t,i,n){return(this.flags.lodash4?_.strictSumBy:_[String("sum")])(_.range(n),function(n){var o=(t[i+n]||t[0]).strip||{},r=e[i+n].getRenderedHeight()+(o.paddingTop||0)+(o.paddingBottom||0)+(o.inlinePaddingTop||0)+(o.inlinePaddingBottom||0);return Math.round(r)})},i.prototype.renderPartialMediaBackground=function(e,t,i,n,o,r,a,s,l){var c=t.partialWidth/12*n,d=0;"right"===t.partialMediaPosition&&(d=n-c),this.renderMediaBackground(e,i,c,o,r,a,s,l,d)},i.prototype.renderMediaBackground=function(e,t,i,n,o,r,a,s,l,c){if(void 0===l&&(l=0),t.mediaType===AdiCoreSanta.MediaItemTypes.Video)e.prepend(this.getVideoBgPreview(t,i,n));else{var d=n;s&&(d-=s.top||s.bottom||0),angular.element('<div class="media-bg"></div>').css({width:i,left:l,height:d,opacity:r||1,marginTop:s&&s.top,marginBottom:s&&s.bottom,"background-image":"url("+this.mediaGallery.itemToThumbnailUrl(t,i,d,{alignment:o,focalPoint:c})+")"}).addClass(t.mediaType+"-bg").prependTo(e),a&&angular.element('<div class="media-bg"></div>').css({width:i,height:n,backgroundColor:this.previewColors.getRGBColor(a)}).addClass("color-bg").prependTo(e)}},i.prototype.reRender=function(e){var t=this;if(e){if(!e.solution)return void this.$log.error("preset with no solution");this.onBeforeRender&&this.onBeforeRender(),this.render(e).then(function(){t.onAfterRender&&t.onAfterRender()})}},i.prototype.buildElement=function(e){var t="",i=e.segments[0];return i&&i.node&&(t=i.node.contentElementType),'<div class="lg-container" data-contentElementType="'+t+'"></div>'},i.prototype.buildArrowsElement=function(e){return'<div class="slideshow-arrows" style="z-index: 1; width: 100%; position: absolute; color: '+this.previewColors.getRGBColor(e,{kit:this.kit})+'; font-size: 70px;"><span class="slideshow-left-arrow" style="float: left">&#10216;</span><span class="slideshow-right-arrow" style="float: right;">&#10217;</span></div>'},i.prototype.getHookByNode=function(e){return"footer"===e.containerPageId?"footer":"GeneralDescription"===e.contentElementType?"header":"body"},i.prototype.render=function(e){var i,n=this,o=e.solution,r=e.node,a=e.lgDataArray||[],s=e.stripSizes||[],l=this.getHookByNode(r),c=$("<div data-hook="+l+"></div>");c.css({width:this.applicationParameters.isInMobileEditMode()?320:1200,height:"auto","background-color":this.getPageBgColor(o,r)});var d=[],u=this.slideShowService.getPaddingForSlideShow(o,e),p=u.slideShowPaddingTop,h=u.slideShowPaddingBottom;return _.each(o,function(r,l){var u=a[l]||a[0]||{},g=u.strip||{},m=u.menuStrip||{},f=r.getRenderedHeight(),v=u.topLine&&u.topLine.enable&&"space"===u.topLine.line&&u.topLine.space||0,y=u.bottomLine&&u.bottomLine.enable&&"space"===u.bottomLine.line&&u.bottomLine.space||0,b=p||g.paddingTop||0,S=h||g.paddingBottom||0;if(n.applicationParameters.isInMobileEditMode()&&c.addClass("layout-preset-preview-mobile"),s[l]&&(i=angular.element('<div class="strip-preview"></div>').appendTo(c),n.applicationParameters.isInMobileEditMode()&&i.addClass("strip-preview-mobile"),g.enable))if(i.css("background-color",n.previewColors.getRGBColor(g.color||"color_18",{kit:n.kit})),g.mediaRef)i.css("background-image","url("+n.stripBackgroundThumbnail(g.mediaRef,c.width(),n.calculateStripHeight(o,a,l,e.stripSizes[l]))+")");else if(g.mediaItems){var C=n.mediaOpacity.getOpacity(r.segments[0].node.identifyingNode),w=n.mediaOpacity.getColor(r.segments[0].node.identifyingNode),T=c.width(),I=n.calculateStripHeight(o,a,l,e.stripSizes[l]),x=g&&g.partialMediaPosition;n.flags.newListLayouts&&x?n.renderPartialMediaBackground(i,g,g.mediaItems[0],T,I,g.alignType,C,w):n.renderMediaBackground(i,g.mediaItems[0],T,I,g.alignType,C,w)}if(!angular.element(i||c).find(".slideshow-arrows")[0]){var P=n.addArrowsToSlideShow(e,r);angular.element(P).appendTo(i||c)}var M=n.buildElement(r),L=angular.element(M).appendTo(i||c),k=Math.max(b,0)+v,$=Math.max(S,0)+y;if(L.css({paddingTop:k,paddingBottom:$}),n.applicationParameters.isInMobileEditMode()&&L.addClass("lg-container-mobile"),m.enable){var A=m.paddingTop||0,E=m.paddingBottom||0,D=r.segments[0].getLENoError(),F=_.find(D.layout,function(e){return e.type===AdiCoreSanta.ElementTypes.Menu||e.subType===AdiCoreSanta.ElementSubTypes.Copyright});if(F){var B=void 0,O=void 0;if(r.isMobile()&&r.isSiteHeader()?(B=D.menuStripTop,O=D.menuStripBottom-D.menuStripTop):(B=F.top-A,O=A+E+F.height),!isNaN(B)&&!isNaN(O)){var H=angular.element('<div class="menu-strip-preview"></div>').appendTo(L).css({height:O,marginTop:k+B});H.css("background-color",n.previewColors.getRGBColor(m.color||"color_18",{kit:n.kit})),m.mediaRef&&H.css("background-image","url("+n.stripBackgroundThumbnail(m.mediaRef,c.width(),O)+")")}}}var R=r.columns;if(n.flags.coreNewMobileColumns&&R&&r.isMobile()&&(R=_(R).flatten().map(function(e){return[e]}).value()),!R||r.isMobile()&&!n.flags.coreNewMobileColumns){var N=angular.element('<div class="lg-preview"></div>').appendTo(L).height(f),U=0;n.flags.newListLayouts&&g.partialContentPosition&&(U=n.getPartialColumnContentOffset(g,c,r));var V=[];if(r.segments.forEach(function(e){var t=angular.element('<div class="segment-preview"></div>').width(e.width).height(e.height).css("left",e.left+U);t.appendTo(N);var i=e.getLENoError();i&&(t.attr("le-id",i.id),V.push(n.renderLEPreview(i,i.layout,t,null,c)))}),!n.flags.coreNewMobileColumns)(w=r.isMobile()&&n.getMobileBackgroundColor(r))&&L.css("background-color",w),L.css({paddingTop:k+(g.inlinePaddingTop||0),paddingBottom:$+(g.inlinePaddingBottom||0)});d.push(n.$p.all(V))}else{var z=r.isMobile()?R.map(function(e){return e[0].height}):n.columnService.getRowsHeight(r),j=0,W=R.length-1,G=[],K=n.columnService.getFloatingColumnOffset(r);R.forEach(function(e,i){var o,a=z[i],s=n.columnService.isStretchedMediaColumn(e[0]),l=i<W&&R[W]&&n.columnService.isStretchedMediaColumn(R[W][0]),d=s?(n.flags.lodash4?_.strictSumBy:_.sum)(z):a,u=angular.element('<div class="lg-preview"></div>').appendTo(L).height(d),p=n.columnService.getColumnsContainerProps(e),h=r.isMobile()?0:p.siteMargin||0;u.addClass("lg-columns-preview"),s&&(i>0&&u.css("margin-top",-1*z[i-1]),i<R.length-1&&u.css("margin-bottom",-1*z[i+1])),l&&u.css("z-index",100),p.fullWidth?(u.addClass("lg-columns-full-width-preview"),u.css({paddingLeft:h,paddingRight:h}),o=c.width()-2*h):(u.width(n.PAGE_WIDTH),o=n.PAGE_WIDTH);var m=p.columnsMargin,f=p.frameMargin,v=r.isHeader()?1:(o-m*(e.length-1)-2*f)/n.columnService.totalStructureColumns;e.forEach(function(i,a){var s=r.isMobile()?50:n.columnService.getAlignment(e,a),l=r.isMobile()?320:Math.floor(v*(i.renderedWidth||i.width)),m=angular.element('<div class="column-container-preview"></div>').height(d).css({width:l,flex:"0 0 auto","justify-content":t[s],top:a%2?K:0}).appendTo(u),f=r.isMobile()?n.applicationParameters.mobileFullWidth:n.columnService.calculateColumnWidth(e,a),y=angular.element('<div class="column-preview"></div>').height(d).width(f).appendTo(m),b=i.segment&&i.segment.getLENoError();if(b){m.attr("le-id",b.id);var S=i.isVirtual||i.isMobile?i.layout:b.layout,C=n.columnService.createColumnBackground(i);if(C)if(C.media){S=_.filter(S,function(e){return e.type!==AdiCoreSanta.ElementTypes.Media});var w=n.mediaOpacity.getOpacity(b.containingSegment.node),T=n.mediaOpacity.getColor(b.containingSegment.node),I=i.extraProps&&i.extraProps.mediaBackgroundPadding?i.extraProps.mediaBackgroundPadding:void 0;n.renderMediaBackground(m,C.media,l,d,void 0,w,T,I,0,n.flags.focalPointFocusOnFaces&&b.containingSegment.getFocalPoint())}else C.color&&m.css("background-color",n.previewColors.getRGBColor(C.color,{opacity:C.colorOpacity||1,kit:n.kit}));var x=void 0;if(i.isVirtual&&1===e.length){var P=p.fullWidth?h:(c.width()-n.PAGE_WIDTH)/2;x=P+(c.width()-2*P-f)*s/100}G.push(n.renderLEPreview(b,n.columnService.adjustLayoutForColumns(b,S,e,a,j,g.inlinePaddingTop||0,g.inlinePaddingBottom||0),y,m,c,x,o))}}),j+=a}),d.push(n.$p.all(G))}}),this.$p.all(d).then(function(){n.$element.empty(),n.$element.append(c)})},i.prototype.getPartialColumnContentOffset=function(e,t,i){var n=e.partialContentPosition,o=t.width(),r=(e.partialWidth/12*o-this.applicationParameters.getPixelsFromGridUnits(e.partialWidth)-10)/2;return"left"===n&&(r=-r),r},i.prototype.getMobileBackgroundColor=function(e){if(!this.flags.coreNewMobileColumns&&e.isMobile()){var t,i=this.columnService.getAnyColumnBackground(e),n=e.segments[0],o=n.getLENoError(),r=n.getRealNodeFromPreviewNode(),a=this.nodeManipulationService.getSegmentByNode(r,r.containerPageId);if(o&&o.hasMedia()&&!o.onMediaStructure&&a&&a.allowedMobileMediaBackgroundPadding()||o&&o.hasMedia()&&o.onMediaStructure){var s=this.columnService.getSegmentMediaColumnBackground(a);t=s&&s.mediaColor}else t=this.userOverrides.getColumnBgColorOverride(n)||i&&i.color;return i&&t?this.previewColors.getRGBColor(t,{kit:this.kit,opacity:i.colorOpacity||1}):void 0}},i.prototype.addArrowsToSlideShow=function(e,t){if("ListHeader"!==t.contentType&&"ListFooter"!==t.contentType&&!t.isMobile()&&e.flags&&e.flags.indexOf("slideShowPreset")>-1){var i=this.slideShowService.getNavigationColor(t);return this.buildArrowsElement(i)}return""},i}();angular.module("adiCoreAppInternal").component("singlePresetPreview",{controller:i,bindings:{presetPreview:"<",isSelected:"<",onBeforeRender:"&?",onAfterRender:"&?",previewPosition:"<?",static:"<?",kit:"<?"}})}(E||(E={})),function(e){var t=function(){function e(e,t,i){this.$scope=e,this.$element=t,this.presetsTranforms=i,this.isAfterRenderScheduled=!1}return e.$inject=["$scope","$element","presetsTranforms"],e.prototype.beforeRenderHandler=function(){this.onBeforeRender&&this.onBeforeRender()},e.prototype.afterRenderHandler=function(){var e=this;1===this.presetPreviewArray.length?this.doAfterRender():this.isAfterRenderScheduled||(this.isAfterRenderScheduled=!0,this.$scope.$evalAsync(function(){return e.doAfterRender()}))},e.prototype.doAfterRender=function(){this.isAfterRenderScheduled=!1,this.executeTransforms(),this.onAfterRender&&this.onAfterRender()},e.prototype.executeTransforms=function(){var e=this;if(this.flags){var t=this.$element.find("single-preset-preview > *");this.flags.filter(function(t){return!!e.presetsTranforms[t]}).map(function(t){return e.presetsTranforms[t]}).forEach(function(i){return i(t,e.$scope)})}},e}();angular.module("adiCoreAppInternal").component("multiPresetPreview",{templateUrl:"views/preset-preview/multi-preset-preview.html",controller:t,bindings:{presetPreviewArray:"<",isSelected:"<?",onBeforeRender:"&?",onAfterRender:"&?",previewPosition:"<?",static:"<?",flags:"<?",kit:"<?"}})}(E||(E={})),i.core=S,i.LogoColorExtraction=o,i.DocumentServicesMediator=p,i.LogoColorService=D,i.preset=E}});
//# sourceMappingURL=second-parties-js.bundle.min.js.map